<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WLG Cover</title>
    <link href="https://shevernitskiy.github.io/store/fonts/Gilroy/import.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="icon"
      type="image/png"
      href="data:image/png;base64,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"
    />
    <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function ce(){}const sg=n=>n;function en(n,e){for(const t in e)n[t]=e[t];return n}function Vc(n){return n()}function Pl(){return Object.create(null)}function He(n){n.forEach(Vc)}function Nt(n){return typeof n=="function"}function Ue(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function og(n){return Object.keys(n).length===0}function ag(n,...e){if(n==null){for(const r of e)r(void 0);return ce}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function fr(n,e,t){n.$$.on_destroy.push(ag(e,t))}function ft(n,e,t,r){if(n){const i=Wc(n,e,t,r);return n[0](i)}}function Wc(n,e,t,r){return n[1]&&r?en(t.ctx.slice(),n[1](r(e))):t.ctx}function dt(n,e,t,r){if(n[2]&&r){const i=n[2](r(t));if(e.dirty===void 0)return i;if(typeof i=="object"){const s=[],o=Math.max(e.dirty.length,i.length);for(let a=0;a<o;a+=1)s[a]=e.dirty[a]|i[a];return s}return e.dirty|i}return e.dirty}function pt(n,e,t,r,i,s){if(i){const o=Wc(e,t,r,s);n.p(o,i)}}function mt(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let r=0;r<t;r++)e[r]=-1;return e}return-1}function dr(n){const e={};for(const t in n)t[0]!=="$"&&(e[t]=n[t]);return e}function tn(n){return n??""}function Ie(n,e,t){return n.set(t),e}const jc=typeof window<"u";let Wo=jc?()=>window.performance.now():()=>Date.now(),ka=jc?n=>requestAnimationFrame(n):ce;const lr=new Set;function Xc(n){lr.forEach(e=>{e.c(n)||(lr.delete(e),e.f())}),lr.size!==0&&ka(Xc)}function qc(n){let e;return lr.size===0&&ka(Xc),{promise:new Promise(t=>{lr.add(e={c:n,f:t})}),abort(){lr.delete(e)}}}const lg=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function te(n,e){n.appendChild(e)}function Yc(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function ug(n){const e=ne("style");return e.textContent="/* empty */",cg(Yc(n),e),e.sheet}function cg(n,e){return te(n.head||n,e),e.sheet}function O(n,e,t){n.insertBefore(e,t||null)}function F(n){n.parentNode&&n.parentNode.removeChild(n)}function hg(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function ne(n){return document.createElement(n)}function zn(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function rt(n){return document.createTextNode(n)}function V(){return rt(" ")}function Ot(){return rt("")}function X(n,e,t,r){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}function ct(n){return function(e){return e.preventDefault(),n.call(this,e)}}function Ht(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function Kc(n){return function(e){e.target===this&&n.call(this,e)}}function T(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function pr(n,e){for(const t in e)T(n,t,e[t])}function Zc(n){return n===""?null:+n}function fg(n){return Array.from(n.childNodes)}function ht(n,e){e=""+e,n.data!==e&&(n.data=e)}function xn(n,e){n.value=e??""}function ve(n,e,t,r){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,"")}function Fe(n,e,t){n.classList.toggle(e,!!t)}function dg(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}class Qc{is_svg=!1;e=void 0;n=void 0;t=void 0;a=void 0;constructor(e=!1){this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,r=null){this.e||(this.is_svg?this.e=zn(t.nodeName):this.e=ne(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(r)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)O(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(F)}}function Ft(n,e){return new n(e)}const ls=new Map;let us=0;function pg(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function mg(n,e){const t={stylesheet:ug(e),rules:{}};return ls.set(n,t),t}function gg(n,e,t,r,i,s,o,a=0){const l=16.666/r;let u=`{
`;for(let m=0;m<=1;m+=l){const v=e+(t-e)*s(m);u+=m*100+`%{${o(v,1-v)}}
`}const c=u+`100% {${o(t,1-t)}}
}`,h=`__svelte_${pg(c)}_${a}`,d=Yc(n),{stylesheet:f,rules:p}=ls.get(d)||mg(d,n);p[h]||(p[h]=!0,f.insertRule(`@keyframes ${h} ${c}`,f.cssRules.length));const g=n.style.animation||"";return n.style.animation=`${g?`${g}, `:""}${h} ${r}ms linear ${i}ms 1 both`,us+=1,h}function _g(n,e){const t=(n.style.animation||"").split(", "),r=t.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),i=t.length-r.length;i&&(n.style.animation=r.join(", "),us-=i,us||vg())}function vg(){ka(()=>{us||(ls.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&F(e)}),ls.clear())})}function bg(n,e,t,r){if(!e)return ce;const i=n.getBoundingClientRect();if(e.left===i.left&&e.right===i.right&&e.top===i.top&&e.bottom===i.bottom)return ce;const{delay:s=0,duration:o=300,easing:a=sg,start:l=Wo()+s,end:u=l+o,tick:c=ce,css:h}=t(n,{from:e,to:i},r);let d=!0,f=!1,p;function g(){h&&(p=gg(n,0,1,o,s,a,h)),s||(f=!0)}function m(){h&&_g(n,p),d=!1}return qc(v=>{if(!f&&v>=l&&(f=!0),f&&v>=u&&(c(1,0),m()),!d)return!1;if(f){const x=v-l,S=0+1*a(x/o);c(S,1-S)}return!0}),g(),c(0,1),m}function xg(n){const e=getComputedStyle(n);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:t,height:r}=e,i=n.getBoundingClientRect();n.style.position="absolute",n.style.width=t,n.style.height=r,yg(n,i)}}function yg(n,e){const t=n.getBoundingClientRect();if(e.left!==t.left||e.top!==t.top){const r=getComputedStyle(n),i=r.transform==="none"?"":r.transform;n.style.transform=`${i} translate(${e.left-t.left}px, ${e.top-t.top}px)`}}let Qr;function Hr(n){Qr=n}function Jc(){if(!Qr)throw new Error("Function called outside component initialization");return Qr}function $c(n){Jc().$$.on_mount.push(n)}function li(){const n=Jc();return(e,t,{cancelable:r=!1}={})=>{const i=n.$$.callbacks[e];if(i){const s=dg(e,t,{cancelable:r});return i.slice().forEach(o=>{o.call(n,s)}),!s.defaultPrevented}return!0}}function Be(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(r=>r.call(this,e))}const tr=[],q=[];let ur=[];const jo=[],eh=Promise.resolve();let Xo=!1;function th(){Xo||(Xo=!0,eh.then(rh))}function nh(){return th(),eh}function Jr(n){ur.push(n)}function ee(n){jo.push(n)}const Xs=new Set;let Yn=0;function rh(){if(Yn!==0)return;const n=Qr;do{try{for(;Yn<tr.length;){const e=tr[Yn];Yn++,Hr(e),Sg(e.$$)}}catch(e){throw tr.length=0,Yn=0,e}for(Hr(null),tr.length=0,Yn=0;q.length;)q.pop()();for(let e=0;e<ur.length;e+=1){const t=ur[e];Xs.has(t)||(Xs.add(t),t())}ur.length=0}while(tr.length);for(;jo.length;)jo.pop()();Xo=!1,Xs.clear(),Hr(n)}function Sg(n){if(n.fragment!==null){n.update(),He(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Jr)}}function wg(n){const e=[],t=[];ur.forEach(r=>n.indexOf(r)===-1?e.push(r):t.push(r)),t.forEach(r=>r()),ur=e}const Ki=new Set;let Fn;function Ye(){Fn={r:0,c:[],p:Fn}}function Ke(){Fn.r||He(Fn.c),Fn=Fn.p}function k(n,e){n&&n.i&&(Ki.delete(n),n.i(e))}function R(n,e,t,r){if(n&&n.o){if(Ki.has(n))return;Ki.add(n),Fn.c.push(()=>{Ki.delete(n),r&&(t&&n.d(1),r())}),n.o(e)}else r&&r()}function cs(n){return n?.length!==void 0?n:Array.from(n)}function Tg(n,e){R(n,1,1,()=>{e.delete(n.key)})}function Cg(n,e){n.f(),Tg(n,e)}function Pg(n,e,t,r,i,s,o,a,l,u,c,h){let d=n.length,f=s.length,p=d;const g={};for(;p--;)g[n[p].key]=p;const m=[],v=new Map,x=new Map,S=[];for(p=f;p--;){const A=h(i,s,p),U=t(A);let E=o.get(U);E?S.push(()=>E.p(A,e)):(E=u(U,A),E.c()),v.set(U,m[p]=E),U in g&&x.set(U,Math.abs(p-g[U]))}const y=new Set,b=new Set;function B(A){k(A,1),A.m(a,c),o.set(A.key,A),c=A.first,f--}for(;d&&f;){const A=m[f-1],U=n[d-1],E=A.key,_=U.key;A===U?(c=A.first,d--,f--):v.has(_)?!o.has(E)||y.has(E)?B(A):b.has(_)?d--:x.get(E)>x.get(_)?(b.add(E),B(A)):(y.add(_),d--):(l(U,o),d--)}for(;d--;){const A=n[d];v.has(A.key)||l(A,o)}for(;f;)B(m[f-1]);return He(S),m}function Ra(n,e){const t={},r={},i={$$scope:1};let s=n.length;for(;s--;){const o=n[s],a=e[s];if(a){for(const l in o)l in a||(r[l]=1);for(const l in a)i[l]||(t[l]=a[l],i[l]=1);n[s]=a}else for(const l in o)i[l]=1}for(const o in r)o in t||(t[o]=void 0);return t}function $(n,e,t){const r=n.$$.props[e];r!==void 0&&(n.$$.bound[r]=t,t(n.$$.ctx[r]))}function H(n){n&&n.c()}function z(n,e,t){const{fragment:r,after_update:i}=n.$$;r&&r.m(e,t),Jr(()=>{const s=n.$$.on_mount.map(Vc).filter(Nt);n.$$.on_destroy?n.$$.on_destroy.push(...s):He(s),n.$$.on_mount=[]}),i.forEach(Jr)}function L(n,e){const t=n.$$;t.fragment!==null&&(wg(t.after_update),He(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Ag(n,e){n.$$.dirty[0]===-1&&(tr.push(n),th(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function De(n,e,t,r,i,s,o=null,a=[-1]){const l=Qr;Hr(n);const u=n.$$={fragment:null,ctx:[],props:s,update:ce,not_equal:i,bound:Pl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Pl(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(u.root);let c=!1;if(u.ctx=t?t(n,e.props||{},(h,d,...f)=>{const p=f.length?f[0]:d;return u.ctx&&i(u.ctx[h],u.ctx[h]=p)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](p),c&&Ag(n,h)),d}):[],u.update(),c=!0,He(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const h=fg(e.target);u.fragment&&u.fragment.l(h),h.forEach(F)}else u.fragment&&u.fragment.c();e.intro&&k(n.$$.fragment),z(n,e.target,e.anchor),rh()}Hr(l)}class ze{$$=void 0;$$set=void 0;$destroy(){L(this,1),this.$destroy=ce}$on(e,t){if(!Nt(t))return ce;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!og(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Eg="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Eg);var Mg={grad:.9,turn:360,rad:360/(2*Math.PI)},sn=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},et=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t+0},Bt=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n>e?n:e},ih=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},Al=function(n){return{r:Bt(n.r,0,255),g:Bt(n.g,0,255),b:Bt(n.b,0,255),a:Bt(n.a)}},qs=function(n){return{r:et(n.r),g:et(n.g),b:et(n.b),a:et(n.a,3)}},kg=/^#([0-9a-f]{3,8})$/i,Pi=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},sh=function(n){var e=n.r,t=n.g,r=n.b,i=n.a,s=Math.max(e,t,r),o=s-Math.min(e,t,r),a=o?s===e?(t-r)/o:s===t?2+(r-e)/o:4+(e-t)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},oh=function(n){var e=n.h,t=n.s,r=n.v,i=n.a;e=e/360*6,t/=100,r/=100;var s=Math.floor(e),o=r*(1-t),a=r*(1-(e-s)*t),l=r*(1-(1-e+s)*t),u=s%6;return{r:255*[r,a,o,o,l,r][u],g:255*[l,r,r,a,o,o][u],b:255*[o,o,l,r,r,a][u],a:i}},El=function(n){return{h:ih(n.h),s:Bt(n.s,0,100),l:Bt(n.l,0,100),a:Bt(n.a)}},Ml=function(n){return{h:et(n.h),s:et(n.s),l:et(n.l),a:et(n.a,3)}},kl=function(n){return oh((t=(e=n).s,{h:e.h,s:(t*=((r=e.l)<50?r:100-r)/100)>0?2*t/(r+t)*100:0,v:r+t,a:e.a}));var e,t,r},Vr=function(n){return{h:(e=sh(n)).h,s:(i=(200-(t=e.s))*(r=e.v)/100)>0&&i<200?t*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,t,r,i},Rg=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Bg=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ig=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Fg=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Rl={string:[[function(n){var e=kg.exec(n);return e?(n=e[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?et(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?et(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var e=Ig.exec(n)||Fg.exec(n);return e?e[2]!==e[4]||e[4]!==e[6]?null:Al({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(n){var e=Rg.exec(n)||Bg.exec(n);if(!e)return null;var t,r,i=El({h:(t=e[1],r=e[2],r===void 0&&(r="deg"),Number(t)*(Mg[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return kl(i)},"hsl"]],object:[[function(n){var e=n.r,t=n.g,r=n.b,i=n.a,s=i===void 0?1:i;return sn(e)&&sn(t)&&sn(r)?Al({r:Number(e),g:Number(t),b:Number(r),a:Number(s)}):null},"rgb"],[function(n){var e=n.h,t=n.s,r=n.l,i=n.a,s=i===void 0?1:i;if(!sn(e)||!sn(t)||!sn(r))return null;var o=El({h:Number(e),s:Number(t),l:Number(r),a:Number(s)});return kl(o)},"hsl"],[function(n){var e=n.h,t=n.s,r=n.v,i=n.a,s=i===void 0?1:i;if(!sn(e)||!sn(t)||!sn(r))return null;var o=function(a){return{h:ih(a.h),s:Bt(a.s,0,100),v:Bt(a.v,0,100),a:Bt(a.a)}}({h:Number(e),s:Number(t),v:Number(r),a:Number(s)});return oh(o)},"hsv"]]},Bl=function(n,e){for(var t=0;t<e.length;t++){var r=e[t][0](n);if(r)return[r,e[t][1]]}return[null,void 0]},Og=function(n){return typeof n=="string"?Bl(n.trim(),Rl.string):typeof n=="object"&&n!==null?Bl(n,Rl.object):[null,void 0]},Ys=function(n,e){var t=Vr(n);return{h:t.h,s:Bt(t.s+100*e,0,100),l:t.l,a:t.a}},Ks=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},Il=function(n,e){var t=Vr(n);return{h:t.h,s:t.s,l:Bt(t.l+100*e,0,100),a:t.a}},Fl=function(){function n(e){this.parsed=Og(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return et(Ks(this.rgba),2)},n.prototype.isDark=function(){return Ks(this.rgba)<.5},n.prototype.isLight=function(){return Ks(this.rgba)>=.5},n.prototype.toHex=function(){return e=qs(this.rgba),t=e.r,r=e.g,i=e.b,o=(s=e.a)<1?Pi(et(255*s)):"","#"+Pi(t)+Pi(r)+Pi(i)+o;var e,t,r,i,s,o},n.prototype.toRgb=function(){return qs(this.rgba)},n.prototype.toRgbString=function(){return e=qs(this.rgba),t=e.r,r=e.g,i=e.b,(s=e.a)<1?"rgba("+t+", "+r+", "+i+", "+s+")":"rgb("+t+", "+r+", "+i+")";var e,t,r,i,s},n.prototype.toHsl=function(){return Ml(Vr(this.rgba))},n.prototype.toHslString=function(){return e=Ml(Vr(this.rgba)),t=e.h,r=e.s,i=e.l,(s=e.a)<1?"hsla("+t+", "+r+"%, "+i+"%, "+s+")":"hsl("+t+", "+r+"%, "+i+"%)";var e,t,r,i,s},n.prototype.toHsv=function(){return e=sh(this.rgba),{h:et(e.h),s:et(e.s),v:et(e.v),a:et(e.a,3)};var e},n.prototype.invert=function(){return wt({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},n.prototype.saturate=function(e){return e===void 0&&(e=.1),wt(Ys(this.rgba,e))},n.prototype.desaturate=function(e){return e===void 0&&(e=.1),wt(Ys(this.rgba,-e))},n.prototype.grayscale=function(){return wt(Ys(this.rgba,-1))},n.prototype.lighten=function(e){return e===void 0&&(e=.1),wt(Il(this.rgba,e))},n.prototype.darken=function(e){return e===void 0&&(e=.1),wt(Il(this.rgba,-e))},n.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},n.prototype.alpha=function(e){return typeof e=="number"?wt({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):et(this.rgba.a,3);var t},n.prototype.hue=function(e){var t=Vr(this.rgba);return typeof e=="number"?wt({h:e,s:t.s,l:t.l,a:t.a}):et(t.h)},n.prototype.isEqual=function(e){return this.toHex()===wt(e).toHex()},n}(),wt=function(n){return n instanceof Fl?n:new Fl(n)};function Ol(n){let e;return{c(){e=ne("input"),T(e,"type","hidden"),T(e,"name",n[3]),e.value=n[0]},m(t,r){O(t,e,r)},p(t,r){r&8&&T(e,"name",t[3]),r&1&&(e.value=t[0])},d(t){t&&F(e)}}}function Ug(n){let e,t,r,i,s,o,a,l,u,c=n[3]&&Ol(n);return{c(){e=ne("div"),t=ne("div"),r=V(),i=ne("div"),o=V(),c&&c.c(),a=Ot(),T(t,"class","track svelte-w4j1dz"),T(i,"class","thumb svelte-w4j1dz"),T(e,"class","slider svelte-w4j1dz"),T(e,"role","slider"),T(e,"aria-orientation",n[4]),T(e,"aria-valuemax",n[11]),T(e,"aria-valuemin",n[10]),T(e,"aria-valuenow",n[0]),T(e,"aria-valuetext",s=n[2](n[0])),T(e,"aria-label",n[7]),T(e,"aria-labelledby",n[8]),T(e,"aria-controls",n[9]),T(e,"tabindex","0"),Fe(e,"reverse",n[5]),ve(e,"--position",n[12])},m(h,d){O(h,e,d),te(e,t),te(e,r),te(e,i),n[22](e),O(h,o,d),c&&c.m(h,d),O(h,a,d),l||(u=[X(window,"mousemove",n[15]),X(window,"mouseup",n[16]),X(e,"keydown",n[13]),X(e,"mousedown",Kc(function(){Nt(n[6]?void 0:n[14])&&(n[6]?void 0:n[14]).apply(this,arguments)})),X(e,"touchstart",ct(function(){Nt(n[6]?void 0:n[17])&&(n[6]?void 0:n[17]).apply(this,arguments)}),{passive:!1}),X(e,"touchmove",ct(function(){Nt(n[6]?void 0:n[17])&&(n[6]?void 0:n[17]).apply(this,arguments)}),{passive:!1}),X(e,"touchend",ct(function(){Nt(n[6]?void 0:n[17])&&(n[6]?void 0:n[17]).apply(this,arguments)}),{passive:!1})],l=!0)},p(h,[d]){n=h,d&16&&T(e,"aria-orientation",n[4]),d&2048&&T(e,"aria-valuemax",n[11]),d&1024&&T(e,"aria-valuemin",n[10]),d&1&&T(e,"aria-valuenow",n[0]),d&5&&s!==(s=n[2](n[0]))&&T(e,"aria-valuetext",s),d&128&&T(e,"aria-label",n[7]),d&256&&T(e,"aria-labelledby",n[8]),d&512&&T(e,"aria-controls",n[9]),d&32&&Fe(e,"reverse",n[5]),d&4096&&ve(e,"--position",n[12]),n[3]?c?c.p(n,d):(c=Ol(n),c.c(),c.m(a.parentNode,a)):c&&(c.d(1),c=null)},i:ce,o:ce,d(h){h&&(F(e),F(o),F(a)),n[22](null),c&&c.d(h),l=!1,He(u)}}}function Gg(n,e,t){let r,i,s,o,{min:a=0}=e,{max:l=100}=e,{step:u=1}=e,{value:c=50}=e,{ariaValueText:h=C=>C.toString()}=e,{name:d=void 0}=e,{direction:f="horizontal"}=e,{reverse:p=!1}=e,{keyboardOnly:g=!1}=e,{slider:m=void 0}=e,{ariaLabel:v=void 0}=e,{ariaLabelledBy:x=void 0}=e,{ariaControls:S=void 0}=e,{isDragging:y=!1}=e;const b=li();function B(C){const N=1/s,W=Math.round(C*N)/N;return Math.max(r,Math.min(i,W))}function A(C){const N=C.shiftKey?s*10:s;C.key==="ArrowUp"||C.key==="ArrowRight"?(t(0,c+=N),C.preventDefault()):C.key==="ArrowDown"||C.key==="ArrowLeft"?(t(0,c-=N),C.preventDefault()):C.key==="Home"?(t(0,c=r),C.preventDefault()):C.key==="End"?(t(0,c=i),C.preventDefault()):C.key==="PageUp"?(t(0,c+=s*10),C.preventDefault()):C.key==="PageDown"&&(t(0,c-=s*10),C.preventDefault()),t(0,c=B(c)),b("input",c)}const U={horizontal:{clientSize:"clientWidth",offset:"left",client:"clientX"},vertical:{clientSize:"clientHeight",offset:"top",client:"clientY"}};function E(C){const N=m?.[U[f].clientSize]||120,W=m?.getBoundingClientRect()[U[f].offset]||0;let le=C[U[f].client]-W;f==="vertical"&&(le=-1*le+N),p?t(0,c=i-le/N*(i-r)):t(0,c=le/N*(i-r)+r),t(0,c=B(c)),b("input",c)}function _(C){E(C),t(18,y=!0)}function I(C){y&&E(C)}function re(){t(18,y=!1)}function Y(C){E({clientX:C.changedTouches[0].clientX,clientY:C.changedTouches[0].clientY})}function j(C){q[C?"unshift":"push"](()=>{m=C,t(1,m)})}return n.$$set=C=>{"min"in C&&t(19,a=C.min),"max"in C&&t(20,l=C.max),"step"in C&&t(21,u=C.step),"value"in C&&t(0,c=C.value),"ariaValueText"in C&&t(2,h=C.ariaValueText),"name"in C&&t(3,d=C.name),"direction"in C&&t(4,f=C.direction),"reverse"in C&&t(5,p=C.reverse),"keyboardOnly"in C&&t(6,g=C.keyboardOnly),"slider"in C&&t(1,m=C.slider),"ariaLabel"in C&&t(7,v=C.ariaLabel),"ariaLabelledBy"in C&&t(8,x=C.ariaLabelledBy),"ariaControls"in C&&t(9,S=C.ariaControls),"isDragging"in C&&t(18,y=C.isDragging)},n.$$.update=()=>{n.$$.dirty&524288&&t(10,r=typeof a=="string"?parseFloat(a):a),n.$$.dirty&1048576&&t(11,i=typeof l=="string"?parseFloat(l):l),n.$$.dirty&2097152&&(s=typeof u=="string"?parseFloat(u):u),n.$$.dirty&3073&&t(12,o=((c-r)/(i-r)*1).toFixed(4))},[c,m,h,d,f,p,g,v,x,S,r,i,o,A,_,I,re,Y,y,a,l,u,j]}class hs extends ze{constructor(e){super(),De(this,e,Gg,Ug,Ue,{min:19,max:20,step:21,value:0,ariaValueText:2,name:3,direction:4,reverse:5,keyboardOnly:6,slider:1,ariaLabel:7,ariaLabelledBy:8,ariaControls:9,isDragging:18})}}function Dg(n){let e,t,r,i,s,o,a,l,u,c,h,d,f;var p=n[2].pickerIndicator;function g(y,b){return{props:{pos:y[7],isDark:y[3]}}}p&&(t=Ft(p,g(n)));function m(y){n[14](y)}let v={keyboardOnly:!0,ariaValueText:zg,ariaLabel:n[4].label.s};n[0]!==void 0&&(v.value=n[0]),s=new hs({props:v}),q.push(()=>$(s,"value",m));function x(y){n[15](y)}let S={keyboardOnly:!0,ariaValueText:Lg,direction:"vertical",ariaLabel:n[4].label.v};return n[1]!==void 0&&(S.value=n[1]),u=new hs({props:S}),q.push(()=>$(u,"value",x)),{c(){e=ne("div"),t&&H(t.$$.fragment),r=V(),i=ne("div"),H(s.$$.fragment),a=V(),l=ne("div"),H(u.$$.fragment),T(i,"class","s svelte-1x9tz9y"),ve(i,"--pos-y",n[7].y),T(l,"class","v svelte-1x9tz9y"),ve(l,"--pos-x",n[7].x),T(e,"class","picker svelte-1x9tz9y"),ve(e,"--picker-color-bg",n[6])},m(y,b){O(y,e,b),t&&z(t,e,null),te(e,r),te(e,i),z(s,i,null),te(e,a),te(e,l),z(u,l,null),n[16](e),h=!0,d||(f=[X(window,"mouseup",n[9]),X(window,"mousedown",n[11]),X(window,"mousemove",n[10]),X(e,"mousedown",ct(n[8])),X(e,"touchstart",n[12],{passive:!1}),X(e,"touchmove",ct(n[12]),{passive:!1}),X(e,"touchend",n[12],{passive:!1})],d=!0)},p(y,[b]){if(b&4&&p!==(p=y[2].pickerIndicator)){if(t){Ye();const U=t;R(U.$$.fragment,1,0,()=>{L(U,1)}),Ke()}p?(t=Ft(p,g(y)),H(t.$$.fragment),k(t.$$.fragment,1),z(t,e,r)):t=null}else if(p){const U={};b&128&&(U.pos=y[7]),b&8&&(U.isDark=y[3]),t.$set(U)}const B={};b&16&&(B.ariaLabel=y[4].label.s),!o&&b&1&&(o=!0,B.value=y[0],ee(()=>o=!1)),s.$set(B),b&128&&ve(i,"--pos-y",y[7].y);const A={};b&16&&(A.ariaLabel=y[4].label.v),!c&&b&2&&(c=!0,A.value=y[1],ee(()=>c=!1)),u.$set(A),b&128&&ve(l,"--pos-x",y[7].x),b&64&&ve(e,"--picker-color-bg",y[6])},i(y){h||(t&&k(t.$$.fragment,y),k(s.$$.fragment,y),k(u.$$.fragment,y),h=!0)},o(y){t&&R(t.$$.fragment,y),R(s.$$.fragment,y),R(u.$$.fragment,y),h=!1},d(y){y&&F(e),t&&L(t),L(s),L(u),n[16](null),d=!1,He(f)}}}function Ai(n,e,t){return Math.min(Math.max(e,n),t)}const zg=n=>`${n}%`,Lg=n=>`${n}%`;function Ng(n,e,t){const r=li();let{components:i}=e,{h:s}=e,{s:o}=e,{v:a}=e,{isDark:l}=e,{texts:u}=e,c,h=!1,d,f={x:100,y:0};function p(A){const{width:U,left:E,height:_,top:I}=c.getBoundingClientRect(),re={x:Ai(A.clientX-E,0,U),y:Ai(A.clientY-I,0,_)};t(0,o=Ai(re.x/U,0,1)*100),t(1,a=Ai((_-re.y)/_,0,1)*100)}function g(A){A.button===0&&(h=!0,p(A))}function m(){h=!1}function v(A){h&&p(A)}function x(A){A.target.isSameNode(c)}function S(A){A.preventDefault(),p(A.changedTouches[0])}function y(A){o=A,t(0,o)}function b(A){a=A,t(1,a)}function B(A){q[A?"unshift":"push"](()=>{c=A,t(5,c)})}return n.$$set=A=>{"components"in A&&t(2,i=A.components),"h"in A&&t(13,s=A.h),"s"in A&&t(0,o=A.s),"v"in A&&t(1,a=A.v),"isDark"in A&&t(3,l=A.isDark),"texts"in A&&t(4,u=A.texts)},n.$$.update=()=>{n.$$.dirty&8192&&typeof s=="number"&&t(6,d=wt({h:s,s:100,v:100,a:1}).toHex()),n.$$.dirty&35&&typeof o=="number"&&typeof a=="number"&&c&&t(7,f={x:o,y:100-a}),n.$$.dirty&3&&r("input",{s:o,v:a})},[o,a,i,l,u,c,d,f,g,m,v,x,S,s,y,b,B]}class Hg extends ze{constructor(e){super(),De(this,e,Ng,Dg,Ue,{components:2,h:13,s:0,v:1,isDark:3,texts:4})}}function Vg(n){let e;return{c(){e=ne("div"),T(e,"class","picker-indicator svelte-i5mg2p"),Fe(e,"is-dark",n[1]),ve(e,"--pos-x",n[0].x),ve(e,"--pos-y",n[0].y)},m(t,r){O(t,e,r)},p(t,[r]){r&2&&Fe(e,"is-dark",t[1]),r&1&&ve(e,"--pos-x",t[0].x),r&1&&ve(e,"--pos-y",t[0].y)},i:ce,o:ce,d(t){t&&F(e)}}}function Wg(n,e,t){let{pos:r}=e,{isDark:i}=e;return n.$$set=s=>{"pos"in s&&t(0,r=s.pos),"isDark"in s&&t(1,i=s.isDark)},[r,i]}class jg extends ze{constructor(e){super(),De(this,e,Wg,Vg,Ue,{pos:0,isDark:1})}}function Xg(n){let e,t,r,i,s,o,a,l,u,c;return{c(){e=ne("input"),r=V(),i=ne("input"),o=V(),a=ne("input"),T(e,"aria-label",t=n[4].label.h),e.value=n[9],T(e,"type","number"),T(e,"min","0"),T(e,"max","360"),T(e,"class","svelte-qtukzs"),T(i,"aria-label",s=n[4].label.s),i.value=n[8],T(i,"type","number"),T(i,"min","0"),T(i,"max","100"),T(i,"class","svelte-qtukzs"),T(a,"aria-label",l=n[4].label.v),a.value=n[7],T(a,"type","number"),T(a,"min","0"),T(a,"max","100"),T(a,"class","svelte-qtukzs")},m(h,d){O(h,e,d),O(h,r,d),O(h,i,d),O(h,o,d),O(h,a,d),u||(c=[X(e,"input",n[13]("h")),X(i,"input",n[13]("s")),X(a,"input",n[13]("v"))],u=!0)},p(h,d){d&16&&t!==(t=h[4].label.h)&&T(e,"aria-label",t),d&512&&e.value!==h[9]&&(e.value=h[9]),d&16&&s!==(s=h[4].label.s)&&T(i,"aria-label",s),d&256&&i.value!==h[8]&&(i.value=h[8]),d&16&&l!==(l=h[4].label.v)&&T(a,"aria-label",l),d&128&&a.value!==h[7]&&(a.value=h[7])},d(h){h&&(F(e),F(r),F(i),F(o),F(a)),u=!1,He(c)}}}function qg(n){let e,t,r,i,s,o,a,l,u,c,h,d,f;return{c(){e=ne("input"),i=V(),s=ne("input"),l=V(),u=ne("input"),T(e,"aria-label",t=n[4].label.r),e.value=r=n[0].r,T(e,"type","number"),T(e,"min","0"),T(e,"max","255"),T(e,"class","svelte-qtukzs"),T(s,"aria-label",o=n[4].label.g),s.value=a=n[0].g,T(s,"type","number"),T(s,"min","0"),T(s,"max","255"),T(s,"class","svelte-qtukzs"),T(u,"aria-label",c=n[4].label.b),u.value=h=n[0].b,T(u,"type","number"),T(u,"min","0"),T(u,"max","255"),T(u,"class","svelte-qtukzs")},m(p,g){O(p,e,g),O(p,i,g),O(p,s,g),O(p,l,g),O(p,u,g),d||(f=[X(e,"input",n[12]("r")),X(s,"input",n[12]("g")),X(u,"input",n[12]("b"))],d=!0)},p(p,g){g&16&&t!==(t=p[4].label.r)&&T(e,"aria-label",t),g&1&&r!==(r=p[0].r)&&e.value!==r&&(e.value=r),g&16&&o!==(o=p[4].label.g)&&T(s,"aria-label",o),g&1&&a!==(a=p[0].g)&&s.value!==a&&(s.value=a),g&16&&c!==(c=p[4].label.b)&&T(u,"aria-label",c),g&1&&h!==(h=p[0].b)&&u.value!==h&&(u.value=h)},d(p){p&&(F(e),F(i),F(s),F(l),F(u)),d=!1,He(f)}}}function Yg(n){let e,t,r,i;return{c(){e=ne("input"),T(e,"aria-label",t=n[4].label.hex),e.value=n[1],T(e,"class","svelte-qtukzs"),ve(e,"flex",3)},m(s,o){O(s,e,o),r||(i=X(e,"input",n[11]),r=!0)},p(s,o){o&16&&t!==(t=s[4].label.hex)&&T(e,"aria-label",t),o&2&&e.value!==s[1]&&(e.value=s[1])},d(s){s&&F(e),r=!1,i()}}}function Ul(n){let e,t,r,i;return{c(){e=ne("input"),T(e,"aria-label",t=n[4].label.a),e.value=n[6],T(e,"type","number"),T(e,"min","0"),T(e,"max","1"),T(e,"step","0.01"),T(e,"class","svelte-qtukzs")},m(s,o){O(s,e,o),r||(i=X(e,"input",function(){Nt(n[5]==="hsv"?n[13]("a"):n[12]("a"))&&(n[5]==="hsv"?n[13]("a"):n[12]("a")).apply(this,arguments)}),r=!0)},p(s,o){n=s,o&16&&t!==(t=n[4].label.a)&&T(e,"aria-label",t),o&64&&e.value!==n[6]&&(e.value=n[6])},d(s){s&&F(e),r=!1,i()}}}function Kg(n){let e,t=n[4].color[n[5]]+"",r;return{c(){e=ne("div"),r=rt(t),T(e,"class","button-like svelte-qtukzs")},m(i,s){O(i,e,s),te(e,r)},p(i,s){s&48&&t!==(t=i[4].color[i[5]]+"")&&ht(r,t)},d(i){i&&F(e)}}}function Zg(n){let e,t,r=n[4].color[n[5]]+"",i,s,o,a=n[4].changeTo+"",l,u,c,h,d;return{c(){e=ne("button"),t=ne("span"),i=rt(r),s=V(),o=ne("span"),l=rt(a),u=V(),c=rt(n[10]),T(t,"class","disappear svelte-qtukzs"),T(t,"aria-hidden","true"),T(o,"class","appear svelte-qtukzs"),T(e,"type","button"),T(e,"class","svelte-qtukzs")},m(f,p){O(f,e,p),te(e,t),te(t,i),te(e,s),te(e,o),te(o,l),te(o,u),te(o,c),h||(d=X(e,"click",n[15]),h=!0)},p(f,p){p&48&&r!==(r=f[4].color[f[5]]+"")&&ht(i,r),p&16&&a!==(a=f[4].changeTo+"")&&ht(l,a),p&1024&&ht(c,f[10])},d(f){f&&F(e),h=!1,d()}}}function Qg(n){let e,t,r,i;function s(d,f){return d[5]==="hex"?Yg:d[5]==="rgb"?qg:Xg}let o=s(n),a=o(n),l=n[2]&&Ul(n);function u(d,f){return d[3].length>1?Zg:Kg}let c=u(n),h=c(n);return{c(){e=ne("div"),t=ne("div"),a.c(),r=V(),l&&l.c(),i=V(),h.c(),T(t,"class","input-container svelte-qtukzs"),T(e,"class","text-input svelte-qtukzs")},m(d,f){O(d,e,f),te(e,t),a.m(t,null),te(t,r),l&&l.m(t,null),te(e,i),h.m(e,null)},p(d,[f]){o===(o=s(d))&&a?a.p(d,f):(a.d(1),a=o(d),a&&(a.c(),a.m(t,r))),d[2]?l?l.p(d,f):(l=Ul(d),l.c(),l.m(t,null)):l&&(l.d(1),l=null),c===(c=u(d))&&h?h.p(d,f):(h.d(1),h=c(d),h&&(h.c(),h.m(e,null)))},i:ce,o:ce,d(d){d&&F(e),a.d(),l&&l.d(),h.d()}}}const Jg=/^#?([A-F0-9]{6}|[A-F0-9]{8})$/i;function $g(n,e,t){let r,i,s,o,a;const l=li();let{isAlpha:u}=e,{rgb:c}=e,{hsv:h}=e,{hex:d}=e,{textInputModes:f}=e,{texts:p}=e,g=f[0]||"hex";function m(y){const b=y.target;Jg.test(b.value)&&(t(1,d=b.value),l("input",{hex:d}))}function v(y){return function(b){t(0,c={...c,[y]:parseFloat(b.target.value)}),l("input",{rgb:c})}}function x(y){return function(b){t(14,h={...h,[y]:parseFloat(b.target.value)}),l("input",{hsv:h})}}const S=()=>t(5,g=r);return n.$$set=y=>{"isAlpha"in y&&t(2,u=y.isAlpha),"rgb"in y&&t(0,c=y.rgb),"hsv"in y&&t(14,h=y.hsv),"hex"in y&&t(1,d=y.hex),"textInputModes"in y&&t(3,f=y.textInputModes),"texts"in y&&t(4,p=y.texts)},n.$$.update=()=>{n.$$.dirty&40&&t(10,r=f[(f.indexOf(g)+1)%f.length]),n.$$.dirty&16384&&t(9,i=Math.round(h.h)),n.$$.dirty&16384&&t(8,s=Math.round(h.s)),n.$$.dirty&16384&&t(7,o=Math.round(h.v)),n.$$.dirty&16384&&t(6,a=h.a===void 0?1:Math.round(h.a*100)/100)},[c,d,u,f,p,g,a,o,s,i,r,m,v,x,h,S]}class e_ extends ze{constructor(e){super(),De(this,e,$g,Qg,Ue,{isAlpha:2,rgb:0,hsv:14,hex:1,textInputModes:3,texts:4})}}function t_(n){let e,t,r,i,s,o,a,l,u,c,h;return{c(){e=ne("label"),t=ne("div"),r=ne("input"),i=V(),s=ne("div"),o=V(),a=ne("div"),l=V(),u=rt(n[2]),T(r,"type","color"),T(r,"name",n[3]),r.value=n[1],T(r,"aria-haspopup","dialog"),T(r,"class","svelte-lemcb1"),T(s,"class","alpha svelte-lemcb1"),T(a,"class","color svelte-lemcb1"),ve(a,"background",n[1]),T(t,"class","container svelte-lemcb1"),T(e,"class","svelte-lemcb1")},m(d,f){O(d,e,f),te(e,t),te(t,r),te(t,i),te(t,s),te(t,o),te(t,a),te(e,l),te(e,u),n[5](e),c||(h=[X(r,"click",ct(Ei)),X(r,"mousedown",ct(Ei)),X(e,"click",ct(Ei)),X(e,"mousedown",ct(Ei))],c=!0)},p(d,[f]){f&8&&T(r,"name",d[3]),f&2&&(r.value=d[1]),f&2&&ve(a,"background",d[1]),f&4&&ht(u,d[2])},i:ce,o:ce,d(d){d&&F(e),n[5](null),c=!1,He(h)}}}function Ei(){}function n_(n,e,t){let{labelElement:r}=e,{hex:i}=e,{label:s}=e,{name:o=void 0}=e,{isOpen:a}=e;function l(u){q[u?"unshift":"push"](()=>{r=u,t(0,r)})}return n.$$set=u=>{"labelElement"in u&&t(0,r=u.labelElement),"hex"in u&&t(1,i=u.hex),"label"in u&&t(2,s=u.label),"name"in u&&t(3,o=u.name),"isOpen"in u&&t(4,a=u.isOpen)},[r,i,s,o,a,l]}class r_ extends ze{constructor(e){super(),De(this,e,n_,t_,Ue,{labelElement:0,hex:1,label:2,name:3,isOpen:4})}}function i_(n){let e,t,r;const i=n[4].default,s=ft(i,n,n[3],null);return{c(){e=ne("div"),s&&s.c(),T(e,"class","wrapper svelte-h9ar9"),T(e,"role",t=n[2]?"dialog":void 0),T(e,"aria-label","color picker"),Fe(e,"is-open",n[1])},m(o,a){O(o,e,a),s&&s.m(e,null),n[5](e),r=!0},p(o,[a]){s&&s.p&&(!r||a&8)&&pt(s,i,o,o[3],r?dt(i,o[3],a,null):mt(o[3]),null),(!r||a&4&&t!==(t=o[2]?"dialog":void 0))&&T(e,"role",t),(!r||a&2)&&Fe(e,"is-open",o[1])},i(o){r||(k(s,o),r=!0)},o(o){R(s,o),r=!1},d(o){o&&F(e),s&&s.d(o),n[5](null)}}}function s_(n,e,t){let{$$slots:r={},$$scope:i}=e,{wrapper:s}=e,{isOpen:o}=e,{isDialog:a}=e;function l(u){q[u?"unshift":"push"](()=>{s=u,t(0,s)})}return n.$$set=u=>{"wrapper"in u&&t(0,s=u.wrapper),"isOpen"in u&&t(1,o=u.isOpen),"isDialog"in u&&t(2,a=u.isDialog),"$$scope"in u&&t(3,i=u.$$scope)},[s,o,a,i,r,l]}class o_ extends ze{constructor(e){super(),De(this,e,s_,i_,Ue,{wrapper:0,isOpen:1,isDialog:2})}}const Zs={label:{h:"hue channel",s:"saturation channel",v:"brightness channel",r:"red channel",g:"green channel",b:"blue channel",a:"alpha channel",hex:"hex color",withoutColor:"without color"},color:{rgb:"rgb",hsv:"hsv",hex:"hex"},changeTo:"change to "},ah="a[href], area[href], input:not([type='hidden']):not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]";function a_(n){return function(e){if(e.target===window)return;const t=e.target;if(!n.contains(t))return;const r=n.querySelectorAll(ah),i=r[0],s=r[r.length-1];function o(l){return l.code==="Tab"&&!l.shiftKey}function a(l){return l.code==="Tab"&&l.shiftKey}o(e)&&e.target===s?(e.preventDefault(),i.focus()):a(e)&&e.target===i&&(e.preventDefault(),s.focus())}}const l_=n=>{const e=n.querySelector(ah);e&&e.focus();const t=a_(n);return document.addEventListener("keydown",t),{destroy(){document.removeEventListener("keydown",t)}}};function u_(n){let e,t,r,i,s,o,a=n[1].label.withoutColor+"",l,u,c;return{c(){e=ne("label"),t=ne("div"),r=ne("input"),i=V(),s=ne("span"),o=V(),l=rt(a),T(r,"type","checkbox"),T(r,"class","svelte-oskb5b"),T(s,"class","svelte-oskb5b"),T(t,"class","svelte-oskb5b"),T(e,"class","nullability-checkbox svelte-oskb5b")},m(h,d){O(h,e,d),te(e,t),te(t,r),r.checked=n[0],te(t,i),te(t,s),te(e,o),te(e,l),u||(c=X(r,"change",n[2]),u=!0)},p(h,[d]){d&1&&(r.checked=h[0]),d&2&&a!==(a=h[1].label.withoutColor+"")&&ht(l,a)},i:ce,o:ce,d(h){h&&F(e),u=!1,c()}}}function c_(n,e,t){let{isUndefined:r}=e,{texts:i}=e;function s(){r=this.checked,t(0,r)}return n.$$set=o=>{"isUndefined"in o&&t(0,r=o.isUndefined),"texts"in o&&t(1,i=o.texts)},[r,i,s]}class h_ extends ze{constructor(e){super(),De(this,e,c_,u_,Ue,{isUndefined:0,texts:1})}}function f_(n){let e;return{c(){e=ne("input"),T(e,"type","hidden"),e.value=n[2],T(e,"name",n[6])},m(t,r){O(t,e,r)},p(t,r){r[0]&4&&(e.value=t[2]),r[0]&64&&T(e,"name",t[6])},i:ce,o:ce,d(t){t&&F(e)}}}function d_(n){let e,t,r,i;function s(l){n[38](l)}var o=n[25]().input;function a(l,u){let c={isOpen:!0,hex:l[2],label:l[5],name:l[6]};return l[23]!==void 0&&(c.labelElement=l[23]),{props:c}}return o&&(e=Ft(o,a(n)),q.push(()=>$(e,"labelElement",s))),{c(){e&&H(e.$$.fragment),r=Ot()},m(l,u){e&&z(e,l,u),O(l,r,u),i=!0},p(l,u){if(o!==(o=l[25]().input)){if(e){Ye();const c=e;R(c.$$.fragment,1,0,()=>{L(c,1)}),Ke()}o?(e=Ft(o,a(l)),q.push(()=>$(e,"labelElement",s)),H(e.$$.fragment),k(e.$$.fragment,1),z(e,r.parentNode,r)):e=null}else if(o){const c={};u[0]&4&&(c.hex=l[2]),u[0]&32&&(c.label=l[5]),u[0]&64&&(c.name=l[6]),!t&&u[0]&8388608&&(t=!0,c.labelElement=l[23],ee(()=>t=!1)),e.$set(c)}},i(l){i||(e&&k(e.$$.fragment,l),i=!0)},o(l){e&&R(e.$$.fragment,l),i=!1},d(l){l&&F(r),e&&L(e,l)}}}function Gl(n){let e,t,r,i;function s(l){n[39](l)}var o=n[25]().nullabilityCheckbox;function a(l,u){let c={texts:l[26]()};return l[16]!==void 0&&(c.isUndefined=l[16]),{props:c}}return o&&(e=Ft(o,a(n)),q.push(()=>$(e,"isUndefined",s))),{c(){e&&H(e.$$.fragment),r=Ot()},m(l,u){e&&z(e,l,u),O(l,r,u),i=!0},p(l,u){if(o!==(o=l[25]().nullabilityCheckbox)){if(e){Ye();const c=e;R(c.$$.fragment,1,0,()=>{L(c,1)}),Ke()}o?(e=Ft(o,a(l)),q.push(()=>$(e,"isUndefined",s)),H(e.$$.fragment),k(e.$$.fragment,1),z(e,r.parentNode,r)):e=null}else if(o){const c={};!t&&u[0]&65536&&(t=!0,c.isUndefined=l[16],ee(()=>t=!1)),e.$set(c)}},i(l){i||(e&&k(e.$$.fragment,l),i=!0)},o(l){e&&R(e.$$.fragment,l),i=!1},d(l){l&&F(r),e&&L(e,l)}}}function Dl(n){let e,t,r;return t=new hs({props:{min:0,max:1,step:.01,value:n[1]?.a??n[20].a,direction:n[12],reverse:n[12]==="vertical",ariaLabel:n[26]().label.a}}),t.$on("input",n[29]("a")),{c(){e=ne("div"),H(t.$$.fragment),T(e,"class","a svelte-tsvobk"),ve(e,"--alphaless-color",(n[2]?n[2]:n[21]).substring(0,7))},m(i,s){O(i,e,s),z(t,e,null),r=!0},p(i,s){const o={};s[0]&1048578&&(o.value=i[1]?.a??i[20].a),s[0]&4096&&(o.direction=i[12]),s[0]&4096&&(o.reverse=i[12]==="vertical"),t.$set(o),s[0]&2097156&&ve(e,"--alphaless-color",(i[2]?i[2]:i[21]).substring(0,7))},i(i){r||(k(t.$$.fragment,i),r=!0)},o(i){R(t.$$.fragment,i),r=!1},d(i){i&&F(e),L(t)}}}function zl(n){let e,t,r;var i=n[25]().textInput;function s(o,a){return{props:{hex:o[2]??o[21],rgb:o[0]??o[19],hsv:o[1]??o[20],isAlpha:o[8],textInputModes:o[11],texts:o[26]()}}}return i&&(e=Ft(i,s(n)),e.$on("input",n[40])),{c(){e&&H(e.$$.fragment),t=Ot()},m(o,a){e&&z(e,o,a),O(o,t,a),r=!0},p(o,a){if(i!==(i=o[25]().textInput)){if(e){Ye();const l=e;R(l.$$.fragment,1,0,()=>{L(l,1)}),Ke()}i?(e=Ft(i,s(o)),e.$on("input",o[40]),H(e.$$.fragment),k(e.$$.fragment,1),z(e,t.parentNode,t)):e=null}else if(i){const l={};a[0]&2097156&&(l.hex=o[2]??o[21]),a[0]&524289&&(l.rgb=o[0]??o[19]),a[0]&1048578&&(l.hsv=o[1]??o[20]),a[0]&256&&(l.isAlpha=o[8]),a[0]&2048&&(l.textInputModes=o[11]),e.$set(l)}},i(o){r||(e&&k(e.$$.fragment,o),r=!0)},o(o){e&&R(e.$$.fragment,o),r=!1},d(o){o&&F(t),e&&L(e,o)}}}function p_(n){let e,t,r;var i=n[25]().a11yNotice;function s(o,a){return{props:{components:o[25](),a11yColors:o[13],hex:o[2]||"#00000000",a11yTexts:o[15],a11yLevel:o[14]}}}return i&&(e=Ft(i,s(n))),{c(){e&&H(e.$$.fragment),t=Ot()},m(o,a){e&&z(e,o,a),O(o,t,a),r=!0},p(o,a){if(i!==(i=o[25]().a11yNotice)){if(e){Ye();const l=e;R(l.$$.fragment,1,0,()=>{L(l,1)}),Ke()}i?(e=Ft(i,s(o)),H(e.$$.fragment),k(e.$$.fragment,1),z(e,t.parentNode,t)):e=null}else if(i){const l={};a[0]&8192&&(l.a11yColors=o[13]),a[0]&4&&(l.hex=o[2]||"#00000000"),a[0]&32768&&(l.a11yTexts=o[15]),a[0]&16384&&(l.a11yLevel=o[14]),e.$set(l)}},i(o){r||(e&&k(e.$$.fragment,o),r=!0)},o(o){e&&R(e.$$.fragment,o),r=!1},d(o){o&&F(t),e&&L(e,o)}}}function m_(n){let e,t,r,i,s,o,a,l,u=n[25]().a11yNotice,c,h,d=n[7]&&Gl(n);t=new Hg({props:{components:n[25](),h:n[1]?.h??n[20].h,s:n[1]?.s??n[20].s,v:n[1]?.v??n[20].v,isDark:n[4],texts:n[26]()}}),t.$on("input",n[30](["s","v"])),s=new hs({props:{min:0,max:360,step:1,value:n[1]?.h??n[20].h,direction:n[12],reverse:n[12]==="vertical",ariaLabel:n[26]().label.h}}),s.$on("input",n[29]("h"));let f=n[8]&&Dl(n),p=n[10]&&zl(n),g=u&&p_(n);return{c(){d&&d.c(),e=V(),H(t.$$.fragment),r=V(),i=ne("div"),H(s.$$.fragment),o=V(),f&&f.c(),a=V(),p&&p.c(),l=V(),g&&g.c(),c=Ot(),T(i,"class","h svelte-tsvobk")},m(m,v){d&&d.m(m,v),O(m,e,v),z(t,m,v),O(m,r,v),O(m,i,v),z(s,i,null),O(m,o,v),f&&f.m(m,v),O(m,a,v),p&&p.m(m,v),O(m,l,v),g&&g.m(m,v),O(m,c,v),h=!0},p(m,v){m[7]?d?(d.p(m,v),v[0]&128&&k(d,1)):(d=Gl(m),d.c(),k(d,1),d.m(e.parentNode,e)):d&&(Ye(),R(d,1,1,()=>{d=null}),Ke());const x={};v[0]&1048578&&(x.h=m[1]?.h??m[20].h),v[0]&1048578&&(x.s=m[1]?.s??m[20].s),v[0]&1048578&&(x.v=m[1]?.v??m[20].v),v[0]&16&&(x.isDark=m[4]),t.$set(x);const S={};v[0]&1048578&&(S.value=m[1]?.h??m[20].h),v[0]&4096&&(S.direction=m[12]),v[0]&4096&&(S.reverse=m[12]==="vertical"),s.$set(S),m[8]?f?(f.p(m,v),v[0]&256&&k(f,1)):(f=Dl(m),f.c(),k(f,1),f.m(a.parentNode,a)):f&&(Ye(),R(f,1,1,()=>{f=null}),Ke()),m[10]?p?(p.p(m,v),v[0]&1024&&k(p,1)):(p=zl(m),p.c(),k(p,1),p.m(l.parentNode,l)):p&&(Ye(),R(p,1,1,()=>{p=null}),Ke()),u&&g.p(m,v)},i(m){h||(k(d),k(t.$$.fragment,m),k(s.$$.fragment,m),k(f),k(p),k(g),h=!0)},o(m){R(d),R(t.$$.fragment,m),R(s.$$.fragment,m),R(f),R(p),R(g),h=!1},d(m){m&&(F(e),F(r),F(i),F(o),F(a),F(l),F(c)),d&&d.d(m),L(t,m),L(s),f&&f.d(m),p&&p.d(m),g&&g.d(m)}}}function g_(n){let e,t,r,i,s,o,a,l,u,c;Jr(n[37]);const h=[d_,f_],d=[];function f(v,x){return v[9]?0:v[6]?1:-1}~(t=f(n))&&(r=d[t]=h[t](n));function p(v){n[41](v)}var g=n[25]().wrapper;function m(v,x){let S={isOpen:v[3],isDialog:v[9],$$slots:{default:[m_]},$$scope:{ctx:v}};return v[24]!==void 0&&(S.wrapper=v[24]),{props:S}}return g&&(s=Ft(g,m(n)),q.push(()=>$(s,"wrapper",p))),{c(){e=ne("span"),r&&r.c(),i=V(),s&&H(s.$$.fragment),T(e,"class",a="color-picker "+n[12]+" svelte-tsvobk")},m(v,x){O(v,e,x),~t&&d[t].m(e,null),te(e,i),s&&z(s,e,null),n[42](e),l=!0,u||(c=[X(window,"mousedown",n[27]),X(window,"keyup",n[28]),X(window,"scroll",n[31]),X(window,"resize",n[37])],u=!0)},p(v,x){let S=t;if(t=f(v),t===S?~t&&d[t].p(v,x):(r&&(Ye(),R(d[S],1,1,()=>{d[S]=null}),Ke()),~t?(r=d[t],r?r.p(v,x):(r=d[t]=h[t](v),r.c()),k(r,1),r.m(e,i)):r=null),g!==(g=v[25]().wrapper)){if(s){Ye();const y=s;R(y.$$.fragment,1,0,()=>{L(y,1)}),Ke()}g?(s=Ft(g,m(v)),q.push(()=>$(s,"wrapper",p)),H(s.$$.fragment),k(s.$$.fragment,1),z(s,e,null)):s=null}else if(g){const y={};x[0]&8&&(y.isOpen=v[3]),x[0]&512&&(y.isDialog=v[9]),x[0]&3800471|x[1]&131072&&(y.$$scope={dirty:x,ctx:v}),!o&&x[0]&16777216&&(o=!0,y.wrapper=v[24],ee(()=>o=!1)),s.$set(y)}(!l||x[0]&4096&&a!==(a="color-picker "+v[12]+" svelte-tsvobk"))&&T(e,"class",a)},i(v){l||(k(r),s&&k(s.$$.fragment,v),l=!0)},o(v){R(r),s&&R(s.$$.fragment,v),l=!1},d(v){v&&F(e),~t&&d[t].d(),s&&L(s),n[42](null),u=!1,He(c)}}}const Kn=12;function __(n,e,t){const r=li();let{components:i={}}=e,{label:s="Choose a color"}=e,{name:o=void 0}=e,{nullable:a=!1}=e,{rgb:l=a?void 0:{r:255,g:0,b:0,a:1}}=e,{hsv:u=a?void 0:{h:0,s:100,v:100,a:1}}=e,{hex:c=a?void 0:"#ff0000"}=e,{color:h=void 0}=e,{isDark:d=!1}=e,{isAlpha:f=!0}=e,{isDialog:p=!0}=e,{isOpen:g=!p}=e,{position:m="fixed"}=e,{isTextInput:v=!0}=e,{textInputModes:x=["hex","rgb","hsv"]}=e,{sliderDirection:S="vertical"}=e,{disableCloseClickOutside:y=!1}=e,{a11yColors:b=[{bgHex:"#ffffff"}]}=e,{a11yLevel:B="AA"}=e,{texts:A=void 0}=e,{a11yTexts:U=void 0}=e,E={r:255,g:0,b:0,a:1},_={h:0,s:100,v:100,a:1},I="#ff0000",re=!1,Y=re,j,C,N,W,le,Z;const D={pickerIndicator:jg,textInput:e_,input:r_,nullabilityCheckbox:h_,wrapper:o_};function oe(){return{...D,...i}}function G(){return{label:{...Zs.label,...A?.label},color:{...Zs.color,...A?.color},changeTo:A?.changeTo??Zs.changeTo}}function Q({target:J}){p&&(C.contains(J)||C.isSameNode(J)?t(3,g=!g):g&&!N.contains(J)&&!y&&t(3,g=!1))}function he({key:J,target:Ne}){if(p)J==="Enter"&&C.contains(Ne)?(t(3,g=!g),setTimeout(()=>{W=l_(N)})):J==="Escape"&&g&&(t(3,g=!1),j.contains(Ne)&&(C?.focus(),W?.destroy()));else return}function Le(){if(re&&!Y){Y=!0,t(1,u=t(0,l=t(2,c=void 0))),r("input",{color:h,hsv:u,rgb:l,hex:c});return}else if(Y&&!re){Y=!1,t(1,u=_),t(0,l=E),t(2,c=I),r("input",{color:h,hsv:u,rgb:l,hex:c});return}if(!u&&!l&&!c){t(16,re=!0),Y=!0,r("input",{color:void 0,hsv:u,rgb:l,hex:c});return}u&&l&&u.h===_.h&&u.s===_.s&&u.v===_.v&&u.a===_.a&&l.r===E.r&&l.g===E.g&&l.b===E.b&&l.a===E.a&&c===I||(t(16,re=!1),u&&u.a===void 0&&t(1,u.a=1,u),_.a===void 0&&t(20,_.a=1,_),l&&l.a===void 0&&t(0,l.a=1,l),E.a===void 0&&t(19,E.a=1,E),c?.substring(7)==="ff"&&t(2,c=c.substring(0,7)),c?.substring(7)==="ff"&&t(2,c=c.substring(0,7)),u&&(u.h!==_.h||u.s!==_.s||u.v!==_.v||u.a!==_.a||!l&&!c)?(t(32,h=wt(u)),t(0,l=h.toRgb()),t(2,c=h.toHex())):l&&(l.r!==E.r||l.g!==E.g||l.b!==E.b||l.a!==E.a||!u&&!c)?(t(32,h=wt(l)),t(2,c=h.toHex()),t(1,u=h.toHsv())):c&&(c!==I||!u&&!l)&&(t(32,h=wt(c)),t(0,l=h.toRgb()),t(1,u=h.toHsv())),h&&t(4,d=h.isDark()),c&&(t(20,_=Object.assign({},u)),t(19,E=Object.assign({},l)),t(21,I=c),Y=re,r("input",{color:h,hsv:u,rgb:l,hex:c})))}function ot(J){return Ne=>{u||t(1,u={..._}),t(1,u[J]=Ne.detail,u)}}function Et(J){return Ne=>{u||t(1,u={..._}),J.forEach(at=>{u&&t(1,u[at]=Ne.detail[at],u)})}}async function st(){if(await nh(),m!=="fixed"&&g&&p&&C&&N){const J=N.getBoundingClientRect(),Ne=C.getBoundingClientRect();(m==="responsive"||m==="responsive-y")&&(Ne.top+J.height+Kn>Z?t(24,N.style.top=`-${J.height+Kn}px`,N):t(24,N.style.top=`${Ne.height+Kn}px`,N)),(m==="responsive"||m==="responsive-x")&&(Ne.left+J.width+Kn>le?t(24,N.style.left=`-${J.width-Ne.width+Kn}px`,N):t(24,N.style.left=`${Kn}px`,N))}}function _t(){t(17,le=window.innerWidth),t(18,Z=window.innerHeight)}function Ze(J){C=J,t(23,C)}function xt(J){re=J,t(16,re)}const Ut=({detail:J})=>{J.hsv?t(1,u=J.hsv):J.rgb?t(0,l=J.rgb):J.hex&&t(2,c=J.hex)};function Mt(J){N=J,t(24,N)}function Xt(J){q[J?"unshift":"push"](()=>{j=J,t(22,j)})}return n.$$set=J=>{"components"in J&&t(33,i=J.components),"label"in J&&t(5,s=J.label),"name"in J&&t(6,o=J.name),"nullable"in J&&t(7,a=J.nullable),"rgb"in J&&t(0,l=J.rgb),"hsv"in J&&t(1,u=J.hsv),"hex"in J&&t(2,c=J.hex),"color"in J&&t(32,h=J.color),"isDark"in J&&t(4,d=J.isDark),"isAlpha"in J&&t(8,f=J.isAlpha),"isDialog"in J&&t(9,p=J.isDialog),"isOpen"in J&&t(3,g=J.isOpen),"position"in J&&t(34,m=J.position),"isTextInput"in J&&t(10,v=J.isTextInput),"textInputModes"in J&&t(11,x=J.textInputModes),"sliderDirection"in J&&t(12,S=J.sliderDirection),"disableCloseClickOutside"in J&&t(35,y=J.disableCloseClickOutside),"a11yColors"in J&&t(13,b=J.a11yColors),"a11yLevel"in J&&t(14,B=J.a11yLevel),"texts"in J&&t(36,A=J.texts),"a11yTexts"in J&&t(15,U=J.a11yTexts)},n.$$.update=()=>{n.$$.dirty[0]&7&&(u||l||c)&&Le(),n.$$.dirty[0]&65536&&Le(),n.$$.dirty[0]&393224&&st()},[l,u,c,g,d,s,o,a,f,p,v,x,S,b,B,U,re,le,Z,E,_,I,j,C,N,oe,G,Q,he,ot,Et,st,h,i,m,y,A,_t,Ze,xt,Ut,Mt,Xt]}class v_ extends ze{constructor(e){super(),De(this,e,__,g_,Ue,{components:33,label:5,name:6,nullable:7,rgb:0,hsv:1,hex:2,color:32,isDark:4,isAlpha:8,isDialog:9,isOpen:3,position:34,isTextInput:10,textInputModes:11,sliderDirection:12,disableCloseClickOutside:35,a11yColors:13,a11yLevel:14,texts:36,a11yTexts:15},null,[-1,-1])}}function b_(n){let e,t,r,i,s,o,a;function l(c){n[3](c)}let u={label:"",position:"responsive"};return n[0]!==void 0&&(u.hex=n[0]),s=new v_({props:u}),q.push(()=>$(s,"hex",l)),s.$on("input",n[4]),s.$on("change",n[5]),{c(){e=ne("span"),t=rt(n[1]),i=V(),H(s.$$.fragment),T(e,"class",r=tn(n[2])+" svelte-cj1vhf")},m(c,h){O(c,e,h),te(e,t),O(c,i,h),z(s,c,h),a=!0},p(c,[h]){(!a||h&2)&&ht(t,c[1]),(!a||h&4&&r!==(r=tn(c[2])+" svelte-cj1vhf"))&&T(e,"class",r);const d={};!o&&h&1&&(o=!0,d.hex=c[0],ee(()=>o=!1)),s.$set(d)},i(c){a||(k(s.$$.fragment,c),a=!0)},o(c){R(s.$$.fragment,c),a=!1},d(c){c&&(F(e),F(i)),L(s,c)}}}function x_(n,e,t){let r,{label:i=""}=e,{hex:s=void 0}=e;function o(u){s=u,t(0,s)}function a(u){Be.call(this,n,u)}function l(u){Be.call(this,n,u)}return n.$$set=u=>{"label"in u&&t(1,i=u.label),"hex"in u&&t(0,s=u.hex)},n.$$.update=()=>{n.$$.dirty&2&&t(2,r=!i||i===""?"hide":"")},[s,i,r,o,a,l]}class bn extends ze{constructor(e){super(),De(this,e,x_,b_,Ue,{label:1,hex:0})}}function y_(n){let e,t,r,i,s,o;return{c(){e=ne("label"),t=rt(n[4]),r=V(),i=ne("input"),T(i,"type","number"),T(i,"min",n[1]),T(i,"max",n[2]),T(i,"step",n[3]),T(i,"placeholder",n[5]),T(e,"class","svelte-18hsjvr")},m(a,l){O(a,e,l),te(e,t),te(e,r),te(e,i),xn(i,n[0]),s||(o=[X(i,"input",n[9]),X(i,"input",n[7]),X(i,"change",n[8]),X(i,"wheel",n[6])],s=!0)},p(a,[l]){l&16&&ht(t,a[4]),l&2&&T(i,"min",a[1]),l&4&&T(i,"max",a[2]),l&8&&T(i,"step",a[3]),l&32&&T(i,"placeholder",a[5]),l&1&&Zc(i.value)!==a[0]&&xn(i,a[0])},i:ce,o:ce,d(a){a&&F(e),s=!1,He(o)}}}function S_(n,e,t){let{value:r=0}=e,{min:i=void 0}=e,{max:s=void 0}=e,{step:o=1}=e,{label:a=""}=e,{placeholder:l=""}=e;function u(f){f.deltaY*-1>0?s&&r<s&&t(0,r+=o):i&&r>i&&t(0,r-=o)}function c(f){Be.call(this,n,f)}function h(f){Be.call(this,n,f)}function d(){r=Zc(this.value),t(0,r)}return n.$$set=f=>{"value"in f&&t(0,r=f.value),"min"in f&&t(1,i=f.min),"max"in f&&t(2,s=f.max),"step"in f&&t(3,o=f.step),"label"in f&&t(4,a=f.label),"placeholder"in f&&t(5,l=f.placeholder)},[r,i,s,o,a,l,u,c,h,d]}class fe extends ze{constructor(e){super(),De(this,e,S_,y_,Ue,{value:0,min:1,max:2,step:3,label:4,placeholder:5})}}function Ll(n){let e,t;return{c(){e=ne("label"),t=rt(n[2]),T(e,"for",n[5]),T(e,"class","svelte-18hsjvr")},m(r,i){O(r,e,i),te(e,t)},p(r,i){i&4&&ht(t,r[2])},d(r){r&&F(e)}}}function w_(n){let e,t,r,i,s=n[2]&&Ll(n);return{c(){s&&s.c(),e=V(),t=ne("input"),T(t,"id",n[5]),T(t,"class",n[3]),T(t,"type","text"),T(t,"placeholder",n[1]),T(t,"style",n[4])},m(o,a){s&&s.m(o,a),O(o,e,a),O(o,t,a),xn(t,n[0]),r||(i=[X(t,"input",n[9]),X(t,"input",n[7]),X(t,"change",n[8])],r=!0)},p(o,[a]){o[2]?s?s.p(o,a):(s=Ll(o),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),a&8&&T(t,"class",o[3]),a&2&&T(t,"placeholder",o[1]),a&16&&T(t,"style",o[4]),a&1&&t.value!==o[0]&&xn(t,o[0])},i:ce,o:ce,d(o){o&&(F(e),F(t)),s&&s.d(o),r=!1,He(i)}}}let T_=0;function C_(n,e,t){let r,{placeholder:i=void 0}=e,{value:s=""}=e,{label:o=void 0}=e,{width:a=void 0}=e,{cl:l=""}=e,u="input_text_"+T_++;function c(f){Be.call(this,n,f)}function h(f){Be.call(this,n,f)}function d(){s=this.value,t(0,s)}return n.$$set=f=>{"placeholder"in f&&t(1,i=f.placeholder),"value"in f&&t(0,s=f.value),"label"in f&&t(2,o=f.label),"width"in f&&t(6,a=f.width),"cl"in f&&t(3,l=f.cl)},n.$$.update=()=>{n.$$.dirty&64&&t(4,r=a?"width: "+a+"px;":"")},[s,i,o,l,r,u,a,c,h,d]}class mr extends ze{constructor(e){super(),De(this,e,C_,w_,Ue,{placeholder:1,value:0,label:2,width:6,cl:3})}}function P_(n){let e,t;const r=n[2].default,i=ft(r,n,n[1],null);return{c(){e=ne("div"),i&&i.c(),T(e,"class","row svelte-9ejy6"),T(e,"style",n[0])},m(s,o){O(s,e,o),i&&i.m(e,null),t=!0},p(s,[o]){i&&i.p&&(!t||o&2)&&pt(i,r,s,s[1],t?dt(r,s[1],o,null):mt(s[1]),null),(!t||o&1)&&T(e,"style",s[0])},i(s){t||(k(i,s),t=!0)},o(s){R(i,s),t=!1},d(s){s&&F(e),i&&i.d(s)}}}function A_(n,e,t){let{$$slots:r={},$$scope:i}=e,{style:s=void 0}=e;return n.$$set=o=>{"style"in o&&t(0,s=o.style),"$$scope"in o&&t(1,i=o.$$scope)},[s,i,r]}class Qe extends ze{constructor(e){super(),De(this,e,A_,P_,Ue,{style:0})}}function Nl(n){let e,t,r,i,s,o,a,l;return{c(){e=ne("button"),t=rt(n[0]),r=V(),i=ne("button"),s=rt(""),T(e,"class","svelte-1bhgzai"),T(i,"class",o=tn(`collapser ${n[1]}`)+" svelte-1bhgzai")},m(u,c){O(u,e,c),te(e,t),O(u,r,c),O(u,i,c),te(i,s),a||(l=[X(e,"click",n[2]),X(i,"click",n[2])],a=!0)},p(u,c){c&1&&ht(t,u[0]),c&2&&o!==(o=tn(`collapser ${u[1]}`)+" svelte-1bhgzai")&&T(i,"class",o)},d(u){u&&(F(e),F(r),F(i)),a=!1,He(l)}}}function E_(n){let e,t,r,i,s,o=n[0]&&Nl(n);const a=n[5].default,l=ft(a,n,n[4],null);return{c(){e=ne("section"),o&&o.c(),t=V(),r=ne("div"),l&&l.c(),T(r,"class",i=tn(`content ${n[1]}`)+" svelte-1bhgzai"),T(e,"class","svelte-1bhgzai")},m(u,c){O(u,e,c),o&&o.m(e,null),te(e,t),te(e,r),l&&l.m(r,null),s=!0},p(u,[c]){u[0]?o?o.p(u,c):(o=Nl(u),o.c(),o.m(e,t)):o&&(o.d(1),o=null),l&&l.p&&(!s||c&16)&&pt(l,a,u,u[4],s?dt(a,u[4],c,null):mt(u[4]),null),(!s||c&2&&i!==(i=tn(`content ${u[1]}`)+" svelte-1bhgzai"))&&T(r,"class",i)},i(u){s||(k(l,u),s=!0)},o(u){R(l,u),s=!1},d(u){u&&F(e),o&&o.d(),l&&l.d(u)}}}function M_(n,e,t){let r,{$$slots:i={},$$scope:s}=e,{title:o}=e,{collapse:a=!1}=e;function l(){t(3,a=!a)}return n.$$set=u=>{"title"in u&&t(0,o=u.title),"collapse"in u&&t(3,a=u.collapse),"$$scope"in u&&t(4,s=u.$$scope)},n.$$.update=()=>{n.$$.dirty&8&&t(1,r=a?"collapse":"")},[o,r,l,a,s,i]}class Zn extends ze{constructor(e){super(),De(this,e,M_,E_,Ue,{title:0,collapse:3})}}function k_(n){let e,t,r;return{c(){e=ne("textarea"),T(e,"placeholder",n[1]),T(e,"tabindex",n[2])},m(i,s){O(i,e,s),xn(e,n[0]),t||(r=[X(e,"input",n[5]),X(e,"input",n[3]),X(e,"change",n[4])],t=!0)},p(i,[s]){s&2&&T(e,"placeholder",i[1]),s&4&&T(e,"tabindex",i[2]),s&1&&xn(e,i[0])},i:ce,o:ce,d(i){i&&F(e),t=!1,He(r)}}}function R_(n,e,t){let{value:r=""}=e,{placeholder:i=void 0}=e,{tabindex:s=void 0}=e;function o(u){Be.call(this,n,u)}function a(u){Be.call(this,n,u)}function l(){r=this.value,t(0,r)}return n.$$set=u=>{"value"in u&&t(0,r=u.value),"placeholder"in u&&t(1,i=u.placeholder),"tabindex"in u&&t(2,s=u.tabindex)},[r,i,s,o,a,l]}class lh extends ze{constructor(e){super(),De(this,e,R_,k_,Ue,{value:0,placeholder:1,tabindex:2})}}const Qn=[];function Ba(n,e=ce){let t;const r=new Set;function i(a){if(Ue(n,a)&&(n=a,t)){const l=!Qn.length;for(const u of r)u[1](),Qn.push(u,n);if(l){for(let u=0;u<Qn.length;u+=2)Qn[u][0](Qn[u+1]);Qn.length=0}}}function s(a){i(a(n))}function o(a,l=ce){const u=[a,l];return r.add(u),r.size===1&&(t=e(i,s)||ce),a(n),()=>{r.delete(u),r.size===0&&t&&(t(),t=null)}}return{set:i,update:s,subscribe:o}}const uh="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1280' height='720'%3E%3Cdefs%3E%3ClinearGradient id='a' x1='0' x2='0' y1='0' y2='1'%3E%3Cstop offset='0' stop-color='%2380F'/%3E%3Cstop offset='1' stop-color='%23f40'/%3E%3C/linearGradient%3E%3Cpattern id='b' width='24' height='24' patternUnits='userSpaceOnUse'%3E%3Ccircle fill='%23ffffff' cx='12' cy='12' r='12'/%3E%3C/pattern%3E%3C/defs%3E%3Crect width='1280' height='720' fill='url(%23a)'/%3E%3Crect width='1280' height='720' fill='url(%23b)' fill-opacity='0.1'/%3E%3C/svg%3E",ch="data:image/svg+xml,%3Csvg width='180' height='180' viewBox='0 0 180 180' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg filter='url(%23filter0_b_4708_581)'%3E%3Crect width='180' height='180' fill='%23E0353D'/%3E%3Cpath d='M127.965 100.325C128.202 96.5313 125.591 93.7559 122.915 91.3863C118.215 86.7356 109.585 88.8783 107.713 95.306C107.584 95.3316 107.523 95.2594 107.452 95.2072C106.34 94.3996 105.053 93.8537 103.693 93.6115C103.09 93.4223 102.322 93.6678 101.852 93.1866C100.213 91.5559 98.5517 89.9466 96.9076 88.3211C96.4885 87.8552 95.7153 87.7699 95.2308 88.1855C93.4715 89.8693 91.7662 91.6043 90.0088 93.2905C82.3937 86.6592 85.854 85.7404 78.1322 93.132C77.5571 93.6012 77.3765 94.3686 77.9098 94.937C79.626 96.6487 81.3706 98.3227 83.0868 100.039C81.4574 101.819 79.6175 103.443 77.9241 105.177C77.4737 105.674 77.4746 106.287 77.9269 106.791C79.6004 108.45 81.2881 110.099 82.9702 111.748C83.1489 111.888 83.2072 112.063 83.2162 112.292C83.2883 115.516 85.1026 117.66 87.3554 119.775C85.9995 120.192 84.7567 120.905 83.7195 121.859C82.6823 122.813 81.8773 123.985 81.3645 125.288C65.1695 120.475 57.6705 100.035 66.8477 86.1099C69.9818 81.2034 74.7226 77.5782 78.7404 73.4023C82.0248 76.3375 84.8888 80.785 89.8339 80.7096C98.161 80.915 102.235 70.7648 96.561 65.3556C94.9966 63.7407 93.3539 62.2219 91.7728 60.6219C97.8339 54.6583 103.574 47.5984 112.411 45.8093C127.227 41.9316 143.422 52.4606 145.592 67.2975C148.157 82.9655 138.193 90.4959 128.056 100.355L127.965 100.325ZM117.832 77.6248C117.581 70.9315 107.409 71.2922 107.592 77.8978C107.927 84.5579 117.932 84.093 117.832 77.6248ZM119.823 65.678C119.781 72.203 129.917 72.3689 130.056 65.7767C130.051 59.1241 119.887 59.1497 119.825 65.678H119.823ZM119.823 77.6984C119.736 84.2258 129.957 84.3898 130.059 77.7804C130.003 71.0932 119.902 71.1207 119.825 77.6979L119.823 77.6984ZM112.7 70.7387C119.398 70.7363 119.422 60.7724 112.741 60.6862C106.025 60.696 105.975 70.7107 112.7 70.7387ZM85.36 76.5075C91.2575 81.988 100.227 74.1314 95.4882 67.7885C90.6123 62.6668 85.3533 57.8819 80.3675 52.8557C74.2523 46.7705 65.1538 43.948 56.5891 45.4422C42.162 47.508 31.0804 62.5317 34.6867 77.5027C35.8278 82.4912 38.2044 86.8269 41.8733 90.4498C48.7228 97.1305 55.5087 104.015 62.4236 110.561C59.0733 102.139 60.0376 92.3549 64.8618 84.6688C58.9055 86.245 52.3755 83.6904 49.3391 78.3726C49.0949 77.9821 48.8901 77.5185 49.0963 77.068C49.3941 76.2033 50.6722 76.0365 51.1951 76.7908C53.9955 82.3337 61.7485 84.5579 67.1497 81.0613C67.675 80.7352 68.1875 80.389 68.6293 79.9557C72.0161 76.6818 75.3019 73.2807 78.7433 70.0706C81.0127 72.1369 83.1299 74.3914 85.36 76.5075ZM100.623 96.3086C95.6949 97.5009 94.0934 103.165 96.9725 107.024C92.1791 103.09 84.6977 107.517 86.0351 113.469C86.4527 116.016 88.6539 117.564 90.3563 119.315C91.3993 120.364 92.4963 121.362 93.5018 122.442C82.0206 117.506 78.7309 135.857 91.1708 134.969C95.9917 134.297 98.4573 128.414 95.692 124.528C102.508 128.38 109.462 121 104.826 114.74L104.878 114.667C111.394 119.534 119.303 111.718 114.426 105.253C121.257 110.303 129.374 101.495 123.598 95.422C121.309 92.9061 118.51 90.3529 114.827 91.4669C110.114 92.6051 108.443 98.0553 111.009 101.859C108.023 99.2317 105.25 94.9482 100.623 96.31V96.3086Z' fill='white'/%3E%3C/g%3E%3Cdefs%3E%3Cfilter id='filter0_b_4708_581' x='-20.1111' y='-20.1111' width='220.222' height='220.222' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3E%3CfeFlood flood-opacity='0' result='BackgroundImageFix'/%3E%3CfeGaussianBlur in='BackgroundImageFix' stdDeviation='10.0556'/%3E%3CfeComposite in2='SourceAlpha' operator='in' result='effect1_backgroundBlur_4708_581'/%3E%3CfeBlend mode='normal' in='SourceGraphic' in2='effect1_backgroundBlur_4708_581' result='shape'/%3E%3C/filter%3E%3C/defs%3E%3C/svg%3E",hh="data:image/jpeg;base64,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",B_=1280,I_=720,fh={version:0,width:B_,height:I_,background:{src:uh,x:0,y:0,w:1280,h:720,flip_h:!1,flip_v:!1},logo:{src:ch,x:1100,y:0,w:180,h:180,blur:0},filter:{adjustment:{enabled:!1,gamma:1,saturation:1,contrast:1,brightness:1},blur:{enabled:!0,value:.2},tilt_shift:{enabled:!1,blur:5,start:{x:600,y:0},end:{x:600,y:720}},vignetting:{enabled:!1,value:.3,alpha:1,blur:.3},zoom_blur:{enabled:!1,center:{x:900,y:360},value:.03,radius:500},gradient:{enabled:!0,start:{value:0,color:"#0000008c"},mid:{value:.34,color:"#00000066"},end:{value:.6,color:"#00000000"}}},title:{text:"",x:60,y:53,font:{face:"Gilroy",size:80,weight:"700",color:"#ffffff",line_height:99},shadow:{value:0,color:"#00000088"}},description:{text:"  ",x:60,gap:11,font:{face:"Gilroy",size:50,weight:"600",color:"#ffffff",line_height:61},shadow:{value:0,color:"#00000088"}},categories:{src:[hh],x:60,y:432,w:170,h:228,round:12,blur:.1,margin:32,shadow:{value:2,color:"#00000066"}},debug:!1},K=Ba(structuredClone(fh)),Zt=Ba({background:uh.split(",")[0],background_cl:"",logo:ch.split(",")[0],app:void 0}),F_="modulepreload",O_=function(n,e){return new URL(n,e).href},Hl={},fs=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");i=Promise.allSettled(t.map(u=>{if(u=O_(u,r),u in Hl)return;Hl[u]=!0;const c=u.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(!!r)for(let p=o.length-1;p>=0;p--){const g=o[p];if(g.href===u&&(!c||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${h}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":F_,c||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),c)return new Promise((p,g)=>{f.addEventListener("load",p),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};var M=(n=>(n.Application="application",n.WebGLPipes="webgl-pipes",n.WebGLPipesAdaptor="webgl-pipes-adaptor",n.WebGLSystem="webgl-system",n.WebGPUPipes="webgpu-pipes",n.WebGPUPipesAdaptor="webgpu-pipes-adaptor",n.WebGPUSystem="webgpu-system",n.CanvasSystem="canvas-system",n.CanvasPipesAdaptor="canvas-pipes-adaptor",n.CanvasPipes="canvas-pipes",n.Asset="asset",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser",n.MaskEffect="mask-effect",n.BlendMode="blend-mode",n.TextureSource="texture-source",n.Environment="environment",n.ShapeBuilder="shape-builder",n.Batcher="batcher",n))(M||{});const qo=n=>{if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");n={...typeof n.extension!="object"?{type:n.extension}:n.extension,ref:n}}if(typeof n=="object")n={...n};else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},Mi=(n,e)=>qo(n).priority??e,pe={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...n){return n.map(qo).forEach(e=>{e.type.forEach(t=>this._removeHandlers[t]?.(e))}),this},add(...n){return n.map(qo).forEach(e=>{e.type.forEach(t=>{const r=this._addHandlers,i=this._queue;r[t]?r[t]?.(e):(i[t]=i[t]||[],i[t]?.push(e))})}),this},handle(n,e,t){const r=this._addHandlers,i=this._removeHandlers;if(r[n]||i[n])throw new Error(`Extension type ${n} already has a handler`);r[n]=e,i[n]=t;const s=this._queue;return s[n]&&(s[n]?.forEach(o=>e(o)),delete s[n]),this},handleByMap(n,e){return this.handle(n,t=>{t.name&&(e[t.name]=t.ref)},t=>{t.name&&delete e[t.name]})},handleByNamedList(n,e,t=-1){return this.handle(n,r=>{e.findIndex(s=>s.name===r.name)>=0||(e.push({name:r.name,value:r.ref}),e.sort((s,o)=>Mi(o.value,t)-Mi(s.value,t)))},r=>{const i=e.findIndex(s=>s.name===r.name);i!==-1&&e.splice(i,1)})},handleByList(n,e,t=-1){return this.handle(n,r=>{e.includes(r.ref)||(e.push(r.ref),e.sort((i,s)=>Mi(s,t)-Mi(i,t)))},r=>{const i=e.indexOf(r.ref);i!==-1&&e.splice(i,1)})}},U_={extension:{type:M.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await fs(()=>Promise.resolve().then(()=>LC),void 0,import.meta.url)}},G_={extension:{type:M.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await fs(()=>Promise.resolve().then(()=>NC),void 0,import.meta.url)}};class ut{constructor(e,t,r){this._x=t||0,this._y=r||0,this._observer=e}clone(e){return new ut(e??this._observer,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}function Ia(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var dh={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,h,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new i(c,h||l,d),p=t?t+u:u;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,h;if(this._eventsCount===0)return u;for(h in c=this._events)e.call(c,h)&&u.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=t?t+u:u,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,p=new Array(f);d<f;d++)p[d]=h[d].fn;return p},a.prototype.listenerCount=function(u){var c=t?t+u:u,h=this._events[c];return h?h.fn?1:h.length:0},a.prototype.emit=function(u,c,h,d,f,p){var g=t?t+u:u;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,x,S;if(m.fn){switch(m.once&&this.removeListener(u,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,h),!0;case 4:return m.fn.call(m.context,c,h,d),!0;case 5:return m.fn.call(m.context,c,h,d,f),!0;case 6:return m.fn.call(m.context,c,h,d,f,p),!0}for(S=1,x=new Array(v-1);S<v;S++)x[S-1]=arguments[S];m.fn.apply(m.context,x)}else{var y=m.length,b;for(S=0;S<y;S++)switch(m[S].once&&this.removeListener(u,m[S].fn,void 0,!0),v){case 1:m[S].fn.call(m[S].context);break;case 2:m[S].fn.call(m[S].context,c);break;case 3:m[S].fn.call(m[S].context,c,h);break;case 4:m[S].fn.call(m[S].context,c,h,d);break;default:if(!x)for(b=1,x=new Array(v-1);b<v;b++)x[b-1]=arguments[b];m[S].fn.apply(m[S].context,x)}}return!0},a.prototype.on=function(u,c,h){return s(this,u,c,h,!1)},a.prototype.once=function(u,c,h){return s(this,u,c,h,!0)},a.prototype.removeListener=function(u,c,h,d){var f=t?t+u:u;if(!this._events[f])return this;if(!c)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!d||p.once)&&(!h||p.context===h)&&o(this,f);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==c||d&&!p[g].once||h&&p[g].context!==h)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&o(this,c)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a})(dh);var D_=dh.exports;const At=Ia(D_),z_=Math.PI*2,L_=180/Math.PI,gr=Math.PI/180;class ke{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new ke(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Qs.x=0,Qs.y=0,Qs}}const Qs=new ke;class ue{constructor(e=1,t=0,r=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=t,this.c=r,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,r,i,s,o){return this.a=e,this.b=t,this.c=r,this.d=i,this.tx=s,this.ty=o,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(e,t){t=t||new ke;const r=e.x,i=e.y;return t.x=this.a*r+this.c*i+this.tx,t.y=this.b*r+this.d*i+this.ty,t}applyInverse(e,t){t=t||new ke;const r=this.a,i=this.b,s=this.c,o=this.d,a=this.tx,l=this.ty,u=1/(r*o+s*-i),c=e.x,h=e.y;return t.x=o*u*c+-s*u*h+(l*s-a*o)*u,t.y=r*u*h+-i*u*c+(-l*r+a*i)*u,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*t-this.b*r,this.b=i*r+this.b*t,this.c=s*t-this.d*r,this.d=s*r+this.d*t,this.tx=o*t-this.ty*r,this.ty=o*r+this.ty*t,this}append(e){const t=this.a,r=this.b,i=this.c,s=this.d;return this.a=e.a*t+e.b*i,this.b=e.a*r+e.b*s,this.c=e.c*t+e.d*i,this.d=e.c*r+e.d*s,this.tx=e.tx*t+e.ty*i+this.tx,this.ty=e.tx*r+e.ty*s+this.ty,this}appendFrom(e,t){const r=e.a,i=e.b,s=e.c,o=e.d,a=e.tx,l=e.ty,u=t.a,c=t.b,h=t.c,d=t.d;return this.a=r*u+i*h,this.b=r*c+i*d,this.c=s*u+o*h,this.d=s*c+o*d,this.tx=a*u+l*h+t.tx,this.ty=a*c+l*d+t.ty,this}setTransform(e,t,r,i,s,o,a,l,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(r*this.a+i*this.c),this.ty=t-(r*this.b+i*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const r=this.a,i=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,r=this.b,i=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-i,s),l=Math.atan2(r,t),u=Math.abs(a+l);return u<1e-5||Math.abs(z_-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*t+o.y*i),e.position.y=this.ty+(o.x*r+o.y*s),e}invert(){const e=this.a,t=this.b,r=this.c,i=this.d,s=this.tx,o=e*i-t*r;return this.a=i/o,this.b=-t/o,this.c=-r/o,this.d=e/o,this.tx=(r*this.ty-i*s)/o,this.ty=-(e*this.ty-t*s)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new ue;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return H_.identity()}static get shared(){return N_.identity()}}const N_=new ue,H_=new ue,En=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Mn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],kn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Rn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Yo=[],ph=[],ki=Math.sign;function V_(){for(let n=0;n<16;n++){const e=[];Yo.push(e);for(let t=0;t<16;t++){const r=ki(En[n]*En[t]+kn[n]*Mn[t]),i=ki(Mn[n]*En[t]+Rn[n]*Mn[t]),s=ki(En[n]*kn[t]+kn[n]*Rn[t]),o=ki(Mn[n]*kn[t]+Rn[n]*Rn[t]);for(let a=0;a<16;a++)if(En[a]===r&&Mn[a]===i&&kn[a]===s&&Rn[a]===o){e.push(a);break}}}for(let n=0;n<16;n++){const e=new ue;e.set(En[n],Mn[n],kn[n],Rn[n],0,0),ph.push(e)}}V_();const We={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:n=>En[n],uY:n=>Mn[n],vX:n=>kn[n],vY:n=>Rn[n],inv:n=>n&8?n&15:-n&7,add:(n,e)=>Yo[n][e],sub:(n,e)=>Yo[n][We.inv(e)],rotate180:n=>n^4,isVertical:n=>(n&3)===2,byDirection:(n,e)=>Math.abs(n)*2<=Math.abs(e)?e>=0?We.S:We.N:Math.abs(e)*2<=Math.abs(n)?n>0?We.E:We.W:e>0?n>0?We.SE:We.SW:n>0?We.NE:We.NW,matrixAppendRotationInv:(n,e,t=0,r=0)=>{const i=ph[We.inv(e)];i.tx=t,i.ty=r,n.append(i)}},Ri=[new ke,new ke,new ke,new ke];class Re{constructor(e=0,t=0,r=0,i=0){this.type="rectangle",this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(i)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Re(0,0,0,0)}clone(){return new Re(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}strokeContains(e,t,r){const{width:i,height:s}=this;if(i<=0||s<=0)return!1;const o=this.x,a=this.y,l=o-r/2,u=o+i+r/2,c=a-r/2,h=a+s+r/2,d=o+r/2,f=o+i-r/2,p=a+r/2,g=a+s-r/2;return e>=l&&e<=u&&t>=c&&t<=h&&!(e>d&&e<f&&t>p&&t<g)}intersects(e,t){if(!t){const U=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=U)return!1;const _=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>_}const r=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=r||o<=s)return!1;const a=Ri[0].set(e.left,e.top),l=Ri[1].set(e.left,e.bottom),u=Ri[2].set(e.right,e.top),c=Ri[3].set(e.right,e.bottom);if(u.x<=a.x||l.y<=a.y)return!1;const h=Math.sign(t.a*t.d-t.b*t.c);if(h===0||(t.apply(a,a),t.apply(l,l),t.apply(u,u),t.apply(c,c),Math.max(a.x,l.x,u.x,c.x)<=r||Math.min(a.x,l.x,u.x,c.x)>=i||Math.max(a.y,l.y,u.y,c.y)<=s||Math.min(a.y,l.y,u.y,c.y)>=o))return!1;const d=h*(l.y-a.y),f=h*(a.x-l.x),p=d*r+f*s,g=d*i+f*s,m=d*r+f*o,v=d*i+f*o;if(Math.max(p,g,m,v)<=d*a.x+f*a.y||Math.min(p,g,m,v)>=d*c.x+f*c.y)return!1;const x=h*(a.y-u.y),S=h*(u.x-a.x),y=x*r+S*s,b=x*i+S*s,B=x*r+S*o,A=x*i+S*o;return!(Math.max(y,b,B,A)<=x*a.x+S*a.y||Math.min(y,b,B,A)>=x*c.x+S*c.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,t=.001){const r=Math.ceil((this.x+this.width-t)*e)/e,i=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=i-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=i,this.height=s-i,this}getBounds(e){return e=e||new Re,e.copyFrom(this),e}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Js={default:-1};function Xe(n="default"){return Js[n]===void 0&&(Js[n]=-1),++Js[n]}const Vl={},we="8.0.0",W_="8.3.4";function ie(n,e,t=3){if(Vl[e])return;let r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${n}`):(r=r.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${n}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${n}`),console.warn(r))),Vl[e]=!0}const mh=()=>{};function _r(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function Wl(n){return!(n&n-1)&&!!n}function j_(n){const e={};for(const t in n)n[t]!==void 0&&(e[t]=n[t]);return e}const jl=Object.create(null);function X_(n){const e=jl[n];return e===void 0&&(jl[n]=Xe("resource")),e}const gh=class _h extends At{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={..._h.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){ie(we,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=X_(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};gh.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let q_=gh;const vh=class bh extends At{constructor(e={}){super(),this.options=e,this.uid=Xe("textureSource"),this._resourceType="textureSource",this._resourceId=Xe("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...bh.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new q_(j_(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Xe("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,t,r){r=r||this._resolution,e=e||this.width,t=t||this.height;const i=Math.round(e*r),s=Math.round(t*r);return this.width=i/r,this.height=s/r,this._resolution=r,this.pixelWidth===i&&this.pixelHeight===s?!1:(this._refreshPOT(),this.pixelWidth=i,this.pixelHeight=s,this.emit("resize",this),this._resourceId=Xe("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Wl(this.pixelWidth)&&Wl(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};vh.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Je=vh;class Fa extends Je{constructor(e){const t=e.resource||new Float32Array(e.width*e.height*4);let r=e.format;r||(t instanceof Float32Array?r="rgba32float":t instanceof Int32Array||t instanceof Uint32Array?r="rgba32uint":t instanceof Int16Array||t instanceof Uint16Array?r="rgba16uint":(t instanceof Int8Array,r="bgra8unorm")),super({...e,resource:t,format:r}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}Fa.extension=M.TextureSource;const Xl=new ue;class xh{constructor(e,t){this.mapCoord=new ue,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof t>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=t,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,t){t===void 0&&(t=e);const r=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];t[i]=s*r.a+o*r.c+r.tx,t[i+1]=s*r.b+o*r.d+r.ty}return t}update(){const e=this._texture;this._updateID++;const t=e.uvs;this.mapCoord.set(t.x1-t.x0,t.y1-t.y0,t.x3-t.x0,t.y3-t.y0,t.x0,t.y0);const r=e.orig,i=e.trim;i&&(Xl.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(Xl));const s=e.source,o=this.uClampFrame,a=this.clampMargin/s._resolution,l=this.clampOffset/s._resolution;return o[0]=(e.frame.x+a+l)/s.width,o[1]=(e.frame.y+a+l)/s.height,o[2]=(e.frame.x+e.frame.width-a+l)/s.width,o[3]=(e.frame.y+e.frame.height-a+l)/s.height,this.uClampOffset[0]=this.clampOffset/s.pixelWidth,this.uClampOffset[1]=this.clampOffset/s.pixelHeight,this.isSimple=e.frame.width===s.width&&e.frame.height===s.height&&e.rotate===0,!0}}class se extends At{constructor({source:e,label:t,frame:r,orig:i,trim:s,defaultAnchor:o,defaultBorders:a,rotate:l,dynamic:u}={}){if(super(),this.uid=Xe("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Re,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=t,this.source=e?.source??new Je,this.noFrame=!r,r)this.frame.copyFrom(r);else{const{width:c,height:h}=this._source;this.frame.width=c,this.frame.height=h}this.orig=i||this.frame,this.trim=s,this.rotate=l??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=u||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new xh(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:t}=this,{width:r,height:i}=this._source,s=t.x/r,o=t.y/i,a=t.width/r,l=t.height/i;let u=this.rotate;if(u){const c=a/2,h=l/2,d=s+c,f=o+h;u=We.add(u,We.NW),e.x0=d+c*We.uX(u),e.y0=f+h*We.uY(u),u=We.add(u,2),e.x1=d+c*We.uX(u),e.y1=f+h*We.uY(u),u=We.add(u,2),e.x2=d+c*We.uX(u),e.y2=f+h*We.uY(u),u=We.add(u,2),e.x3=d+c*We.uX(u),e.y3=f+h*We.uY(u)}else e.x0=s,e.y0=o,e.x1=s+a,e.y1=o,e.x2=s+a,e.y2=o+l,e.x3=s,e.y3=o+l}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return ie(we,"Texture.baseTexture is now Texture.source"),this._source}}se.EMPTY=new se({label:"EMPTY",source:new Je({label:"EMPTY"})});se.EMPTY.destroy=mh;se.WHITE=new se({source:new Fa({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});se.WHITE.destroy=mh;function ds(n,e,t,r){const{width:i,height:s}=t.orig,o=t.trim;if(o){const a=o.width,l=o.height;n.minX=o.x-e._x*i-r,n.maxX=n.minX+a,n.minY=o.y-e._y*s-r,n.maxY=n.minY+l}else n.minX=-e._x*i-r,n.maxX=n.minX+i,n.minY=-e._y*s-r,n.maxY=n.minY+s}const ql=new ue;class vt{constructor(e=1/0,t=1/0,r=-1/0,i=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ql,this.minX=e,this.minY=t,this.maxX=r,this.maxY=i}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Re);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ql,this}set(e,t,r,i){this.minX=e,this.minY=t,this.maxX=r,this.maxY=i}addFrame(e,t,r,i,s){s||(s=this.matrix);const o=s.a,a=s.b,l=s.c,u=s.d,c=s.tx,h=s.ty;let d=this.minX,f=this.minY,p=this.maxX,g=this.maxY,m=o*e+l*t+c,v=a*e+u*t+h;m<d&&(d=m),v<f&&(f=v),m>p&&(p=m),v>g&&(g=v),m=o*r+l*t+c,v=a*r+u*t+h,m<d&&(d=m),v<f&&(f=v),m>p&&(p=m),v>g&&(g=v),m=o*e+l*i+c,v=a*e+u*i+h,m<d&&(d=m),v<f&&(f=v),m>p&&(p=m),v>g&&(g=v),m=o*r+l*i+c,v=a*r+u*i+h,m<d&&(d=m),v<f&&(f=v),m>p&&(p=m),v>g&&(g=v),this.minX=d,this.minY=f,this.maxX=p,this.maxY=g}addRect(e,t){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,t)}addBounds(e,t){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,t)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const t=this.minX,r=this.minY,i=this.maxX,s=this.maxY,{a:o,b:a,c:l,d:u,tx:c,ty:h}=e;let d=o*t+l*r+c,f=a*t+u*r+h;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*i+l*r+c,f=a*i+u*r+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*t+l*s+c,f=a*t+u*s+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*i+l*s+c,f=a*i+u*s+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,t,r,i){return this.minX<e&&(this.minX=e),this.maxX>t&&(this.maxX=t),this.minY<r&&(this.minY=r),this.maxY>i&&(this.maxY=i),this}pad(e,t=e){return this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new vt(this.minX,this.minY,this.maxX,this.maxY)}scale(e,t=e){return this.minX*=e,this.minY*=t,this.maxX*=e,this.maxY*=t,this}get x(){return this.minX}set x(e){const t=this.maxX-this.minX;this.minX=e,this.maxX=e+t}get y(){return this.minY}set y(e){const t=this.maxY-this.minY;this.minY=e,this.maxY=e+t}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,t,r,i){let s=this.minX,o=this.minY,a=this.maxX,l=this.maxY;i||(i=this.matrix);const u=i.a,c=i.b,h=i.c,d=i.d,f=i.tx,p=i.ty;for(let g=t;g<r;g+=2){const m=e[g],v=e[g+1],x=u*m+h*v+f,S=c*m+d*v+p;s=x<s?x:s,o=S<o?S:o,a=x>a?x:a,l=S>l?S:l}this.minX=s,this.minY=o,this.maxX=a,this.maxY=l}containsPoint(e,t){return this.minX<=e&&this.minY<=t&&this.maxX>=e&&this.maxY>=t}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}}var Y_={grad:.9,turn:360,rad:360/(2*Math.PI)},on=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},tt=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t+0},It=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n>e?n:e},yh=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},Yl=function(n){return{r:It(n.r,0,255),g:It(n.g,0,255),b:It(n.b,0,255),a:It(n.a)}},$s=function(n){return{r:tt(n.r),g:tt(n.g),b:tt(n.b),a:tt(n.a,3)}},K_=/^#([0-9a-f]{3,8})$/i,Bi=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},Sh=function(n){var e=n.r,t=n.g,r=n.b,i=n.a,s=Math.max(e,t,r),o=s-Math.min(e,t,r),a=o?s===e?(t-r)/o:s===t?2+(r-e)/o:4+(e-t)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},wh=function(n){var e=n.h,t=n.s,r=n.v,i=n.a;e=e/360*6,t/=100,r/=100;var s=Math.floor(e),o=r*(1-t),a=r*(1-(e-s)*t),l=r*(1-(1-e+s)*t),u=s%6;return{r:255*[r,a,o,o,l,r][u],g:255*[l,r,r,a,o,o][u],b:255*[o,o,l,r,r,a][u],a:i}},Kl=function(n){return{h:yh(n.h),s:It(n.s,0,100),l:It(n.l,0,100),a:It(n.a)}},Zl=function(n){return{h:tt(n.h),s:tt(n.s),l:tt(n.l),a:tt(n.a,3)}},Ql=function(n){return wh((t=(e=n).s,{h:e.h,s:(t*=((r=e.l)<50?r:100-r)/100)>0?2*t/(r+t)*100:0,v:r+t,a:e.a}));var e,t,r},Wr=function(n){return{h:(e=Sh(n)).h,s:(i=(200-(t=e.s))*(r=e.v)/100)>0&&i<200?t*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,t,r,i},Z_=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Q_=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,J_=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,$_=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ko={string:[[function(n){var e=K_.exec(n);return e?(n=e[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?tt(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?tt(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var e=J_.exec(n)||$_.exec(n);return e?e[2]!==e[4]||e[4]!==e[6]?null:Yl({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(n){var e=Z_.exec(n)||Q_.exec(n);if(!e)return null;var t,r,i=Kl({h:(t=e[1],r=e[2],r===void 0&&(r="deg"),Number(t)*(Y_[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return Ql(i)},"hsl"]],object:[[function(n){var e=n.r,t=n.g,r=n.b,i=n.a,s=i===void 0?1:i;return on(e)&&on(t)&&on(r)?Yl({r:Number(e),g:Number(t),b:Number(r),a:Number(s)}):null},"rgb"],[function(n){var e=n.h,t=n.s,r=n.l,i=n.a,s=i===void 0?1:i;if(!on(e)||!on(t)||!on(r))return null;var o=Kl({h:Number(e),s:Number(t),l:Number(r),a:Number(s)});return Ql(o)},"hsl"],[function(n){var e=n.h,t=n.s,r=n.v,i=n.a,s=i===void 0?1:i;if(!on(e)||!on(t)||!on(r))return null;var o=function(a){return{h:yh(a.h),s:It(a.s,0,100),v:It(a.v,0,100),a:It(a.a)}}({h:Number(e),s:Number(t),v:Number(r),a:Number(s)});return wh(o)},"hsv"]]},Jl=function(n,e){for(var t=0;t<e.length;t++){var r=e[t][0](n);if(r)return[r,e[t][1]]}return[null,void 0]},e0=function(n){return typeof n=="string"?Jl(n.trim(),Ko.string):typeof n=="object"&&n!==null?Jl(n,Ko.object):[null,void 0]},eo=function(n,e){var t=Wr(n);return{h:t.h,s:It(t.s+100*e,0,100),l:t.l,a:t.a}},to=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},$l=function(n,e){var t=Wr(n);return{h:t.h,s:t.s,l:It(t.l+100*e,0,100),a:t.a}},Zo=function(){function n(e){this.parsed=e0(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return tt(to(this.rgba),2)},n.prototype.isDark=function(){return to(this.rgba)<.5},n.prototype.isLight=function(){return to(this.rgba)>=.5},n.prototype.toHex=function(){return e=$s(this.rgba),t=e.r,r=e.g,i=e.b,o=(s=e.a)<1?Bi(tt(255*s)):"","#"+Bi(t)+Bi(r)+Bi(i)+o;var e,t,r,i,s,o},n.prototype.toRgb=function(){return $s(this.rgba)},n.prototype.toRgbString=function(){return e=$s(this.rgba),t=e.r,r=e.g,i=e.b,(s=e.a)<1?"rgba("+t+", "+r+", "+i+", "+s+")":"rgb("+t+", "+r+", "+i+")";var e,t,r,i,s},n.prototype.toHsl=function(){return Zl(Wr(this.rgba))},n.prototype.toHslString=function(){return e=Zl(Wr(this.rgba)),t=e.h,r=e.s,i=e.l,(s=e.a)<1?"hsla("+t+", "+r+"%, "+i+"%, "+s+")":"hsl("+t+", "+r+"%, "+i+"%)";var e,t,r,i,s},n.prototype.toHsv=function(){return e=Sh(this.rgba),{h:tt(e.h),s:tt(e.s),v:tt(e.v),a:tt(e.a,3)};var e},n.prototype.invert=function(){return qt({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},n.prototype.saturate=function(e){return e===void 0&&(e=.1),qt(eo(this.rgba,e))},n.prototype.desaturate=function(e){return e===void 0&&(e=.1),qt(eo(this.rgba,-e))},n.prototype.grayscale=function(){return qt(eo(this.rgba,-1))},n.prototype.lighten=function(e){return e===void 0&&(e=.1),qt($l(this.rgba,e))},n.prototype.darken=function(e){return e===void 0&&(e=.1),qt($l(this.rgba,-e))},n.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},n.prototype.alpha=function(e){return typeof e=="number"?qt({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):tt(this.rgba.a,3);var t},n.prototype.hue=function(e){var t=Wr(this.rgba);return typeof e=="number"?qt({h:e,s:t.s,l:t.l,a:t.a}):tt(t.h)},n.prototype.isEqual=function(e){return this.toHex()===qt(e).toHex()},n}(),qt=function(n){return n instanceof Zo?n:new Zo(n)},eu=[],t0=function(n){n.forEach(function(e){eu.indexOf(e)<0&&(e(Zo,Ko),eu.push(e))})};function n0(n,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in t)r[t[i]]=i;var s={};n.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,u=r[this.toHex()];if(u)return u;if(o?.closest){var c=this.toRgb(),h=1/0,d="black";if(!s.length)for(var f in t)s[f]=new n(t[f]).toRgb();for(var p in t){var g=(a=c,l=s[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));g<h&&(h=g,d=p)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":t[a];return l?new n(l).toRgb():null},"name"])}t0([n0]);const vr=class Dr{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Dr)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,t){const r=typeof e;if(r!==typeof t)return!1;if(r==="number"||r==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((s,o)=>s===t[o]);if(e!==null&&t!==null){const s=Object.keys(e),o=Object.keys(t);return s.length!==o.length?!1:s.every(a=>e[a]===t[a])}return e===t}toRgba(){const[e,t,r,i]=this._components;return{r:e,g:t,b:r,a:i}}toRgb(){const[e,t,r]=this._components;return{r:e,g:t,b:r}}toRgbaString(){const[e,t,r]=this.toUint8RgbArray();return`rgba(${e},${t},${r},${this.alpha})`}toUint8RgbArray(e){const[t,r,i]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e=e||this._arrayRgb,e[0]=Math.round(t*255),e[1]=Math.round(r*255),e[2]=Math.round(i*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e=e||this._arrayRgba;const[t,r,i,s]=this._components;return e[0]=t,e[1]=r,e[2]=i,e[3]=s,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e=e||this._arrayRgb;const[t,r,i]=this._components;return e[0]=t,e[1]=r,e[2]=i,e}toNumber(){return this._int}toBgrNumber(){const[e,t,r]=this.toUint8RgbArray();return(r<<16)+(t<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,r,i,s]=Dr._temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=r,this._components[2]*=i,this._components[3]*=s,this._refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return t&&(r=r*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(r<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let t,r,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;t=(o>>16&255)/255,r=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,r,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,r,i,s=255]=e,t/=255,r/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Dr.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=qt(e);o.isValid()&&({r:t,g:r,b:i,a:s}=o.rgba,t/=255,r/=255,i/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=r,this._components[2]=i,this._components[3]=s,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,t,r]=this._components;this._int=(e*255<<16)+(t*255<<8)+(r*255|0)}_clamp(e,t=0,r=1){return typeof e=="number"?Math.min(Math.max(e,t),r):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,t),r)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof Dr||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};vr.shared=new vr;vr._temp=new vr;vr.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let me=vr;const r0={cullArea:null,cullable:!1,cullableChildren:!0};class Oa{constructor(e,t){this._pool=[],this._count=0,this._index=0,this._classType=e,t&&this.prepopulate(t)}prepopulate(e){for(let t=0;t<e;t++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let t;return this._index>0?t=this._pool[--this._index]:t=new this._classType,t.init?.(e),t}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class i0{constructor(){this._poolsByClass=new Map}prepopulate(e,t){this.getPool(e).prepopulate(t)}get(e,t){return this.getPool(e).get(t)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new Oa(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(t=>{const r=e[t._classType.name]?t._classType.name+t._classType.ID:t._classType.name;e[r]={free:t.totalFree,used:t.totalUsed,size:t.totalSize}}),e}}const Te=new i0;function Th(n,e,t){const r=n.length;let i;if(e>=r||t===0)return;t=e+t>r?r-e:t;const s=r-t;for(i=e;i<s;++i)n[i]=n[i+t];n.length=s}const s0={allowChildren:!0,removeChildren(n=0,e){const t=e??this.children.length,r=t-n,i=[];if(r>0&&r<=t){for(let o=t-1;o>=n;o--){const a=this.children[o];a&&(i.push(a),a.parent=null)}Th(this.children,n,t);const s=this.renderGroup||this.parentRenderGroup;s&&s.removeChildren(i);for(let o=0;o<i.length;++o)this.emit("childRemoved",i[o],this,o),i[o].emit("removed",this);return i}else if(r===0&&this.children.length===0)return i;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(n){const e=this.getChildAt(n);return this.removeChild(e)},getChildAt(n){if(n<0||n>=this.children.length)throw new Error(`getChildAt: Index (${n}) does not exist.`);return this.children[n]},setChildIndex(n,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(n),this.addChildAt(n,e)},getChildIndex(n){const e=this.children.indexOf(n);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(n,e){this.allowChildren||ie(we,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:t}=this;if(e<0||e>t.length)throw new Error(`${n}addChildAt: The index ${e} supplied is out of bounds ${t.length}`);if(n.parent){const i=n.parent.children.indexOf(n);if(n.parent===this&&i===e)return n;i!==-1&&n.parent.children.splice(i,1)}e===t.length?t.push(n):t.splice(e,0,n),n.parent=this,n.didChange=!0,n.didViewUpdate=!1,n._updateFlags=15;const r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(n),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",n,this,e),n.emit("added",this),n},swapChildren(n,e){if(n===e)return;const t=this.getChildIndex(n),r=this.getChildIndex(e);this.children[t]=e,this.children[r]=n;const i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...n){return n.length===1?this.reparentChildAt(n[0],this.children.length):(n.forEach(e=>this.reparentChildAt(e,this.children.length)),n[0])},reparentChildAt(n,e){if(n.parent===this)return this.setChildIndex(n,e),n;const t=n.worldTransform.clone();n.removeFromParent(),this.addChildAt(n,e);const r=this.worldTransform.clone();return r.invert(),t.prepend(r),n.setFromMatrix(t),n}};class ps{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class o0{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let t=0;t<this._tests.length;t++){const r=this._tests[t];if(r.test(e))return Te.get(r.maskClass,e)}return e}returnMaskEffect(e){Te.return(e)}}const Qo=new o0;pe.handleByList(M.MaskEffect,Qo._effectClasses);const a0={_maskEffect:null,_filterEffect:null,effects:[],addEffect(n){if(this.effects.indexOf(n)!==-1)return;this.effects.push(n),this.effects.sort((r,i)=>r.priority-i.priority);const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0),this._updateIsSimple()},removeEffect(n){const e=this.effects.indexOf(n);e!==-1&&(this.effects.splice(e,1),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateIsSimple())},set mask(n){const e=this._maskEffect;e?.mask!==n&&(e&&(this.removeEffect(e),Qo.returnMaskEffect(e),this._maskEffect=null),n!=null&&(this._maskEffect=Qo.getMaskEffect(n),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},set filters(n){!Array.isArray(n)&&n&&(n=[n]);const e=this._filterEffect||(this._filterEffect=new ps);n=n;const t=n?.length>0,r=e.filters?.length>0,i=t!==r;n=Array.isArray(n)?n.slice(0):n,e.filters=Object.freeze(n),i&&(t?this.addEffect(e):(this.removeEffect(e),e.filters=n??null))},get filters(){return this._filterEffect?.filters},set filterArea(n){this._filterEffect||(this._filterEffect=new ps),this._filterEffect.filterArea=n},get filterArea(){return this._filterEffect?.filterArea}},l0={label:null,get name(){return ie(we,"Container.name property has been removed, use Container.label instead"),this.label},set name(n){ie(we,"Container.name property has been removed, use Container.label instead"),this.label=n},getChildByName(n,e=!1){return this.getChildByLabel(n,e)},getChildByLabel(n,e=!1){const t=this.children;for(let r=0;r<t.length;r++){const i=t[r];if(i.label===n||n instanceof RegExp&&n.test(i.label))return i}if(e)for(let r=0;r<t.length;r++){const s=t[r].getChildByLabel(n,!0);if(s)return s}return null},getChildrenByLabel(n,e=!1,t=[]){const r=this.children;for(let i=0;i<r.length;i++){const s=r[i];(s.label===n||n instanceof RegExp&&n.test(s.label))&&t.push(s)}if(e)for(let i=0;i<r.length;i++)r[i].getChildrenByLabel(n,!0,t);return t}},un=new Oa(ue),cn=new Oa(vt);function Ua(n,e,t){t.clear();let r,i;return n.parent?e?r=n.parent.worldTransform:(i=un.get().identity(),r=ms(n,i)):r=ue.IDENTITY,Ch(n,t,r,e),i&&un.return(i),t.isValid||t.set(0,0,0,0),t}function Ch(n,e,t,r){if(!n.visible||!n.measurable)return;let i;r?i=n.worldTransform:(n.updateLocalTransform(),i=un.get(),i.appendFrom(n.localTransform,t));const s=e,o=!!n.effects.length;if(o&&(e=cn.get().clear()),n.boundsArea)e.addRect(n.boundsArea,i);else{n.addBounds&&(e.matrix=i,n.addBounds(e));for(let a=0;a<n.children.length;a++)Ch(n.children[a],e,i,r)}if(o){for(let a=0;a<n.effects.length;a++)n.effects[a].addBounds?.(e);s.addBounds(e,ue.IDENTITY),cn.return(e)}r||un.return(i)}function ms(n,e){const t=n.parent;return t&&(ms(t,e),t.updateLocalTransform(),e.append(t.localTransform)),e}let no=0;const tu=500;function de(...n){no!==tu&&(no++,no===tu?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...n))}function Ga(n,e,t){return e.clear(),t||(t=ue.IDENTITY),Ph(n,e,t,n,!0),e.isValid||e.set(0,0,0,0),e}function Ph(n,e,t,r,i){let s;if(i)s=un.get(),s=t.copyTo(s);else{if(!n.visible||!n.measurable)return;n.updateLocalTransform();const l=n.localTransform;s=un.get(),s.appendFrom(l,t)}const o=e,a=!!n.effects.length;if(a&&(e=cn.get().clear()),n.boundsArea)e.addRect(n.boundsArea,s);else{n.renderPipeId&&(e.matrix=s,n.addBounds(e));const l=n.children;for(let u=0;u<l.length;u++)Ph(l[u],e,s,r,!1)}if(a){for(let l=0;l<n.effects.length;l++)n.effects[l].addLocalBounds?.(e,r);o.addBounds(e,ue.IDENTITY),cn.return(e)}un.return(s)}function Ah(n,e){const t=n.children;for(let r=0;r<t.length;r++){const i=t[r],s=i.uid,o=(i._didViewChangeTick&65535)<<16|i._didContainerChangeTick&65535,a=e.index;(e.data[a]!==s||e.data[a+1]!==o)&&(e.data[e.index]=s,e.data[e.index+1]=o,e.didChange=!0),e.index=a+2,i.children.length&&Ah(i,e)}return e.didChange}const u0=new ue,c0={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(n,e){const t=Math.sign(this.scale.x)||1;e!==0?this.scale.x=n/e*t:this.scale.x=t},_setHeight(n,e){const t=Math.sign(this.scale.y)||1;e!==0?this.scale.y=n/e*t:this.scale.y=t},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new vt});const n=this._localBoundsCacheData;return n.index=1,n.didChange=!1,n.data[0]!==this._didViewChangeTick&&(n.didChange=!0,n.data[0]=this._didViewChangeTick),Ah(this,n),n.didChange&&Ga(this,n.localBounds,u0),n.localBounds},getBounds(n,e){return Ua(this,n,e||new vt)}},h0={_onRender:null,set onRender(n){const e=this.renderGroup||this.parentRenderGroup;if(!n){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=n},get onRender(){return this._onRender}},f0={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(n){this._zIndex!==n&&(this._zIndex=n,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(d0))}};function d0(n,e){return n._zIndex-e._zIndex}const p0={getGlobalPosition(n=new ke,e=!1){return this.parent?this.parent.toGlobal(this._position,n,e):(n.x=this._position.x,n.y=this._position.y),n},toGlobal(n,e,t=!1){if(!t){this.updateLocalTransform();const r=ms(this,new ue);return r.append(this.localTransform),r.apply(n,e)}return this.worldTransform.apply(n,e)},toLocal(n,e,t,r){if(e&&(n=e.toGlobal(n,t,r)),!r){this.updateLocalTransform();const i=ms(this,new ue);return i.append(this.localTransform),i.applyInverse(n,t)}return this.worldTransform.applyInverse(n,t)}};let m0=0;class Eh{constructor(){this.uid=Xe("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.tick=0}reset(){this.instructionSize=0,this.tick=m0++}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}class g0{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new ue,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Eh,this._onRenderContainers=[]}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const t=e.children;for(let r=0;r<t.length;r++)this.addChild(t[r])}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const t=this.childrenToUpdate[e];t.list.fill(null),t.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const t=this.renderGroupChildren.indexOf(e);t>-1&&this.renderGroupChildren.splice(t,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const t=e.children;for(let r=0;r<t.length;r++)this.addChild(t[r])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const t=e.children;for(let r=0;r<t.length;r++)this.removeChild(t[r])}removeChildren(e){for(let t=0;t<e.length;t++)this.removeChild(e[t])}onChildUpdate(e){let t=this.childrenToUpdate[e.relativeRenderGroupDepth];t||(t=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),t.list[t.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(e.didViewUpdate=!1,this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e))}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender()}destroy(){this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const t=this.root.children;for(let r=0;r<t.length;r++)this._getChildren(t[r],e);return e}_getChildren(e,t=[]){if(t.push(e),e.renderGroup)return t;const r=e.children;for(let i=0;i<r.length;i++)this._getChildren(r[i],t);return t}}function _0(n,e,t={}){for(const r in e)!t[r]&&e[r]!==void 0&&(n[r]=e[r])}const ro=new ut(null),io=new ut(null),so=new ut(null,1,1),gs=1,Da=2,jr=4;class Ge extends At{constructor(e={}){super(),this.uid=Xe("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new ue,this.relativeGroupTransform=new ue,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new ut(this,0,0),this._scale=so,this._pivot=io,this._skew=ro,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],_0(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(t=>this.addChild(t)),e.parent?.addChild(this)}static mixin(e){Object.defineProperties(Ge.prototype,Object.getOwnPropertyDescriptors(e))}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||ie(we,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let i=0;i<e.length;i++)this.addChild(e[i]);return e[0]}const t=e[0];if(t.parent===this)return this.children.splice(this.children.indexOf(t),1),this.children.push(t),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),t;t.parent&&t.parent.removeChild(t),this.children.push(t),this.sortableChildren&&(this.sortDirty=!0),t.parent=this,t.didChange=!0,t.didViewUpdate=!1,t._updateFlags=15;const r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(t),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this),this._didViewChangeTick++,t._zIndex!==0&&t.depthOfChildModified(),t}removeChild(...e){if(e.length>1){for(let i=0;i<e.length;i++)this.removeChild(e[i]);return e[0]}const t=e[0],r=this.children.indexOf(t);return r>-1&&(this._didViewChangeTick++,this.children.splice(r,1),this.renderGroup?this.renderGroup.removeChild(t):this.parentRenderGroup&&this.parentRenderGroup.removeChild(t),t.parent=null,this.emit("childRemoved",t,this,r),t.emit("removed",this)),t}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=Te.get(g0,this),this.groupTransform=ue.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),Te.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new ue),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*L_}set angle(e){this.rotation=e*gr}get pivot(){return this._pivot===io&&(this._pivot=new ut(this,0,0)),this._pivot}set pivot(e){this._pivot===io&&(this._pivot=new ut(this,0,0)),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===ro&&(this._skew=new ut(this,0,0)),this._skew}set skew(e){this._skew===ro&&(this._skew=new ut(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===so&&(this._scale=new ut(this,1,1)),this._scale}set scale(e){this._scale===so&&(this._scale=new ut(this,0,0)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const t=this.getLocalBounds().width;this._setWidth(e,t)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const t=this.getLocalBounds().height;this._setHeight(e,t)}getSize(e){e||(e={});const t=this.getLocalBounds();return e.width=Math.abs(this.scale.x*t.width),e.height=Math.abs(this.scale.y*t.height),e}setSize(e,t){const r=this.getLocalBounds();typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,r.width),t!==void 0&&this._setHeight(t,r.height)}_updateSkew(){const e=this._rotation,t=this._skew;this._cx=Math.cos(e+t._y),this._sx=Math.sin(e+t._y),this._cy=-Math.sin(e-t._x),this._sy=Math.cos(e-t._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const t=this.localTransform,r=this._scale,i=this._pivot,s=this._position,o=r._x,a=r._y,l=i._x,u=i._y;t.a=this._cx*o,t.b=this._sx*o,t.c=this._cy*a,t.d=this._sy*a,t.tx=s._x-(l*t.a+u*t.c),t.ty=s._y-(l*t.b+u*t.d)}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=gs,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const r=me.shared.setValue(e??16777215).toBgrNumber();r!==this.localColor&&(this.localColor=r,this._updateFlags|=gs,this._onUpdate())}get tint(){const e=this.localColor;return((e&255)<<16)+(e&65280)+(e>>16&255)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Da,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const t=e?2:0;(this.localDisplayStatus&2)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=jr,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const t=e?0:4;(this.localDisplayStatus&4)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=jr,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const t=e?1:0;(this.localDisplayStatus&1)!==t&&(this._updateFlags|=jr,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;const t=this.removeChildren(0,this.children.length);if(this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.children)for(let i=0;i<t.length;++i)t[i].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}Ge.mixin(s0);Ge.mixin(p0);Ge.mixin(h0);Ge.mixin(c0);Ge.mixin(a0);Ge.mixin(l0);Ge.mixin(f0);Ge.mixin(r0);class za extends Ge{constructor(){super(...arguments),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=0,this._lastInstructionTick=-1,this._bounds=new vt(0,1,0,0),this._boundsDirty=!0}_updateBounds(){}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const t=this.bounds,{x:r,y:i}=e;return r>=t.minX&&r<=t.maxX&&i>=t.minY&&i<=t.maxY}destroy(e){super.destroy(e),this._bounds=null}}class Jt extends za{constructor(e=se.EMPTY){e instanceof se&&(e={texture:e});const{texture:t=se.EMPTY,anchor:r,roundPixels:i,width:s,height:o,...a}=e;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._didSpriteUpdate=!1,this._sourceBounds={minX:0,maxX:1,minY:0,maxY:0},this._sourceBoundsDirty=!0,this._anchor=new ut({_onUpdate:()=>{this.onViewUpdate()}}),r?this.anchor=r:t.defaultAnchor&&(this.anchor=t.defaultAnchor),this.texture=t,this.allowChildren=!1,this.roundPixels=i??!1,s!==void 0&&(this.width=s),o!==void 0&&(this.height=o)}static from(e,t=!1){return e instanceof se?new Jt(e):new Jt(se.from(e,t))}set texture(e){e||(e=se.EMPTY);const t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get sourceBounds(){return this._sourceBoundsDirty&&(this._updateSourceBounds(),this._sourceBoundsDirty=!1),this._sourceBounds}containsPoint(e){const t=this.sourceBounds;return e.x>=t.maxX&&e.x<=t.minX&&e.y>=t.maxY&&e.y<=t.minY}addBounds(e){const t=this._texture.trim?this.sourceBounds:this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}onViewUpdate(){if(this._didViewChangeTick++,this._didSpriteUpdate=!0,this._sourceBoundsDirty=this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}_updateBounds(){ds(this._bounds,this._anchor,this._texture,0)}_updateSourceBounds(){const e=this._anchor,t=this._texture,r=this._sourceBounds,{width:i,height:s}=t.orig;r.maxX=-e._x*i,r.minX=r.maxX+i,r.maxY=-e._y*s,r.minY=r.maxY+s}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(r)}this._texture=null,this._bounds=null,this._sourceBounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),t!==void 0&&this._setHeight(t,this._texture.orig.height)}}const v0=new vt;function Mh(n,e,t){const r=v0;n.measurable=!0,Ua(n,t,r),e.addBoundsMask(r),n.measurable=!1}function kh(n,e,t){const r=cn.get();n.measurable=!0;const i=un.get().identity(),s=Rh(n,t,i);Ga(n,r,s),n.measurable=!1,e.addBoundsMask(r),un.return(i),cn.return(r)}function Rh(n,e,t){return n?(n!==e&&(Rh(n.parent,e,t),n.updateLocalTransform(),t.append(n.localTransform)),t):(de("Mask bounds, renderable is not inside the root container"),t)}class Bh{constructor(e){this.priority=0,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Jt),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(e,t){Mh(this.mask,e,t)}addLocalBounds(e,t){kh(this.mask,e,t)}containsPoint(e,t){const r=this.mask;return t(r,e)}destroy(){this.reset()}static test(e){return e instanceof Jt}}Bh.extension=M.MaskEffect;class Ih{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}Ih.extension=M.MaskEffect;class Fh{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(e,t){Mh(this.mask,e,t)}addLocalBounds(e,t){kh(this.mask,e,t)}containsPoint(e,t){const r=this.mask;return t(r,e)}destroy(){this.reset()}static test(e){return e instanceof Ge}}Fh.extension=M.MaskEffect;const b0={createCanvas:(n,e)=>{const t=document.createElement("canvas");return t.width=n,t.height=e,t},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(n,e)=>fetch(n,e),parseXML:n=>new DOMParser().parseFromString(n,"text/xml")};let nu=b0;const Se={get(){return nu},set(n){nu=n}};class yn extends Je{constructor(e){e.resource||(e.resource=Se.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity;const t=e.resource;(this.pixelWidth!==t.width||this.pixelWidth!==t.height)&&this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,t=this.height,r=this._resolution){const i=super.resize(e,t,r);return i&&this.resizeCanvas(),i}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}yn.extension=M.TextureSource;class Nn extends Je{constructor(e){if(e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){const t=Se.get().createCanvas(e.resource.width,e.resource.height);t.getContext("2d").drawImage(e.resource,0,0,e.resource.width,e.resource.height),e.resource=t,de("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}Nn.extension=M.TextureSource;var $r=(n=>(n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY",n))($r||{});class oo{constructor(e,t=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=t,this.priority=r,this._once=i}match(e,t=null){return this._fn===e&&this._context===t}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const t=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const Oh=class St{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new oo(null,null,1/0),this.deltaMS=1/St.targetFPMS,this.elapsedMS=1/St.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=$r.NORMAL){return this._addListener(new oo(e,t,r))}addOnce(e,t,r=$r.NORMAL){return this._addListener(new oo(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(!t)e.connect(r);else{for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r.match(e,t)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*St.targetFPMS;const r=this._head;let i=r.next;for(;i;)i=i.emit(this);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,St.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!St._shared){const e=St._shared=new St;e.autoStart=!0,e._protected=!0}return St._shared}static get system(){if(!St._system){const e=St._system=new St;e.autoStart=!0,e._protected=!0}return St._system}};Oh.targetFPMS=.06;let $t=Oh,ao;async function Uh(){return ao??(ao=(async()=>{const e=document.createElement("canvas").getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const t=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!t)return"premultiply-alpha-on-upload";const r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);const s=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,s),e.deleteFramebuffer(i),e.deleteTexture(r),e.getExtension("WEBGL_lose_context")?.loseContext(),s[0]<=s[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),ao}const Cs=class Gh extends Je{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...Gh.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=$t.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,t=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(t.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await Uh(),this._load=new Promise((r,i)=>{this.isValid?r(this):(this._resolve=r,this._reject=i,t.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${t.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&($t.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||($t.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&($t.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};Cs.extension=M.TextureSource;Cs.defaultOptions={...Je.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Cs.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Zi=Cs;const Lt=(n,e,t=!1)=>(Array.isArray(n)||(n=[n]),e?n.map(r=>typeof r=="string"||t?e(r):r):n);class x0{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||de(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const r=Lt(e);let i;for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];if(u.test(t)){i=u.getCacheableAssets(r,t);break}}const s=new Map(Object.entries(i||{}));i||r.forEach(l=>{s.set(l,t)});const o=[...s.keys()],a={cacheKeys:o,keys:r};r.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{const u=i?i[l]:t;this._cache.has(l)&&this._cache.get(l)!==u&&de("[Cache] already has key:",l),this._cache.set(l,s.get(l))})}remove(e){if(!this._cacheMap.has(e)){de(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(i=>{this._cache.delete(i)}),t.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const Oe=new x0,Jo=[];pe.handleByList(M.TextureSource,Jo);function Dh(n={}){const e=n&&n.resource,t=e?n.resource:n,r=e?n:{resource:n};for(let i=0;i<Jo.length;i++){const s=Jo[i];if(s.test(t))return new s(r)}throw new Error(`Could not find a source type for resource: ${r.resource}`)}function y0(n={},e=!1){const t=n&&n.resource,r=t?n.resource:n,i=t?n:{resource:n};if(!e&&Oe.has(r))return Oe.get(r);const s=new se({source:Dh(i)});return s.on("destroy",()=>{Oe.has(r)&&Oe.remove(r)}),e||Oe.set(r,s),s}function S0(n,e=!1){return typeof n=="string"?Oe.get(n):n instanceof Je?new se({source:n}):y0(n,e)}se.from=S0;Je.from=Dh;pe.add(Bh,Ih,Fh,Zi,Nn,yn,Fa);var wn=(n=>(n[n.Low=0]="Low",n[n.Normal=1]="Normal",n[n.High=2]="High",n))(wn||{});function Dt(n){if(typeof n!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(n)}`)}function Br(n){return n.split("?")[0].split("#")[0]}function w0(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function T0(n,e,t){return n.replace(new RegExp(w0(e),"g"),t)}function C0(n,e){let t="",r=0,i=-1,s=0,o=-1;for(let a=0;a<=n.length;++a){if(a<n.length)o=n.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(t.length<2||r!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",r=0):(t=t.slice(0,l),r=t.length-1-t.lastIndexOf("/")),i=a,s=0;continue}}else if(t.length===2||t.length===1){t="",r=0,i=a,s=0;continue}}}else t.length>0?t+=`/${n.slice(i+1,a)}`:t=n.slice(i+1,a),r=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return t}const Ct={toPosix(n){return T0(n,"\\","/")},isUrl(n){return/^https?:/.test(this.toPosix(n))},isDataUrl(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},isBlobUrl(n){return n.startsWith("blob:")},hasProtocol(n){return/^[^/:]+:/.test(this.toPosix(n))},getProtocol(n){Dt(n),n=this.toPosix(n);const e=/^file:\/\/\//.exec(n);if(e)return e[0];const t=/^[^/:]+:\/{0,2}/.exec(n);return t?t[0]:""},toAbsolute(n,e,t){if(Dt(n),this.isDataUrl(n)||this.isBlobUrl(n))return n;const r=Br(this.toPosix(e??Se.get().getBaseUrl())),i=Br(this.toPosix(t??this.rootname(r)));return n=this.toPosix(n),n.startsWith("/")?Ct.join(i,n.slice(1)):this.isAbsolute(n)?n:this.join(r,n)},normalize(n){if(Dt(n),n.length===0)return".";if(this.isDataUrl(n)||this.isBlobUrl(n))return n;n=this.toPosix(n);let e="";const t=n.startsWith("/");this.hasProtocol(n)&&(e=this.rootname(n),n=n.slice(e.length));const r=n.endsWith("/");return n=C0(n),n.length>0&&r&&(n+="/"),t?`/${n}`:e+n},isAbsolute(n){return Dt(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){const r=n[t];if(Dt(r),r.length>0)if(e===void 0)e=r;else{const i=n[t-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${r}`:e+=`/${r}`}}return e===void 0?".":this.normalize(e)},dirname(n){if(Dt(n),n.length===0)return".";n=this.toPosix(n);let e=n.charCodeAt(0);const t=e===47;let r=-1,i=!0;const s=this.getProtocol(n),o=n;n=n.slice(s.length);for(let a=n.length-1;a>=1;--a)if(e=n.charCodeAt(a),e===47){if(!i){r=a;break}}else i=!1;return r===-1?t?"/":this.isUrl(o)?s+n:s:t&&r===1?"//":s+n.slice(0,r)},rootname(n){Dt(n),n=this.toPosix(n);let e="";if(n.startsWith("/")?e="/":e=this.getProtocol(n),this.isUrl(n)){const t=n.indexOf("/",e.length);t!==-1?e=n.slice(0,t):e=n,e.endsWith("/")||(e+="/")}return e},basename(n,e){Dt(n),e&&Dt(e),n=Br(this.toPosix(n));let t=0,r=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e.length===n.length&&e===n)return"";let o=e.length-1,a=-1;for(s=n.length-1;s>=0;--s){const l=n.charCodeAt(s);if(l===47){if(!i){t=s+1;break}}else a===-1&&(i=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(r=s):(o=-1,r=a))}return t===r?r=a:r===-1&&(r=n.length),n.slice(t,r)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===47){if(!i){t=s+1;break}}else r===-1&&(i=!1,r=s+1);return r===-1?"":n.slice(t,r)},extname(n){Dt(n),n=Br(this.toPosix(n));let e=-1,t=0,r=-1,i=!0,s=0;for(let o=n.length-1;o>=0;--o){const a=n.charCodeAt(o);if(a===47){if(!i){t=o+1;break}continue}r===-1&&(i=!1,r=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||r===-1||s===0||s===1&&e===r-1&&e===t+1?"":n.slice(e,r)},parse(n){Dt(n);const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;n=Br(this.toPosix(n));let t=n.charCodeAt(0);const r=this.isAbsolute(n);let i;e.root=this.rootname(n),r||this.hasProtocol(n)?i=1:i=0;let s=-1,o=0,a=-1,l=!0,u=n.length-1,c=0;for(;u>=i;--u){if(t=n.charCodeAt(u),t===47){if(!l){o=u+1;break}continue}a===-1&&(l=!1,a=u+1),t===46?s===-1?s=u:c!==1&&(c=1):s!==-1&&(c=-1)}return s===-1||a===-1||c===0||c===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&r?e.base=e.name=n.slice(1,a):e.base=e.name=n.slice(o,a)):(o===0&&r?(e.name=n.slice(1,s),e.base=n.slice(1,a)):(e.name=n.slice(o,s),e.base=n.slice(o,a)),e.ext=n.slice(s,a)),e.dir=this.dirname(n),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function zh(n,e,t,r,i){const s=e[t];for(let o=0;o<s.length;o++){const a=s[o];t<e.length-1?zh(n.replace(r[t],a),e,t+1,r,i):i.push(n.replace(r[t],a))}}function P0(n){const e=/\{(.*?)\}/g,t=n.match(e),r=[];if(t){const i=[];t.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),zh(n,i,0,t,r)}else r.push(n);return r}const _s=n=>!Array.isArray(n);class Sr{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(t[r])}`).join("&")}}getAlias(e){const{alias:t,src:r}=e;return Lt(t||r,s=>typeof s=="string"?s:Array.isArray(s)?s.map(o=>o?.src??o):s?.src?s.src:s,!0)}addManifest(e){this._manifest&&de("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const r=[];let i=t;Array.isArray(t)||(i=Object.entries(t).map(([s,o])=>typeof o=="string"||Array.isArray(o)?{alias:s,src:o}:{alias:s,...o})),i.forEach(s=>{const o=s.src,a=s.alias;let l;if(typeof a=="string"){const u=this._createBundleAssetId(e,a);r.push(u),l=[a,u]}else{const u=a.map(c=>this._createBundleAssetId(e,c));r.push(...u),l=[...a,...u]}this.add({...s,alias:l,src:o})}),this._bundles[e]=r}add(e){const t=[];Array.isArray(e)?t.push(...e):t.push(e);let r;r=s=>{this.hasKey(s)&&de(`[Resolver] already has key: ${s} overwriting`)},Lt(t).forEach(s=>{const{src:o}=s;let{data:a,format:l,loadParser:u}=s;const c=Lt(o).map(f=>typeof f=="string"?P0(f):Array.isArray(f)?f:[f]),h=this.getAlias(s);Array.isArray(h)?h.forEach(r):r(h);const d=[];c.forEach(f=>{f.forEach(p=>{let g={};if(typeof p!="object"){g.src=p;for(let m=0;m<this._parsers.length;m++){const v=this._parsers[m];if(v.test(p)){g=v.parse(p);break}}}else a=p.data??a,l=p.format??l,u=p.loadParser??u,g={...g,...p};if(!h)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:h,data:a,format:l,loadParser:u}),d.push(g)})}),h.forEach(f=>{this._assetMap[f]=d})})}resolveBundle(e){const t=_s(e);e=Lt(e);const r={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const l in o){const u=o[l];a[this._extractAssetIdFromBundle(i,l)]=u}r[i]=a}}),t?r[e[0]]:r}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const r={};for(const i in t)r[i]=t[i].src;return r}return t.src}resolve(e){const t=_s(e);e=Lt(e);const r={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=this._getPreferredOrder(s);o?.priority.forEach(a=>{o.params[a].forEach(l=>{const u=s.filter(c=>c[a]?c[a]===l:!1);u.length&&(s=u)})}),this._resolverHash[i]=s[0]}else this._resolverHash[i]=this._buildResolvedAsset({alias:[i],src:i},{});r[i]=this._resolverHash[i]}),t?r[e[0]]:r}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const r=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(r.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}_buildResolvedAsset(e,t){const{aliases:r,data:i,loadParser:s,format:o}=t;return(this._basePath||this._rootPath)&&(e.src=Ct.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=r??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??A0(e.src),e}}Sr.RETINA_PREFIX=/@([0-9\.]+)x/;function A0(n){return n.split(".").pop().split("?").shift().split("#").shift()}const $o=(n,e)=>{const t=e.split("?")[1];return t&&(n+=`?${t}`),n},Lh=class zr{constructor(e,t){this.linkedSheets=[],this._texture=e instanceof se?e:null,this.textureSource=e.source,this.textures={},this.animations={},this.data=t;const r=parseFloat(t.meta.scale);r?(this.resolution=r,e.source.resolution=this.resolution):this.resolution=e.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=zr.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const r=zr.BATCH_SIZE;for(;t-e<r&&t<this._frameKeys.length;){const i=this._frameKeys[t],s=this._frames[i],o=s.frame;if(o){let a=null,l=null;const u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,c=new Re(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new Re(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Re(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new Re(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new se({source:this.textureSource,frame:a,orig:c,trim:l,rotate:s.rotated?2:0,defaultAnchor:s.anchor,defaultBorders:s.borders,label:i.toString()})}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let r=0;r<e[t].length;r++){const i=e[t][r];this.animations[t].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*zr.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*zr.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Lh.BATCH_SIZE=1e3;let ru=Lh;const E0=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Nh(n,e,t){const r={};if(n.forEach(i=>{r[i]=e}),Object.keys(e.textures).forEach(i=>{r[i]=e.textures[i]}),!t){const i=Ct.dirname(n[0]);e.linkedSheets.forEach((s,o)=>{const a=Nh([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0);Object.assign(r,a)})}return r}const M0={extension:M.Asset,cache:{test:n=>n instanceof ru,getCacheableAssets:(n,e)=>Nh(n,e,!1)},resolver:{extension:{type:M.ResolveParser,name:"resolveSpritesheet"},test:n=>{const t=n.split("?")[0].split("."),r=t.pop(),i=t.pop();return r==="json"&&E0.includes(i)},parse:n=>{const e=n.split(".");return{resolution:parseFloat(Sr.RETINA_PREFIX.exec(n)?.[1]??"1"),format:e[e.length-2],src:n}}},loader:{name:"spritesheetLoader",extension:{type:M.LoadParser,priority:wn.Normal,name:"spritesheetLoader"},async testParse(n,e){return Ct.extname(e.src).toLowerCase()===".json"&&!!n.frames},async parse(n,e,t){const{texture:r,imageFilename:i}=e?.data??{};let s=Ct.dirname(e.src);s&&s.lastIndexOf("/")!==s.length-1&&(s+="/");let o;if(r instanceof se)o=r;else{const u=$o(s+(i??n.meta.image),e.src);o=(await t.load([u]))[u]}const a=new ru(o.source,n);await a.parse();const l=n?.meta?.related_multi_packs;if(Array.isArray(l)){const u=[];for(const h of l){if(typeof h!="string")continue;let d=s+h;e.data?.ignoreMultiPack||(d=$o(d,e.src),u.push(t.load({src:d,data:{ignoreMultiPack:!0}})))}const c=await Promise.all(u);a.linkedSheets=c,c.forEach(h=>{h.linkedSheets=[a].concat(a.linkedSheets.filter(d=>d!==h))})}return a},async unload(n,e,t){await t.unload(n.textureSource._sourceOrigin),n.destroy(!1)}}};pe.add(M0);class ui{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=ui.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ke,this.page=new ke,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,r,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}var lo=/iPhone/i,iu=/iPod/i,su=/iPad/i,ou=/\biOS-universal(?:.+)Mac\b/i,uo=/\bAndroid(?:.+)Mobile\b/i,au=/Android/i,Jn=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Ii=/Silk/i,an=/Windows Phone/i,lu=/\bWindows(?:.+)ARM\b/i,uu=/BlackBerry/i,cu=/BB10/i,hu=/Opera Mini/i,fu=/\b(CriOS|Chrome)(?:.+)Mobile/i,du=/Mobile(?:.+)Firefox\b/i,pu=function(n){return typeof n<"u"&&n.platform==="MacIntel"&&typeof n.maxTouchPoints=="number"&&n.maxTouchPoints>1&&typeof MSStream>"u"};function k0(n){return function(e){return e.test(n)}}function mu(n){var e={userAgent:"",platform:"",maxTouchPoints:0};!n&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof n=="string"?e.userAgent=n:n&&n.userAgent&&(e={userAgent:n.userAgent,platform:n.platform,maxTouchPoints:n.maxTouchPoints||0});var t=e.userAgent,r=t.split("[FBAN");typeof r[1]<"u"&&(t=r[0]),r=t.split("Twitter"),typeof r[1]<"u"&&(t=r[0]);var i=k0(t),s={apple:{phone:i(lo)&&!i(an),ipod:i(iu),tablet:!i(lo)&&(i(su)||pu(e))&&!i(an),universal:i(ou),device:(i(lo)||i(iu)||i(su)||i(ou)||pu(e))&&!i(an)},amazon:{phone:i(Jn),tablet:!i(Jn)&&i(Ii),device:i(Jn)||i(Ii)},android:{phone:!i(an)&&i(Jn)||!i(an)&&i(uo),tablet:!i(an)&&!i(Jn)&&!i(uo)&&(i(Ii)||i(au)),device:!i(an)&&(i(Jn)||i(Ii)||i(uo)||i(au))||i(/\bokhttp\b/i)},windows:{phone:i(an),tablet:i(lu),device:i(an)||i(lu)},other:{blackberry:i(uu),blackberry10:i(cu),opera:i(hu),firefox:i(du),chrome:i(fu),device:i(uu)||i(cu)||i(hu)||i(du)||i(fu)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const R0=mu.default??mu,B0=R0(globalThis.navigator),I0=9,Fi=100,F0=0,O0=0,gu=2,_u=1,U0=-1e3,G0=-1e3,D0=2;class Hh{constructor(e,t=B0){this._mobileInfo=t,this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this._pool=[],this._renderId=0,this._children=[],this._androidUpdateCount=0,this._androidUpdateFrequency=500,this._hookDiv=null,(t.tablet||t.phone)&&this._createTouchHook();const r=document.createElement("div");r.style.width=`${Fi}px`,r.style.height=`${Fi}px`,r.style.position="absolute",r.style.top=`${F0}px`,r.style.left=`${O0}px`,r.style.zIndex=gu.toString(),this._div=r,this._renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}get hookDiv(){return this._hookDiv}_createTouchHook(){const e=document.createElement("button");e.style.width=`${_u}px`,e.style.height=`${_u}px`,e.style.position="absolute",e.style.top=`${U0}px`,e.style.left=`${G0}px`,e.style.zIndex=D0.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this._activate(),this._destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}_destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}_activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this._renderer.runners.postrender.add(this),this._renderer.view.canvas.parentNode?.appendChild(this._div))}_deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this._renderer.runners.postrender.remove(this),this._div.parentNode?.removeChild(this._div))}_updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this._addChild(e),e._renderId=this._renderId);const t=e.children;if(t)for(let r=0;r<t.length;r++)this._updateAccessibleObjects(t[r])}init(e){this.debug=e?.debug??this.debug,this._renderer.runners.postrender.remove(this)}postrender(){const e=performance.now();if(this._mobileInfo.android.device&&e<this._androidUpdateCount||(this._androidUpdateCount=e+this._androidUpdateFrequency,!this._renderer.renderingToScreen||!this._renderer.view.canvas))return;this._renderer.lastObjectRendered&&this._updateAccessibleObjects(this._renderer.lastObjectRendered);const{x:t,y:r,width:i,height:s}=this._renderer.view.canvas.getBoundingClientRect(),{width:o,height:a,resolution:l}=this._renderer,u=i/o*l,c=s/a*l;let h=this._div;h.style.left=`${t}px`,h.style.top=`${r}px`,h.style.width=`${o}px`,h.style.height=`${a}px`;for(let d=0;d<this._children.length;d++){const f=this._children[d];if(f._renderId!==this._renderId)f._accessibleActive=!1,Th(this._children,d,1),this._div.removeChild(f._accessibleDiv),this._pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{h=f._accessibleDiv;let p=f.hitArea;const g=f.worldTransform;f.hitArea?(h.style.left=`${(g.tx+p.x*g.a)*u}px`,h.style.top=`${(g.ty+p.y*g.d)*c}px`,h.style.width=`${p.width*g.a*u}px`,h.style.height=`${p.height*g.d*c}px`):(p=f.getBounds().rectangle,this._capHitArea(p),h.style.left=`${p.x*u}px`,h.style.top=`${p.y*c}px`,h.style.width=`${p.width*u}px`,h.style.height=`${p.height*c}px`,h.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(h.title=f.accessibleTitle||""),h.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&h.setAttribute("aria-label",f.accessibleHint||"")),(f.accessibleTitle!==h.title||f.tabIndex!==h.tabIndex)&&(h.title=f.accessibleTitle||"",h.tabIndex=f.tabIndex,this.debug&&this._updateDebugHTML(h))}}this._renderId++}_updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}_capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:t,height:r}=this._renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>r&&(e.height=r-e.y)}_addChild(e){let t=this._pool.pop();t||(t=document.createElement("button"),t.style.width=`${Fi}px`,t.style.height=`${Fi}px`,t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=gu.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title=`container ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this._updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.container=e,this._children.push(e),this._div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){const{container:r}=e.target,i=this._renderer.events.rootBoundary,s=Object.assign(new ui(i),{target:r});i.rootTarget=this._renderer.lastObjectRendered,t.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===I0&&this._activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this._deactivate()}destroy(){this._destroyTouchHook(),this._div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this._pool=null,this._children=null,this._renderer=null}}Hh.extension={type:[M.WebGLSystem,M.WebGPUSystem],name:"accessibility"};const z0={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,_renderId:-1},co=Object.create(null),vu=Object.create(null);function ei(n,e){let t=vu[n];return t===void 0&&(co[e]===void 0&&(co[e]=1),vu[n]=t=co[e]++),t}let Oi;function Vh(){return(!Oi||Oi?.isContextLost())&&(Oi=Se.get().createCanvas().getContext("webgl",{})),Oi}let Ui;function L0(){if(!Ui){Ui="mediump";const n=Vh();n&&n.getShaderPrecisionFormat&&(Ui=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision?"highp":"mediump")}return Ui}function N0(n,e,t){return e?n:t?(n=n.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${n}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${n}
        `}function H0(n,e,t){const r=t?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(n.substring(0,9)!=="precision"){let i=t?e.requestedFragmentPrecision:e.requestedVertexPrecision;return i==="highp"&&r!=="highp"&&(i="mediump"),`precision ${i} float;
${n}`}else if(r!=="highp"&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}function V0(n,e){return e?`#version 300 es
${n}`:n}const W0={},j0={};function X0(n,{name:e="pixi-program"},t=!0){e=e.replace(/\s+/g,"-"),e+=t?"-fragment":"-vertex";const r=t?W0:j0;return r[e]?(r[e]++,e+=`-${r[e]}`):r[e]=1,n.indexOf("#define SHADER_NAME")!==-1?n:`${`#define SHADER_NAME ${e}`}
${n}`}function q0(n,e){return e?n.replace("#version 300 es",""):n}const ho={stripVersion:q0,ensurePrecision:H0,addProgramDefines:N0,setProgramName:X0,insertVersion:V0},fo=Object.create(null),Wh=class ea{constructor(e){e={...ea.defaultOptions,...e};const t=e.fragment.indexOf("#version 300 es")!==-1,r={stripVersion:t,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:L0()},setProgramName:{name:e.name},addProgramDefines:t,insertVersion:t};let i=e.fragment,s=e.vertex;Object.keys(ho).forEach(o=>{const a=r[o];i=ho[o](i,a,!0),s=ho[o](s,a,!1)}),this.fragment=i,this.vertex=s,this._key=ei(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(e){const t=`${e.vertex}:${e.fragment}`;return fo[t]||(fo[t]=new ea(e)),fo[t]}};Wh.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let _e=Wh;const bu={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function ti(n){return bu[n]??bu.float32}const Y0={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function K0({source:n,entryPoint:e}){const t={},r=n.indexOf(`fn ${e}`);if(r!==-1){const i=n.indexOf("->",r);if(i!==-1){const s=n.substring(r,i),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(s))!==null;){const l=Y0[a[3]]??"float32";t[a[2]]={location:parseInt(a[1],10),format:l,stride:ti(l).stride,offset:0,instance:!1,start:0}}}}return t}function po(n){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,t=/@group\((\d+)\)/,r=/@binding\((\d+)\)/,i=/var(<[^>]+>)? (\w+)/,s=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,u=n.match(e)?.map(h=>({group:parseInt(h.match(t)[1],10),binding:parseInt(h.match(r)[1],10),name:h.match(i)[2],isUniform:h.match(i)[1]==="<uniform>",type:h.match(s)[1]}));if(!u)return{groups:[],structs:[]};const c=n.match(o)?.map(h=>{const d=h.match(l)[1],f=h.match(a).reduce((p,g)=>{const[m,v]=g.split(":");return p[m.trim()]=v.trim(),p},{});return f?{name:d,members:f}:null}).filter(({name:h})=>u.some(d=>d.type===h))??[];return{groups:u,structs:c}}var Lr=(n=>(n[n.VERTEX=1]="VERTEX",n[n.FRAGMENT=2]="FRAGMENT",n[n.COMPUTE=4]="COMPUTE",n))(Lr||{});function Z0({groups:n}){const e=[];for(let t=0;t<n.length;t++){const r=n[t];e[r.group]||(e[r.group]=[]),r.isUniform?e[r.group].push({binding:r.binding,visibility:Lr.VERTEX|Lr.FRAGMENT,buffer:{type:"uniform"}}):r.type==="sampler"?e[r.group].push({binding:r.binding,visibility:Lr.FRAGMENT,sampler:{type:"filtering"}}):r.type==="texture_2d"&&e[r.group].push({binding:r.binding,visibility:Lr.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function Q0({groups:n}){const e=[];for(let t=0;t<n.length;t++){const r=n[t];e[r.group]||(e[r.group]={}),e[r.group][r.name]=r.binding}return e}function J0(n,e){const t=new Set,r=new Set,i=[...n.structs,...e.structs].filter(o=>t.has(o.name)?!1:(t.add(o.name),!0)),s=[...n.groups,...e.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return r.has(a)?!1:(r.add(a),!0)});return{structs:i,groups:s}}const mo=Object.create(null);class ge{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:t,vertex:r,layout:i,gpuLayout:s,name:o}=e;if(this.name=o,this.fragment=t,this.vertex=r,t.source===r.source){const a=po(t.source);this.structsAndGroups=a}else{const a=po(r.source),l=po(t.source);this.structsAndGroups=J0(a,l)}this.layout=i??Q0(this.structsAndGroups),this.gpuLayout=s??Z0(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:t}=this,r=e.source+t.source+e.entryPoint+t.entryPoint;this._layoutKey=ei(r,"program")}get attributeData(){return this._attributeData??(this._attributeData=K0(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(e){const t=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return mo[t]||(mo[t]=new ge(e)),mo[t]}}const jh=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>"],$0=jh.reduce((n,e)=>(n[e]=!0,n),{});function ev(n,e){switch(n){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Xh=class qh{constructor(e,t){this._touched=0,this.uid=Xe("uniform"),this._resourceType="uniformGroup",this._resourceId=Xe("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,t={...qh.defaultOptions,...t},this.uniformStructures=e;const r={};for(const i in e){const s=e[i];if(s.name=i,s.size=s.size??1,!$0[s.type])throw new Error(`Uniform type ${s.type} is not supported. Supported uniform types are: ${jh.join(", ")}`);s.value??(s.value=ev(s.type,s.size)),r[i]=s.value}this.uniforms=r,this._dirtyId=1,this.ubo=t.ubo,this.isStatic=t.isStatic,this._signature=ei(Object.keys(r).map(i=>`${i}-${e[i].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Xh.defaultOptions={ubo:!1,isStatic:!1};let gt=Xh;class hn{constructor(e){this.resources=Object.create(null),this._dirty=!0;let t=0;for(const r in e){const i=e[r];this.setResource(i,t++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let t=0;for(const r in this.resources)e[t++]=this.resources[r]._resourceId;this._key=e.join("|")}setResource(e,t){const r=this.resources[t];e!==r&&(r&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[t]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const t=this.resources;for(const r in t)t[r]._touched=e}destroy(){const e=this.resources;for(const t in e)e[t].off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const t=this.resources;for(const r in t)t[r]===e&&(t[r]=null)}else this._updateKey()}}var Pt=(n=>(n[n.WEBGL=1]="WEBGL",n[n.WEBGPU=2]="WEBGPU",n[n.BOTH=3]="BOTH",n))(Pt||{});class Wt extends At{constructor(e){super(),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:t,glProgram:r,groups:i,resources:s,compatibleRenderers:o,groupMap:a}=e;this.gpuProgram=t,this.glProgram=r,o===void 0&&(o=0,t&&(o|=Pt.WEBGPU),r&&(o|=Pt.WEBGL)),this.compatibleRenderers=o;const l={};if(!s&&!i&&(s={}),s&&i)throw new Error("[Shader] Cannot have both resources and groups");if(!t&&i&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!t&&i&&a)for(const u in a)for(const c in a[u]){const h=a[u][c];l[h]={group:u,binding:c,name:h}}else if(t&&i&&!a){const u=t.structsAndGroups.groups;a={},u.forEach(c=>{a[c.group]=a[c.group]||{},a[c.group][c.binding]=c.name,l[c.name]=c})}else if(s){i={},a={},t&&t.structsAndGroups.groups.forEach(h=>{a[h.group]=a[h.group]||{},a[h.group][h.binding]=h.name,l[h.name]=h});let u=0;for(const c in s)l[c]||(i[99]||(i[99]=new hn,this._ownedBindGroups.push(i[99])),l[c]={group:99,binding:u,name:c},a[99]=a[99]||{},a[99][u]=c,u++);for(const c in s){const h=c;let d=s[c];!d.source&&!d._resourceType&&(d=new gt(d));const f=l[h];f&&(i[f.group]||(i[f.group]=new hn,this._ownedBindGroups.push(i[f.group])),i[f.group].setResource(d,f.binding))}}this.groups=i,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(i,l)}addResource(e,t,r){var i,s;(i=this._uniformBindMap)[t]||(i[t]={}),(s=this._uniformBindMap[t])[r]||(s[r]=e),this.groups[t]||(this.groups[t]=new hn,this._ownedBindGroups.push(this.groups[t]))}_buildResourceAccessor(e,t){const r={};for(const i in t){const s=t[i];Object.defineProperty(r,s.name,{get(){return e[s.group].getResource(s.binding)},set(o){e[s.group].setResource(o,s.binding)}})}return r}destroy(e=!1){this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(t=>{t.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(e){const{gpu:t,gl:r,...i}=e;let s,o;return t&&(s=ge.from(t)),r&&(o=_e.from(r)),new Wt({gpuProgram:s,glProgram:o,...i})}}const tv={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},go=0,_o=1,vo=2,bo=3,xo=4,yo=5,ta=class Yh{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<go)}set blend(e){!!(this.data&1<<go)!==e&&(this.data^=1<<go)}get offsets(){return!!(this.data&1<<_o)}set offsets(e){!!(this.data&1<<_o)!==e&&(this.data^=1<<_o)}set cullMode(e){if(e==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=e==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<vo)}set culling(e){!!(this.data&1<<vo)!==e&&(this.data^=1<<vo)}get depthTest(){return!!(this.data&1<<bo)}set depthTest(e){!!(this.data&1<<bo)!==e&&(this.data^=1<<bo)}get depthMask(){return!!(this.data&1<<yo)}set depthMask(e){!!(this.data&1<<yo)!==e&&(this.data^=1<<yo)}get clockwiseFrontFace(){return!!(this.data&1<<xo)}set clockwiseFrontFace(e){!!(this.data&1<<xo)!==e&&(this.data^=1<<xo)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!=="none",this._blendMode=e,this._blendModeId=tv[e]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new Yh;return e.depthTest=!1,e.blend=!0,e}};ta.default2d=ta.for2d();let pn=ta;const Kh=class na extends Wt{constructor(e){e={...na.defaultOptions,...e},super(e),this.enabled=!0,this._state=pn.for2d(),this.blendMode=e.blendMode,this.padding=e.padding,typeof e.antialias=="boolean"?this.antialias=e.antialias?"on":"off":this.antialias=e.antialias,this.resolution=e.resolution,this.blendRequired=e.blendRequired,this.addResource("uTexture",0,1)}apply(e,t,r,i){e.applyFilter(this,t,r,i)}get blendMode(){return this._state.blendMode}set blendMode(e){this._state.blendMode=e}static from(e){const{gpu:t,gl:r,...i}=e;let s,o;return t&&(s=ge.from(t)),r&&(o=_e.from(r)),new na({gpuProgram:s,glProgram:o,...i})}};Kh.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1};let xe=Kh;const ra=[];pe.handleByNamedList(M.Environment,ra);async function nv(n){if(!n)for(let e=0;e<ra.length;e++){const t=ra[e];if(t.value.test()){await t.value.load();return}}}let Ir;function Zh(){if(typeof Ir=="boolean")return Ir;try{Ir=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Ir=!1}return Ir}var La={exports:{}};La.exports=Ps;La.exports.default=Ps;function Ps(n,e,t){t=t||2;var r=e&&e.length,i=r?e[0]*t:n.length,s=Qh(n,0,i,t,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,u,c,h,d,f;if(r&&(s=av(n,e,s,t)),n.length>80*t){a=u=n[0],l=c=n[1];for(var p=t;p<i;p+=t)h=n[p],d=n[p+1],h<a&&(a=h),d<l&&(l=d),h>u&&(u=h),d>c&&(c=d);f=Math.max(u-a,c-l),f=f!==0?32767/f:0}return ni(s,o,t,a,l,f,0),o}function Qh(n,e,t,r,i){var s,o;if(i===oa(n,e,t,r)>0)for(s=e;s<t;s+=r)o=xu(s,n[s],n[s+1],o);else for(s=t-r;s>=e;s-=r)o=xu(s,n[s],n[s+1],o);return o&&As(o,o.next)&&(ii(o),o=o.next),o}function Ln(n,e){if(!n)return n;e||(e=n);var t=n,r;do if(r=!1,!t.steiner&&(As(t,t.next)||je(t.prev,t,t.next)===0)){if(ii(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function ni(n,e,t,r,i,s,o){if(n){!o&&s&&fv(n,r,i,s);for(var a=n,l,u;n.prev!==n.next;){if(l=n.prev,u=n.next,s?iv(n,r,i,s):rv(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),ii(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=sv(Ln(n),e,t),ni(n,e,t,r,i,s,2)):o===2&&ov(n,e,t,r,i,s):ni(Ln(n),e,t,r,i,s,1);break}}}}function rv(n){var e=n.prev,t=n,r=n.next;if(je(e,t,r)>=0)return!1;for(var i=e.x,s=t.x,o=r.x,a=e.y,l=t.y,u=r.y,c=i<s?i<o?i:o:s<o?s:o,h=a<l?a<u?a:u:l<u?l:u,d=i>s?i>o?i:o:s>o?s:o,f=a>l?a>u?a:u:l>u?l:u,p=r.next;p!==e;){if(p.x>=c&&p.x<=d&&p.y>=h&&p.y<=f&&ar(i,a,s,l,o,u,p.x,p.y)&&je(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function iv(n,e,t,r){var i=n.prev,s=n,o=n.next;if(je(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,u=o.x,c=i.y,h=s.y,d=o.y,f=a<l?a<u?a:u:l<u?l:u,p=c<h?c<d?c:d:h<d?h:d,g=a>l?a>u?a:u:l>u?l:u,m=c>h?c>d?c:d:h>d?h:d,v=ia(f,p,e,t,r),x=ia(g,m,e,t,r),S=n.prevZ,y=n.nextZ;S&&S.z>=v&&y&&y.z<=x;){if(S.x>=f&&S.x<=g&&S.y>=p&&S.y<=m&&S!==i&&S!==o&&ar(a,c,l,h,u,d,S.x,S.y)&&je(S.prev,S,S.next)>=0||(S=S.prevZ,y.x>=f&&y.x<=g&&y.y>=p&&y.y<=m&&y!==i&&y!==o&&ar(a,c,l,h,u,d,y.x,y.y)&&je(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;S&&S.z>=v;){if(S.x>=f&&S.x<=g&&S.y>=p&&S.y<=m&&S!==i&&S!==o&&ar(a,c,l,h,u,d,S.x,S.y)&&je(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;y&&y.z<=x;){if(y.x>=f&&y.x<=g&&y.y>=p&&y.y<=m&&y!==i&&y!==o&&ar(a,c,l,h,u,d,y.x,y.y)&&je(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function sv(n,e,t){var r=n;do{var i=r.prev,s=r.next.next;!As(i,s)&&Jh(i,r,r.next,s)&&ri(i,s)&&ri(s,i)&&(e.push(i.i/t|0),e.push(r.i/t|0),e.push(s.i/t|0),ii(r),ii(r.next),r=n=s),r=r.next}while(r!==n);return Ln(r)}function ov(n,e,t,r,i,s){var o=n;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&mv(o,a)){var l=$h(o,a);o=Ln(o,o.next),l=Ln(l,l.next),ni(o,e,t,r,i,s,0),ni(l,e,t,r,i,s,0);return}a=a.next}o=o.next}while(o!==n)}function av(n,e,t,r){var i=[],s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:n.length,u=Qh(n,a,l,r,!1),u===u.next&&(u.steiner=!0),i.push(pv(u));for(i.sort(lv),s=0;s<i.length;s++)t=uv(i[s],t);return t}function lv(n,e){return n.x-e.x}function uv(n,e){var t=cv(n,e);if(!t)return e;var r=$h(t,n);return Ln(r,r.next),Ln(t,t.next)}function cv(n,e){var t=e,r=n.x,i=n.y,s=-1/0,o;do{if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){var a=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=r&&a>s&&(s=a,o=t.x<t.next.x?t:t.next,a===r))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,u=o.x,c=o.y,h=1/0,d;t=o;do r>=t.x&&t.x>=u&&r!==t.x&&ar(i<c?r:s,i,u,c,i<c?s:r,i,t.x,t.y)&&(d=Math.abs(i-t.y)/(r-t.x),ri(t,n)&&(d<h||d===h&&(t.x>o.x||t.x===o.x&&hv(o,t)))&&(o=t,h=d)),t=t.next;while(t!==l);return o}function hv(n,e){return je(n.prev,n,e.prev)<0&&je(e.next,n,n.next)<0}function fv(n,e,t,r){var i=n;do i.z===0&&(i.z=ia(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,dv(i)}function dv(n){var e,t,r,i,s,o,a,l,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,r=t,a=0,e=0;e<u&&(a++,r=r.nextZ,!!r);e++);for(l=u;a>0||l>0&&r;)a!==0&&(l===0||!r||t.z<=r.z)?(i=t,t=t.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;t=r}s.nextZ=null,u*=2}while(o>1);return n}function ia(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function pv(n){var e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function ar(n,e,t,r,i,s,o,a){return(i-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(r-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(i-o)*(r-a)}function mv(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!gv(n,e)&&(ri(n,e)&&ri(e,n)&&_v(n,e)&&(je(n.prev,n,e.prev)||je(n,e.prev,e))||As(n,e)&&je(n.prev,n,n.next)>0&&je(e.prev,e,e.next)>0)}function je(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function As(n,e){return n.x===e.x&&n.y===e.y}function Jh(n,e,t,r){var i=Di(je(n,e,t)),s=Di(je(n,e,r)),o=Di(je(t,r,n)),a=Di(je(t,r,e));return!!(i!==s&&o!==a||i===0&&Gi(n,t,e)||s===0&&Gi(n,r,e)||o===0&&Gi(t,n,r)||a===0&&Gi(t,e,r))}function Gi(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Di(n){return n>0?1:n<0?-1:0}function gv(n,e){var t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&Jh(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function ri(n,e){return je(n.prev,n,n.next)<0?je(n,e,n.next)>=0&&je(n,n.prev,e)>=0:je(n,e,n.prev)<0||je(n,n.next,e)<0}function _v(n,e){var t=n,r=!1,i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function $h(n,e){var t=new sa(n.i,n.x,n.y),r=new sa(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function xu(n,e,t,r){var i=new sa(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ii(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function sa(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ps.deviation=function(n,e,t,r){var i=e&&e.length,s=i?e[0]*t:n.length,o=Math.abs(oa(n,0,s,t));if(i)for(var a=0,l=e.length;a<l;a++){var u=e[a]*t,c=a<l-1?e[a+1]*t:n.length;o-=Math.abs(oa(n,u,c,t))}var h=0;for(a=0;a<r.length;a+=3){var d=r[a]*t,f=r[a+1]*t,p=r[a+2]*t;h+=Math.abs((n[d]-n[p])*(n[f+1]-n[d+1])-(n[d]-n[f])*(n[p+1]-n[d+1]))}return o===0&&h===0?0:Math.abs((h-o)/o)};function oa(n,e,t,r){for(var i=0,s=e,o=t-r;s<t;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}Ps.flatten=function(n){for(var e=n[0][0].length,t={vertices:[],holes:[],dimensions:e},r=0,i=0;i<n.length;i++){for(var s=0;s<n[i].length;s++)for(var o=0;o<e;o++)t.vertices.push(n[i][s][o]);i>0&&(r+=n[i-1].length,t.holes.push(r))}return t};var vv=La.exports;const bv=Ia(vv);var Tt=(n=>(n[n.NONE=0]="NONE",n[n.COLOR=16384]="COLOR",n[n.STENCIL=1024]="STENCIL",n[n.DEPTH=256]="DEPTH",n[n.COLOR_DEPTH=16640]="COLOR_DEPTH",n[n.COLOR_STENCIL=17408]="COLOR_STENCIL",n[n.DEPTH_STENCIL=1280]="DEPTH_STENCIL",n[n.ALL=17664]="ALL",n))(Tt||{});class ef{constructor(e){this.items=[],this._name=e}emit(e,t,r,i,s,o,a,l){const{name:u,items:c}=this;for(let h=0,d=c.length;h<d;h++)c[h][u](e,t,r,i,s,o,a,l);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&this.items.splice(t,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const xv=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],tf=class nf extends At{constructor(e){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const t=[...xv,...this.config.runners??[]];this._addRunners(...t),this._unsafeEvalCheck()}async init(e={}){const t=e.skipExtensionImports===!0?!0:e.manageImports===!1;await nv(t),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const r in this._systemsHash)e={...this._systemsHash[r].constructor.defaultOptions,...e};e={...nf.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let r=0;r<this.runners.init.items.length;r++)await this.runners.init.items[r].init(e);this._initOptions=e}render(e,t){let r=e;if(r instanceof Ge&&(r={container:r},t&&(ie(we,"passing a second argument is deprecated, please use render options instead"),r.target=t.renderTexture)),r.target||(r.target=this.view.renderTarget),r.target===this.view.renderTarget&&(this._lastObjectRendered=r.container,r.clearColor=this.background.colorRgba),r.clearColor){const i=Array.isArray(r.clearColor)&&r.clearColor.length===4;r.clearColor=i?r.clearColor:me.shared.setValue(r.clearColor).toArray()}r.transform||(r.container.updateLocalTransform(),r.transform=r.container.localTransform),this.runners.prerender.emit(r),this.runners.renderStart.emit(r),this.runners.render.emit(r),this.runners.renderEnd.emit(r),this.runners.postrender.emit(r)}resize(e,t,r){const i=this.view.resolution;this.view.resize(e,t,r),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),r!==void 0&&r!==i&&this.runners.resolutionChange.emit(r)}clear(e={}){const t=this;e.target||(e.target=t.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=Tt.ALL);const{clear:r,clearColor:i,target:s}=e;me.shared.setValue(i??this.background.colorRgba),t.renderTarget.clear(s,r,me.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(t=>{this.runners[t]=new ef(t)})}_addSystems(e){let t;for(t in e){const r=e[t];this._addSystem(r.value,r.name)}}_addSystem(e,t){const r=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=r,this._systemsHash[t]=r;for(const i in this.runners)this.runners[i].add(r);return this}_addPipes(e,t){const r=t.reduce((i,s)=>(i[s.name]=s.value,i),{});e.forEach(i=>{const s=i.value,o=i.name,a=r[o];this.renderPipes[o]=new s(this,a?new a:null)})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Zh())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};tf.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Es=tf,zi;function yv(n){return zi!==void 0||(zi=(()=>{const e={stencil:!0,failIfMajorPerformanceCaveat:n??Es.defaultOptions.failIfMajorPerformanceCaveat};try{if(!Se.get().getWebGLRenderingContext())return!1;let r=Se.get().createCanvas().getContext("webgl",e);const i=!!r?.getContextAttributes()?.stencil;if(r){const s=r.getExtension("WEBGL_lose_context");s&&s.loseContext()}return r=null,i}catch{return!1}})()),zi}let Li;async function Sv(n={}){return Li!==void 0||(Li=await(async()=>{const e=Se.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(n)).requestDevice(),!0}catch{return!1}})()),Li}const yu=["webgl","webgpu","canvas"];async function wv(n){let e=[];n.preference?(e.push(n.preference),yu.forEach(s=>{s!==n.preference&&e.push(s)})):e=yu.slice();let t,r={};for(let s=0;s<e.length;s++){const o=e[s];if(o==="webgpu"&&await Sv()){const{WebGPURenderer:a}=await fs(async()=>{const{WebGPURenderer:l}=await Promise.resolve().then(()=>c2);return{WebGPURenderer:l}},void 0,import.meta.url);t=a,r={...n,...n.webgpu};break}else if(o==="webgl"&&yv(n.failIfMajorPerformanceCaveat??Es.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await fs(async()=>{const{WebGLRenderer:l}=await Promise.resolve().then(()=>jy);return{WebGLRenderer:l}},void 0,import.meta.url);t=a,r={...n,...n.webgl};break}else if(o==="canvas")throw r={...n},new Error("CanvasRenderer is not yet implemented")}if(delete r.webgpu,delete r.webgl,!t)throw new Error("No available renderer for the current environment");const i=new t;return await i.init(r),i}const vs="8.4.1";class rf{static init(){globalThis.__PIXI_APP_INIT__?.(this,vs)}static destroy(){}}rf.extension=M.Application;class sf{constructor(e){this._renderer=e}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,vs)}destroy(){this._renderer=null}}sf.extension={type:[M.WebGLSystem,M.WebGPUSystem],name:"initHook",priority:-10};const of=class aa{constructor(...e){this.stage=new Ge,e[0]!==void 0&&ie(we,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.renderer=await wv(e),aa._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return ie(we,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,t=!1){const r=aa._plugins.slice(0);r.reverse(),r.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};of._plugins=[];let af=of;pe.handleByList(M.Application,af._plugins);pe.add(rf);class lf{static init(e){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let t,r;if(this._resizeTo===globalThis.window)t=globalThis.innerWidth,r=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;t=i,r=s}this.renderer.resize(t,r),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}lf.extension=M.Application;class uf{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,$r.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?$t.shared:new $t,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}uf.extension=M.Application;class cf extends At{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return ie(we,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return ie(we,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return ie(we,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return ie(we,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return ie(we,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const t in this.chars)this.chars[t].texture?.destroy();this.chars=null,e&&(this.pages.forEach(t=>t.texture.destroy(!0)),this.pages=null)}}const hf=class la{constructor(e,t,r,i){this.uid=Xe("fillGradient"),this.type="linear",this.gradientStops=[],this._styleKey=null,this.x0=e,this.y0=t,this.x1=r,this.y1=i}addColorStop(e,t){return this.gradientStops.push({offset:e,color:me.shared.setValue(t).toHexa()}),this._styleKey=null,this}buildLinearGradient(){const e=la.defaultTextureSize,{gradientStops:t}=this,r=Se.get().createCanvas();r.width=e,r.height=e;const i=r.getContext("2d"),s=i.createLinearGradient(0,0,la.defaultTextureSize,1);for(let g=0;g<t.length;g++){const m=t[g];s.addColorStop(m.offset,m.color)}i.fillStyle=s,i.fillRect(0,0,e,e),this.texture=new se({source:new Nn({resource:r,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:o,y0:a,x1:l,y1:u}=this,c=new ue,h=l-o,d=u-a,f=Math.sqrt(h*h+d*d),p=Math.atan2(d,h);c.translate(-o,-a),c.scale(1/e,1/e),c.rotate(-p),c.scale(256/f,1),this.transform=c,this._styleKey=null}get styleKey(){if(this._styleKey)return this._styleKey;const e=this.gradientStops.map(i=>`${i.offset}-${i.color}`).join("-"),t=this.texture.uid,r=this.transform.toArray().join("-");return`fill-gradient-${this.uid}-${e}-${t}-${r}-${this.x0}-${this.y0}-${this.x1}-${this.y1}`}};hf.defaultTextureSize=256;let si=hf;const Su={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class Ms{constructor(e,t){this.uid=Xe("fillPattern"),this.transform=new ue,this._styleKey=null,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),t&&(e.source.style.addressModeU=Su[t].addressModeU,e.source.style.addressModeV=Su[t].addressModeV)}setTransform(e){const t=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/t.frame.width,1/t.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var Tv=Pv,So={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},Cv=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function Pv(n){var e=[];return n.replace(Cv,function(t,r,i){var s=r.toLowerCase();for(i=Ev(i),s=="m"&&i.length>2&&(e.push([r].concat(i.splice(0,2))),s="l",r=r=="m"?"l":"L");;){if(i.length==So[s])return i.unshift(r),e.push(i);if(i.length<So[s])throw new Error("malformed path data");e.push([r].concat(i.splice(0,So[s])))}}),e}var Av=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function Ev(n){var e=n.match(Av);return e?e.map(Number):[]}const Mv=Ia(Tv);function kv(n,e){const t=Mv(n),r=[];let i=null,s=0,o=0;for(let a=0;a<t.length;a++){const l=t[a],u=l[0],c=l;switch(u){case"M":s=c[1],o=c[2],e.moveTo(s,o);break;case"m":s+=c[1],o+=c[2],e.moveTo(s,o);break;case"H":s=c[1],e.lineTo(s,o);break;case"h":s+=c[1],e.lineTo(s,o);break;case"V":o=c[1],e.lineTo(s,o);break;case"v":o+=c[1],e.lineTo(s,o);break;case"L":s=c[1],o=c[2],e.lineTo(s,o);break;case"l":s+=c[1],o+=c[2],e.lineTo(s,o);break;case"C":s=c[5],o=c[6],e.bezierCurveTo(c[1],c[2],c[3],c[4],s,o);break;case"c":e.bezierCurveTo(s+c[1],o+c[2],s+c[3],o+c[4],s+c[5],o+c[6]),s+=c[5],o+=c[6];break;case"S":s=c[3],o=c[4],e.bezierCurveToShort(c[1],c[2],s,o);break;case"s":e.bezierCurveToShort(s+c[1],o+c[2],s+c[3],o+c[4]),s+=c[3],o+=c[4];break;case"Q":s=c[3],o=c[4],e.quadraticCurveTo(c[1],c[2],s,o);break;case"q":e.quadraticCurveTo(s+c[1],o+c[2],s+c[3],o+c[4]),s+=c[3],o+=c[4];break;case"T":s=c[1],o=c[2],e.quadraticCurveToShort(s,o);break;case"t":s+=c[1],o+=c[2],e.quadraticCurveToShort(s,o);break;case"A":s=c[6],o=c[7],e.arcToSvg(c[1],c[2],c[3],c[4],c[5],s,o);break;case"a":s+=c[6],o+=c[7],e.arcToSvg(c[1],c[2],c[3],c[4],c[5],s,o);break;case"Z":case"z":e.closePath(),r.length>0&&(i=r.pop(),i?(s=i.startX,o=i.startY):(s=0,o=0)),i=null;break;default:de(`Unknown SVG path command: ${u}`)}u!=="Z"&&u!=="z"&&i===null&&(i={startX:s,startY:o},r.push(i))}return e}class Na{constructor(e=0,t=0,r=0){this.type="circle",this.x=e,this.y=t,this.radius=r}clone(){return new Na(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const r=this.radius*this.radius;let i=this.x-e,s=this.y-t;return i*=i,s*=s,i+s<=r}strokeContains(e,t,r){if(this.radius===0)return!1;const i=this.x-e,s=this.y-t,o=this.radius,a=r/2,l=Math.sqrt(i*i+s*s);return l<o+a&&l>o-a}getBounds(e){return e=e||new Re,e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ha{constructor(e=0,t=0,r=0,i=0){this.type="ellipse",this.x=e,this.y=t,this.halfWidth=r,this.halfHeight=i}clone(){return new Ha(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,t){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let r=(e-this.x)/this.halfWidth,i=(t-this.y)/this.halfHeight;return r*=r,i*=i,r+i<=1}strokeContains(e,t,r){const{halfWidth:i,halfHeight:s}=this;if(i<=0||s<=0)return!1;const o=r/2,a=i-o,l=s-o,u=i+o,c=s+o,h=e-this.x,d=t-this.y,f=h*h/(a*a)+d*d/(l*l),p=h*h/(u*u)+d*d/(c*c);return f>1&&p<=1}getBounds(e){return e=e||new Re,e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function Rv(n,e,t,r,i,s){const o=n-t,a=e-r,l=i-t,u=s-r,c=o*l+a*u,h=l*l+u*u;let d=-1;h!==0&&(d=c/h);let f,p;d<0?(f=t,p=r):d>1?(f=i,p=s):(f=t+d*l,p=r+d*u);const g=n-f,m=e-p;return g*g+m*m}class Xr{constructor(...e){this.type="polygon";let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const r=[];for(let i=0,s=t.length;i<s;i++)r.push(t[i].x,t[i].y);t=r}this.points=t,this.closePath=!0}clone(){const e=this.points.slice(),t=new Xr(e);return t.closePath=this.closePath,t}contains(e,t){let r=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[s*2],l=this.points[s*2+1],u=this.points[o*2],c=this.points[o*2+1];l>t!=c>t&&e<(u-a)*((t-l)/(c-l))+a&&(r=!r)}return r}strokeContains(e,t,r){const i=r/2,s=i*i,{points:o}=this,a=o.length-(this.closePath?0:2);for(let l=0;l<a;l+=2){const u=o[l],c=o[l+1],h=o[(l+2)%o.length],d=o[(l+3)%o.length];if(Rv(e,t,u,c,h,d)<=s)return!0}return!1}getBounds(e){e=e||new Re;const t=this.points;let r=1/0,i=-1/0,s=1/0,o=-1/0;for(let a=0,l=t.length;a<l;a+=2){const u=t[a],c=t[a+1];r=u<r?u:r,i=u>i?u:i,s=c<s?c:s,o=c>o?c:o}return e.x=r,e.width=i-r,e.y=s,e.height=o-s,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,t)=>`${e}, ${t}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Ni=(n,e,t,r,i,s)=>{const o=n-t,a=e-r,l=Math.sqrt(o*o+a*a);return l>=i-s&&l<=i+s};class Va{constructor(e=0,t=0,r=0,i=0,s=20){this.type="roundedRectangle",this.x=e,this.y=t,this.width=r,this.height=i,this.radius=s}getBounds(e){return e=e||new Re,e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new Va(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+r&&t<=this.y+this.height-r||e>=this.x+r&&e<=this.x+this.width-r)return!0;let i=e-(this.x+r),s=t-(this.y+r);const o=r*r;if(i*i+s*s<=o||(i=e-(this.x+this.width-r),i*i+s*s<=o)||(s=t-(this.y+this.height-r),i*i+s*s<=o)||(i=e-(this.x+r),i*i+s*s<=o))return!0}return!1}strokeContains(e,t,r){const{x:i,y:s,width:o,height:a,radius:l}=this,u=r/2,c=i+l,h=s+l,d=o-l*2,f=a-l*2,p=i+o,g=s+a;return(e>=i-u&&e<=i+u||e>=p-u&&e<=p+u)&&t>=h&&t<=h+f||(t>=s-u&&t<=s+u||t>=g-u&&t<=g+u)&&e>=c&&e<=c+d?!0:e<c&&t<h&&Ni(e,t,c,h,l,u)||e>p-l&&t<h&&Ni(e,t,p-l,h,l,u)||e>p-l&&t>g-l&&Ni(e,t,p-l,g-l,l,u)||e<c&&t>g-l&&Ni(e,t,c,g-l,l,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const Bv=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Iv(n){let e="";for(let t=0;t<n;++t)t>0&&(e+=`
else `),t<n-1&&(e+=`if(test == ${t}.0){}`);return e}function Fv(n,e){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const r=Bv.replace(/%forloop%/gi,Iv(n));if(e.shaderSource(t,r),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))n=n/2|0;else break}}finally{e.deleteShader(t)}return n}let $n=null;function wr(){if($n)return $n;const n=Vh();return $n=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),$n=Fv($n,n),n.getExtension("WEBGL_lose_context")?.loseContext(),$n}const ff={};function Wa(n,e){let t=2166136261;for(let r=0;r<e;r++)t^=n[r].uid,t=Math.imul(t,16777619),t>>>=0;return ff[t]||Ov(n,e,t)}let wo=0;function Ov(n,e,t){const r={};let i=0;wo||(wo=wr());for(let o=0;o<wo;o++){const a=o<e?n[o]:se.EMPTY.source;r[i++]=a.source,r[i++]=a.style}const s=new hn(r);return ff[t]=s,s}class wu{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function ua(n,e){const t=n.byteLength/8|0,r=new Float64Array(n,0,t);new Float64Array(e,0,t).set(r);const s=n.byteLength-t*8;if(s>0){const o=new Uint8Array(n,t*8,s);new Uint8Array(e,t*8,s).set(o)}}const Uv={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var nt=(n=>(n[n.DISABLED=0]="DISABLED",n[n.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",n[n.MASK_ACTIVE=2]="MASK_ACTIVE",n[n.RENDERING_MASK_REMOVE=3]="RENDERING_MASK_REMOVE",n[n.NONE=4]="NONE",n))(nt||{});function bs(n,e){return e.alphaMode==="no-premultiply-alpha"&&Uv[n]||n}class Gv{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const t=this.textures[e];this.textures[e]=null,this.ids[t.uid]=null}this.count=0}}class Dv{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new Gv,this.blendMode="normal",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const df=[];let ca=0;function Tu(){return ca>0?df[--ca]:new Dv}function Cu(n){df[ca++]=n}let Fr=0;const pf=class Qi{constructor(e={}){this.uid=Xe("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],Qi.defaultOptions.maxTextures=Qi.defaultOptions.maxTextures??wr(),e={...Qi.defaultOptions,...e};const{maxTextures:t,attributesInitialSize:r,indicesInitialSize:i}=e;this.attributeBuffer=new wu(r*4),this.indexBuffer=new Uint16Array(i),this.maxTextures=t}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)Cu(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,t){const r=e._batch.textures.ids[t._source.uid];return!r&&r!==0?!1:(e._textureId=r,e.texture=t,!0)}updateElement(e){this.dirty=!0;const t=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId)}break(e){const t=this._elements;if(!t[this.elementStart])return;let r=Tu(),i=r.textures;i.clear();const s=t[this.elementStart];let o=bs(s.blendMode,s.texture._source);this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const a=this.attributeBuffer.float32View,l=this.attributeBuffer.uint32View,u=this.indexBuffer;let c=this._batchIndexSize,h=this._batchIndexStart,d="startBatch";const f=this.maxTextures;for(let p=this.elementStart;p<this.elementSize;++p){const g=t[p];t[p]=null;const v=g.texture._source,x=bs(g.blendMode,v),S=o!==x;if(v._batchTick===Fr&&!S){g._textureId=v._textureBindLocation,c+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,a,l,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,a,l,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize)),g._batch=r;continue}v._batchTick=Fr,(i.count>=f||S)&&(this._finishBatch(r,h,c-h,i,o,e,d),d="renderBatch",h=c,o=x,r=Tu(),i=r.textures,i.clear(),++Fr),g._textureId=v._textureBindLocation=i.count,i.ids[v.uid]=i.count,i.textures[i.count++]=v,g._batch=r,c+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,a,l,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,a,l,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize))}i.count>0&&(this._finishBatch(r,h,c-h,i,o,e,d),h=c,++Fr),this.elementStart=this.elementSize,this._batchIndexStart=h,this._batchIndexSize=c}_finishBatch(e,t,r,i,s,o,a){e.gpuBindGroup=null,e.bindGroup=null,e.action=a,e.batcher=this,e.textures=i,e.blendMode=s,e.start=t,e.size=r,++Fr,this.batches[this.batchIndex++]=e,o.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const t=Math.max(e,this.attributeBuffer.size*2),r=new wu(t);ua(this.attributeBuffer.rawBinaryData,r.rawBinaryData),this.attributeBuffer=r}_resizeIndexBuffer(e){const t=this.indexBuffer;let r=Math.max(e,t.length*1.5);r+=r%2;const i=r>65535?new Uint32Array(r):new Uint16Array(r);if(i.BYTES_PER_ELEMENT!==t.BYTES_PER_ELEMENT)for(let s=0;s<t.length;s++)i[s]=t[s];else ua(t.buffer,i.buffer);this.indexBuffer=i}packQuadIndex(e,t,r){e[t]=r+0,e[t+1]=r+1,e[t+2]=r+2,e[t+3]=r+0,e[t+4]=r+2,e[t+5]=r+3}packIndex(e,t,r,i){const s=e.indices,o=e.indexSize,a=e.indexOffset,l=e.attributeOffset;for(let u=0;u<o;u++)t[r++]=i+s[u+a]-l}destroy(){for(let e=0;e<this.batches.length;e++)Cu(this.batches[e]);this.batches=null;for(let e=0;e<this._elements.length;e++)this._elements[e]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};pf.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let zv=pf;var Ee=(n=>(n[n.MAP_READ=1]="MAP_READ",n[n.MAP_WRITE=2]="MAP_WRITE",n[n.COPY_SRC=4]="COPY_SRC",n[n.COPY_DST=8]="COPY_DST",n[n.INDEX=16]="INDEX",n[n.VERTEX=32]="VERTEX",n[n.UNIFORM=64]="UNIFORM",n[n.STORAGE=128]="STORAGE",n[n.INDIRECT=256]="INDIRECT",n[n.QUERY_RESOLVE=512]="QUERY_RESOLVE",n[n.STATIC=1024]="STATIC",n))(Ee||{});class Vt extends At{constructor(e){let{data:t,size:r}=e;const{usage:i,label:s,shrinkToFit:o}=e;super(),this.uid=Xe("buffer"),this._resourceType="buffer",this._resourceId=Xe("resource"),this._touched=0,this._updateID=1,this.shrinkToFit=!0,this.destroyed=!1,t instanceof Array&&(t=new Float32Array(t)),this._data=t,r=r??t?.byteLength;const a=!!t;this.descriptor={size:r,usage:i,mappedAtCreation:a,label:s},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get static(){return!!(this.descriptor.usage&Ee.STATIC)}set static(e){e?this.descriptor.usage|=Ee.STATIC:this.descriptor.usage&=~Ee.STATIC}setDataWithSize(e,t,r){if(this._updateID++,this._updateSize=t*e.BYTES_PER_ELEMENT,this._data===e){r&&this.emit("update",this);return}const i=this._data;if(this._data=e,i.length!==e.length){!this.shrinkToFit&&e.byteLength<i.byteLength?r&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=Xe("resource"),this.emit("change",this));return}r&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function mf(n,e){if(!(n instanceof Vt)){let t=e?Ee.INDEX:Ee.VERTEX;n instanceof Array&&(e?(n=new Uint32Array(n),t=Ee.INDEX|Ee.COPY_DST):(n=new Float32Array(n),t=Ee.VERTEX|Ee.COPY_DST)),n=new Vt({data:n,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:t})}return n}function Lv(n,e,t){const r=n.getAttribute(e);if(!r)return t.minX=0,t.minY=0,t.maxX=0,t.maxY=0,t;const i=r.buffer.data;let s=1/0,o=1/0,a=-1/0,l=-1/0;const u=i.BYTES_PER_ELEMENT,c=(r.offset||0)/u,h=(r.stride||2*4)/u;for(let d=c;d<i.length;d+=h){const f=i[d],p=i[d+1];f>a&&(a=f),p>l&&(l=p),f<s&&(s=f),p<o&&(o=p)}return t.minX=s,t.minY=o,t.maxX=a,t.maxY=l,t}function Nv(n){return(n instanceof Vt||Array.isArray(n)||n.BYTES_PER_ELEMENT)&&(n={buffer:n}),n.buffer=mf(n.buffer,!1),n}class ks extends At{constructor(e){const{attributes:t,indexBuffer:r,topology:i}=e;super(),this.uid=Xe("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new vt,this._boundsDirty=!0,this.attributes=t,this.buffers=[],this.instanceCount=e.instanceCount||1;for(const s in t){const o=t[s]=Nv(t[s]);this.buffers.indexOf(o.buffer)===-1&&(this.buffers.push(o.buffer),o.buffer.on("update",this.onBufferUpdate,this),o.buffer.on("change",this.onBufferUpdate,this))}r&&(this.indexBuffer=mf(r,!0),this.buffers.push(this.indexBuffer)),this.topology=i||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const t=this.attributes[e];return t.buffer.data.length/(t.stride/4||t.size)}return 0}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,Lv(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(t=>t.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const Hv=new Float32Array(1),Vv=new Uint32Array(1);class Wv extends ks{constructor(){const t=new Vt({data:Hv,label:"attribute-batch-buffer",usage:Ee.VERTEX|Ee.COPY_DST,shrinkToFit:!1}),r=new Vt({data:Vv,label:"index-batch-buffer",usage:Ee.INDEX|Ee.COPY_DST,shrinkToFit:!1}),i=6*4;super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:i,offset:0},aUV:{buffer:t,format:"float32x2",stride:i,offset:2*4},aColor:{buffer:t,format:"unorm8x4",stride:i,offset:4*4},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:i,offset:5*4}},indexBuffer:r})}}function Pu(n,e,t){if(n)for(const r in n){const i=r.toLocaleLowerCase(),s=e[i];if(s){let o=n[r];r==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),t&&s.push(`//----${t}----//`),s.push(o)}else de(`${r} placement hook does not exist in shader`)}}const jv=/\{\{(.*?)\}\}/g;function Au(n){const e={};return(n.match(jv)?.map(r=>r.replace(/[{()}]/g,""))??[]).forEach(r=>{e[r]=[]}),e}function Eu(n,e){let t;const r=/@in\s+([^;]+);/g;for(;(t=r.exec(n))!==null;)e.push(t[1])}function Mu(n,e,t=!1){const r=[];Eu(e,r),n.forEach(a=>{a.header&&Eu(a.header,r)});const i=r;t&&i.sort();const s=i.map((a,l)=>`       @location(${l}) ${a},`).join(`
`);let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${s}
`),o}function ku(n,e){let t;const r=/@out\s+([^;]+);/g;for(;(t=r.exec(n))!==null;)e.push(t[1])}function Xv(n){const t=/\b(\w+)\s*:/g.exec(n);return t?t[1]:""}function qv(n){const e=/@.*?\s+/g;return n.replace(e,"")}function Yv(n,e){const t=[];ku(e,t),n.forEach(l=>{l.header&&ku(l.header,t)});let r=0;const i=t.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${r++}) ${l}`).join(`,
`),s=t.sort().map(l=>`       var ${qv(l)};`).join(`
`),o=`return VSOutput(
                ${t.sort().map(l=>` ${Xv(l)}`).join(`,
`)});`;let a=e.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${i}
`),a=a.replace("{{start}}",`
${s}
`),a=a.replace("{{return}}",`
${o}
`),a}function Ru(n,e){let t=n;for(const r in e){const i=e[r];i.join(`
`).length?t=t.replace(`{{${r}}}`,`//-----${r} START-----//
${i.join(`
`)}
//----${r} FINISH----//`):t=t.replace(`{{${r}}}`,"")}return t}const vn=Object.create(null),To=new Map;let Kv=0;function Zv({template:n,bits:e}){const t=gf(n,e);if(vn[t])return vn[t];const{vertex:r,fragment:i}=Jv(n,e);return vn[t]=_f(r,i,e),vn[t]}function Qv({template:n,bits:e}){const t=gf(n,e);return vn[t]||(vn[t]=_f(n.vertex,n.fragment,e)),vn[t]}function Jv(n,e){const t=e.map(o=>o.vertex).filter(o=>!!o),r=e.map(o=>o.fragment).filter(o=>!!o);let i=Mu(t,n.vertex,!0);i=Yv(t,i);const s=Mu(r,n.fragment,!0);return{vertex:i,fragment:s}}function gf(n,e){return e.map(t=>(To.has(t)||To.set(t,Kv++),To.get(t))).sort((t,r)=>t-r).join("-")+n.vertex+n.fragment}function _f(n,e,t){const r=Au(n),i=Au(e);return t.forEach(s=>{Pu(s.vertex,r,s.name),Pu(s.fragment,i,s.name)}),{vertex:Ru(n,r),fragment:Ru(e,i)}}const $v=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,eb=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,tb=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,nb=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,rb={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},ib={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function ci({bits:n,name:e}){const t=Zv({template:{fragment:eb,vertex:$v},bits:[rb,...n]});return ge.from({name:e,vertex:{source:t.vertex,entryPoint:"main"},fragment:{source:t.fragment,entryPoint:"main"}})}function hi({bits:n,name:e}){return new _e({name:e,...Qv({template:{vertex:tb,fragment:nb},bits:[ib,...n]})})}const ja={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},Xa={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Co={};function sb(n){const e=[];if(n===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let t=0;for(let r=0;r<n;r++)e.push(`@group(1) @binding(${t++}) var textureSource${r+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${t++}) var textureSampler${r+1}: sampler;`)}return e.join(`
`)}function ob(n){const e=[];if(n===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let t=0;t<n;t++)t===n-1?e.push("  default:{"):e.push(`  case ${t}:{`),e.push(`      outColor = textureSampleGrad(textureSource${t+1}, textureSampler${t+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function qa(n){return Co[n]||(Co[n]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${sb(n)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${ob(n)}
            `}}),Co[n]}const Po={};function ab(n){const e=[];for(let t=0;t<n;t++)t>0&&e.push("else"),t<n-1&&e.push(`if(vTextureId < ${t}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${t}], vUV);`),e.push("}");return e.join(`
`)}function Ya(n){return Po[n]||(Po[n]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${n}];

            `,main:`

                ${ab(n)}
            `}}),Po[n]}const fi={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},di={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Bu={};function Ka(n){let e=Bu[n];if(e)return e;const t=new Int32Array(n);for(let r=0;r<n;r++)t[r]=r;return e=Bu[n]=new gt({uTextures:{value:t,type:"i32",size:n}},{isStatic:!0}),e}class lb extends Wt{constructor(e){const t=hi({name:"batch",bits:[Xa,Ya(e),di]}),r=ci({name:"batch",bits:[ja,qa(e),fi]});super({glProgram:t,gpuProgram:r,resources:{batchSamplers:Ka(e)}})}}let Iu=null;const vf=class bf extends zv{constructor(){super(...arguments),this.geometry=new Wv,this.shader=Iu||(Iu=new lb(this.maxTextures)),this.name=bf.extension.name,this.vertexSize=6}packAttributes(e,t,r,i,s){const o=s<<16|e.roundPixels&65535,a=e.transform,l=a.a,u=a.b,c=a.c,h=a.d,d=a.tx,f=a.ty,{positions:p,uvs:g}=e,m=e.color,v=e.attributeOffset,x=v+e.attributeSize;for(let S=v;S<x;S++){const y=S*2,b=p[y],B=p[y+1];t[i++]=l*b+c*B+d,t[i++]=h*B+u*b+f,t[i++]=g[y],t[i++]=g[y+1],r[i++]=m,r[i++]=o}}packQuadAttributes(e,t,r,i,s){const o=e.texture,a=e.transform,l=a.a,u=a.b,c=a.c,h=a.d,d=a.tx,f=a.ty,p=e.bounds,g=p.maxX,m=p.minX,v=p.maxY,x=p.minY,S=o.uvs,y=e.color,b=s<<16|e.roundPixels&65535;t[i+0]=l*m+c*x+d,t[i+1]=h*x+u*m+f,t[i+2]=S.x0,t[i+3]=S.y0,r[i+4]=y,r[i+5]=b,t[i+6]=l*g+c*x+d,t[i+7]=h*x+u*g+f,t[i+8]=S.x1,t[i+9]=S.y1,r[i+10]=y,r[i+11]=b,t[i+12]=l*g+c*v+d,t[i+13]=h*v+u*g+f,t[i+14]=S.x2,t[i+15]=S.y2,r[i+16]=y,r[i+17]=b,t[i+18]=l*m+c*v+d,t[i+19]=h*v+u*m+f,t[i+20]=S.x3,t[i+21]=S.y3,r[i+22]=y,r[i+23]=b}};vf.extension={type:[M.Batcher],name:"default"};let Za=vf;function ub(n,e,t,r,i,s,o,a=null){let l=0;t*=e,i*=s;const u=a.a,c=a.b,h=a.c,d=a.d,f=a.tx,p=a.ty;for(;l<o;){const g=n[t],m=n[t+1];r[i]=u*g+h*m+f,r[i+1]=c*g+d*m+p,i+=s,t+=e,l++}}function cb(n,e,t,r){let i=0;for(e*=t;i<r;)n[e]=0,n[e+1]=0,e+=t,i++}function xf(n,e,t,r,i){const s=e.a,o=e.b,a=e.c,l=e.d,u=e.tx,c=e.ty;t=t||0,r=r||2,i=i||n.length/r-t;let h=t*r;for(let d=0;d<i;d++){const f=n[h],p=n[h+1];n[h]=s*f+a*p+u,n[h+1]=o*f+l*p+c,h+=r}}function hb(n,e){if(n===16777215||!e)return e;if(e===16777215||!n)return n;const t=n>>16&255,r=n>>8&255,i=n&255,s=e>>16&255,o=e>>8&255,a=e&255,l=t*s/255,u=r*o/255,c=i*a/255;return(l<<16)+(u<<8)+c}const fb=new ue;class Qa{constructor(){this.packAsQuad=!1,this.batcherName="default",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,t=e>>16|e&65280|(e&255)<<16,r=this.renderable;return r?hb(t,r.groupColor)+(this.alpha*r.groupAlpha*255<<24):t+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||fb}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData}reset(){this.applyTransform=!0,this.renderable=null}}const oi={extension:{type:M.ShapeBuilder,name:"circle"},build(n,e){let t,r,i,s,o,a;if(n.type==="circle"){const y=n;t=y.x,r=y.y,o=a=y.radius,i=s=0}else if(n.type==="ellipse"){const y=n;t=y.x,r=y.y,o=y.halfWidth,a=y.halfHeight,i=s=0}else{const y=n,b=y.width/2,B=y.height/2;t=y.x+b,r=y.y+B,o=a=Math.max(0,Math.min(y.radius,Math.min(b,B))),i=b-o,s=B-a}if(!(o>=0&&a>=0&&i>=0&&s>=0))return e;const l=Math.ceil(2.3*Math.sqrt(o+a)),u=l*8+(i?4:0)+(s?4:0);if(u===0)return e;if(l===0)return e[0]=e[6]=t+i,e[1]=e[3]=r+s,e[2]=e[4]=t-i,e[5]=e[7]=r-s,e;let c=0,h=l*4+(i?2:0)+2,d=h,f=u,p=i+o,g=s,m=t+p,v=t-p,x=r+g;if(e[c++]=m,e[c++]=x,e[--h]=x,e[--h]=v,s){const y=r-g;e[d++]=v,e[d++]=y,e[--f]=y,e[--f]=m}for(let y=1;y<l;y++){const b=Math.PI/2*(y/l),B=i+Math.cos(b)*o,A=s+Math.sin(b)*a,U=t+B,E=t-B,_=r+A,I=r-A;e[c++]=U,e[c++]=_,e[--h]=_,e[--h]=E,e[d++]=E,e[d++]=I,e[--f]=I,e[--f]=U}p=i,g=s+a,m=t+p,v=t-p,x=r+g;const S=r-g;return e[c++]=m,e[c++]=x,e[--f]=S,e[--f]=m,i&&(e[c++]=v,e[c++]=x,e[--f]=S,e[--f]=v),e},triangulate(n,e,t,r,i,s){if(n.length===0)return;let o=0,a=0;for(let c=0;c<n.length;c+=2)o+=n[c],a+=n[c+1];o/=n.length/2,a/=n.length/2;let l=r;e[l*t]=o,e[l*t+1]=a;const u=l++;for(let c=0;c<n.length;c+=2)e[l*t]=n[c],e[l*t+1]=n[c+1],c>0&&(i[s++]=l,i[s++]=u,i[s++]=l-1),l++;i[s++]=u+1,i[s++]=u,i[s++]=l-1}},db={...oi,extension:{...oi.extension,name:"ellipse"}},pb={...oi,extension:{...oi.extension,name:"roundedRectangle"}},mb=1e-4,Fu=1e-4;function gb(n){const e=n.length;if(e<6)return 1;let t=0;for(let r=0,i=n[e-2],s=n[e-1];r<e;r+=2){const o=n[r],a=n[r+1];t+=(o-i)*(a+s),i=o,s=a}return t<0?-1:1}function Ou(n,e,t,r,i,s,o,a){const l=n-t*i,u=e-r*i,c=n+t*s,h=e+r*s;let d,f;o?(d=r,f=-t):(d=-r,f=t);const p=l+d,g=u+f,m=c+d,v=h+f;return a.push(p,g),a.push(m,v),2}function An(n,e,t,r,i,s,o,a){const l=t-n,u=r-e;let c=Math.atan2(l,u),h=Math.atan2(i-n,s-e);a&&c<h?c+=Math.PI*2:!a&&c>h&&(h+=Math.PI*2);let d=c;const f=h-c,p=Math.abs(f),g=Math.sqrt(l*l+u*u),m=(15*p*Math.sqrt(g)/Math.PI>>0)+1,v=f/m;if(d+=v,a){o.push(n,e),o.push(t,r);for(let x=1,S=d;x<m;x++,S+=v)o.push(n,e),o.push(n+Math.sin(S)*g,e+Math.cos(S)*g);o.push(n,e),o.push(i,s)}else{o.push(t,r),o.push(n,e);for(let x=1,S=d;x<m;x++,S+=v)o.push(n+Math.sin(S)*g,e+Math.cos(S)*g),o.push(n,e);o.push(i,s),o.push(n,e)}return m*2}function _b(n,e,t,r,i,s,o,a,l){const u=mb;if(n.length===0)return;const c=e;let h=c.alignment;if(e.alignment!==.5){let G=gb(n);h=(h-.5)*G+.5}const d=new ke(n[0],n[1]),f=new ke(n[n.length-2],n[n.length-1]),p=r,g=Math.abs(d.x-f.x)<u&&Math.abs(d.y-f.y)<u;if(p){n=n.slice(),g&&(n.pop(),n.pop(),f.set(n[n.length-2],n[n.length-1]));const G=(d.x+f.x)*.5,Q=(f.y+d.y)*.5;n.unshift(G,Q),n.push(G,Q)}const m=i,v=n.length/2;let x=n.length;const S=m.length/2,y=c.width/2,b=y*y,B=c.miterLimit*c.miterLimit;let A=n[0],U=n[1],E=n[2],_=n[3],I=0,re=0,Y=-(U-_),j=A-E,C=0,N=0,W=Math.sqrt(Y*Y+j*j);Y/=W,j/=W,Y*=y,j*=y;const le=h,Z=(1-le)*2,D=le*2;p||(c.cap==="round"?x+=An(A-Y*(Z-D)*.5,U-j*(Z-D)*.5,A-Y*Z,U-j*Z,A+Y*D,U+j*D,m,!0)+2:c.cap==="square"&&(x+=Ou(A,U,Y,j,Z,D,!0,m))),m.push(A-Y*Z,U-j*Z),m.push(A+Y*D,U+j*D);for(let G=1;G<v-1;++G){A=n[(G-1)*2],U=n[(G-1)*2+1],E=n[G*2],_=n[G*2+1],I=n[(G+1)*2],re=n[(G+1)*2+1],Y=-(U-_),j=A-E,W=Math.sqrt(Y*Y+j*j),Y/=W,j/=W,Y*=y,j*=y,C=-(_-re),N=E-I,W=Math.sqrt(C*C+N*N),C/=W,N/=W,C*=y,N*=y;const Q=E-A,he=U-_,Le=E-I,ot=re-_,Et=Q*Le+he*ot,st=he*Le-ot*Q,_t=st<0;if(Math.abs(st)<.001*Math.abs(Et)){m.push(E-Y*Z,_-j*Z),m.push(E+Y*D,_+j*D),Et>=0&&(c.join==="round"?x+=An(E,_,E-Y*Z,_-j*Z,E-C*Z,_-N*Z,m,!1)+4:x+=2,m.push(E-C*D,_-N*D),m.push(E+C*Z,_+N*Z));continue}const Ze=(-Y+A)*(-j+_)-(-Y+E)*(-j+U),xt=(-C+I)*(-N+_)-(-C+E)*(-N+re),Ut=(Q*xt-Le*Ze)/st,Mt=(ot*Ze-he*xt)/st,Xt=(Ut-E)*(Ut-E)+(Mt-_)*(Mt-_),J=E+(Ut-E)*Z,Ne=_+(Mt-_)*Z,at=E-(Ut-E)*D,kt=_-(Mt-_)*D,yt=Math.min(Q*Q+he*he,Le*Le+ot*ot),mn=_t?Z:D,Ve=yt+mn*mn*b;Xt<=Ve?c.join==="bevel"||Xt/b>B?(_t?(m.push(J,Ne),m.push(E+Y*D,_+j*D),m.push(J,Ne),m.push(E+C*D,_+N*D)):(m.push(E-Y*Z,_-j*Z),m.push(at,kt),m.push(E-C*Z,_-N*Z),m.push(at,kt)),x+=2):c.join==="round"?_t?(m.push(J,Ne),m.push(E+Y*D,_+j*D),x+=An(E,_,E+Y*D,_+j*D,E+C*D,_+N*D,m,!0)+4,m.push(J,Ne),m.push(E+C*D,_+N*D)):(m.push(E-Y*Z,_-j*Z),m.push(at,kt),x+=An(E,_,E-Y*Z,_-j*Z,E-C*Z,_-N*Z,m,!1)+4,m.push(E-C*Z,_-N*Z),m.push(at,kt)):(m.push(J,Ne),m.push(at,kt)):(m.push(E-Y*Z,_-j*Z),m.push(E+Y*D,_+j*D),c.join==="round"?_t?x+=An(E,_,E+Y*D,_+j*D,E+C*D,_+N*D,m,!0)+2:x+=An(E,_,E-Y*Z,_-j*Z,E-C*Z,_-N*Z,m,!1)+2:c.join==="miter"&&Xt/b<=B&&(_t?(m.push(at,kt),m.push(at,kt)):(m.push(J,Ne),m.push(J,Ne)),x+=2),m.push(E-C*Z,_-N*Z),m.push(E+C*D,_+N*D),x+=2)}A=n[(v-2)*2],U=n[(v-2)*2+1],E=n[(v-1)*2],_=n[(v-1)*2+1],Y=-(U-_),j=A-E,W=Math.sqrt(Y*Y+j*j),Y/=W,j/=W,Y*=y,j*=y,m.push(E-Y*Z,_-j*Z),m.push(E+Y*D,_+j*D),p||(c.cap==="round"?x+=An(E-Y*(Z-D)*.5,_-j*(Z-D)*.5,E-Y*Z,_-j*Z,E+Y*D,_+j*D,m,!1)+2:c.cap==="square"&&(x+=Ou(E,_,Y,j,Z,D,!1,m)));const oe=Fu*Fu;for(let G=S;G<x+S-2;++G)A=m[G*2],U=m[G*2+1],E=m[(G+1)*2],_=m[(G+1)*2+1],I=m[(G+2)*2],re=m[(G+2)*2+1],!(Math.abs(A*(_-re)+E*(re-U)+I*(U-_))<oe)&&a.push(G,G+1,G+2)}function yf(n,e,t,r,i,s,o){const a=bv(n,e,2);if(!a)return;for(let u=0;u<a.length;u+=3)s[o++]=a[u]+i,s[o++]=a[u+1]+i,s[o++]=a[u+2]+i;let l=i*r;for(let u=0;u<n.length;u+=2)t[l]=n[u],t[l+1]=n[u+1],l+=r}const vb=[],bb={extension:{type:M.ShapeBuilder,name:"polygon"},build(n,e){for(let t=0;t<n.points.length;t++)e[t]=n.points[t];return e},triangulate(n,e,t,r,i,s){yf(n,vb,e,t,r,i,s)}},xb={extension:{type:M.ShapeBuilder,name:"rectangle"},build(n,e){const t=n,r=t.x,i=t.y,s=t.width,o=t.height;return s>=0&&o>=0&&(e[0]=r,e[1]=i,e[2]=r+s,e[3]=i,e[4]=r+s,e[5]=i+o,e[6]=r,e[7]=i+o),e},triangulate(n,e,t,r,i,s){let o=0;r*=t,e[r+o]=n[0],e[r+o+1]=n[1],o+=t,e[r+o]=n[2],e[r+o+1]=n[3],o+=t,e[r+o]=n[6],e[r+o+1]=n[7],o+=t,e[r+o]=n[4],e[r+o+1]=n[5],o+=t;const a=r/t;i[s++]=a,i[s++]=a+1,i[s++]=a+2,i[s++]=a+1,i[s++]=a+3,i[s++]=a+2}},yb={extension:{type:M.ShapeBuilder,name:"triangle"},build(n,e){return e[0]=n.x,e[1]=n.y,e[2]=n.x2,e[3]=n.y2,e[4]=n.x3,e[5]=n.y3,e},triangulate(n,e,t,r,i,s){let o=0;r*=t,e[r+o]=n[0],e[r+o+1]=n[1],o+=t,e[r+o]=n[2],e[r+o+1]=n[3],o+=t,e[r+o]=n[4],e[r+o+1]=n[5];const a=r/t;i[s++]=a,i[s++]=a+1,i[s++]=a+2}},Rs={};pe.handleByMap(M.ShapeBuilder,Rs);pe.add(xb,bb,yb,oi,db,pb);const Sb=new Re;function wb(n,e){const{geometryData:t,batches:r}=e;r.length=0,t.indices.length=0,t.vertices.length=0,t.uvs.length=0;for(let i=0;i<n.instructions.length;i++){const s=n.instructions[i];if(s.action==="texture")Tb(s.data,r,t);else if(s.action==="fill"||s.action==="stroke"){const o=s.action==="stroke",a=s.data.path.shapePath,l=s.data.style,u=s.data.hole;o&&u&&Uu(u.shapePath,l,null,!0,r,t),Uu(a,l,u,o,r,t)}}}function Tb(n,e,t){const{vertices:r,uvs:i,indices:s}=t,o=s.length,a=r.length/2,l=[],u=Rs.rectangle,c=Sb,h=n.image;c.x=n.dx,c.y=n.dy,c.width=n.dw,c.height=n.dh;const d=n.transform;u.build(c,l),d&&xf(l,d),u.triangulate(l,r,2,a,s,o);const f=h.uvs;i.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const p=Te.get(Qa);p.indexOffset=o,p.indexSize=s.length-o,p.attributeOffset=a,p.attributeSize=r.length/2-a,p.baseColor=n.style,p.alpha=n.alpha,p.texture=h,p.geometryData=t,e.push(p)}function Uu(n,e,t,r,i,s){const{vertices:o,uvs:a,indices:l}=s,u=n.shapePrimitives.length-1;n.shapePrimitives.forEach(({shape:c,transform:h},d)=>{const f=l.length,p=o.length/2,g=[],m=Rs[c.type];if(m.build(c,g),h&&xf(g,h),r){const y=c.closePath??!0;_b(g,e,!1,y,o,2,p,l)}else if(t&&u===d){u!==0&&console.warn("[Pixi Graphics] only the last shape have be cut out");const y=[],b=g.slice();Cb(t.shapePath).forEach(A=>{y.push(b.length/2),b.push(...A)}),yf(b,y,o,2,p,l,f)}else m.triangulate(g,o,2,p,l,f);const v=a.length/2,x=e.texture;if(x!==se.WHITE){const y=e.matrix;y&&(h&&y.append(h.clone().invert()),ub(o,2,p,a,v,2,o.length/2-p,y))}else cb(a,v,2,o.length/2-p);const S=Te.get(Qa);S.indexOffset=f,S.indexSize=l.length-f,S.attributeOffset=p,S.attributeSize=o.length/2-p,S.baseColor=e.color,S.alpha=e.alpha,S.texture=x,S.geometryData=s,i.push(S)})}function Cb(n){if(!n)return[];const e=n.shapePrimitives,t=[];for(let r=0;r<e.length;r++){const i=e[r].shape,s=[];Rs[i.type].build(i,s),t.push(s)}return t}class Pb{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Ab{constructor(){this.batcher=new Za,this.instructions=new Eh}init(){this.instructions.reset()}get geometry(){return ie(W_,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Ja=class ha{constructor(){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null)}init(e){ha.defaultOptions.bezierSmoothness=e?.bezierSmoothness??ha.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let t=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){t?this._cleanGraphicsContextData(e):t=this._initContext(e),wb(e,t);const r=e.batchMode;e.customShader||r==="no-batch"?t.isBatchable=!1:r==="auto"&&(t.isBatchable=t.geometryData.vertices.length<400),e.dirty=!1}return t}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const t=Te.get(Ab),{batches:r,geometryData:i}=this._gpuContextHash[e.uid],s=i.vertices.length,o=i.indices.length;for(let c=0;c<r.length;c++)r[c].applyTransform=!1;const a=t.batcher;a.ensureAttributeBuffer(s),a.ensureIndexBuffer(o),a.begin();for(let c=0;c<r.length;c++){const h=r[c];a.add(h)}a.finish(t.instructions);const l=a.geometry;l.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),l.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const u=a.batches;for(let c=0;c<u.length;c++){const h=u[c];h.bindGroup=Wa(h.textures.textures,h.textures.count)}return this._graphicsDataContextHash[e.uid]=t,t}_initContext(e){const t=new Pb;return t.context=e,this._gpuContextHash[e.uid]=t,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const t=this._gpuContextHash[e.uid];t.isBatchable||this._graphicsDataContextHash[e.uid]&&(Te.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),t.batches&&t.batches.forEach(r=>{Te.return(r)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}};Ja.extension={type:[M.WebGLSystem,M.WebGPUSystem,M.CanvasSystem],name:"graphicsContext"};Ja.defaultOptions={bezierSmoothness:.5};let $a=Ja;const Eb=8,Hi=11920929e-14,Mb=1;function Sf(n,e,t,r,i,s,o,a,l,u){const h=Math.min(.99,Math.max(0,u??$a.defaultOptions.bezierSmoothness));let d=(Mb-h)/1;return d*=d,kb(e,t,r,i,s,o,a,l,n,d),n}function kb(n,e,t,r,i,s,o,a,l,u){fa(n,e,t,r,i,s,o,a,l,u,0),l.push(o,a)}function fa(n,e,t,r,i,s,o,a,l,u,c){if(c>Eb)return;const h=(n+t)/2,d=(e+r)/2,f=(t+i)/2,p=(r+s)/2,g=(i+o)/2,m=(s+a)/2,v=(h+f)/2,x=(d+p)/2,S=(f+g)/2,y=(p+m)/2,b=(v+S)/2,B=(x+y)/2;if(c>0){let A=o-n,U=a-e;const E=Math.abs((t-o)*U-(r-a)*A),_=Math.abs((i-o)*U-(s-a)*A);if(E>Hi&&_>Hi){if((E+_)*(E+_)<=u*(A*A+U*U)){l.push(b,B);return}}else if(E>Hi){if(E*E<=u*(A*A+U*U)){l.push(b,B);return}}else if(_>Hi){if(_*_<=u*(A*A+U*U)){l.push(b,B);return}}else if(A=b-(n+o)/2,U=B-(e+a)/2,A*A+U*U<=u){l.push(b,B);return}}fa(n,e,h,d,v,x,b,B,l,u,c+1),fa(b,B,S,y,g,m,o,a,l,u,c+1)}const Rb=8,Bb=11920929e-14,Ib=1;function Fb(n,e,t,r,i,s,o,a){const u=Math.min(.99,Math.max(0,a??$a.defaultOptions.bezierSmoothness));let c=(Ib-u)/1;return c*=c,Ob(e,t,r,i,s,o,n,c),n}function Ob(n,e,t,r,i,s,o,a){da(o,n,e,t,r,i,s,a,0),o.push(i,s)}function da(n,e,t,r,i,s,o,a,l){if(l>Rb)return;const u=(e+r)/2,c=(t+i)/2,h=(r+s)/2,d=(i+o)/2,f=(u+h)/2,p=(c+d)/2;let g=s-e,m=o-t;const v=Math.abs((r-s)*m-(i-o)*g);if(v>Bb){if(v*v<=a*(g*g+m*m)){n.push(f,p);return}}else if(g=f-(e+s)/2,m=p-(t+o)/2,g*g+m*m<=a){n.push(f,p);return}da(n,e,t,u,c,f,p,a,l+1),da(n,f,p,h,d,s,o,a,l+1)}function wf(n,e,t,r,i,s,o,a){let l=Math.abs(i-s);(!o&&i>s||o&&s>i)&&(l=2*Math.PI-l),a=a||Math.max(6,Math.floor(6*Math.pow(r,1/3)*(l/Math.PI))),a=Math.max(a,3);let u=l/a,c=i;u*=o?-1:1;for(let h=0;h<a+1;h++){const d=Math.cos(c),f=Math.sin(c),p=e+d*r,g=t+f*r;n.push(p,g),c+=u}}function Ub(n,e,t,r,i,s){const o=n[n.length-2],l=n[n.length-1]-t,u=o-e,c=i-t,h=r-e,d=Math.abs(l*h-u*c);if(d<1e-8||s===0){(n[n.length-2]!==e||n[n.length-1]!==t)&&n.push(e,t);return}const f=l*l+u*u,p=c*c+h*h,g=l*c+u*h,m=s*Math.sqrt(f)/d,v=s*Math.sqrt(p)/d,x=m*g/f,S=v*g/p,y=m*h+v*u,b=m*c+v*l,B=u*(v+x),A=l*(v+x),U=h*(m+S),E=c*(m+S),_=Math.atan2(A-b,B-y),I=Math.atan2(E-b,U-y);wf(n,y+e,b+t,s,_,I,u*c>h*l)}const qr=Math.PI*2,Ao={centerX:0,centerY:0,ang1:0,ang2:0},Eo=({x:n,y:e},t,r,i,s,o,a,l)=>{n*=t,e*=r;const u=i*n-s*e,c=s*n+i*e;return l.x=u+o,l.y=c+a,l};function Gb(n,e){const t=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),r=e===1.5707963267948966?.551915024494:t,i=Math.cos(n),s=Math.sin(n),o=Math.cos(n+e),a=Math.sin(n+e);return[{x:i-s*r,y:s+i*r},{x:o+a*r,y:a-o*r},{x:o,y:a}]}const Gu=(n,e,t,r)=>{const i=n*r-e*t<0?-1:1;let s=n*t+e*r;return s>1&&(s=1),s<-1&&(s=-1),i*Math.acos(s)},Db=(n,e,t,r,i,s,o,a,l,u,c,h,d)=>{const f=Math.pow(i,2),p=Math.pow(s,2),g=Math.pow(c,2),m=Math.pow(h,2);let v=f*p-f*m-p*g;v<0&&(v=0),v/=f*m+p*g,v=Math.sqrt(v)*(o===a?-1:1);const x=v*i/s*h,S=v*-s/i*c,y=u*x-l*S+(n+t)/2,b=l*x+u*S+(e+r)/2,B=(c-x)/i,A=(h-S)/s,U=(-c-x)/i,E=(-h-S)/s,_=Gu(1,0,B,A);let I=Gu(B,A,U,E);a===0&&I>0&&(I-=qr),a===1&&I<0&&(I+=qr),d.centerX=y,d.centerY=b,d.ang1=_,d.ang2=I};function zb(n,e,t,r,i,s,o,a=0,l=0,u=0){if(s===0||o===0)return;const c=Math.sin(a*qr/360),h=Math.cos(a*qr/360),d=h*(e-r)/2+c*(t-i)/2,f=-c*(e-r)/2+h*(t-i)/2;if(d===0&&f===0)return;s=Math.abs(s),o=Math.abs(o);const p=Math.pow(d,2)/Math.pow(s,2)+Math.pow(f,2)/Math.pow(o,2);p>1&&(s*=Math.sqrt(p),o*=Math.sqrt(p)),Db(e,t,r,i,s,o,l,u,c,h,d,f,Ao);let{ang1:g,ang2:m}=Ao;const{centerX:v,centerY:x}=Ao;let S=Math.abs(m)/(qr/4);Math.abs(1-S)<1e-7&&(S=1);const y=Math.max(Math.ceil(S),1);m/=y;let b=n[n.length-2],B=n[n.length-1];const A={x:0,y:0};for(let U=0;U<y;U++){const E=Gb(g,m),{x:_,y:I}=Eo(E[0],s,o,h,c,v,x,A),{x:re,y:Y}=Eo(E[1],s,o,h,c,v,x,A),{x:j,y:C}=Eo(E[2],s,o,h,c,v,x,A);Sf(n,b,B,_,I,re,Y,j,C),b=j,B=C,g+=m}}function Lb(n,e,t){const r=(o,a)=>{const l=a.x-o.x,u=a.y-o.y,c=Math.sqrt(l*l+u*u),h=l/c,d=u/c;return{len:c,nx:h,ny:d}},i=(o,a)=>{o===0?n.moveTo(a.x,a.y):n.lineTo(a.x,a.y)};let s=e[e.length-1];for(let o=0;o<e.length;o++){const a=e[o%e.length],l=a.radius??t;if(l<=0){i(o,a),s=a;continue}const u=e[(o+1)%e.length],c=r(a,s),h=r(a,u);if(c.len<1e-4||h.len<1e-4){i(o,a),s=a;continue}let d=Math.asin(c.nx*h.ny-c.ny*h.nx),f=1,p=!1;c.nx*h.nx-c.ny*-h.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,p=!0):d>0&&(f=-1,p=!0);const g=d/2;let m,v=Math.abs(Math.cos(g)*l/Math.sin(g));v>Math.min(c.len/2,h.len/2)?(v=Math.min(c.len/2,h.len/2),m=Math.abs(v*Math.sin(g)/Math.cos(g))):m=l;const x=a.x+h.nx*v+-h.ny*m*f,S=a.y+h.ny*v+h.nx*m*f,y=Math.atan2(c.ny,c.nx)+Math.PI/2*f,b=Math.atan2(h.ny,h.nx)-Math.PI/2*f;o===0&&n.moveTo(x+Math.cos(y)*m,S+Math.sin(y)*m),n.arc(x,S,m,y,b,p),s=a}}function Nb(n,e,t,r){const i=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),s=(a,l,u)=>({x:a.x+(l.x-a.x)*u,y:a.y+(l.y-a.y)*u}),o=e.length;for(let a=0;a<o;a++){const l=e[(a+1)%o],u=l.radius??t;if(u<=0){a===0?n.moveTo(l.x,l.y):n.lineTo(l.x,l.y);continue}const c=e[a],h=e[(a+2)%o],d=i(c,l);let f;if(d<1e-4)f=l;else{const m=Math.min(d/2,u);f=s(l,c,m/d)}const p=i(h,l);let g;if(p<1e-4)g=l;else{const m=Math.min(p/2,u);g=s(l,h,m/p)}a===0?n.moveTo(f.x,f.y):n.lineTo(f.x,f.y),n.quadraticCurveTo(l.x,l.y,g.x,g.y,r)}}const Hb=new Re;class Vb{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new vt,this._graphicsPath2D=e}moveTo(e,t){return this.startPoly(e,t),this}lineTo(e,t){this._ensurePoly();const r=this._currentPoly.points,i=r[r.length-2],s=r[r.length-1];return(i!==e||s!==t)&&r.push(e,t),this}arc(e,t,r,i,s,o){this._ensurePoly(!1);const a=this._currentPoly.points;return wf(a,e,t,r,i,s,o),this}arcTo(e,t,r,i,s){this._ensurePoly();const o=this._currentPoly.points;return Ub(o,e,t,r,i,s),this}arcToSvg(e,t,r,i,s,o,a){const l=this._currentPoly.points;return zb(l,this._currentPoly.lastX,this._currentPoly.lastY,o,a,e,t,r,i,s),this}bezierCurveTo(e,t,r,i,s,o,a){this._ensurePoly();const l=this._currentPoly;return Sf(this._currentPoly.points,l.lastX,l.lastY,e,t,r,i,s,o,a),this}quadraticCurveTo(e,t,r,i,s){this._ensurePoly();const o=this._currentPoly;return Fb(this._currentPoly.points,o.lastX,o.lastY,e,t,r,i,s),this}closePath(){return this.endPoly(!0),this}addPath(e,t){this.endPoly(),t&&!t.isIdentity()&&(e=e.clone(!0),e.transform(t));for(let r=0;r<e.instructions.length;r++){const i=e.instructions[r];this[i.action](...i.data)}return this}finish(e=!1){this.endPoly(e)}rect(e,t,r,i,s){return this.drawShape(new Re(e,t,r,i),s),this}circle(e,t,r,i){return this.drawShape(new Na(e,t,r),i),this}poly(e,t,r){const i=new Xr(e);return i.closePath=t,this.drawShape(i,r),this}regularPoly(e,t,r,i,s=0,o){i=Math.max(i|0,3);const a=-1*Math.PI/2+s,l=Math.PI*2/i,u=[];for(let c=0;c<i;c++){const h=c*l+a;u.push(e+r*Math.cos(h),t+r*Math.sin(h))}return this.poly(u,!0,o),this}roundPoly(e,t,r,i,s,o=0,a){if(i=Math.max(i|0,3),s<=0)return this.regularPoly(e,t,r,i,o);const l=r*Math.sin(Math.PI/i)-.001;s=Math.min(s,l);const u=-1*Math.PI/2+o,c=Math.PI*2/i,h=(i-2)*Math.PI/i/2;for(let d=0;d<i;d++){const f=d*c+u,p=e+r*Math.cos(f),g=t+r*Math.sin(f),m=f+Math.PI+h,v=f-Math.PI-h,x=p+s*Math.cos(m),S=g+s*Math.sin(m),y=p+s*Math.cos(v),b=g+s*Math.sin(v);d===0?this.moveTo(x,S):this.lineTo(x,S),this.quadraticCurveTo(p,g,y,b,a)}return this.closePath()}roundShape(e,t,r=!1,i){return e.length<3?this:(r?Nb(this,e,t,i):Lb(this,e,t),this.closePath())}filletRect(e,t,r,i,s){if(s===0)return this.rect(e,t,r,i);const o=Math.min(r,i)/2,a=Math.min(o,Math.max(-o,s)),l=e+r,u=t+i,c=a<0?-a:0,h=Math.abs(a);return this.moveTo(e,t+h).arcTo(e+c,t+c,e+h,t,h).lineTo(l-h,t).arcTo(l-c,t+c,l,t+h,h).lineTo(l,u-h).arcTo(l-c,u-c,e+r-h,u,h).lineTo(e+h,u).arcTo(e+c,u-c,e,u-h,h).closePath()}chamferRect(e,t,r,i,s,o){if(s<=0)return this.rect(e,t,r,i);const a=Math.min(s,Math.min(r,i)/2),l=e+r,u=t+i,c=[e+a,t,l-a,t,l,t+a,l,u-a,l-a,u,e+a,u,e,u-a,e,t+a];for(let h=c.length-1;h>=2;h-=2)c[h]===c[h-2]&&c[h-1]===c[h-3]&&c.splice(h-1,2);return this.poly(c,!0,o)}ellipse(e,t,r,i,s){return this.drawShape(new Ha(e,t,r,i),s),this}roundRect(e,t,r,i,s,o){return this.drawShape(new Va(e,t,r,i,s),o),this}drawShape(e,t){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:t}),this}startPoly(e,t){let r=this._currentPoly;return r&&this.endPoly(),r=new Xr,r.points.push(e,t),this._currentPoly=r,this}endPoly(e=!1){const t=this._currentPoly;return t&&t.points.length>2&&(t.closePath=e,this.shapePrimitives.push({shape:t})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new Xr,e)){const t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let r=t.shape.x,i=t.shape.y;if(t.transform&&!t.transform.isIdentity()){const s=t.transform,o=r;r=s.a*r+s.c*i+s.tx,i=s.b*o+s.d*i+s.ty}this._currentPoly.points.push(r,i)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let t=0;t<e.instructions.length;t++){const r=e.instructions[t];this[r.action](...r.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const t=this.shapePrimitives;for(let r=0;r<t.length;r++){const i=t[r],s=i.shape.getBounds(Hb);i.transform?e.addRect(s,i.transform):e.addRect(s)}return e}}class br{constructor(e){this.instructions=[],this.uid=Xe("graphicsPath"),this._dirty=!0,typeof e=="string"?kv(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new Vb(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,t){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,t]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,t,r,i,s){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(ke.shared);let l=0,u=0;if(!o||o.action!=="bezierCurveTo")l=a.x,u=a.y;else{l=o.data[2],u=o.data[3];const c=a.x,h=a.y;l=c+(c-l),u=h+(h-u)}return this.instructions.push({action:"bezierCurveTo",data:[l,u,e,t,r,i,s]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,t,r){const i=this.instructions[this.instructions.length-1],s=this.getLastPoint(ke.shared);let o=0,a=0;if(!i||i.action!=="quadraticCurveTo")o=s.x,a=s.y;else{o=i.data[0],a=i.data[1];const l=s.x,u=s.y;o=l+(l-o),a=u+(u-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,e,t,r]}),this._dirty=!0,this}rect(e,t,r,i,s){return this.instructions.push({action:"rect",data:[e,t,r,i,s]}),this._dirty=!0,this}circle(e,t,r,i){return this.instructions.push({action:"circle",data:[e,t,r,i]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,t,r,i,s,o,a){s=s||i/2;const l=-1*Math.PI/2+o,u=r*2,c=Math.PI*2/u,h=[];for(let d=0;d<u;d++){const f=d%2?s:i,p=d*c+l;h.push(e+f*Math.cos(p),t+f*Math.sin(p))}return this.poly(h,!0,a),this}clone(e=!1){const t=new br;if(!e)t.instructions=this.instructions.slice();else for(let r=0;r<this.instructions.length;r++){const i=this.instructions[r];t.instructions.push({action:i.action,data:i.data.slice()})}return t}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const t=e.a,r=e.b,i=e.c,s=e.d,o=e.tx,a=e.ty;let l=0,u=0,c=0,h=0,d=0,f=0,p=0,g=0;for(let m=0;m<this.instructions.length;m++){const v=this.instructions[m],x=v.data;switch(v.action){case"moveTo":case"lineTo":l=x[0],u=x[1],x[0]=t*l+i*u+o,x[1]=r*l+s*u+a;break;case"bezierCurveTo":c=x[0],h=x[1],d=x[2],f=x[3],l=x[4],u=x[5],x[0]=t*c+i*h+o,x[1]=r*c+s*h+a,x[2]=t*d+i*f+o,x[3]=r*d+s*f+a,x[4]=t*l+i*u+o,x[5]=r*l+s*u+a;break;case"quadraticCurveTo":c=x[0],h=x[1],l=x[2],u=x[3],x[0]=t*c+i*h+o,x[1]=r*c+s*h+a,x[2]=t*l+i*u+o,x[3]=r*l+s*u+a;break;case"arcToSvg":l=x[5],u=x[6],p=x[0],g=x[1],x[0]=t*p+i*g,x[1]=r*p+s*g,x[5]=t*l+i*u+o,x[6]=r*l+s*u+a;break;case"circle":x[4]=Or(x[3],e);break;case"rect":x[4]=Or(x[4],e);break;case"ellipse":x[8]=Or(x[8],e);break;case"roundRect":x[5]=Or(x[5],e);break;case"addPath":x[0].transform(e);break;case"poly":x[2]=Or(x[2],e);break;default:de("unknown transform action",v.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let t=this.instructions.length-1,r=this.instructions[t];if(!r)return e.x=0,e.y=0,e;for(;r.action==="closePath";){if(t--,t<0)return e.x=0,e.y=0,e;r=this.instructions[t]}switch(r.action){case"moveTo":case"lineTo":e.x=r.data[0],e.y=r.data[1];break;case"quadraticCurveTo":e.x=r.data[2],e.y=r.data[3];break;case"bezierCurveTo":e.x=r.data[4],e.y=r.data[5];break;case"arc":case"arcToSvg":e.x=r.data[5],e.y=r.data[6];break;case"addPath":r.data[0].getLastPoint(e);break}return e}}function Or(n,e){return n?n.prepend(e):e.clone()}function Wb(n,e){if(typeof n=="string"){const r=document.createElement("div");r.innerHTML=n.trim(),n=r.querySelector("svg")}const t={context:e,path:new br};return Tf(n,t,null,null),e}function Tf(n,e,t,r){const i=n.children,{fillStyle:s,strokeStyle:o}=jb(n);s&&t?t={...t,...s}:s&&(t=s),o&&r?r={...r,...o}:o&&(r=o),e.context.fillStyle=t,e.context.strokeStyle=r;let a,l,u,c,h,d,f,p,g,m,v,x,S,y,b,B,A;switch(n.nodeName.toLowerCase()){case"path":y=n.getAttribute("d"),b=new br(y),e.context.path(b),t&&e.context.fill(),r&&e.context.stroke();break;case"circle":f=$e(n,"cx",0),p=$e(n,"cy",0),g=$e(n,"r",0),e.context.ellipse(f,p,g,g),t&&e.context.fill(),r&&e.context.stroke();break;case"rect":a=$e(n,"x",0),l=$e(n,"y",0),B=$e(n,"width",0),A=$e(n,"height",0),m=$e(n,"rx",0),v=$e(n,"ry",0),m||v?e.context.roundRect(a,l,B,A,m||v):e.context.rect(a,l,B,A),t&&e.context.fill(),r&&e.context.stroke();break;case"ellipse":f=$e(n,"cx",0),p=$e(n,"cy",0),m=$e(n,"rx",0),v=$e(n,"ry",0),e.context.beginPath(),e.context.ellipse(f,p,m,v),t&&e.context.fill(),r&&e.context.stroke();break;case"line":u=$e(n,"x1",0),c=$e(n,"y1",0),h=$e(n,"x2",0),d=$e(n,"y2",0),e.context.beginPath(),e.context.moveTo(u,c),e.context.lineTo(h,d),r&&e.context.stroke();break;case"polygon":S=n.getAttribute("points"),x=S.match(/\d+/g).map(U=>parseInt(U,10)),e.context.poly(x,!0),t&&e.context.fill(),r&&e.context.stroke();break;case"polyline":S=n.getAttribute("points"),x=S.match(/\d+/g).map(U=>parseInt(U,10)),e.context.poly(x,!1),r&&e.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${n.nodeName}> elements unsupported`);break}}for(let U=0;U<i.length;U++)Tf(i[U],e,t,r)}function $e(n,e,t){const r=n.getAttribute(e);return r?Number(r):t}function jb(n){const e=n.getAttribute("style"),t={},r={};let i=!1,s=!1;if(e){const o=e.split(";");for(let a=0;a<o.length;a++){const l=o[a],[u,c]=l.split(":");switch(u){case"stroke":c!=="none"&&(t.color=me.shared.setValue(c).toNumber(),s=!0);break;case"stroke-width":t.width=Number(c);break;case"fill":c!=="none"&&(i=!0,r.color=me.shared.setValue(c).toNumber());break;case"fill-opacity":r.alpha=Number(c);break;case"stroke-opacity":t.alpha=Number(c);break;case"opacity":r.alpha=Number(c),t.alpha=Number(c);break}}}else{const o=n.getAttribute("stroke");o&&o!=="none"&&(s=!0,t.color=me.shared.setValue(o).toNumber(),t.width=$e(n,"stroke-width",1));const a=n.getAttribute("fill");a&&a!=="none"&&(i=!0,r.color=me.shared.setValue(a).toNumber())}return{strokeStyle:s?t:null,fillStyle:i?r:null}}function Xb(n){return me.isColorLike(n)}function Du(n){return n instanceof Ms}function zu(n){return n instanceof si}function qb(n,e,t){const r=me.shared.setValue(e??0);return n.color=r.toNumber(),n.alpha=r.alpha===1?t.alpha:r.alpha,n.texture=se.WHITE,{...t,...n}}function Lu(n,e,t){return n.fill=e,n.color=16777215,n.texture=e.texture,n.matrix=e.transform,{...t,...n}}function Nu(n,e,t){return e.buildLinearGradient(),n.fill=e,n.color=16777215,n.texture=e.texture,n.matrix=e.transform,{...t,...n}}function Yb(n,e){const t={...e,...n};if(t.texture){if(t.texture!==se.WHITE){const s=t.matrix?.invert()||new ue;s.translate(t.texture.frame.x,t.texture.frame.y),s.scale(1/t.texture.source.width,1/t.texture.source.height),t.matrix=s}const i=t.texture.source.style;i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update())}const r=me.shared.setValue(t.color);return t.alpha*=r.alpha,t.color=r.toNumber(),t.matrix=t.matrix?t.matrix.clone():null,t}function On(n,e){if(n==null)return null;const t={},r=n;return Xb(n)?qb(t,n,e):Du(n)?Lu(t,n,e):zu(n)?Nu(t,n,e):r.fill&&Du(r.fill)?Lu(r,r.fill,e):r.fill&&zu(r.fill)?Nu(r,r.fill,e):Yb(r,e)}function xs(n,e){const{width:t,alignment:r,miterLimit:i,cap:s,join:o,...a}=e,l=On(n,a);return l?{width:t,alignment:r,miterLimit:i,cap:s,join:o,...l}:null}const Kb=new ke,Hu=new ue,el=class Yt extends At{constructor(){super(...arguments),this.uid=Xe("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new br,this._transform=new ue,this._fillStyle={...Yt.defaultFillStyle},this._strokeStyle={...Yt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new vt,this._boundsDirty=!0}clone(){const e=new Yt;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=On(e,Yt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=xs(e,Yt.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=On(e,Yt.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=On(e,Yt.defaultStrokeStyle),this}texture(e,t,r,i,s,o){return this.instructions.push({action:"texture",data:{image:e,dx:r||0,dy:i||0,dw:s||e.frame.width,dh:o||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:t?me.shared.setValue(t).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new br,this}fill(e,t){let r;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="stroke"?r=i.data.path:r=this._activePath.clone(),r?(e!=null&&(t!==void 0&&typeof e=="number"&&(ie(we,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:t}),this._fillStyle=On(e,Yt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:t}=this._activePath.getLastPoint(ke.shared);this._activePath.clear(),this._activePath.moveTo(e,t)}stroke(e){let t;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r&&r.action==="fill"?t=r.data.path:t=this._activePath.clone(),t?(e!=null&&(this._strokeStyle=xs(e,Yt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:t}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const t=this.instructions[this.instructions.length-1-e],r=this._activePath.clone();if(t&&(t.action==="stroke"||t.action==="fill"))if(t.data.hole)t.data.hole.addPath(r);else{t.data.hole=r;break}}return this._initNextPathLocation(),this}arc(e,t,r,i,s,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*e+a.c*t+a.tx,a.b*e+a.d*t+a.ty,r,i,s,o),this}arcTo(e,t,r,i,s){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*e+o.c*t+o.tx,o.b*e+o.d*t+o.ty,o.a*r+o.c*i+o.tx,o.b*r+o.d*i+o.ty,s),this}arcToSvg(e,t,r,i,s,o,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,t,r,i,s,l.a*o+l.c*a+l.tx,l.b*o+l.d*a+l.ty),this}bezierCurveTo(e,t,r,i,s,o,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*t+l.tx,l.b*e+l.d*t+l.ty,l.a*r+l.c*i+l.tx,l.b*r+l.d*i+l.ty,l.a*s+l.c*o+l.tx,l.b*s+l.d*o+l.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,t,r,i){return this._tick++,this._activePath.ellipse(e,t,r,i,this._transform.clone()),this}circle(e,t,r){return this._tick++,this._activePath.circle(e,t,r,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,t){this._tick++;const r=this._transform;return this._activePath.lineTo(r.a*e+r.c*t+r.tx,r.b*e+r.d*t+r.ty),this}moveTo(e,t){this._tick++;const r=this._transform,i=this._activePath.instructions,s=r.a*e+r.c*t+r.tx,o=r.b*e+r.d*t+r.ty;return i.length===1&&i[0].action==="moveTo"?(i[0].data[0]=s,i[0].data[1]=o,this):(this._activePath.moveTo(s,o),this)}quadraticCurveTo(e,t,r,i,s){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*e+o.c*t+o.tx,o.b*e+o.d*t+o.ty,o.a*r+o.c*i+o.tx,o.b*r+o.d*i+o.ty,s),this}rect(e,t,r,i){return this._tick++,this._activePath.rect(e,t,r,i,this._transform.clone()),this}roundRect(e,t,r,i,s){return this._tick++,this._activePath.roundRect(e,t,r,i,s,this._transform.clone()),this}poly(e,t){return this._tick++,this._activePath.poly(e,t,this._transform.clone()),this}regularPoly(e,t,r,i,s=0,o){return this._tick++,this._activePath.regularPoly(e,t,r,i,s,o),this}roundPoly(e,t,r,i,s,o){return this._tick++,this._activePath.roundPoly(e,t,r,i,s,o),this}roundShape(e,t,r,i){return this._tick++,this._activePath.roundShape(e,t,r,i),this}filletRect(e,t,r,i,s){return this._tick++,this._activePath.filletRect(e,t,r,i,s),this}chamferRect(e,t,r,i,s,o){return this._tick++,this._activePath.chamferRect(e,t,r,i,s,o),this}star(e,t,r,i,s=0,o=0){return this._tick++,this._activePath.star(e,t,r,i,s,o,this._transform.clone()),this}svg(e){return this._tick++,Wb(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,t=e){return this._transform.scale(e,t),this}setTransform(e,t,r,i,s,o){return e instanceof ue?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,t,r,i,s,o),this)}transform(e,t,r,i,s,o){return e instanceof ue?(this._transform.append(e),this):(Hu.set(e,t,r,i,s,o),this._transform.append(Hu),this)}translate(e,t=e){return this._transform.translate(e,t),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const e=this._bounds;e.clear();for(let t=0;t<this.instructions.length;t++){const r=this.instructions[t],i=r.action;if(i==="fill"){const s=r.data;e.addBounds(s.path.bounds)}else if(i==="texture"){const s=r.data;e.addFrame(s.dx,s.dy,s.dx+s.dw,s.dy+s.dh,s.transform)}if(i==="stroke"){const s=r.data,o=s.style.width/2,a=s.path.bounds;e.addFrame(a.minX-o,a.minY-o,a.maxX+o,a.maxY+o)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const t=this.instructions;let r=!1;for(let i=0;i<t.length;i++){const s=t[i],o=s.data,a=o.path;if(!s.action||!a)continue;const l=o.style,u=a.shapePath.shapePrimitives;for(let c=0;c<u.length;c++){const h=u[c].shape;if(!l||!h)continue;const d=u[c].transform,f=d?d.applyInverse(e,Kb):e;s.action==="fill"?r=h.contains(f.x,f.y):r=h.strokeContains(f.x,f.y,l.width);const p=o.hole;if(p){const g=p.shapePath?.shapePrimitives;if(g)for(let m=0;m<g.length;m++)g[m].shape.contains(f.x,f.y)&&(r=!1)}if(r)return!0}}return r}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(r),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(r)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};el.defaultFillStyle={color:16777215,alpha:1,texture:se.WHITE,matrix:null,fill:null};el.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:se.WHITE,matrix:null,fill:null};let Rt=el;const Vu=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function Cf(n){const e=[];let t=0;for(let r=0;r<Vu.length;r++){const i=`_${Vu[r]}`;e[t++]=n[i]}return t=Pf(n._fill,e,t),t=Zb(n._stroke,e,t),t=Qb(n.dropShadow,e,t),e.join("-")}function Pf(n,e,t){return n&&(e[t++]=n.color,e[t++]=n.alpha,e[t++]=n.fill?.styleKey),t}function Zb(n,e,t){return n&&(t=Pf(n,e,t),e[t++]=n.width,e[t++]=n.alignment,e[t++]=n.cap,e[t++]=n.join,e[t++]=n.miterLimit),t}function Qb(n,e,t){return n&&(e[t++]=n.alpha,e[t++]=n.angle,e[t++]=n.blur,e[t++]=n.distance,e[t++]=me.shared.setValue(n.color).toNumber()),t}const tl=class nr extends At{constructor(e={}){super(),Jb(e);const t={...nr.defaultTextStyle,...e};for(const r in t){const i=r;this[i]=t[r]}this.update()}get align(){return this._align}set align(e){this._align=e,this.update()}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords=e,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...nr.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...nr.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e,this.update()}get fontSize(){return this._fontSize}set fontSize(e){typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e,this.update()}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e,this.update()}get leading(){return this._leading}set leading(e){this._leading=e,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing=e,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e,this.update()}get padding(){return this._padding}set padding(e){this._padding=e,this.update()}get trim(){return this._trim}set trim(e){this._trim=e,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace=e,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap=e,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth=e,this.update()}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...Rt.defaultFillStyle,...e},()=>{this._fill=On({...this._originalFill},Rt.defaultFillStyle)})),this._fill=On(e===0?"black":e,Rt.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...Rt.defaultStrokeStyle,...e},()=>{this._stroke=xs({...this._originalStroke},Rt.defaultStrokeStyle)})),this._stroke=xs(e,Rt.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=Cf(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=nr.defaultTextStyle;for(const t in e)this[t]=e[t]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new nr({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(r),this._originalFill?.texture&&this._originalFill.texture.destroy(r),this._stroke?.texture&&this._stroke.texture.destroy(r),this._originalStroke?.texture&&this._originalStroke.texture.destroy(r)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,t){return new Proxy(e,{set:(r,i,s)=>(r[i]=s,t?.(i,s),this.update(),!0)})}_isFillStyle(e){return(e??null)!==null&&!(me.isColorLike(e)||e instanceof si||e instanceof Ms)}};tl.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};tl.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let dn=tl;function Jb(n){const e=n;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const t=dn.defaultDropShadow;n.dropShadow={alpha:e.dropShadowAlpha??t.alpha,angle:e.dropShadowAngle??t.angle,blur:e.dropShadowBlur??t.blur,color:e.dropShadowColor??t.color,distance:e.dropShadowDistance??t.distance}}if(e.strokeThickness!==void 0){ie(we,"strokeThickness is now a part of stroke");const t=e.stroke;let r={};if(me.isColorLike(t))r.color=t;else if(t instanceof si||t instanceof Ms)r.fill=t;else if(Object.hasOwnProperty.call(t,"color")||Object.hasOwnProperty.call(t,"fill"))r=t;else throw new Error("Invalid stroke value.");n.stroke={...r,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){ie(we,"gradient fill is now a fill pattern: `new FillGradient(...)`");let t;n.fontSize==null?n.fontSize=dn.defaultTextStyle.fontSize:typeof n.fontSize=="string"?t=parseInt(n.fontSize,10):t=n.fontSize;const r=new si(0,0,0,t*1.7),i=e.fillGradientStops.map(s=>me.shared.setValue(s).toNumber());i.forEach((s,o)=>{const a=o/(i.length-1);r.addColorStop(a,s)}),n.fill={fill:r}}}class $b{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,t){const r=Se.get().createCanvas();r.width=e,r.height=t;const i=r.getContext("2d");return{canvas:r,context:i}}getOptimalCanvasAndContext(e,t,r=1){e=Math.ceil(e*r-1e-6),t=Math.ceil(t*r-1e-6),e=_r(e),t=_r(t);const i=(e<<17)+(t<<1);this._canvasPool[i]||(this._canvasPool[i]=[]);let s=this._canvasPool[i].pop();return s||(s=this._createCanvasAndContext(e,t)),s}returnCanvasAndContext(e){const t=e.canvas,{width:r,height:i}=t,s=(r<<17)+(i<<1);this._canvasPool[s].push(e)}clear(){this._canvasPool={}}}const fn=new $b,e1=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function ys(n){const e=typeof n.fontSize=="number"?`${n.fontSize}px`:n.fontSize;let t=n.fontFamily;Array.isArray(n.fontFamily)||(t=n.fontFamily.split(","));for(let r=t.length-1;r>=0;r--){let i=t[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!e1.includes(i)&&(i=`"${i}"`),t[r]=i}return`${n.fontStyle} ${n.fontVariant} ${n.fontWeight} ${e} ${t.join(",")}`}const Mo={willReadFrequently:!0},jt=class ae{static get experimentalLetterSpacingSupported(){let e=ae._experimentalLetterSpacingSupported;if(e!==void 0){const t=Se.get().getCanvasRenderingContext2D().prototype;e=ae._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,r,i,s,o,a,l,u){this.text=e,this.style=t,this.width=r,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=u}static measureText(e=" ",t,r=ae._canvas,i=t.wordWrap){const s=`${e}:${t.styleKey}`;if(ae._measurementCache[s])return ae._measurementCache[s];const o=ys(t),a=ae.measureFont(o);a.fontSize===0&&(a.fontSize=t.fontSize,a.ascent=t.fontSize);const l=ae.__context;l.font=o;const c=(i?ae._wordWrap(e,t,r):e).split(/(?:\r\n|\r|\n)/),h=new Array(c.length);let d=0;for(let x=0;x<c.length;x++){const S=ae._measureText(c[x],t.letterSpacing,l);h[x]=S,d=Math.max(d,S)}const f=t._stroke?.width||0;let p=d+f;t.dropShadow&&(p+=t.dropShadow.distance);const g=t.lineHeight||a.fontSize;let m=Math.max(g,a.fontSize+f)+(c.length-1)*(g+t.leading);return t.dropShadow&&(m+=t.dropShadow.distance),new ae(e,t,p,m,c,h,g+t.leading,d,a)}static _measureText(e,t,r){let i=!1;ae.experimentalLetterSpacingSupported&&(ae.experimentalLetterSpacing?(r.letterSpacing=`${t}px`,r.textLetterSpacing=`${t}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let s=r.measureText(e).width;return s>0&&(i?s-=t:s+=(ae.graphemeSegmenter(e).length-1)*t),s}static _wordWrap(e,t,r=ae._canvas){const i=r.getContext("2d",Mo);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:u,whiteSpace:c}=t,h=ae._collapseSpaces(c),d=ae._collapseNewlines(c);let f=!h;const p=t.wordWrapWidth+u,g=ae._tokenize(e);for(let m=0;m<g.length;m++){let v=g[m];if(ae._isNewline(v)){if(!d){a+=ae._addLine(o),f=!h,o="",s=0;continue}v=" "}if(h){const S=ae.isBreakingSpace(v),y=ae.isBreakingSpace(o[o.length-1]);if(S&&y)continue}const x=ae._getFromCache(v,u,l,i);if(x>p)if(o!==""&&(a+=ae._addLine(o),o="",s=0),ae.canBreakWords(v,t.breakWords)){const S=ae.wordWrapSplit(v);for(let y=0;y<S.length;y++){let b=S[y],B=b,A=1;for(;S[y+A];){const E=S[y+A];if(!ae.canBreakChars(B,E,v,y,t.breakWords))b+=E;else break;B=E,A++}y+=A-1;const U=ae._getFromCache(b,u,l,i);U+s>p&&(a+=ae._addLine(o),f=!1,o="",s=0),o+=b,s+=U}}else{o.length>0&&(a+=ae._addLine(o),o="",s=0);const S=m===g.length-1;a+=ae._addLine(v,!S),f=!1,o="",s=0}else x+s>p&&(f=!1,a+=ae._addLine(o),o="",s=0),(o.length>0||!ae.isBreakingSpace(v)||f)&&(o+=v,s+=x)}return a+=ae._addLine(o,!1),a}static _addLine(e,t=!0){return e=ae._trimRight(e),e=t?`${e}
`:e,e}static _getFromCache(e,t,r,i){let s=r[e];return typeof s!="number"&&(s=ae._measureText(e,t,i)+t,r[e]=s),s}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const r=e[t];if(!ae.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:ae._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:ae._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const t=[];let r="";if(typeof e!="string")return t;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(ae.isBreakingSpace(s,o)||ae._isNewline(s)){r!==""&&(t.push(r),r=""),t.push(s);continue}r+=s}return r!==""&&t.push(r),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,i,s){return!0}static wordWrapSplit(e){return ae.graphemeSegmenter(e)}static measureFont(e){if(ae._fonts[e])return ae._fonts[e];const t=ae._context;t.font=e;const r=t.measureText(ae.METRICS_STRING+ae.BASELINE_SYMBOL),i={ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,fontSize:r.actualBoundingBoxAscent+r.actualBoundingBoxDescent};return ae._fonts[e]=i,i}static clearMetrics(e=""){e?delete ae._fonts[e]:ae._fonts={}}static get _canvas(){if(!ae.__canvas){let e;try{const t=new OffscreenCanvas(0,0);if(t.getContext("2d",Mo)?.measureText)return ae.__canvas=t,t;e=Se.get().createCanvas()}catch{e=Se.get().createCanvas()}e.width=e.height=10,ae.__canvas=e}return ae.__canvas}static get _context(){return ae.__context||(ae.__context=ae._canvas.getContext("2d",Mo)),ae.__context}};jt.METRICS_STRING="|q";jt.BASELINE_SYMBOL="M";jt.BASELINE_MULTIPLIER=1.4;jt.HEIGHT_MULTIPLIER=2;jt.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const n=new Intl.Segmenter;return e=>[...n.segment(e)].map(t=>t.segment)}return n=>[...n]})();jt.experimentalLetterSpacing=!1;jt._fonts={};jt._newlines=[10,13];jt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];jt._measurementCache={};let Qt=jt;function Ss(n,e){if(n.texture===se.WHITE&&!n.fill)return me.shared.setValue(n.color).setAlpha(n.alpha??1).toHexa();if(n.fill){if(n.fill instanceof Ms){const t=n.fill,r=e.createPattern(t.texture.source.resource,"repeat"),i=t.transform.copyTo(ue.shared);return i.scale(t.texture.frame.width,t.texture.frame.height),r.setTransform(i),r}else if(n.fill instanceof si){const t=n.fill;if(t.type==="linear"){const r=e.createLinearGradient(t.x0,t.y0,t.x1,t.y1);return t.gradientStops.forEach(i=>{r.addColorStop(i.offset,me.shared.setValue(i.color).toHex())}),r}}}else{const t=e.createPattern(n.texture.source.resource,"repeat"),r=n.matrix.copyTo(ue.shared);return r.scale(n.texture.frame.width,n.texture.frame.height),t.setTransform(r),t}return de("FillStyle not recognised",n),"red"}function Af(n){if(n==="")return[];typeof n=="string"&&(n=[n]);const e=[];for(let t=0,r=n.length;t<r;t++){const i=n[t];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);if(i[0].length===0||i[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...Array.from(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const Ef=class Mf extends cf{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const t={...Mf.defaultOptions,...e};this._textureSize=t.textureSize,this._mipmap=t.mipmap;const r=t.style.clone();t.overrideFill&&(r._fill.color=16777215,r._fill.alpha=1,r._fill.texture=se.WHITE,r._fill.fill=null),this.applyFillAsTint=t.overrideFill;const i=r.fontSize;r.fontSize=this.baseMeasurementFontSize;const s=ys(r);t.overrideSize?r._stroke&&(r._stroke.width*=this.baseRenderedFontSize/i):r.fontSize=this.baseRenderedFontSize=i,this._style=r,this._skipKerning=t.skipKerning??!1,this.resolution=t.resolution??1,this._padding=t.padding??4,this.fontMetrics=Qt.measureFont(s),this.lineHeight=r.lineHeight||this.fontMetrics.fontSize||r.fontSize}ensureCharacters(e){const t=Af(e).filter(g=>!this._currentChars.includes(g)).filter((g,m,v)=>v.indexOf(g)===m);if(!t.length)return;this._currentChars=[...this._currentChars,...t];let r;this._currentPageIndex===-1?r=this._nextPage():r=this.pages[this._currentPageIndex];let{canvas:i,context:s}=r.canvasAndContext,o=r.texture.source;const a=this._style;let l=this._currentX,u=this._currentY;const c=this.baseRenderedFontSize/this.baseMeasurementFontSize,h=this._padding*c,d=a.fontStyle==="italic"?2:1;let f=0,p=!1;for(let g=0;g<t.length;g++){const m=t[g],v=Qt.measureText(m,a,i,!1);v.lineHeight=v.height;const x=d*v.width*c,S=v.height*c,y=x+h*2,b=S+h*2;if(p=!1,m!==`
`&&m!=="\r"&&m!=="	"&&m!==" "&&(p=!0,f=Math.ceil(Math.max(b,f))),l+y>this._textureSize&&(u+=f,f=b,l=0,u+f>this._textureSize)){o.update();const A=this._nextPage();i=A.canvasAndContext.canvas,s=A.canvasAndContext.context,o=A.texture.source,u=0}const B=x/c-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[m]={id:m.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:B,kerning:{}},p){this._drawGlyph(s,v,l+h,u+h,c,a);const A=o.width*c,U=o.height*c,E=new Re(l/A*o.width,u/U*o.height,y/A*o.width,b/U*o.height);this.chars[m].texture=new se({source:o,frame:E}),l+=Math.ceil(y)}}o.update(),this._currentX=l,this._currentY=u,this._skipKerning&&this._applyKerning(t,s)}get pageTextures(){return ie(we,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,t){const r=this._measureCache;for(let i=0;i<e.length;i++){const s=e[i];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let l=r[s];l||(l=r[s]=t.measureText(s).width);let u=r[a];u||(u=r[a]=t.measureText(a).width);let c=t.measureText(s+a).width,h=c-(l+u);h&&(this.chars[s].kerning[a]=h),c=t.measureText(s+a).width,h=c-(l+u),h&&(this.chars[a].kerning[s]=h)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,t=fn.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(t.context,this._style,e);const r=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),i=new se({source:new Nn({resource:t.canvas,resolution:r,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),s={canvasAndContext:t,texture:i};return this.pages[this._currentPageIndex]=s,s}_setupContext(e,t,r){t.fontSize=this.baseRenderedFontSize,e.scale(r,r),e.font=ys(t),t.fontSize=this.baseMeasurementFontSize,e.textBaseline=t.textBaseline;const i=t._stroke,s=i?.width??0;if(i&&(e.lineWidth=s,e.lineJoin=i.join,e.miterLimit=i.miterLimit,e.strokeStyle=Ss(i,e)),t._fill&&(e.fillStyle=Ss(t._fill,e)),t.dropShadow){const o=t.dropShadow,a=me.shared.setValue(o.color).toArray(),l=o.blur*r,u=o.distance*r;e.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,e.shadowBlur=l,e.shadowOffsetX=Math.cos(o.angle)*u,e.shadowOffsetY=Math.sin(o.angle)*u}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,t,r,i,s,o){const a=t.text,l=t.fontProperties,c=(o._stroke?.width??0)*s,h=r+c/2,d=i-c/2,f=l.descent*s,p=t.lineHeight*s;o.stroke&&c&&e.strokeText(a,h,d+p-f),o._fill&&e.fillText(a,h,d+p-f)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:t,texture:r}=this.pages[e];t.canvas.width=t.canvas.width,fn.returnCanvasAndContext(t),r.destroy(!0)}this.pages=null}};Ef.defaultOptions={textureSize:512,style:new dn,mipmap:!0};let Wu=Ef;function kf(n,e,t,r){const i={width:0,height:0,offsetY:0,scale:e.fontSize/t.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};i.offsetY=t.baseLineOffset;let s=i.lines[0],o=null,a=!0;const l={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},u=p=>{const g=s.width;for(let m=0;m<l.index;m++){const v=p.positions[m];s.chars.push(p.chars[m]),s.charPositions.push(v+g)}s.width+=p.width,a=!1,l.width=0,l.index=0,l.chars.length=0},c=()=>{let p=s.chars.length-1;if(r){let g=s.chars[p];for(;g===" ";)s.width-=t.chars[g].xAdvance,g=s.chars[--p]}i.width=Math.max(i.width,s.width),s={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,i.lines.push(s),i.height+=t.lineHeight},h=t.baseMeasurementFontSize/e.fontSize,d=e.letterSpacing*h,f=e.wordWrapWidth*h;for(let p=0;p<n.length+1;p++){let g;const m=p===n.length;m||(g=n[p]);const v=t.chars[g]||t.chars[" "];if(/(?:\s)/.test(g)||g==="\r"||g===`
`||m){if(!a&&e.wordWrap&&s.width+l.width-d>f?(c(),u(l),m||s.charPositions.push(0)):(l.start=s.width,u(l),m||s.charPositions.push(0)),g==="\r"||g===`
`)s.width!==0&&c();else if(!m){const b=v.xAdvance+(v.kerning[o]||0)+d;s.width+=b,s.spaceWidth=b,s.spacesIndex.push(s.charPositions.length),s.chars.push(g)}}else{const y=v.kerning[o]||0,b=v.xAdvance+y+d;l.positions[l.index++]=l.width+y,l.chars.push(g),l.width+=b}o=g}return c(),e.align==="center"?t1(i):e.align==="right"?n1(i):e.align==="justify"&&r1(i),i}function t1(n){for(let e=0;e<n.lines.length;e++){const t=n.lines[e],r=n.width/2-t.width/2;for(let i=0;i<t.charPositions.length;i++)t.charPositions[i]+=r}}function n1(n){for(let e=0;e<n.lines.length;e++){const t=n.lines[e],r=n.width-t.width;for(let i=0;i<t.charPositions.length;i++)t.charPositions[i]+=r}}function r1(n){const e=n.width;for(let t=0;t<n.lines.length;t++){const r=n.lines[t];let i=0,s=r.spacesIndex[i++],o=0;const a=r.spacesIndex.length,u=(e-r.width)/a;for(let c=0;c<r.charPositions.length;c++)c===s&&(s=r.spacesIndex[i++],o+=u),r.charPositions[c]+=o}}let Vi=0;class i1{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(e,t){let r=`${t.fontFamily}-bitmap`,i=!0;if(t._fill.fill&&!t._stroke)r+=t._fill.fill.styleKey,i=!1;else if(t._stroke||t.dropShadow){let o=t.styleKey;o=o.substring(0,o.lastIndexOf("-")),r=`${o}-bitmap`,i=!1}if(!Oe.has(r)){const o=new Wu({style:t,overrideFill:i,overrideSize:!0,...this.defaultOptions});Vi++,Vi>50&&de("BitmapText",`You have dynamically created ${Vi} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{Vi--,Oe.remove(r)}),Oe.set(r,o)}const s=Oe.get(r);return s.ensureCharacters?.(e),s}getLayout(e,t,r=!0){const i=this.getFont(e,t);return kf([...e],t,i,r)}measureText(e,t,r=!0){return this.getLayout(e,t,r)}install(...e){let t=e[0];typeof t=="string"&&(t={name:t,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},ie(we,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const r=t?.name;if(!r)throw new Error("[BitmapFontManager] Property `name` is required.");t={...this.defaultOptions,...t};const i=t.style,s=i instanceof dn?i:new dn(i),o=s._fill.fill!==null&&s._fill.fill!==void 0,a=new Wu({style:s,overrideFill:o,skipKerning:t.skipKerning,padding:t.padding,resolution:t.resolution,overrideSize:!1}),l=Af(t.chars);return a.ensureCharacters(l.join("")),Oe.set(`${r}-bitmap`,a),a.once("destroy",()=>Oe.remove(`${r}-bitmap`)),a}uninstall(e){const t=`${e}-bitmap`,r=Oe.get(t);r&&(Oe.remove(t),r.destroy())}}const pa=new i1;class Rf extends cf{constructor(e,t){super();const{textures:r,data:i}=e;Object.keys(i.pages).forEach(s=>{const o=i.pages[parseInt(s,10)],a=r[o.id];this.pages.push({texture:a})}),Object.keys(i.chars).forEach(s=>{const o=i.chars[s],{frame:a,source:l}=r[o.page],u=new Re(o.x+a.x,o.y+a.y,o.width,o.height),c=new se({source:l,frame:u});this.chars[s]={id:s.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:c}}),this.baseRenderedFontSize=i.fontSize,this.baseMeasurementFontSize=i.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:i.fontSize},this.baseLineOffset=i.baseLineOffset,this.lineHeight=i.lineHeight,this.fontFamily=i.fontFamily,this.distanceField=i.distanceField??{type:"none",range:0},this.url=t}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:t}=this.pages[e];t.destroy(!0)}this.pages=null}static install(e){pa.install(e)}static uninstall(e){pa.uninstall(e)}}const ko={test(n){return typeof n=="string"&&n.startsWith("info face=")},parse(n){const e=n.match(/^[a-z]+\s+.+$/gm),t={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const h in e){const d=e[h].match(/^[a-z]+/gm)[0],f=e[h].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const g in f){const m=f[g].split("="),v=m[0],x=m[1].replace(/"/gm,""),S=parseFloat(x),y=isNaN(S)?x:S;p[v]=y}t[d].push(p)}const r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[i]=t.info,[s]=t.common,[o]=t.distanceField??[];o&&(r.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),r.fontSize=parseInt(i.size,10),r.fontFamily=i.face,r.lineHeight=parseInt(s.lineHeight,10);const a=t.page;for(let h=0;h<a.length;h++)r.pages.push({id:parseInt(a[h].id,10)||0,file:a[h].file});const l={};r.baseLineOffset=r.lineHeight-parseInt(s.base,10);const u=t.char;for(let h=0;h<u.length;h++){const d=u[h],f=parseInt(d.id,10);let p=d.letter??d.char??String.fromCharCode(f);p==="space"&&(p=" "),l[f]=p,r.chars[p]={id:f,page:parseInt(d.page,10)||0,x:parseInt(d.x,10),y:parseInt(d.y,10),width:parseInt(d.width,10),height:parseInt(d.height,10),xOffset:parseInt(d.xoffset,10),yOffset:parseInt(d.yoffset,10),xAdvance:parseInt(d.xadvance,10),kerning:{}}}const c=t.kerning||[];for(let h=0;h<c.length;h++){const d=parseInt(c[h].first,10),f=parseInt(c[h].second,10),p=parseInt(c[h].amount,10);r.chars[l[f]].kerning[l[d]]=p}return r}},ju={test(n){const e=n;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(n){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},t=n.getElementsByTagName("info")[0],r=n.getElementsByTagName("common")[0],i=n.getElementsByTagName("distanceField")[0];i&&(e.distanceField={type:i.getAttribute("fieldType"),range:parseInt(i.getAttribute("distanceRange"),10)});const s=n.getElementsByTagName("page"),o=n.getElementsByTagName("char"),a=n.getElementsByTagName("kerning");e.fontSize=parseInt(t.getAttribute("size"),10),e.fontFamily=t.getAttribute("face"),e.lineHeight=parseInt(r.getAttribute("lineHeight"),10);for(let u=0;u<s.length;u++)e.pages.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});const l={};e.baseLineOffset=e.lineHeight-parseInt(r.getAttribute("base"),10);for(let u=0;u<o.length;u++){const c=o[u],h=parseInt(c.getAttribute("id"),10);let d=c.getAttribute("letter")??c.getAttribute("char")??String.fromCharCode(h);d==="space"&&(d=" "),l[h]=d,e.chars[d]={id:h,page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xOffset:parseInt(c.getAttribute("xoffset"),10),yOffset:parseInt(c.getAttribute("yoffset"),10),xAdvance:parseInt(c.getAttribute("xadvance"),10),kerning:{}}}for(let u=0;u<a.length;u++){const c=parseInt(a[u].getAttribute("first"),10),h=parseInt(a[u].getAttribute("second"),10),d=parseInt(a[u].getAttribute("amount"),10);e.chars[l[h]].kerning[l[c]]=d}return e}},Xu={test(n){return typeof n=="string"&&n.includes("<font>")?ju.test(Se.get().parseXML(n)):!1},parse(n){return ju.parse(Se.get().parseXML(n))}},s1=[".xml",".fnt"],o1={extension:{type:M.CacheParser,name:"cacheBitmapFont"},test:n=>n instanceof Rf,getCacheableAssets(n,e){const t={};return n.forEach(r=>{t[r]=e,t[`${r}-bitmap`]=e}),t[`${e.fontFamily}-bitmap`]=e,t}},a1={extension:{type:M.LoadParser,priority:wn.Normal},name:"loadBitmapFont",test(n){return s1.includes(Ct.extname(n).toLowerCase())},async testParse(n){return ko.test(n)||Xu.test(n)},async parse(n,e,t){const r=ko.test(n)?ko.parse(n):Xu.parse(n),{src:i}=e,{pages:s}=r,o=[],a=r.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let h=0;h<s.length;++h){const d=s[h].file;let f=Ct.join(Ct.dirname(i),d);f=$o(f,i),o.push({src:f,data:a})}const l=await t.load(o),u=o.map(h=>l[h.src]);return new Rf({data:r,textures:u},i)},async load(n,e){return await(await Se.get().fetch(n)).text()},async unload(n,e,t){await Promise.all(n.pages.map(r=>t.unload(r.texture.source._sourceOrigin))),n.destroy()}};class l1{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<t;r++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const u1={extension:{type:M.CacheParser,name:"cacheTextureArray"},test:n=>Array.isArray(n)&&n.every(e=>e instanceof se),getCacheableAssets:(n,e)=>{const t={};return n.forEach(r=>{e.forEach((i,s)=>{t[r+(s===0?"":s+1)]=i})}),t}};async function Bf(n){if("Image"in globalThis)return new Promise(e=>{const t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=n});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(n)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const c1={extension:{type:M.DetectionParser,priority:1},test:async()=>Bf("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async n=>[...n,"avif"],remove:async n=>n.filter(e=>e!=="avif")},qu=["png","jpg","jpeg"],h1={extension:{type:M.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async n=>[...n,...qu],remove:async n=>n.filter(e=>!qu.includes(e))},f1="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function nl(n){return f1?!1:document.createElement("video").canPlayType(n)!==""}const d1={extension:{type:M.DetectionParser,priority:0},test:async()=>nl("video/mp4"),add:async n=>[...n,"mp4","m4v"],remove:async n=>n.filter(e=>e!=="mp4"&&e!=="m4v")},p1={extension:{type:M.DetectionParser,priority:0},test:async()=>nl("video/ogg"),add:async n=>[...n,"ogv"],remove:async n=>n.filter(e=>e!=="ogv")},m1={extension:{type:M.DetectionParser,priority:0},test:async()=>nl("video/webm"),add:async n=>[...n,"webm"],remove:async n=>n.filter(e=>e!=="webm")},g1={extension:{type:M.DetectionParser,priority:0},test:async()=>Bf("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async n=>[...n,"webp"],remove:async n=>n.filter(e=>e!=="webp")};class _1{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,r)=>(this._parsersValidated=!1,e[t]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const r={promise:null,parser:null};return r.promise=(async()=>{let i=null,s=null;if(t.loadParser&&(s=this._parserHash[t.loadParser],s||de(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!s){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(e,t,this)){s=a;break}}if(!s)return de(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,t,this),r.parser=s;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(i,t,this)&&(i=await a.parse(i,t,this)||i,r.parser=a)}return i})(),r}async load(e,t){this._parsersValidated||this._validateParsers();let r=0;const i={},s=_s(e),o=Lt(e,u=>({alias:[u],src:u,data:{}})),a=o.length,l=o.map(async u=>{const c=Ct.toAbsolute(u.src);if(!i[u.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,u)),i[u.src]=await this.promiseCache[c].promise,t&&t(++r/a)}catch(h){throw delete this.promiseCache[c],delete i[u.src],new Error(`[Loader.load] Failed to load ${c}.
${h}`)}});return await Promise.all(l),s?i[o[0].src]:i}async unload(e){const r=Lt(e,i=>({alias:[i],src:i})).map(async i=>{const s=Ct.toAbsolute(i.src),o=this.promiseCache[s];if(o){const a=await o.promise;delete this.promiseCache[s],await o.parser?.unload?.(a,i,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,t)=>(t.name?e[t.name]&&de(`[Assets] loadParser name conflict "${t.name}"`):de("[Assets] loadParser should have a name"),{...e,[t.name]:t}),{})}}function Tr(n,e){if(Array.isArray(e)){for(const t of e)if(n.startsWith(`data:${t}`))return!0;return!1}return n.startsWith(`data:${e}`)}function Cr(n,e){const t=n.split("?")[0],r=Ct.extname(t).toLowerCase();return Array.isArray(e)?e.includes(r):r===e}const v1=".json",b1="application/json",x1={extension:{type:M.LoadParser,priority:wn.Low},name:"loadJson",test(n){return Tr(n,b1)||Cr(n,v1)},async load(n){return await(await Se.get().fetch(n)).json()}},y1=".txt",S1="text/plain",w1={name:"loadTxt",extension:{type:M.LoadParser,priority:wn.Low,name:"loadTxt"},test(n){return Tr(n,S1)||Cr(n,y1)},async load(n){return await(await Se.get().fetch(n)).text()}},T1=["normal","bold","100","200","300","400","500","600","700","800","900"],C1=[".ttf",".otf",".woff",".woff2"],P1=["font/ttf","font/otf","font/woff","font/woff2"],A1=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function E1(n){const e=Ct.extname(n),i=Ct.basename(n,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let s=i.length>0;for(const a of i)if(!a.match(A1)){s=!1;break}let o=i.join(" ");return s||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const M1=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function k1(n){return M1.test(n)?n:encodeURI(n)}const R1={extension:{type:M.LoadParser,priority:wn.Low},name:"loadWebFont",test(n){return Tr(n,P1)||Cr(n,C1)},async load(n,e){const t=Se.get().getFontFaceSet();if(t){const r=[],i=e.data?.family??E1(n),s=e.data?.weights?.filter(a=>T1.includes(a))??["normal"],o=e.data??{};for(let a=0;a<s.length;a++){const l=s[a],u=new FontFace(i,`url(${k1(n)})`,{...o,weight:l});await u.load(),t.add(u),r.push(u)}return Oe.set(`${i}-and-url`,{url:n,fontFaces:r}),r.length===1?r[0]:r}return de("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(n){(Array.isArray(n)?n:[n]).forEach(e=>{Oe.remove(e.family),Se.get().getFontFaceSet().delete(e)})}};function rl(n,e=1){const t=Sr.RETINA_PREFIX?.exec(n);return t?parseFloat(t[1]):e}function il(n,e,t){n.label=t,n._sourceOrigin=t;const r=new se({source:n,label:t}),i=()=>{delete e.promiseCache[t],Oe.has(t)&&Oe.remove(t)};return r.source.once("destroy",()=>{e.promiseCache[t]&&(de("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),i())}),r.once("destroy",()=>{n.destroyed||(de("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),r}const B1=".svg",I1="image/svg+xml",F1={extension:{type:M.LoadParser,priority:wn.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(n){return Tr(n,I1)||Cr(n,B1)},async load(n,e,t){return e.data.parseAsGraphicsContext??this.config.parseAsGraphicsContext?U1(n):O1(n,e,t,this.config.crossOrigin)},unload(n){n.destroy(!0)}};async function O1(n,e,t,r){const s=await(await Se.get().fetch(n)).blob(),o=URL.createObjectURL(s),a=new Image;a.src=o,a.crossOrigin=r,await a.decode(),URL.revokeObjectURL(o);const l=document.createElement("canvas"),u=l.getContext("2d"),c=e.data?.resolution||rl(n),h=e.data?.width??a.width,d=e.data?.height??a.height;l.width=h*c,l.height=d*c,u.drawImage(a,0,0,h*c,d*c);const{parseAsGraphicsContext:f,...p}=e.data,g=new Nn({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:c,...p});return il(g,t,n)}async function U1(n){const t=await(await Se.get().fetch(n)).text(),r=new Rt;return r.svg(t),r}const G1=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let cr=null,ma=class{constructor(){cr||(cr=URL.createObjectURL(new Blob([G1],{type:"application/javascript"}))),this.worker=new Worker(cr)}};ma.revokeObjectURL=function(){cr&&(URL.revokeObjectURL(cr),cr=null)};const D1=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let hr=null;class If{constructor(){hr||(hr=URL.createObjectURL(new Blob([D1],{type:"application/javascript"}))),this.worker=new Worker(hr)}}If.revokeObjectURL=function(){hr&&(URL.revokeObjectURL(hr),hr=null)};let Yu=0,Ro;class z1{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:t}=new ma;t.addEventListener("message",r=>{t.terminate(),ma.revokeObjectURL(),e(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,t){return this._run("loadImageBitmap",[e,t?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Ro===void 0&&(Ro=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<Ro&&(this._createdWorkers++,e=new If().worker,e.addEventListener("message",t=>{this._complete(t.data),this._returnWorker(t.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const r=new Promise((i,s)=>{this._queue.push({id:e,arguments:t,resolve:i,reject:s})});return this._next(),r}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const t=this._queue.pop(),r=t.id;this._resolveHash[Yu]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:Yu++,id:r})}}const Ku=new z1,L1=[".jpeg",".jpg",".png",".webp",".avif"],N1=["image/jpeg","image/png","image/webp","image/avif"];async function H1(n,e){const t=await Se.get().fetch(n);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${n}: ${t.status} ${t.statusText}`);const r=await t.blob();return e?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(r,{premultiplyAlpha:"none"}):createImageBitmap(r)}const Ff={name:"loadTextures",extension:{type:M.LoadParser,priority:wn.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(n){return Tr(n,N1)||Cr(n,L1)},async load(n,e,t){let r=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Ku.isImageBitmapSupported()?r=await Ku.loadImageBitmap(n,e):r=await H1(n,e):r=await new Promise(s=>{r=new Image,r.crossOrigin=this.config.crossOrigin,r.src=n,r.complete?s(r):r.onload=()=>{s(r)}});const i=new Nn({resource:r,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||rl(n),...e.data});return il(i,t,n)},unload(n){n.destroy(!0)}},Of=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],V1=Of.map(n=>`video/${n.substring(1)}`);function W1(n,e,t){t===void 0&&!e.startsWith("data:")?n.crossOrigin=X1(e):t!==!1&&(n.crossOrigin=typeof t=="string"?t:"anonymous")}function j1(n){return new Promise((e,t)=>{n.addEventListener("canplaythrough",r),n.addEventListener("error",i),n.load();function r(){s(),e()}function i(o){s(),t(o)}function s(){n.removeEventListener("canplaythrough",r),n.removeEventListener("error",i)}})}function X1(n,e=globalThis.location){if(n.startsWith("data:"))return"";e=e||globalThis.location;const t=new URL(n,document.baseURI);return t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol?"anonymous":""}const q1={name:"loadVideo",extension:{type:M.LoadParser,name:"loadVideo"},test(n){const e=Tr(n,V1),t=Cr(n,Of);return e||t},async load(n,e,t){const r={...Zi.defaultOptions,resolution:e.data?.resolution||rl(n),alphaMode:e.data?.alphaMode||await Uh(),...e.data},i=document.createElement("video"),s={preload:r.autoLoad!==!1?"auto":void 0,"webkit-playsinline":r.playsinline!==!1?"":void 0,playsinline:r.playsinline!==!1?"":void 0,muted:r.muted===!0?"":void 0,loop:r.loop===!0?"":void 0,autoplay:r.autoPlay!==!1?"":void 0};Object.keys(s).forEach(l=>{const u=s[l];u!==void 0&&i.setAttribute(l,u)}),r.muted===!0&&(i.muted=!0),W1(i,n,r.crossorigin);const o=document.createElement("source");let a;if(n.startsWith("data:"))a=n.slice(5,n.indexOf(";"));else if(!n.startsWith("blob:")){const l=n.split("?")[0].slice(n.lastIndexOf(".")+1).toLowerCase();a=Zi.MIME_TYPES[l]||`video/${l}`}return o.src=n,a&&(o.type=a),new Promise(l=>{const u=async()=>{const c=new Zi({...r,resource:i});i.removeEventListener("canplay",u),e.data.preload&&await j1(i),l(il(c,t,n))};i.addEventListener("canplay",u),i.appendChild(o)})},unload(n){n.destroy(!0)}},Uf={extension:{type:M.ResolveParser,name:"resolveTexture"},test:Ff.test,parse:n=>({resolution:parseFloat(Sr.RETINA_PREFIX.exec(n)?.[1]??"1"),format:n.split(".").pop(),src:n})},Y1={extension:{type:M.ResolveParser,priority:-2,name:"resolveJson"},test:n=>Sr.RETINA_PREFIX.test(n)&&n.endsWith(".json"),parse:Uf.parse};class K1{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Sr,this.loader=new _1,this.cache=Oe,this._backgroundLoader=new l1(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){de("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let s=e.manifest;typeof s=="string"&&(s=await this.load(s)),this.resolver.addManifest(s)}const t=e.texturePreference?.resolution??1,r=typeof t=="number"?[t]:t,i=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:r}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,t){this._initialized||await this.init();const r=_s(e),i=Lt(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(u=>!this.resolver.hasKey(u))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,t);return r?o[i[0]]:o}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let r=!1;typeof e=="string"&&(r=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let a=0,l=0;const u=()=>{t?.(++a/l)},c=o.map(h=>{const d=i[h];return l+=Object.keys(d).length,this._mapLoadToResolve(d,u).then(f=>{s[h]=f})});return await Promise.all(c),r?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Oe.get(e);const t={};for(let r=0;r<e.length;r++)t[r]=Oe.get(e[r]);return t}async _mapLoadToResolve(e,t){const r=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const i=await this.loader.load(r,t);this._backgroundLoader.active=!0;const s={};return r.forEach(o=>{const a=i[o.src],l=[o.src];o.alias&&l.push(...o.alias),l.forEach(u=>{s[u]=a}),Oe.set(l,a)}),s}async unload(e){this._initialized||await this.init();const t=Lt(e).map(i=>typeof i!="string"?i.src:i),r=this.resolver.resolve(t);await this._unloadFromResolved(r)}async unloadBundle(e){this._initialized||await this.init(),e=Lt(e);const t=this.resolver.resolveBundle(e),r=Object.keys(t).map(i=>this._unloadFromResolved(t[i]));await Promise.all(r)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(r=>{Oe.remove(r.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const r of e.detections)e.skipDetections||await r.test()?t=await r.add(t):e.skipDetections||(t=await r.remove(t));return t=t.filter((r,i)=>t.indexOf(r)===i),t}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(r=>r in e).forEach(r=>{t.config[r]=e[r]})})}}const Nr=new K1;pe.handleByList(M.LoadParser,Nr.loader.parsers).handleByList(M.ResolveParser,Nr.resolver.parsers).handleByList(M.CacheParser,Nr.cache.parsers).handleByList(M.DetectionParser,Nr.detections);pe.add(u1,h1,c1,g1,d1,p1,m1,x1,w1,R1,F1,Ff,q1,a1,o1,Uf,Y1);const Zu={loader:M.LoadParser,resolver:M.ResolveParser,cache:M.CacheParser,detection:M.DetectionParser};pe.handle(M.Asset,n=>{const e=n.ref;Object.entries(Zu).filter(([t])=>!!e[t]).forEach(([t,r])=>pe.add(Object.assign(e[t],{extension:e[t].extension??r})))},n=>{const e=n.ref;Object.keys(Zu).filter(t=>!!e[t]).forEach(t=>pe.remove(e[t]))});class Z1{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this._tickerAdded||!this.domElement||($t.system.add(this._tickerUpdate,this,$r.INTERACTION),this._tickerAdded=!0)}removeTickerListener(){this._tickerAdded&&($t.system.remove(this._tickerUpdate,this),this._tickerAdded=!1)}pointerMoved(){this._didMove=!0}_update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events._rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY,pointerType:e.pointerType,pointerId:e.pointerId}))}_tickerUpdate(e){this._deltaTime+=e.deltaTime,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this._update())}}const _n=new Z1;class ws extends ui{constructor(){super(...arguments),this.client=new ke,this.movement=new ke,this.offset=new ke,this.global=new ke,this.screen=new ke}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,r){return e.worldTransform.applyInverse(r||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,r,i,s,o,a,l,u,c,h,d,f,p,g){throw new Error("Method not implemented.")}}class zt extends ws{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class xr extends ws{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}xr.DOM_DELTA_PIXEL=0;xr.DOM_DELTA_LINE=1;xr.DOM_DELTA_PAGE=2;const Q1=2048,J1=new ke,Ur=new ke;class $1{constructor(e){this.dispatch=new At,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((r,i)=>r.priority-i.priority)}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const t=this.mappingTable[e.type];if(t)for(let r=0,i=t.length;r<i;r++)t[r].fn(e);else de(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){_n.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",s=this[i](this.rootTarget,this.rootTarget.eventMode,J1.set(e,t),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(e,t){if(!e.target)return;const r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=r.length-1;i<s;i++)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=r.length-2;i>=0;i--)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,r=this._allInteractiveElements){if(r.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(t)?t:[t];for(let s=r.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=r[s],this.notifyTarget(e,o)})}propagationPath(e){const t=[e];for(let r=0;r<Q1&&e!==this.rootTarget&&e.parent;r++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestMoveRecursive(e,t,r,i,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&(_n.pauseUpdate=!1),e.interactiveChildren&&e.children){const c=e.children;for(let h=c.length-1;h>=0;h--){const d=c[h],f=this.hitTestMoveRecursive(d,this._isInteractive(t)?t:d.eventMode,r,i,s,o||s(e,r));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=e.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(e),f.push(e)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const l=this._isInteractive(t),u=e.isInteractive();return u&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,r)&&i(e,r)?u?[e]:[]:null}hitTestRecursive(e,t,r,i,s){if(this._interactivePrune(e)||s(e,r))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&(_n.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children,u=r;for(let c=l.length-1;c>=0;c--){const h=l[c],d=this.hitTestRecursive(h,this._isInteractive(t)?t:h.eventMode,u,i,s);if(d){if(d.length>0&&!d[d.length-1].parent)continue;const f=e.isInteractive();return(d.length>0||f)&&d.push(e),d}}}const o=this._isInteractive(t),a=e.isInteractive();return o&&i(e,r)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!e||!e.visible||!e.renderable||!e.includeInBuild||!e.measurable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren}hitPruneFn(e,t){if(e.hitArea&&(e.worldTransform.applyInverse(t,Ur),!e.hitArea.contains(Ur.x,Ur.y)))return!0;if(e.effects&&e.effects.length)for(let r=0;r<e.effects.length;r++){const i=e.effects[r];if(i.containsPoint&&!i.containsPoint(t,this.hitTestFn))return!0}return!1}hitTestFn(e,t){return e.hitArea?!0:e?.containsPoint?(e.worldTransform.applyInverse(t,Ur),e.containsPoint(Ur)):!1}notifyTarget(e,t){if(!e.currentTarget.isInteractive())return;t=t??e.type;const r=`on${t}`;e.currentTarget[r]?.(e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this._notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this._notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof zt)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),t.pointerType==="touch")this.dispatchEvent(t,"touchstart");else if(t.pointerType==="mouse"||t.pointerType==="pen"){const i=t.button===2;this.dispatchEvent(t,i?"rightdown":"mousedown")}const r=this.trackingData(e.pointerId);r.pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){if(!(e instanceof zt)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const r=t.pointerType==="mouse"||t.pointerType==="pen",i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(i.overTargets?.length>0&&s!==t.target){const l=e.type==="mousemove"?"mouseout":"pointerout",u=this.createPointerEvent(e,l,s);if(this.dispatchEvent(u,"pointerout"),r&&this.dispatchEvent(u,"mouseout"),!t.composedPath().includes(s)){const c=this.createPointerEvent(e,"pointerleave",s);for(c.eventPhase=c.AT_TARGET;c.target&&!t.composedPath().includes(c.target);)c.currentTarget=c.target,this.notifyTarget(c),r&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(u)}if(s!==t.target){const l=e.type==="mousemove"?"mouseover":"pointerover",u=this.clonePointerEvent(t,l);this.dispatchEvent(u,"pointerover"),r&&this.dispatchEvent(u,"mouseover");let c=s?.parent;for(;c&&c!==this.rootTarget.parent&&c!==t.target;)c=c.parent;if(!c||c===this.rootTarget.parent){const d=this.clonePointerEvent(t,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==s&&d.target!==this.rootTarget.parent;)d.currentTarget=d.target,this.notifyTarget(d),r&&this.notifyTarget(d,"mouseenter"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(u)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(t,"pointermove"),a&&o.push("globalpointermove"),t.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),a&&o.push("globaltouchmove")),r&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),a&&o.push("globalmousemove"),this.cursor=t.target?.cursor),o.length>0&&this.all(t,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){if(!(e instanceof zt)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),r=this.createPointerEvent(e),i=r.pointerType==="mouse"||r.pointerType==="pen";this.dispatchEvent(r,"pointerover"),i&&this.dispatchEvent(r,"mouseover"),r.pointerType==="mouse"&&(this.cursor=r.target?.cursor);const s=this.clonePointerEvent(r,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;t.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof zt)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId);if(t.overTargets){const r=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(t.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),r&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),r&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;t.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof zt)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=performance.now(),r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerup"),r.pointerType==="touch")this.dispatchEvent(r,"touchend");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const a=r.button===2;this.dispatchEvent(r,a?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!r.composedPath().includes(s)){let a=s;for(;a&&!r.composedPath().includes(a);){if(r.currentTarget=a,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch")this.notifyTarget(r,"touchendoutside");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const l=r.button===2;this.notifyTarget(r,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(r,"click");a.target=o,a.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:t});const l=i.clicksByButton[e.button];if(l.target===a.target&&t-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=t,a.detail=l.clickCount,a.pointerType==="mouse"){const u=a.button===2;this.dispatchEvent(a,u?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(r)}mapPointerUpOutside(e){if(!(e instanceof zt)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),r=this.findMountedTarget(t.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(r){let s=r;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof xr)){de("EventBoundary cannot map a non-wheel event as a wheel event");return}const t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let r=1;r<e.length&&e[r].parent===t;r++)t=e[r];return t}createPointerEvent(e,t,r){const i=this.allocateEvent(zt);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=r??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof t=="string"&&(i.type=t),i}createWheelEvent(e){const t=this.allocateEvent(xr);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){const r=this.allocateEvent(zt);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t??r.type,r}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof zt&&t instanceof zt&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof ws&&t instanceof ws&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}_notifyListeners(e,t){const r=e.currentTarget._events[t];if(r)if("fn"in r)r.once&&e.currentTarget.removeListener(t,r.fn,void 0,!0),r.fn.call(r.context,e);else for(let i=0,s=r.length;i<s&&!e.propagationImmediatelyStopped;i++)r[i].once&&e.currentTarget.removeListener(t,r[i].fn,void 0,!0),r[i].fn.call(r[i].context,e)}}const ex=1,tx={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},sl=class ga{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new $1(null),_n.init(this),this.autoPreventDefault=!0,this._eventsAdded=!1,this._rootPointerEvent=new zt(null),this._rootWheelEvent=new xr(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...ga.defaultEventFeatures},{set:(t,r,i)=>(r==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),t[r]=i,!0)}),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerUp=this._onPointerUp.bind(this),this._onPointerOverOut=this._onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{canvas:t,resolution:r}=this.renderer;this.setTargetElement(t),this.resolution=r,ga._defaultEventMode=e.eventMode??"passive",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null,this._currentCursor=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this._currentCursor===e)return;this._currentCursor=e;const r=this.cursorStyles[e];if(r)switch(typeof r){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.domElement.style,r);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this._rootPointerEvent}_onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this._normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let r=0,i=t.length;r<i;r++){const s=t[r],o=this._bootstrapEvent(this._rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}_onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,_n.pointerMoved();const t=this._normalizeToPointerData(e);for(let r=0,i=t.length;r<i;r++){const s=this._bootstrapEvent(this._rootPointerEvent,t[r]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}_onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const r=t!==this.domElement?"outside":"",i=this._normalizeToPointerData(e);for(let s=0,o=i.length;s<o;s++){const a=this._bootstrapEvent(this._rootPointerEvent,i[s]);a.type+=r,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}_onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this._normalizeToPointerData(e);for(let r=0,i=t.length;r<i;r++){const s=this._bootstrapEvent(this._rootPointerEvent,t[r]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this._removeEvents(),this.domElement=e,_n.domElement=e,this._addEvents()}_addEvents(){if(this._eventsAdded||!this.domElement)return;_n.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this._onPointerMove,!0),this.domElement.addEventListener("pointerdown",this._onPointerDown,!0),this.domElement.addEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this._onPointerOverOut,!0),globalThis.addEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this._onPointerMove,!0),this.domElement.addEventListener("mousedown",this._onPointerDown,!0),this.domElement.addEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this._onPointerOverOut,!0),globalThis.addEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this._onPointerDown,!0),this.domElement.addEventListener("touchend",this._onPointerUp,!0),this.domElement.addEventListener("touchmove",this._onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this._eventsAdded=!0}_removeEvents(){if(!this._eventsAdded||!this.domElement)return;_n.removeTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction="")),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this._onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this._onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this._onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this._onPointerMove,!0),this.domElement.removeEventListener("mousedown",this._onPointerDown,!0),this.domElement.removeEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this._onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this._onPointerDown,!0),this.domElement.removeEventListener("touchend",this._onPointerUp,!0),this.domElement.removeEventListener("touchmove",this._onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this._eventsAdded=!1}mapPositionToPoint(e,t,r){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(t-i.left)*(this.domElement.width/i.width)*s,e.y=(r-i.top)*(this.domElement.height/i.height)*s}_normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let r=0,i=e.changedTouches.length;r<i;r++){const s=e.changedTouches[r];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,t.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const r=e;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=ex),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,t.push(r)}else t.push(e);return t}normalizeWheelEvent(e){const t=this._rootWheelEvent;return this._transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}_bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this._transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=tx[e.type]||e.type),e}_transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};sl.extension={name:"events",type:[M.WebGLSystem,M.CanvasSystem,M.WebGPUSystem],priority:-1};sl.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let Gf=sl;const nx={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,get interactive(){return this.eventMode==="dynamic"||this.eventMode==="static"},set interactive(n){this.eventMode=n?"static":"passive"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Gf.defaultEventMode},set eventMode(n){this._internalEventMode=n},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(n,e,t){const r=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,i=typeof t=="object"?t.signal:void 0,s=typeof t=="object"?t.once===!0:!1,o=typeof e=="function"?void 0:e;n=r?`${n}capture`:n;const a=typeof e=="function"?e:e.handleEvent,l=this;i&&i.addEventListener("abort",()=>{l.off(n,a,o)}),s?l.once(n,a,o):l.on(n,a,o)},removeEventListener(n,e,t){const r=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,i=typeof e=="function"?void 0:e;n=r?`${n}capture`:n,e=typeof e=="function"?e:e.handleEvent,this.off(n,e,i)},dispatchEvent(n){if(!(n instanceof ui))throw new Error("Container cannot propagate events outside of the Federated Events API");return n.defaultPrevented=!1,n.path=null,n.target=this,n.manager.dispatchEvent(n),!n.defaultPrevented}};var rx=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,ix=`
in vec2 vTextureCoord;

out vec4 finalColor;

uniform float uAlpha;
uniform sampler2D uTexture;

void main()
{
    finalColor =  texture(uTexture, vTextureCoord) * uAlpha;
}
`,Qu=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct AlphaUniforms {
  uAlpha:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> alphaUniforms : AlphaUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
 
    var sample = textureSample(uTexture, uSampler, uv);
    
    return sample * alphaUniforms.uAlpha;
}`;const Df=class zf extends xe{constructor(e){e={...zf.defaultOptions,...e};const t=ge.from({vertex:{source:Qu,entryPoint:"mainVertex"},fragment:{source:Qu,entryPoint:"mainFragment"}}),r=_e.from({vertex:rx,fragment:ix,name:"alpha-filter"}),{alpha:i,...s}=e,o=new gt({uAlpha:{value:i,type:"f32"}});super({...s,gpuProgram:t,glProgram:r,resources:{alphaUniforms:o}})}get alpha(){return this.resources.alphaUniforms.uniforms.uAlpha}set alpha(e){this.resources.alphaUniforms.uniforms.uAlpha=e}};Df.defaultOptions={alpha:1};let sx=Df,ox=0;class ax{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1}createTexture(e,t,r){const i=new Je({...this.textureOptions,width:e,height:t,resolution:1,antialias:r,autoGarbageCollect:!0});return new se({source:i,label:`texturePool_${ox++}`})}getOptimalTexture(e,t,r=1,i){let s=Math.ceil(e*r-1e-6),o=Math.ceil(t*r-1e-6);s=_r(s),o=_r(o);const a=(s<<17)+(o<<1)+(i?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(s,o,i)),l.source._resolution=r,l.source.width=s/r,l.source.height=o/r,l.source.pixelWidth=s,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=t,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(e,t=!1){const r=e.source;return this.getOptimalTexture(e.width,e.height,r._resolution,t)}returnTexture(e){const t=this._poolKeyHash[e.uid];this._texturePool[t].push(e)}clear(e){if(e=e!==!1,e)for(const t in this._texturePool){const r=this._texturePool[t];if(r)for(let i=0;i<r.length;i++)r[i].destroy(!0)}this._texturePool={}}}const Me=new ax,Lf={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},lx=["in vec2 vBlurTexCoords[%size%];","uniform sampler2D uTexture;","out vec4 finalColor;","void main(void)","{","    finalColor = vec4(0.0);","    %blur%","}"].join(`
`);function ux(n){const e=Lf[n],t=e.length;let r=lx,i="";const s="finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<n;a++){let l=s.replace("%index%",a.toString());o=a,a>=t&&(o=n-a-1),l=l.replace("%value%",e[o].toString()),i+=l,i+=`
`}return r=r.replace("%blur%",i),r=r.replace("%size%",n.toString()),r}const cx=`
    in vec2 aPosition;

    uniform float uStrength;

    out vec2 vBlurTexCoords[%size%];

    uniform vec4 uInputSize;
    uniform vec4 uOutputFrame;
    uniform vec4 uOutputTexture;

    vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

    vec2 filterTextureCoord( void )
    {
        return aPosition * (uOutputFrame.zw * uInputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        float pixelStrength = uInputSize.%dimension% * uStrength;

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function hx(n,e){const t=Math.ceil(n/2);let r=cx,i="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);";for(let o=0;o<n;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(t-1)}.0`),i+=a,i+=`
`}return r=r.replace("%blur%",i),r=r.replace("%size%",n.toString()),r=r.replace("%dimension%",e?"z":"w"),r}function fx(n,e){const t=hx(e,n),r=ux(e);return _e.from({vertex:t,fragment:r,name:`blur-${n?"horizontal":"vertical"}-pass-filter`})}var dx=`

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlurUniforms {
  uStrength:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    %blur-struct%
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}


@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {

  let filteredCord = filterTextureCoord(aPosition);

  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;

  return VSOutput(
   filterVertexPosition(aPosition),
    %blur-vertex-out%
  );
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  %blur-fragment-in%
) -> @location(0) vec4<f32> {

    var   finalColor = vec4(0.0);

    %blur-sampling%

    return finalColor;
}`;function px(n,e){const t=Lf[e],r=t.length,i=[],s=[],o=[];for(let h=0;h<e;h++){i[h]=`@location(${h}) offset${h}: vec2<f32>,`,n?s[h]=`filteredCord + vec2(${h-r+1} * pixelStrength, 0.0),`:s[h]=`filteredCord + vec2(0.0, ${h-r+1} * pixelStrength),`;const d=h<r?h:e-h-1,f=t[d].toString();o[h]=`finalColor += textureSample(uTexture, uSampler, offset${h}) * ${f};`}const a=i.join(`
`),l=s.join(`
`),u=o.join(`
`),c=dx.replace("%blur-struct%",a).replace("%blur-vertex-out%",l).replace("%blur-fragment-in%",a).replace("%blur-sampling%",u).replace("%dimension%",n?"z":"w");return ge.from({vertex:{source:c,entryPoint:"mainVertex"},fragment:{source:c,entryPoint:"mainFragment"}})}const Nf=class Hf extends xe{constructor(e){e={...Hf.defaultOptions,...e};const t=fx(e.horizontal,e.kernelSize),r=px(e.horizontal,e.kernelSize);super({glProgram:t,gpuProgram:r,resources:{blurUniforms:{uStrength:{value:0,type:"f32"}}},...e}),this.horizontal=e.horizontal,this._quality=0,this.quality=e.quality,this.blur=e.strength,this._uniforms=this.resources.blurUniforms.uniforms}apply(e,t,r,i){if(this._uniforms.uStrength=this.strength/this.passes,this.passes===1)e.applyFilter(this,t,r,i);else{const s=Me.getSameSizeTexture(t);let o=t,a=s;this._state.blend=!1;const l=e.renderer.type===Pt.WEBGPU;for(let u=0;u<this.passes-1;u++){e.applyFilter(this,o,a,u===0?!0:l);const c=a;a=o,o=c}this._state.blend=!0,e.applyFilter(this,o,r,i),Me.returnTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}};Nf.defaultOptions={strength:8,quality:4,kernelSize:5};let Yr=Nf;class Ji extends xe{constructor(...e){let t=e[0]??{};typeof t=="number"&&(ie(we,"BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }"),t={strength:t},e[1]!==void 0&&(t.quality=e[1]),e[2]!==void 0&&(t.resolution=e[2]||"inherit"),e[3]!==void 0&&(t.kernelSize=e[3])),t={...Yr.defaultOptions,...t};const{strength:r,strengthX:i,strengthY:s,quality:o,...a}=t;super({...a,compatibleRenderers:Pt.BOTH,resources:{}}),this._repeatEdgePixels=!1,this.blurXFilter=new Yr({horizontal:!0,...t}),this.blurYFilter=new Yr({horizontal:!1,...t}),this.quality=o,this.strengthX=i??r,this.strengthY=s??r,this.repeatEdgePixels=!1}apply(e,t,r,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=Me.getSameSizeTexture(t);this.blurXFilter.blendMode="normal",this.blurXFilter.apply(e,t,a,!0),this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,a,r,i),Me.returnTexture(a)}else o?(this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,t,r,i)):(this.blurXFilter.blendMode=this.blendMode,this.blurXFilter.apply(e,t,r,i))}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.blur),Math.abs(this.blurYFilter.blur))*2}get strength(){if(this.strengthX!==this.strengthY)throw new Error("BlurFilter's strengthX and strengthY are different");return this.strengthX}set strength(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get strengthX(){return this.blurXFilter.blur}set strengthX(e){this.blurXFilter.blur=e,this.updatePadding()}get strengthY(){return this.blurYFilter.blur}set strengthY(e){this.blurYFilter.blur=e,this.updatePadding()}get blur(){return ie("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength}set blur(e){ie("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength=e}get blurX(){return ie("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX}set blurX(e){ie("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX=e}get blurY(){return ie("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY}set blurY(e){ie("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}Ji.defaultOptions={strength:8,quality:4,kernelSize:5};class Vf{constructor(e){this._renderer=e}push(e,t,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"filter",canBundle:!1,action:"pushFilter",container:t,filterEffect:e})}pop(e,t,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}execute(e){e.action==="pushFilter"?this._renderer.filter.push(e):e.action==="popFilter"&&this._renderer.filter.pop()}destroy(){this._renderer=null}}Vf.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"filter"};const mx=new ue;function gx(n,e){return e.clear(),Wf(n,e),e.isValid||e.set(0,0,0,0),n.renderGroup?e.applyMatrix(n.renderGroup.localTransform):e.applyMatrix(n.parentRenderGroup.worldTransform),e}function Wf(n,e){if(n.localDisplayStatus!==7||!n.measurable)return;const t=!!n.effects.length;let r=e;if((n.renderGroup||t)&&(r=cn.get().clear()),n.boundsArea)e.addRect(n.boundsArea,n.worldTransform);else{if(n.renderPipeId){const s=n.bounds;r.addFrame(s.minX,s.minY,s.maxX,s.maxY,n.groupTransform)}const i=n.children;for(let s=0;s<i.length;s++)Wf(i[s],r)}if(t){let i=!1;for(let s=0;s<n.effects.length;s++)n.effects[s].addBounds&&(i||(i=!0,r.applyMatrix(n.parentRenderGroup.worldTransform)),n.effects[s].addBounds(r,!0));i&&(r.applyMatrix(n.parentRenderGroup.worldTransform.copyTo(mx).invert()),e.addBounds(r,n.relativeGroupTransform)),e.addBounds(r),cn.return(r)}else n.renderGroup&&(e.addBounds(r,n.relativeGroupTransform),cn.return(r))}function _x(n,e){e.clear();const t=e.matrix;for(let r=0;r<n.length;r++){const i=n[r];i.globalDisplayStatus<7||(e.matrix=i.worldTransform,i.addBounds(e))}return e.matrix=t,e}const vx=new ks({attributes:{aPosition:{buffer:new Float32Array([0,0,1,0,1,1,0,1]),format:"float32x2",stride:2*4,offset:0}},indexBuffer:new Uint32Array([0,1,2,0,2,3])});class jf{constructor(e){this._filterStackIndex=0,this._filterStack=[],this._filterGlobalUniforms=new gt({uInputSize:{value:new Float32Array(4),type:"vec4<f32>"},uInputPixel:{value:new Float32Array(4),type:"vec4<f32>"},uInputClamp:{value:new Float32Array(4),type:"vec4<f32>"},uOutputFrame:{value:new Float32Array(4),type:"vec4<f32>"},uGlobalFrame:{value:new Float32Array(4),type:"vec4<f32>"},uOutputTexture:{value:new Float32Array(4),type:"vec4<f32>"}}),this._globalFilterBindGroup=new hn({}),this.renderer=e}get activeBackTexture(){return this._activeFilterData?.backTexture}push(e){const t=this.renderer,r=e.filterEffect.filters;this._filterStack[this._filterStackIndex]||(this._filterStack[this._filterStackIndex]=this._getFilterData());const i=this._filterStack[this._filterStackIndex];if(this._filterStackIndex++,r.length===0){i.skip=!0;return}const s=i.bounds;e.renderables?_x(e.renderables,s):e.filterEffect.filterArea?(s.clear(),s.addRect(e.filterEffect.filterArea),s.applyMatrix(e.container.worldTransform)):gx(e.container,s);const o=t.renderTarget.renderTarget.colorTexture.source;let a=1/0,l=0,u=!0,c=!1,h=!1;for(let f=0;f<r.length;f++){const p=r[f];if(a=Math.min(a,p.resolution==="inherit"?o._resolution:p.resolution),l+=p.padding,p.antialias==="off"?u=!1:p.antialias==="inherit"&&u&&(u=o.antialias),!!!(p.compatibleRenderers&t.type)){h=!1;break}if(p.blendRequired&&!(t.backBuffer?.useBackBuffer??!0)){de("Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options."),h=!1;break}h=p.enabled||h,c=c||p.blendRequired}if(!h){i.skip=!0;return}const d=t.renderTarget.rootViewPort;if(s.scale(a).fitBounds(0,d.width,0,d.height).ceil().scale(1/a).pad(l|0),!s.isPositive){i.skip=!0;return}i.skip=!1,i.bounds=s,i.blendRequired=c,i.container=e.container,i.filterEffect=e.filterEffect,i.previousRenderSurface=t.renderTarget.renderSurface,i.inputTexture=Me.getOptimalTexture(s.width,s.height,a,u),t.renderTarget.bind(i.inputTexture,!0),t.globalUniforms.push({offset:s})}pop(){const e=this.renderer;this._filterStackIndex--;const t=this._filterStack[this._filterStackIndex];if(t.skip)return;this._activeFilterData=t;const r=t.inputTexture,i=t.bounds;let s=se.EMPTY;if(e.renderTarget.finishRenderPass(),t.blendRequired){const a=this._filterStackIndex>0?this._filterStack[this._filterStackIndex-1].bounds:null,l=e.renderTarget.getRenderTarget(t.previousRenderSurface);s=this.getBackTexture(l,i,a)}t.backTexture=s;const o=t.filterEffect.filters;if(this._globalFilterBindGroup.setResource(r.source.style,2),this._globalFilterBindGroup.setResource(s.source,3),e.globalUniforms.pop(),o.length===1)o[0].apply(this,r,t.previousRenderSurface,!1),Me.returnTexture(r);else{let a=t.inputTexture,l=Me.getOptimalTexture(i.width,i.height,a.source._resolution,!1),u=0;for(u=0;u<o.length-1;++u){o[u].apply(this,a,l,!0);const h=a;a=l,l=h}o[u].apply(this,a,t.previousRenderSurface,!1),Me.returnTexture(a),Me.returnTexture(l)}t.blendRequired&&Me.returnTexture(s)}getBackTexture(e,t,r){const i=e.colorTexture.source._resolution,s=Me.getOptimalTexture(t.width,t.height,i,!1);let o=t.minX,a=t.minY;r&&(o-=r.minX,a-=r.minY),o=Math.floor(o*i),a=Math.floor(a*i);const l=Math.ceil(t.width*i),u=Math.ceil(t.height*i);return this.renderer.renderTarget.copyToTexture(e,s,{x:o,y:a},{width:l,height:u},{x:0,y:0}),s}applyFilter(e,t,r,i){const s=this.renderer,o=this._filterStack[this._filterStackIndex],a=o.bounds,l=ke.shared,c=o.previousRenderSurface===r;let h=this.renderer.renderTarget.rootRenderTarget.colorTexture.source._resolution,d=this._filterStackIndex-1;for(;d>0&&this._filterStack[d].skip;)--d;d>0&&(h=this._filterStack[d].inputTexture.source._resolution);const f=this._filterGlobalUniforms,p=f.uniforms,g=p.uOutputFrame,m=p.uInputSize,v=p.uInputPixel,x=p.uInputClamp,S=p.uGlobalFrame,y=p.uOutputTexture;if(c){let A=this._filterStackIndex;for(;A>0;){A--;const U=this._filterStack[this._filterStackIndex-1];if(!U.skip){l.x=U.bounds.minX,l.y=U.bounds.minY;break}}g[0]=a.minX-l.x,g[1]=a.minY-l.y}else g[0]=0,g[1]=0;g[2]=t.frame.width,g[3]=t.frame.height,m[0]=t.source.width,m[1]=t.source.height,m[2]=1/m[0],m[3]=1/m[1],v[0]=t.source.pixelWidth,v[1]=t.source.pixelHeight,v[2]=1/v[0],v[3]=1/v[1],x[0]=.5*v[2],x[1]=.5*v[3],x[2]=t.frame.width*m[2]-.5*v[2],x[3]=t.frame.height*m[3]-.5*v[3];const b=this.renderer.renderTarget.rootRenderTarget.colorTexture;S[0]=l.x*h,S[1]=l.y*h,S[2]=b.source.width*h,S[3]=b.source.height*h;const B=this.renderer.renderTarget.getRenderTarget(r);if(s.renderTarget.bind(r,!!i),r instanceof se?(y[0]=r.frame.width,y[1]=r.frame.height):(y[0]=B.width,y[1]=B.height),y[2]=B.isRoot?-1:1,f.update(),s.renderPipes.uniformBatch){const A=s.renderPipes.uniformBatch.getUboResource(f);this._globalFilterBindGroup.setResource(A,0)}else this._globalFilterBindGroup.setResource(f,0);this._globalFilterBindGroup.setResource(t.source,1),this._globalFilterBindGroup.setResource(t.source.style,2),e.groups[0]=this._globalFilterBindGroup,s.encoder.draw({geometry:vx,shader:e,state:e._state,topology:"triangle-list"}),s.type===Pt.WEBGL&&s.renderTarget.finishRenderPass()}_getFilterData(){return{skip:!1,inputTexture:null,bounds:new vt,container:null,filterEffect:null,blendRequired:!1,previousRenderSurface:null}}calculateSpriteMatrix(e,t){const r=this._activeFilterData,i=e.set(r.inputTexture._source.width,0,0,r.inputTexture._source.height,r.bounds.minX,r.bounds.minY),s=t.worldTransform.copyTo(ue.shared);return s.invert(),i.prepend(s),i.scale(1/t.texture.frame.width,1/t.texture.frame.height),i.translate(t.anchor.x,t.anchor.y),i}}jf.extension={type:[M.WebGLSystem,M.WebGPUSystem],name:"filter"};var bx=`in vec2 vMaskCoord;
in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform sampler2D uMaskTexture;

uniform float uAlpha;
uniform vec4 uMaskClamp;

out vec4 finalColor;

void main(void)
{
    float clip = step(3.5,
        step(uMaskClamp.x, vMaskCoord.x) +
        step(uMaskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, uMaskClamp.z) +
        step(vMaskCoord.y, uMaskClamp.w));

    // TODO look into why this is needed
    float npmAlpha = uAlpha; 
    vec4 original = texture(uTexture, vTextureCoord);
    vec4 masky = texture(uMaskTexture, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * uAlpha * clip);

    finalColor = original;
}
`,xx=`in vec2 aPosition;

out vec2 vTextureCoord;
out vec2 vMaskCoord;


uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;
uniform mat3 uFilterMatrix;

vec4 filterVertexPosition(  vec2 aPosition )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
       
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord(  vec2 aPosition )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

vec2 getFilterCoord( vec2 aPosition )
{
    return  ( uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}   

void main(void)
{
    gl_Position = filterVertexPosition(aPosition);
    vTextureCoord = filterTextureCoord(aPosition);
    vMaskCoord = getFilterCoord(aPosition);
}
`,Ju=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,  
};

struct MaskUniforms {
  uFilterMatrix:mat3x3<f32>,
  uMaskClamp:vec4<f32>,
  uAlpha:f32,
};


@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> filterUniforms : MaskUniforms;
@group(1) @binding(1) var uMaskTexture: texture_2d<f32>;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) filterUv : vec2<f32>,
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getFilterCoord(aPosition:vec2<f32> ) -> vec2<f32>
{
  return ( filterUniforms.uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}

fn getSize() -> vec2<f32>
{

  
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition),
   getFilterCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @location(1) filterUv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    var maskClamp = filterUniforms.uMaskClamp;

     var clip = step(3.5,
        step(maskClamp.x, filterUv.x) +
        step(maskClamp.y, filterUv.y) +
        step(filterUv.x, maskClamp.z) +
        step(filterUv.y, maskClamp.w));

    var mask = textureSample(uMaskTexture, uSampler, filterUv);
    var source = textureSample(uTexture, uSampler, uv);
    
    var npmAlpha = 0.0;

    var alphaMul = 1.0 - npmAlpha * (1.0 - mask.a);

    var a = (alphaMul * mask.r) * clip;

    return vec4(source.rgb, source.a) * a;
}`;class yx extends xe{constructor(e){const{sprite:t,...r}=e,i=new xh(t.texture),s=new gt({uFilterMatrix:{value:new ue,type:"mat3x3<f32>"},uMaskClamp:{value:i.uClampFrame,type:"vec4<f32>"},uAlpha:{value:1,type:"f32"}}),o=ge.from({vertex:{source:Ju,entryPoint:"mainVertex"},fragment:{source:Ju,entryPoint:"mainFragment"}}),a=_e.from({vertex:xx,fragment:bx,name:"mask-filter"});super({...r,gpuProgram:o,glProgram:a,resources:{filterUniforms:s,uMaskTexture:t.texture.source}}),this.sprite=t,this._textureMatrix=i}apply(e,t,r,i){this._textureMatrix.texture=this.sprite.texture,e.calculateSpriteMatrix(this.resources.filterUniforms.uniforms.uFilterMatrix,this.sprite).prepend(this._textureMatrix.mapCoord),this.resources.uMaskTexture=this.sprite.texture.source,e.applyFilter(this,t,r,i)}}class ai extends za{constructor(e){e instanceof Rt&&(e={context:e});const{context:t,roundPixels:r,...i}=e||{};super({label:"Graphics",...i}),this.renderPipeId="graphics",t?this._context=t:this._context=this._ownedContext=new Rt,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=r??!1}set context(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}addBounds(e){e.addBounds(this._context.bounds)}containsPoint(e){return this._context.containsPoint(e)}onViewUpdate(){if(this._didViewChangeTick++,this._didGraphicsUpdate=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):(e===!0||e?.context===!0)&&this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_callContextMethod(e,t){return this.context[e](...t),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){return e?new ai(this._context.clone()):(this._ownedContext=null,new ai(this._context))}lineStyle(e,t,r){ie(we,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const i={};return e&&(i.width=e),t&&(i.color=t),r&&(i.alpha=r),this.context.strokeStyle=i,this}beginFill(e,t){ie(we,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const r={};return e&&(r.color=e),t&&(r.alpha=t),this.context.fillStyle=r,this}endFill(){ie(we,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return(e.width!==Rt.defaultStrokeStyle.width||e.color!==Rt.defaultStrokeStyle.color||e.alpha!==Rt.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...e){return ie(we,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return ie(we,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return ie(we,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return ie(we,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return ie(we,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return ie(we,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}}const Xf=class qf extends ks{constructor(...e){let t=e[0]??{};t instanceof Float32Array&&(ie(we,"use new MeshGeometry({ positions, uvs, indices }) instead"),t={positions:t,uvs:e[1],indices:e[2]}),t={...qf.defaultOptions,...t};const r=t.positions||new Float32Array([0,0,1,0,1,1,0,1]),i=t.uvs||new Float32Array([0,0,1,0,1,1,0,1]),s=t.indices||new Uint32Array([0,1,2,0,2,3]),o=t.shrinkBuffersToFit,a=new Vt({data:r,label:"attribute-mesh-positions",shrinkToFit:o,usage:Ee.VERTEX|Ee.COPY_DST}),l=new Vt({data:i,label:"attribute-mesh-uvs",shrinkToFit:o,usage:Ee.VERTEX|Ee.COPY_DST}),u=new Vt({data:s,label:"index-mesh-buffer",shrinkToFit:o,usage:Ee.INDEX|Ee.COPY_DST});super({attributes:{aPosition:{buffer:a,format:"float32x2",stride:2*4,offset:0},aUV:{buffer:l,format:"float32x2",stride:2*4,offset:0}},indexBuffer:u,topology:t.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(e){this.attributes.aPosition.buffer.data=e}get uvs(){return this.attributes.aUV.buffer.data}set uvs(e){this.attributes.aUV.buffer.data=e}get indices(){return this.indexBuffer.data}set indices(e){this.indexBuffer.data=e}};Xf.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let ol=Xf;class Sx extends za{constructor(e,t){const{text:r,resolution:i,style:s,anchor:o,width:a,height:l,roundPixels:u,...c}=e;super({...c}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=t,this.text=r??"",this.style=s,this.resolution=i??null,this.allowChildren=!1,this._anchor=new ut({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=u??!1,a!==void 0&&(this.width=a),l!==void 0&&(this.height=l)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){e=e||{},this._style?.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this.bounds.width),t!==void 0&&this._setHeight(t,this.bounds.height)}addBounds(e){const t=this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}containsPoint(e){const t=this.bounds.width,r=this.bounds.height,i=-t*this.anchor.x;let s=0;return e.x>=i&&e.x<=i+t&&(s=-r*this.anchor.y,e.y>=s&&e.y<=s+r)}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0,this._didTextUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e?.style)&&this._style.destroy(e),this._style=null,this._text=null}}function wx(n,e){let t=n[0]??{};return(typeof t=="string"||n[1])&&(ie(we,`use new ${e}({ text: "hi!", style }) instead`),t={text:t,style:n[1]}),t}class $u extends Sx{constructor(...e){const t=wx(e,"Text");super(t,dn),this.renderPipeId="text"}_updateBounds(){const e=this._bounds,t=this._anchor,r=Qt.measureText(this._text,this._style),{width:i,height:s}=r;e.minX=-t._x*i,e.maxX=e.minX+i,e.minY=-t._y*s,e.maxY=e.minY+s}}function Tx(n){const e=n._stroke,t=n._fill,i=[`div { ${[`color: ${me.shared.setValue(t.color).toHex()}`,`font-size: ${n.fontSize}px`,`font-family: ${n.fontFamily}`,`font-weight: ${n.fontWeight}`,`font-style: ${n.fontStyle}`,`font-variant: ${n.fontVariant}`,`letter-spacing: ${n.letterSpacing}px`,`text-align: ${n.align}`,`padding: ${n.padding}px`,`white-space: ${n.whiteSpace==="pre"&&n.wordWrap?"pre-wrap":n.whiteSpace}`,...n.lineHeight?[`line-height: ${n.lineHeight}px`]:[],...n.wordWrap?[`word-wrap: ${n.breakWords?"break-all":"break-word"}`,`max-width: ${n.wordWrapWidth}px`]:[],...e?[Kf(e)]:[],...n.dropShadow?[Yf(n.dropShadow)]:[],...n.cssOverrides].join(";")} }`];return Cx(n.tagStyles,i),i.join(" ")}function Yf(n){const e=me.shared.setValue(n.color).setAlpha(n.alpha).toHexa(),t=Math.round(Math.cos(n.angle)*n.distance),r=Math.round(Math.sin(n.angle)*n.distance),i=`${t}px ${r}px`;return n.blur>0?`text-shadow: ${i} ${n.blur}px ${e}`:`text-shadow: ${i} ${e}`}function Kf(n){return[`-webkit-text-stroke-width: ${n.width}px`,`-webkit-text-stroke-color: ${me.shared.setValue(n.color).toHex()}`,`text-stroke-width: ${n.width}px`,`text-stroke-color: ${me.shared.setValue(n.color).toHex()}`,"paint-order: stroke"].join(";")}const ec={fontSize:"font-size: {{VALUE}}px",fontFamily:"font-family: {{VALUE}}",fontWeight:"font-weight: {{VALUE}}",fontStyle:"font-style: {{VALUE}}",fontVariant:"font-variant: {{VALUE}}",letterSpacing:"letter-spacing: {{VALUE}}px",align:"text-align: {{VALUE}}",padding:"padding: {{VALUE}}px",whiteSpace:"white-space: {{VALUE}}",lineHeight:"line-height: {{VALUE}}px",wordWrapWidth:"max-width: {{VALUE}}px"},tc={fill:n=>`color: ${me.shared.setValue(n).toHex()}`,breakWords:n=>`word-wrap: ${n?"break-all":"break-word"}`,stroke:Kf,dropShadow:Yf};function Cx(n,e){for(const t in n){const r=n[t],i=[];for(const s in r)tc[s]?i.push(tc[s](r[s])):ec[s]&&i.push(ec[s].replace("{{VALUE}}",r[s]));e.push(`${t} { ${i.join(";")} }`)}}class al extends dn{constructor(e={}){super(e),this._cssOverrides=[],this.cssOverrides??(this.cssOverrides=e.cssOverrides),this.tagStyles=e.tagStyles??{}}set cssOverrides(e){this._cssOverrides=e instanceof Array?e:[e],this.update()}get cssOverrides(){return this._cssOverrides}_generateKey(){return this._styleKey=Cf(this)+this._cssOverrides.join("-"),this._styleKey}update(){this._cssStyle=null,super.update()}clone(){return new al({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow?{...this.dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,cssOverrides:this.cssOverrides})}get cssStyle(){return this._cssStyle||(this._cssStyle=Tx(this)),this._cssStyle}addOverride(...e){const t=e.filter(r=>!this.cssOverrides.includes(r));t.length>0&&(this.cssOverrides.push(...t),this.update())}removeOverride(...e){const t=e.filter(r=>this.cssOverrides.includes(r));t.length>0&&(this.cssOverrides=this.cssOverrides.filter(r=>!t.includes(r)),this.update())}set fill(e){typeof e!="string"&&typeof e!="number"&&de("[HTMLTextStyle] only color fill is not supported by HTMLText"),super.fill=e}set stroke(e){e&&typeof e!="string"&&typeof e!="number"&&de("[HTMLTextStyle] only color stroke is not supported by HTMLText"),super.stroke=e}}const nc="http://www.w3.org/2000/svg",rc="http://www.w3.org/1999/xhtml";class Zf{constructor(){this.svgRoot=document.createElementNS(nc,"svg"),this.foreignObject=document.createElementNS(nc,"foreignObject"),this.domElement=document.createElementNS(rc,"div"),this.styleElement=document.createElementNS(rc,"style"),this.image=new Image;const{foreignObject:e,svgRoot:t,styleElement:r,domElement:i}=this;e.setAttribute("width","10000"),e.setAttribute("height","10000"),e.style.overflow="hidden",t.appendChild(e),e.appendChild(r),e.appendChild(i)}}let ic;function Px(n,e,t,r){r=r||ic||(ic=new Zf);const{domElement:i,styleElement:s,svgRoot:o}=r;i.innerHTML=`<style>${e.cssStyle};</style><div style='padding:0'>${n}</div>`,i.setAttribute("style","transform-origin: top left; display: inline-block"),t&&(s.textContent=t),document.body.appendChild(o);const a=i.getBoundingClientRect();o.remove();const l=Qt.measureFont(e.fontStyle).descent,u=e.padding*2;return{width:a.width-u,height:a.height+l-u}}class Qf{constructor(){this._didUpload=!1,this._tempState=pn.for2d()}init(e){e.renderer.runners.contextChange.add(this)}contextChange(){this._didUpload=!1}start(e,t,r){const i=e.renderer;i.shader.bind(r,this._didUpload),i.shader.updateUniformGroup(i.globalUniforms.uniformGroup),i.geometry.bind(t,r.glProgram)}execute(e,t){const r=e.renderer;this._didUpload=!0,this._tempState.blendMode=t.blendMode,r.state.set(this._tempState);const i=t.textures.textures;for(let s=0;s<t.textures.count;s++)r.texture.bind(i[s],s);r.geometry.draw("triangle-list",t.size,t.start)}}Qf.extension={type:[M.WebGLPipesAdaptor],name:"batch"};const Wi=pn.for2d();class Jf{start(e,t,r){const i=e.renderer,s=i.encoder,o=r.gpuProgram;this._shader=r,this._geometry=t,s.setGeometry(t,o),Wi.blendMode="normal",i.pipeline.getPipeline(t,o,Wi);const a=i.globalUniforms.bindGroup;s.resetBindGroup(1),s.setBindGroup(0,a,o)}execute(e,t){const r=this._shader.gpuProgram,i=e.renderer,s=i.encoder;if(!t.bindGroup){const l=t.textures;t.bindGroup=Wa(l.textures,l.count)}Wi.blendMode=t.blendMode;const o=i.bindGroup.getBindGroup(t.bindGroup,r,1),a=i.pipeline.getPipeline(this._geometry,r,Wi);t.bindGroup._touch(i.textureGC.count),s.setPipeline(a),s.renderPassEncoder.setBindGroup(1,o),s.renderPassEncoder.drawIndexed(t.size,1,t.start)}}Jf.extension={type:[M.WebGPUPipesAdaptor],name:"batch"};const ll=class $f{constructor(e,t){this.state=pn.for2d(),this._batchersByInstructionSet=Object.create(null),this._activeBatches=Object.create(null),this.renderer=e,this._adaptor=t,this._adaptor.init?.(this)}static getBatcher(e){return new this._availableBatchers[e]}buildStart(e){let t=this._batchersByInstructionSet[e.uid];t||(t=this._batchersByInstructionSet[e.uid]=Object.create(null),t.default||(t.default=new Za)),this._activeBatches=t,this._activeBatch=this._activeBatches.default;for(const r in this._activeBatches)this._activeBatches[r].begin()}addToBatch(e,t){if(this._activeBatch.name!==e.batcherName){this._activeBatch.break(t);let r=this._activeBatches[e.batcherName];r||(r=this._activeBatches[e.batcherName]=$f.getBatcher(e.batcherName),r.begin()),this._activeBatch=r}this._activeBatch.add(e)}break(e){this._activeBatch.break(e)}buildEnd(e){this._activeBatch.break(e);const t=this._activeBatches;for(const r in t){const i=t[r],s=i.geometry;s.indexBuffer.setDataWithSize(i.indexBuffer,i.indexSize,!0),s.buffers[0].setDataWithSize(i.attributeBuffer.float32View,i.attributeSize,!1)}}upload(e){const t=this._batchersByInstructionSet[e.uid];for(const r in t){const i=t[r],s=i.geometry;i.dirty&&(i.dirty=!1,s.buffers[0].update(i.attributeSize*4))}}execute(e){if(e.action==="startBatch"){const t=e.batcher,r=t.geometry,i=t.shader;this._adaptor.start(this,r,i)}this._adaptor.execute(this,e)}destroy(){this.state=null,this.renderer=null,this._adaptor=null;for(const e in this._activeBatches)this._activeBatches[e].destroy();this._activeBatches=null}};ll.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"batch"};ll._availableBatchers=Object.create(null);let ed=ll;pe.handleByMap(M.Batcher,ed._availableBatchers);pe.add(Za);const Kr={name:"local-uniform-bit",vertex:{header:`

            struct LocalUniforms {
                uTransformMatrix:mat3x3<f32>,
                uColor:vec4<f32>,
                uRound:f32,
            }

            @group(1) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `}},Ax={...Kr,vertex:{...Kr.vertex,header:Kr.vertex.header.replace("group(1)","group(2)")}},ul={name:"local-uniform-bit",vertex:{header:`

            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix = uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `}},Ex={name:"texture-bit",vertex:{header:`

        struct TextureUniforms {
            uTextureMatrix:mat3x3<f32>,
        }

        @group(2) @binding(2) var<uniform> textureUniforms : TextureUniforms;
        `,main:`
            uv = (textureUniforms.uTextureMatrix * vec3(uv, 1.0)).xy;
        `},fragment:{header:`
            @group(2) @binding(0) var uTexture: texture_2d<f32>;
            @group(2) @binding(1) var uSampler: sampler;

         
        `,main:`
            outColor = textureSample(uTexture, uSampler, vUV);
        `}},Mx={name:"texture-bit",vertex:{header:`
            uniform mat3 uTextureMatrix;
        `,main:`
            uv = (uTextureMatrix * vec3(uv, 1.0)).xy;
        `},fragment:{header:`
        uniform sampler2D uTexture;

         
        `,main:`
            outColor = texture(uTexture, vUV);
        `}};function kx(n,e){const t=n.root,r=n.instructionSet;r.reset();const i=e.renderPipes?e:e.batch.renderer,s=i.renderPipes;s.batch.buildStart(r),s.blendMode.buildStart(),s.colorMask.buildStart(),t.sortableChildren&&t.sortChildren(),td(t,r,i,!0),s.batch.buildEnd(r),s.blendMode.buildEnd(r)}function Bs(n,e,t){const r=t.renderPipes?t:t.batch.renderer;n.globalDisplayStatus<7||!n.includeInBuild||(n.sortableChildren&&n.sortChildren(),n.isSimple?Rx(n,e,r):td(n,e,r,!1))}function Rx(n,e,t){if(n.renderPipeId){const{renderPipes:r,renderableGC:i}=t;r.blendMode.setBlendMode(n,n.groupBlendMode,e),n.didViewUpdate=!1,r[n.renderPipeId].addRenderable(n,e),i.addRenderable(n,e)}if(!n.renderGroup){const r=n.children,i=r.length;for(let s=0;s<i;s++)Bs(r[s],e,t)}}function td(n,e,t,r){const{renderPipes:i,renderableGC:s}=t;if(!r&&n.renderGroup)i.renderGroup.addRenderGroup(n.renderGroup,e);else{for(let l=0;l<n.effects.length;l++){const u=n.effects[l];i[u.pipe].push(u,n,e)}const o=n.renderPipeId;o&&(i.blendMode.setBlendMode(n,n.groupBlendMode,e),n.didViewUpdate=!1,i[o].addRenderable(n,e),s.addRenderable(n,e));const a=n.children;if(a.length)for(let l=0;l<a.length;l++)Bs(a[l],e,t);for(let l=n.effects.length-1;l>=0;l--){const u=n.effects[l];i[u.pipe].pop(u,n,e)}}}const Bx=new vt;class Ix extends ps{constructor(){super(),this.filters=[new yx({sprite:new Jt(se.EMPTY),resolution:"inherit",antialias:"inherit"})]}get sprite(){return this.filters[0].sprite}set sprite(e){this.filters[0].sprite=e}}class nd{constructor(e){this._activeMaskStage=[],this._renderer=e}push(e,t,r){const i=this._renderer;if(i.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"pushMaskBegin",mask:e,canBundle:!1,maskedContainer:t}),e.renderMaskToTexture){const s=e.mask;s.includeInBuild=!0,Bs(s,r,i),s.includeInBuild=!1}i.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"pushMaskEnd",mask:e,maskedContainer:t,canBundle:!1})}pop(e,t,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"popMaskEnd",mask:e,canBundle:!1})}execute(e){const t=this._renderer,r=e.mask.renderMaskToTexture;if(e.action==="pushMaskBegin"){const i=Te.get(Ix);if(r){e.mask.mask.measurable=!0;const s=Ua(e.mask.mask,!0,Bx);e.mask.mask.measurable=!1,s.ceil();const o=t.renderTarget.renderTarget.colorTexture.source,a=Me.getOptimalTexture(s.width,s.height,o._resolution,o.antialias);t.renderTarget.push(a,!0),t.globalUniforms.push({offset:s,worldColor:4294967295});const l=i.sprite;l.texture=a,l.worldTransform.tx=s.minX,l.worldTransform.ty=s.minY,this._activeMaskStage.push({filterEffect:i,maskedContainer:e.maskedContainer,filterTexture:a})}else i.sprite=e.mask.mask,this._activeMaskStage.push({filterEffect:i,maskedContainer:e.maskedContainer})}else if(e.action==="pushMaskEnd"){const i=this._activeMaskStage[this._activeMaskStage.length-1];r&&(t.type===Pt.WEBGL&&t.renderTarget.finishRenderPass(),t.renderTarget.pop(),t.globalUniforms.pop()),t.filter.push({renderPipeId:"filter",action:"pushFilter",container:i.maskedContainer,filterEffect:i.filterEffect,canBundle:!1})}else if(e.action==="popMaskEnd"){t.filter.pop();const i=this._activeMaskStage.pop();r&&Me.returnTexture(i.filterTexture),Te.return(i.filterEffect)}}destroy(){this._renderer=null,this._activeMaskStage=null}}nd.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"alphaMask"};class rd{constructor(e){this._colorStack=[],this._colorStackIndex=0,this._currentColor=0,this._renderer=e}buildStart(){this._colorStack[0]=15,this._colorStackIndex=1,this._currentColor=15}push(e,t,r){this._renderer.renderPipes.batch.break(r);const s=this._colorStack;s[this._colorStackIndex]=s[this._colorStackIndex-1]&e.mask;const o=this._colorStack[this._colorStackIndex];o!==this._currentColor&&(this._currentColor=o,r.add({renderPipeId:"colorMask",colorMask:o,canBundle:!1})),this._colorStackIndex++}pop(e,t,r){this._renderer.renderPipes.batch.break(r);const s=this._colorStack;this._colorStackIndex--;const o=s[this._colorStackIndex-1];o!==this._currentColor&&(this._currentColor=o,r.add({renderPipeId:"colorMask",colorMask:o,canBundle:!1}))}execute(e){this._renderer.colorMask.setMask(e.colorMask)}destroy(){this._colorStack=null}}rd.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"colorMask"};class id{constructor(e){this._maskStackHash={},this._maskHash=new WeakMap,this._renderer=e}push(e,t,r){var i;const s=e,o=this._renderer;o.renderPipes.batch.break(r),o.renderPipes.blendMode.setBlendMode(s.mask,"none",r),r.add({renderPipeId:"stencilMask",action:"pushMaskBegin",mask:e,canBundle:!1});const a=s.mask;a.includeInBuild=!0,this._maskHash.has(s)||this._maskHash.set(s,{instructionsStart:0,instructionsLength:0});const l=this._maskHash.get(s);l.instructionsStart=r.instructionSize,Bs(a,r,o),a.includeInBuild=!1,o.renderPipes.batch.break(r),r.add({renderPipeId:"stencilMask",action:"pushMaskEnd",mask:e,canBundle:!1});const u=r.instructionSize-l.instructionsStart-1;l.instructionsLength=u;const c=o.renderTarget.renderTarget.uid;(i=this._maskStackHash)[c]??(i[c]=0)}pop(e,t,r){const i=e,s=this._renderer;s.renderPipes.batch.break(r),s.renderPipes.blendMode.setBlendMode(i.mask,"none",r),r.add({renderPipeId:"stencilMask",action:"popMaskBegin",canBundle:!1});const o=this._maskHash.get(e);for(let a=0;a<o.instructionsLength;a++)r.instructions[r.instructionSize++]=r.instructions[o.instructionsStart++];r.add({renderPipeId:"stencilMask",action:"popMaskEnd",canBundle:!1})}execute(e){var t;const r=this._renderer,i=r.renderTarget.renderTarget.uid;let s=(t=this._maskStackHash)[i]??(t[i]=0);e.action==="pushMaskBegin"?(r.renderTarget.ensureDepthStencil(),r.stencil.setStencilMode(nt.RENDERING_MASK_ADD,s),s++,r.colorMask.setMask(0)):e.action==="pushMaskEnd"?(r.stencil.setStencilMode(nt.MASK_ACTIVE,s),r.colorMask.setMask(15)):e.action==="popMaskBegin"?(r.colorMask.setMask(0),s!==0?r.stencil.setStencilMode(nt.RENDERING_MASK_REMOVE,s):(r.renderTarget.clear(null,Tt.STENCIL),r.stencil.setStencilMode(nt.DISABLED,s)),s--):e.action==="popMaskEnd"&&(r.stencil.setStencilMode(nt.MASK_ACTIVE,s),r.colorMask.setMask(15)),this._maskStackHash[i]=s}destroy(){this._renderer=null,this._maskStackHash=null,this._maskHash=null}}id.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"stencilMask"};var $i=(n=>(n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",n))($i||{});class Fx{constructor(e,t){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.type=t}}class sd{constructor(e){this._gpuBuffers=Object.create(null),this._boundBufferBases=Object.create(null),this._renderer=e}destroy(){this._renderer=null,this._gl=null,this._gpuBuffers=null,this._boundBufferBases=null}contextChange(){this._gpuBuffers=Object.create(null),this._gl=this._renderer.gl}getGlBuffer(e){return this._gpuBuffers[e.uid]||this.createGLBuffer(e)}bind(e){const{_gl:t}=this,r=this.getGlBuffer(e);t.bindBuffer(r.type,r.buffer)}bindBufferBase(e,t){const{_gl:r}=this;if(this._boundBufferBases[t]!==e){const i=this.getGlBuffer(e);this._boundBufferBases[t]=e,r.bindBufferBase(r.UNIFORM_BUFFER,t,i.buffer)}}bindBufferRange(e,t,r){const{_gl:i}=this;r=r||0;const s=this.getGlBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,t||0,s.buffer,r*256,256)}updateBuffer(e){const{_gl:t}=this,r=this.getGlBuffer(e);if(e._updateID===r.updateID)return r;r.updateID=e._updateID,t.bindBuffer(r.type,r.buffer);const i=e.data;if(r.byteLength>=e.data.byteLength)t.bufferSubData(r.type,0,i,0,e._updateSize/i.BYTES_PER_ELEMENT);else{const s=e.descriptor.usage&Ee.STATIC?t.STATIC_DRAW:t.DYNAMIC_DRAW;r.byteLength=i.byteLength,t.bufferData(r.type,i,s)}return r}destroyAll(){const e=this._gl;for(const t in this._gpuBuffers)e.deleteBuffer(this._gpuBuffers[t].buffer);this._gpuBuffers=Object.create(null)}onBufferDestroy(e,t){const r=this._gpuBuffers[e.uid],i=this._gl;t||i.deleteBuffer(r.buffer),this._gpuBuffers[e.uid]=null}createGLBuffer(e){const{_gl:t}=this;let r=$i.ARRAY_BUFFER;e.descriptor.usage&Ee.INDEX?r=$i.ELEMENT_ARRAY_BUFFER:e.descriptor.usage&Ee.UNIFORM&&(r=$i.UNIFORM_BUFFER);const i=new Fx(t.createBuffer(),r);return this._gpuBuffers[e.uid]=i,e.on("destroy",this.onBufferDestroy,this),i}}sd.extension={type:[M.WebGLSystem],name:"buffer"};const cl=class od{constructor(e){this.supports={uint32Indices:!0,uniformBufferObject:!0,vertexArrayObject:!0,srgbTextures:!0,nonPowOf2wrapping:!0,msaa:!0,nonPowOf2mipmaps:!0},this._renderer=e,this.extensions=Object.create(null),this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this._renderer.gl=e}init(e){e={...od.defaultOptions,...e};let t=this.multiView=e.multiView;if(e.context&&t&&(de("Renderer created with both a context and multiview enabled. Disabling multiView as both cannot work together."),t=!1),t?this.canvas=Se.get().createCanvas(this._renderer.canvas.width,this._renderer.canvas.height):this.canvas=this._renderer.view.canvas,e.context)this.initFromContext(e.context);else{const r=this._renderer.background.alpha<1,i=e.premultipliedAlpha??!0,s=e.antialias&&!this._renderer.backBuffer.useBackBuffer;this.createContext(e.preferWebGLVersion,{alpha:r,premultipliedAlpha:i,antialias:s,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference??"default"})}}ensureCanvasSize(e){if(!this.multiView){e!==this.canvas&&de("multiView is disabled, but targetCanvas is not the main canvas");return}const{canvas:t}=this;(t.width<e.width||t.height<e.height)&&(t.width=Math.max(e.width,e.width),t.height=Math.max(e.height,e.height))}initFromContext(e){this.gl=e,this.webGLVersion=e instanceof Se.get().getWebGLRenderingContext()?1:2,this.getExtensions(),this.validateContext(e),this._renderer.runners.contextChange.emit(e);const t=this._renderer.view.canvas;t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}createContext(e,t){let r;const i=this.canvas;if(e===2&&(r=i.getContext("webgl2",t)),!r&&(r=i.getContext("webgl",t),!r))throw new Error("This browser does not support WebGL. Try using the canvas renderer");this.gl=r,this.initFromContext(this.gl)}getExtensions(){const{gl:e}=this,t={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc"),rgtc:e.getExtension("EXT_texture_compression_rgtc"),loseContext:e.getExtension("WEBGL_lose_context")};if(this.webGLVersion===1)this.extensions={...t,drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear"),vertexAttribDivisorANGLE:e.getExtension("ANGLE_instanced_arrays"),srgb:e.getExtension("EXT_sRGB")};else{this.extensions={...t,colorBufferFloat:e.getExtension("EXT_color_buffer_float")};const r=e.getExtension("WEBGL_provoking_vertex");r&&r.provokingVertexWEBGL(r.FIRST_VERTEX_CONVENTION_WEBGL)}}handleContextLost(e){e.preventDefault(),this._contextLossForced&&(this._contextLossForced=!1,setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext?.restoreContext()},0))}handleContextRestored(){this._renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this._renderer.view.canvas;this._renderer=null,e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext?.loseContext()}forceContextLoss(){this.extensions.loseContext?.loseContext(),this._contextLossForced=!0}validateContext(e){const t=e.getContextAttributes();t&&!t.stencil&&de("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=this.supports,i=this.webGLVersion===2,s=this.extensions;r.uint32Indices=i||!!s.uint32ElementIndex,r.uniformBufferObject=i,r.vertexArrayObject=i||!!s.vertexArrayObject,r.srgbTextures=i||!!s.srgb,r.nonPowOf2wrapping=i,r.nonPowOf2mipmaps=i,r.msaa=i,r.uint32Indices||de("Provided WebGL context does not support 32 index buffer, large scenes may not render correctly")}};cl.extension={type:[M.WebGLSystem],name:"context"};cl.defaultOptions={context:null,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:void 0,preferWebGLVersion:2,multiView:!1};let Ox=cl;function ad(n,e){for(const t in n.attributes){const r=n.attributes[t],i=e[t];i?(r.format??(r.format=i.format),r.offset??(r.offset=i.offset),r.instance??(r.instance=i.instance)):de(`Attribute ${t} is not present in the shader, but is present in the geometry. Unable to infer attribute details.`)}Ux(n)}function Ux(n){const{buffers:e,attributes:t}=n,r={},i={};for(const s in e){const o=e[s];r[o.uid]=0,i[o.uid]=0}for(const s in t){const o=t[s];r[o.buffer.uid]+=ti(o.format).stride}for(const s in t){const o=t[s];o.stride??(o.stride=r[o.buffer.uid]),o.start??(o.start=i[o.buffer.uid]),i[o.buffer.uid]+=ti(o.format).stride}}var _a=(n=>(n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n))(_a||{}),ld=(n=>(n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n))(ld||{}),Ce=(n=>(n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT",n))(Ce||{});const sc={uint8x2:Ce.UNSIGNED_BYTE,uint8x4:Ce.UNSIGNED_BYTE,sint8x2:Ce.BYTE,sint8x4:Ce.BYTE,unorm8x2:Ce.UNSIGNED_BYTE,unorm8x4:Ce.UNSIGNED_BYTE,snorm8x2:Ce.BYTE,snorm8x4:Ce.BYTE,uint16x2:Ce.UNSIGNED_SHORT,uint16x4:Ce.UNSIGNED_SHORT,sint16x2:Ce.SHORT,sint16x4:Ce.SHORT,unorm16x2:Ce.UNSIGNED_SHORT,unorm16x4:Ce.UNSIGNED_SHORT,snorm16x2:Ce.SHORT,snorm16x4:Ce.SHORT,float16x2:Ce.HALF_FLOAT,float16x4:Ce.HALF_FLOAT,float32:Ce.FLOAT,float32x2:Ce.FLOAT,float32x3:Ce.FLOAT,float32x4:Ce.FLOAT,uint32:Ce.UNSIGNED_INT,uint32x2:Ce.UNSIGNED_INT,uint32x3:Ce.UNSIGNED_INT,uint32x4:Ce.UNSIGNED_INT,sint32:Ce.INT,sint32x2:Ce.INT,sint32x3:Ce.INT,sint32x4:Ce.INT};function Gx(n){return sc[n]??sc.float32}const Dx={"point-list":0,"line-list":1,"line-strip":3,"triangle-list":4,"triangle-strip":5};class ud{constructor(e){this._geometryVaoHash=Object.create(null),this._renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0}contextChange(){const e=this.gl=this._renderer.gl;if(!this._renderer.context.supports.vertexArrayObject)throw new Error("[PixiJS] Vertex Array Objects are not supported on this device");const t=this._renderer.context.extensions.vertexArrayObject;t&&(e.createVertexArray=()=>t.createVertexArrayOES(),e.bindVertexArray=i=>t.bindVertexArrayOES(i),e.deleteVertexArray=i=>t.deleteVertexArrayOES(i));const r=this._renderer.context.extensions.vertexAttribDivisorANGLE;r&&(e.drawArraysInstanced=(i,s,o,a)=>{r.drawArraysInstancedANGLE(i,s,o,a)},e.drawElementsInstanced=(i,s,o,a,l)=>{r.drawElementsInstancedANGLE(i,s,o,a,l)},e.vertexAttribDivisor=(i,s)=>r.vertexAttribDivisorANGLE(i,s)),this._activeGeometry=null,this._activeVao=null,this._geometryVaoHash=Object.create(null)}bind(e,t){const r=this.gl;this._activeGeometry=e;const i=this.getVao(e,t);this._activeVao!==i&&(this._activeVao=i,r.bindVertexArray(i)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this._renderer.buffer;for(let r=0;r<e.buffers.length;r++){const i=e.buffers[r];t.updateBuffer(i)}}checkCompatibility(e,t){const r=e.attributes,i=t._attributeData;for(const s in i)if(!r[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,t){const r=e.attributes,i=t._attributeData,s=["g",e.uid];for(const o in r)i[o]&&s.push(o,i[o].location);return s.join("-")}getVao(e,t){return this._geometryVaoHash[e.uid]?.[t._key]||this.initGeometryVao(e,t)}initGeometryVao(e,t,r=!0){const i=this._renderer.gl,s=this._renderer.buffer;this._renderer.shader._getProgramData(t),this.checkCompatibility(e,t);const o=this.getSignature(e,t);this._geometryVaoHash[e.uid]||(this._geometryVaoHash[e.uid]=Object.create(null),e.on("destroy",this.onGeometryDestroy,this));const a=this._geometryVaoHash[e.uid];let l=a[o];if(l)return a[t._key]=l,l;ad(e,t._attributeData);const u=e.buffers;l=i.createVertexArray(),i.bindVertexArray(l);for(let c=0;c<u.length;c++){const h=u[c];s.bind(h)}return this.activateVao(e,t),a[t._key]=l,a[o]=l,i.bindVertexArray(null),l}onGeometryDestroy(e,t){const r=this._geometryVaoHash[e.uid],i=this.gl;if(r){if(t)for(const s in r)this._activeVao!==r[s]&&this.unbind(),i.deleteVertexArray(r[s]);this._geometryVaoHash[e.uid]=null}}destroyAll(e=!1){const t=this.gl;for(const r in this._geometryVaoHash){if(e)for(const i in this._geometryVaoHash[r]){const s=this._geometryVaoHash[r];this._activeVao!==s&&this.unbind(),t.deleteVertexArray(s[i])}this._geometryVaoHash[r]=null}}activateVao(e,t){const r=this._renderer.gl,i=this._renderer.buffer,s=e.attributes;e.indexBuffer&&i.bind(e.indexBuffer);let o=null;for(const a in s){const l=s[a],u=l.buffer,c=i.getGlBuffer(u),h=t._attributeData[a];if(h){o!==c&&(i.bind(u),o=c);const d=h.location;r.enableVertexAttribArray(d);const f=ti(l.format),p=Gx(l.format);if(h.format?.substring(1,4)==="int"?r.vertexAttribIPointer(d,f.size,p,l.stride,l.offset):r.vertexAttribPointer(d,f.size,p,f.normalised,l.stride,l.offset),l.instance)if(this.hasInstance){const g=l.divisor??1;r.vertexAttribDivisor(d,g)}else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,t,r,i){const{gl:s}=this._renderer,o=this._activeGeometry,a=Dx[o.topology||e];if(i||(i=o.instanceCount),o.indexBuffer){const l=o.indexBuffer.data.BYTES_PER_ELEMENT,u=l===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;i>1?s.drawElementsInstanced(a,t||o.indexBuffer.data.length,u,(r||0)*l,i):s.drawElements(a,t||o.indexBuffer.data.length,u,(r||0)*l)}else i>1?s.drawArraysInstanced(a,r||0,t||o.getSize(),i):s.drawArrays(a,r||0,t||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this._renderer=null,this.gl=null,this._activeVao=null,this._activeGeometry=null}}ud.extension={type:[M.WebGLSystem],name:"geometry"};const zx=new ks({attributes:{aPosition:[-1,-1,3,-1,-1,3]}}),hl=class cd{constructor(e){this.useBackBuffer=!1,this._useBackBufferThisRender=!1,this._renderer=e}init(e={}){const{useBackBuffer:t,antialias:r}={...cd.defaultOptions,...e};this.useBackBuffer=t,this._antialias=r,this._renderer.context.supports.msaa||(de("antialiasing, is not supported on when using the back buffer"),this._antialias=!1),this._state=pn.for2d();const i=new _e({vertex:`
                attribute vec2 aPosition;
                out vec2 vUv;

                void main() {
                    gl_Position = vec4(aPosition, 0.0, 1.0);

                    vUv = (aPosition + 1.0) / 2.0;

                    // flip dem UVs
                    vUv.y = 1.0 - vUv.y;
                }`,fragment:`
                in vec2 vUv;
                out vec4 finalColor;

                uniform sampler2D uTexture;

                void main() {
                    finalColor = texture(uTexture, vUv);
                }`,name:"big-triangle"});this._bigTriangleShader=new Wt({glProgram:i,resources:{uTexture:se.WHITE.source}})}renderStart(e){const t=this._renderer.renderTarget.getRenderTarget(e.target);if(this._useBackBufferThisRender=this.useBackBuffer&&!!t.isRoot,this._useBackBufferThisRender){const r=this._renderer.renderTarget.getRenderTarget(e.target);this._targetTexture=r.colorTexture,e.target=this._getBackBufferTexture(r.colorTexture)}}renderEnd(){this._presentBackBuffer()}_presentBackBuffer(){const e=this._renderer;e.renderTarget.finishRenderPass(),this._useBackBufferThisRender&&(e.renderTarget.bind(this._targetTexture,!1),this._bigTriangleShader.resources.uTexture=this._backBufferTexture.source,e.encoder.draw({geometry:zx,shader:this._bigTriangleShader,state:this._state}))}_getBackBufferTexture(e){return this._backBufferTexture=this._backBufferTexture||new se({source:new Je({width:e.width,height:e.height,resolution:e._resolution,antialias:this._antialias})}),this._backBufferTexture.source.resize(e.width,e.height,e._resolution),this._backBufferTexture}destroy(){this._backBufferTexture&&(this._backBufferTexture.destroy(),this._backBufferTexture=null)}};hl.extension={type:[M.WebGLSystem],name:"backBuffer",priority:1};hl.defaultOptions={useBackBuffer:!1};let Lx=hl;class hd{constructor(e){this._colorMaskCache=15,this._renderer=e}setMask(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.gl.colorMask(!!(e&8),!!(e&4),!!(e&2),!!(e&1)))}}hd.extension={type:[M.WebGLSystem],name:"colorMask"};class fd{constructor(e){this.commandFinished=Promise.resolve(),this._renderer=e}setGeometry(e,t){this._renderer.geometry.bind(e,t.glProgram)}finishRenderPass(){}draw(e){const t=this._renderer,{geometry:r,shader:i,state:s,skipSync:o,topology:a,size:l,start:u,instanceCount:c}=e;t.shader.bind(i,o),t.geometry.bind(r,t.shader._activeProgram),s&&t.state.set(s),t.geometry.draw(a,l,u,c??r.instanceCount)}destroy(){this._renderer=null}}fd.extension={type:[M.WebGLSystem],name:"encoder"};class Nx{constructor(){this.width=-1,this.height=-1,this.msaa=!1,this.msaaRenderBuffer=[]}}const Hn=[];Hn[nt.NONE]=void 0;Hn[nt.DISABLED]={stencilWriteMask:0,stencilReadMask:0};Hn[nt.RENDERING_MASK_ADD]={stencilFront:{compare:"equal",passOp:"increment-clamp"},stencilBack:{compare:"equal",passOp:"increment-clamp"}};Hn[nt.RENDERING_MASK_REMOVE]={stencilFront:{compare:"equal",passOp:"decrement-clamp"},stencilBack:{compare:"equal",passOp:"decrement-clamp"}};Hn[nt.MASK_ACTIVE]={stencilWriteMask:0,stencilFront:{compare:"equal",passOp:"keep"},stencilBack:{compare:"equal",passOp:"keep"}};class dd{constructor(e){this._stencilCache={enabled:!1,stencilReference:0,stencilMode:nt.NONE},this._renderTargetStencilState=Object.create(null),e.renderTarget.onRenderTargetChange.add(this)}contextChange(e){this._gl=e,this._comparisonFuncMapping={always:e.ALWAYS,never:e.NEVER,equal:e.EQUAL,"not-equal":e.NOTEQUAL,less:e.LESS,"less-equal":e.LEQUAL,greater:e.GREATER,"greater-equal":e.GEQUAL},this._stencilOpsMapping={keep:e.KEEP,zero:e.ZERO,replace:e.REPLACE,invert:e.INVERT,"increment-clamp":e.INCR,"decrement-clamp":e.DECR,"increment-wrap":e.INCR_WRAP,"decrement-wrap":e.DECR_WRAP},this._stencilCache.enabled=!1,this._stencilCache.stencilMode=nt.NONE,this._stencilCache.stencilReference=0}onRenderTargetChange(e){if(this._activeRenderTarget===e)return;this._activeRenderTarget=e;let t=this._renderTargetStencilState[e.uid];t||(t=this._renderTargetStencilState[e.uid]={stencilMode:nt.DISABLED,stencilReference:0}),this.setStencilMode(t.stencilMode,t.stencilReference)}setStencilMode(e,t){const r=this._renderTargetStencilState[this._activeRenderTarget.uid],i=this._gl,s=Hn[e],o=this._stencilCache;if(r.stencilMode=e,r.stencilReference=t,e===nt.DISABLED){this._stencilCache.enabled&&(this._stencilCache.enabled=!1,i.disable(i.STENCIL_TEST));return}this._stencilCache.enabled||(this._stencilCache.enabled=!0,i.enable(i.STENCIL_TEST)),(e!==o.stencilMode||o.stencilReference!==t)&&(o.stencilMode=e,o.stencilReference=t,i.stencilFunc(this._comparisonFuncMapping[s.stencilBack.compare],t,255),i.stencilOp(i.KEEP,i.KEEP,this._stencilOpsMapping[s.stencilBack.passOp]))}}dd.extension={type:[M.WebGLSystem],name:"stencil"};class pd{constructor(e){this._syncFunctionHash=Object.create(null),this._adaptor=e,this._systemCheck()}_systemCheck(){if(!Zh())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}ensureUniformGroup(e){const t=this.getUniformGroupData(e);e.buffer||(e.buffer=new Vt({data:new Float32Array(t.layout.size/4),usage:Ee.UNIFORM|Ee.COPY_DST}))}getUniformGroupData(e){return this._syncFunctionHash[e._signature]||this._initUniformGroup(e)}_initUniformGroup(e){const t=e._signature;let r=this._syncFunctionHash[t];if(!r){const i=Object.keys(e.uniformStructures).map(a=>e.uniformStructures[a]),s=this._adaptor.createUboElements(i),o=this._generateUboSync(s.uboElements);r=this._syncFunctionHash[t]={layout:s,syncFunction:o}}return this._syncFunctionHash[t]}_generateUboSync(e){return this._adaptor.generateUboSync(e)}syncUniformGroup(e,t,r){const i=this.getUniformGroupData(e);return e.buffer||(e.buffer=new Vt({data:new Float32Array(i.layout.size/4),usage:Ee.UNIFORM|Ee.COPY_DST})),t||(t=e.buffer.data),r||(r=0),i.syncFunction(e.uniforms,t,r),!0}updateUniformGroup(e){if(e.isStatic&&!e._dirtyId)return!1;e._dirtyId=0;const t=this.syncUniformGroup(e);return e.buffer.update(),t}destroy(){this._syncFunctionHash=null}}const md={f32:4,"vec2<f32>":8,"vec3<f32>":12,"vec4<f32>":16,"mat2x2<f32>":16*2,"mat3x3<f32>":16*3,"mat4x4<f32>":16*4};function Hx(n){const e=n.map(s=>({data:s,offset:0,size:0}));let t=0,r=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(t=md[o.data.type],!t)throw new Error(`Unknown type ${o.data.type}`);if(o.data.size>1&&(t=Math.max(t,16)*o.data.size),o.size=t,r%t!==0&&r<16){const a=r%t%16;r+=a,i+=a}r+t>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=t,r=t):(o.offset=i,r+=t,i+=t)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}const Un=[{type:"mat3x3<f32>",test:n=>n.value.a!==void 0,ubo:`
            var matrix = uv[name].toArray(true);
            data[offset] = matrix[0];
            data[offset + 1] = matrix[1];
            data[offset + 2] = matrix[2];
            data[offset + 4] = matrix[3];
            data[offset + 5] = matrix[4];
            data[offset + 6] = matrix[5];
            data[offset + 8] = matrix[6];
            data[offset + 9] = matrix[7];
            data[offset + 10] = matrix[8];
        `,uniform:`
            gl.uniformMatrix3fv(ud[name].location, false, uv[name].toArray(true));
        `},{type:"vec4<f32>",test:n=>n.type==="vec4<f32>"&&n.size===1&&n.value.width!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
            data[offset + 2] = v.width;
            data[offset + 3] = v.height;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height) {
                cv[0] = v.x;
                cv[1] = v.y;
                cv[2] = v.width;
                cv[3] = v.height;
                gl.uniform4f(ud[name].location, v.x, v.y, v.width, v.height);
            }
        `},{type:"vec2<f32>",test:n=>n.type==="vec2<f32>"&&n.size===1&&n.value.x!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y) {
                cv[0] = v.x;
                cv[1] = v.y;
                gl.uniform2f(ud[name].location, v.x, v.y);
            }
        `},{type:"vec4<f32>",test:n=>n.type==="vec4<f32>"&&n.size===1&&n.value.red!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
            data[offset + 3] = v.alpha;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                cv[3] = v.alpha;
                gl.uniform4f(ud[name].location, v.red, v.green, v.blue, v.alpha);
            }
        `},{type:"vec3<f32>",test:n=>n.type==="vec3<f32>"&&n.size===1&&n.value.red!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                gl.uniform3f(ud[name].location, v.red, v.green, v.blue);
            }
        `}];function gd(n,e,t,r){const i=[`
        var v = null;
        var v2 = null;
        var t = 0;
        var index = 0;
        var name = null;
        var arrayOffset = null;
    `];let s=0;for(let a=0;a<n.length;a++){const l=n[a],u=l.data.name;let c=!1,h=0;for(let d=0;d<Un.length;d++)if(Un[d].test(l.data)){h=l.offset/4,i.push(`name = "${u}";`,`offset += ${h-s};`,Un[d][e]||Un[d].ubo),c=!0;break}if(!c)if(l.data.size>1)h=l.offset/4,i.push(t(l,h-s));else{const d=r[l.data.type];h=l.offset/4,i.push(`
                    v = uv.${u};
                    offset += ${h-s};
                    ${d};
                `)}s=h}const o=i.join(`
`);return new Function("uv","data","offset",o)}function er(n,e){return`
        for (let i = 0; i < ${n*e}; i++) {
            data[offset + (((i / ${n})|0) * 4) + (i % ${n})] = v[i];
        }
    `}const _d={f32:`
        data[offset] = v;`,i32:`
        data[offset] = v;`,"vec2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];`,"vec3<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];`,"vec4<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 3] = v[3];`,"mat2x2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 4] = v[2];
        data[offset + 5] = v[3];`,"mat3x3<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];
        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];`,"mat4x4<f32>":`
        for (let i = 0; i < 16; i++) {
            data[offset + i] = v[i];
        }`,"mat3x2<f32>":er(3,2),"mat4x2<f32>":er(4,2),"mat2x3<f32>":er(2,3),"mat4x3<f32>":er(4,3),"mat2x4<f32>":er(2,4),"mat3x4<f32>":er(3,4)},Vx={..._d,"mat2x2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 3] = v[3];
    `};function Wx(n,e){const t=Math.max(md[n.data.type]/16,1),r=n.data.value.length/n.data.size,i=(4-r%4)%4;return`
        v = uv.${n.data.name};
        offset += ${e};

        arrayOffset = offset;

        t = 0;

        for(var i=0; i < ${n.data.size*t}; i++)
        {
            for(var j = 0; j < ${r}; j++)
            {
                data[arrayOffset++] = v[t++];
            }
            ${i!==0?`arrayOffset += ${i};`:""}
        }
    `}function jx(n){return gd(n,"uboStd40",Wx,_d)}class vd extends pd{constructor(){super({createUboElements:Hx,generateUboSync:jx})}}vd.extension={type:[M.WebGLSystem],name:"ubo"};class Xx{constructor(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new Re}init(e,t){this._renderer=e,this._renderTargetSystem=t,e.runners.contextChange.add(this)}contextChange(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new Re}copyToTexture(e,t,r,i,s){const o=this._renderTargetSystem,a=this._renderer,l=o.getGpuRenderTarget(e),u=a.gl;return this.finishRenderPass(e),u.bindFramebuffer(u.FRAMEBUFFER,l.resolveTargetFramebuffer),a.texture.bind(t,0),u.copyTexSubImage2D(u.TEXTURE_2D,0,s.x,s.y,r.x,r.y,i.width,i.height),t}startRenderPass(e,t=!0,r,i){const s=this._renderTargetSystem,o=e.colorTexture,a=s.getGpuRenderTarget(e);let l=i.y;e.isRoot&&(l=o.pixelHeight-i.height),e.colorTextures.forEach(h=>{this._renderer.texture.unbind(h)});const u=this._renderer.gl;u.bindFramebuffer(u.FRAMEBUFFER,a.framebuffer);const c=this._viewPortCache;(c.x!==i.x||c.y!==l||c.width!==i.width||c.height!==i.height)&&(c.x=i.x,c.y=l,c.width=i.width,c.height=i.height,u.viewport(i.x,l,i.width,i.height)),!a.depthStencilRenderBuffer&&(e.stencil||e.depth)&&this._initStencil(a),this.clear(e,t,r)}finishRenderPass(e){const r=this._renderTargetSystem.getGpuRenderTarget(e);if(!r.msaa)return;const i=this._renderer.gl;i.bindFramebuffer(i.FRAMEBUFFER,r.resolveTargetFramebuffer),i.bindFramebuffer(i.READ_FRAMEBUFFER,r.framebuffer),i.blitFramebuffer(0,0,r.width,r.height,0,0,r.width,r.height,i.COLOR_BUFFER_BIT,i.NEAREST),i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)}initGpuRenderTarget(e){const r=this._renderer.gl,i=new Nx,s=e.colorTexture;return yn.test(s.resource)?(this._renderer.context.ensureCanvasSize(e.colorTexture.resource),i.framebuffer=null,i):(this._initColor(e,i),r.bindFramebuffer(r.FRAMEBUFFER,null),i)}destroyGpuRenderTarget(e){const t=this._renderer.gl;e.framebuffer&&(t.deleteFramebuffer(e.framebuffer),e.framebuffer=null),e.resolveTargetFramebuffer&&(t.deleteFramebuffer(e.resolveTargetFramebuffer),e.resolveTargetFramebuffer=null),e.depthStencilRenderBuffer&&(t.deleteRenderbuffer(e.depthStencilRenderBuffer),e.depthStencilRenderBuffer=null),e.msaaRenderBuffer.forEach(r=>{t.deleteRenderbuffer(r)}),e.msaaRenderBuffer=null}clear(e,t,r){if(!t)return;const i=this._renderTargetSystem;typeof t=="boolean"&&(t=t?Tt.ALL:Tt.NONE);const s=this._renderer.gl;if(t&Tt.COLOR){r??(r=i.defaultClearColor);const o=this._clearColorCache,a=r;(o[0]!==a[0]||o[1]!==a[1]||o[2]!==a[2]||o[3]!==a[3])&&(o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],s.clearColor(a[0],a[1],a[2],a[3]))}s.clear(t)}resizeGpuRenderTarget(e){if(e.isRoot)return;const r=this._renderTargetSystem.getGpuRenderTarget(e);this._resizeColor(e,r),(e.stencil||e.depth)&&this._resizeStencil(r)}_initColor(e,t){const r=this._renderer,i=r.gl,s=i.createFramebuffer();if(t.resolveTargetFramebuffer=s,i.bindFramebuffer(i.FRAMEBUFFER,s),t.width=e.colorTexture.source.pixelWidth,t.height=e.colorTexture.source.pixelHeight,e.colorTextures.forEach((o,a)=>{const l=o.source;l.antialias&&(r.context.supports.msaa?t.msaa=!0:de("[RenderTexture] Antialiasing on textures is not supported in WebGL1")),r.texture.bindSource(l,0);const c=r.texture.getGlSource(l).texture;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+a,3553,c,0)}),t.msaa){const o=i.createFramebuffer();t.framebuffer=o,i.bindFramebuffer(i.FRAMEBUFFER,o),e.colorTextures.forEach((a,l)=>{const u=i.createRenderbuffer();t.msaaRenderBuffer[l]=u})}else t.framebuffer=s;this._resizeColor(e,t)}_resizeColor(e,t){const r=e.colorTexture.source;if(t.width=r.pixelWidth,t.height=r.pixelHeight,e.colorTextures.forEach((i,s)=>{s!==0&&i.source.resize(r.width,r.height,r._resolution)}),t.msaa){const i=this._renderer,s=i.gl,o=t.framebuffer;s.bindFramebuffer(s.FRAMEBUFFER,o),e.colorTextures.forEach((a,l)=>{const u=a.source;i.texture.bindSource(u,0);const h=i.texture.getGlSource(u).internalFormat,d=t.msaaRenderBuffer[l];s.bindRenderbuffer(s.RENDERBUFFER,d),s.renderbufferStorageMultisample(s.RENDERBUFFER,4,h,u.pixelWidth,u.pixelHeight),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+l,s.RENDERBUFFER,d)})}}_initStencil(e){if(e.framebuffer===null)return;const t=this._renderer.gl,r=t.createRenderbuffer();e.depthStencilRenderBuffer=r,t.bindRenderbuffer(t.RENDERBUFFER,r),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r),this._resizeStencil(e)}_resizeStencil(e){const t=this._renderer.gl;t.bindRenderbuffer(t.RENDERBUFFER,e.depthStencilRenderBuffer),e.msaa?t.renderbufferStorageMultisample(t.RENDERBUFFER,4,t.DEPTH24_STENCIL8,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,this._renderer.context.webGLVersion===2?t.DEPTH24_STENCIL8:t.DEPTH_STENCIL,e.width,e.height)}postrender(e){if(this._renderer.context.multiView&&yn.test(e.colorTexture.resource)){const t=this._renderer.context.canvas,r=e.colorTexture;r.context2D.drawImage(t,0,r.pixelHeight-t.height)}}}function qx(n,e,t,r,i,s){const o=s?1:-1;return n.identity(),n.a=1/r*2,n.d=o*(1/i*2),n.tx=-1-e*n.a,n.ty=-o-t*n.d,n}const Gr=new Map;function bd(n,e){if(!Gr.has(n)){const t=new se({source:new yn({resource:n,...e})}),r=()=>{Gr.get(n)===t&&Gr.delete(n)};t.once("destroy",r),t.source.once("destroy",r),Gr.set(n,t)}return Gr.get(n)}function Yx(n){const e=n.colorTexture.source.resource;return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement&&document.body.contains(e)}const xd=class yd{constructor(e={}){if(this.uid=Xe("renderTarget"),this.colorTextures=[],this.dirtyId=0,this.isRoot=!1,this._size=new Float32Array(2),this._managedColorTextures=!1,e={...yd.defaultOptions,...e},this.stencil=e.stencil,this.depth=e.depth,this.isRoot=e.isRoot,typeof e.colorTextures=="number"){this._managedColorTextures=!0;for(let t=0;t<e.colorTextures;t++)this.colorTextures.push(new Je({width:e.width,height:e.height,resolution:e.resolution,antialias:e.antialias}))}else{this.colorTextures=[...e.colorTextures.map(r=>r.source)];const t=this.colorTexture.source;this.resize(t.width,t.height,t._resolution)}this.colorTexture.source.on("resize",this.onSourceResize,this),(e.depthStencilTexture||this.stencil)&&(e.depthStencilTexture instanceof se||e.depthStencilTexture instanceof Je?this.depthStencilTexture=e.depthStencilTexture.source:this.ensureDepthStencilTexture())}get size(){const e=this._size;return e[0]=this.pixelWidth,e[1]=this.pixelHeight,e}get width(){return this.colorTexture.source.width}get height(){return this.colorTexture.source.height}get pixelWidth(){return this.colorTexture.source.pixelWidth}get pixelHeight(){return this.colorTexture.source.pixelHeight}get resolution(){return this.colorTexture.source._resolution}get colorTexture(){return this.colorTextures[0]}onSourceResize(e){this.resize(e.width,e.height,e._resolution,!0)}ensureDepthStencilTexture(){this.depthStencilTexture||(this.depthStencilTexture=new Je({width:this.width,height:this.height,resolution:this.resolution,format:"depth24plus-stencil8",autoGenerateMipmaps:!1,antialias:!1,mipLevelCount:1}))}resize(e,t,r=this.resolution,i=!1){this.dirtyId++,this.colorTextures.forEach((s,o)=>{i&&o===0||s.source.resize(e,t,r)}),this.depthStencilTexture&&this.depthStencilTexture.source.resize(e,t,r)}destroy(){this.colorTexture.source.off("resize",this.onSourceResize,this),this._managedColorTextures&&this.colorTextures.forEach(e=>{e.destroy()}),this.depthStencilTexture&&(this.depthStencilTexture.destroy(),delete this.depthStencilTexture)}};xd.defaultOptions={width:0,height:0,resolution:1,colorTextures:1,stencil:!1,depth:!1,antialias:!1,isRoot:!1};let va=xd;class Sd{constructor(e){this.rootViewPort=new Re,this.viewport=new Re,this.onRenderTargetChange=new ef("onRenderTargetChange"),this.projectionMatrix=new ue,this.defaultClearColor=[0,0,0,0],this._renderSurfaceToRenderTargetHash=new Map,this._gpuRenderTargetHash=Object.create(null),this._renderTargetStack=[],this._renderer=e}finishRenderPass(){this.adaptor.finishRenderPass(this.renderTarget)}renderStart({target:e,clear:t,clearColor:r,frame:i}){this._renderTargetStack.length=0,this.push(e,t,r,i),this.rootViewPort.copyFrom(this.viewport),this.rootRenderTarget=this.renderTarget,this.renderingToScreen=Yx(this.rootRenderTarget)}postrender(){this.adaptor.postrender?.(this.rootRenderTarget)}bind(e,t=!0,r,i){const s=this.getRenderTarget(e),o=this.renderTarget!==s;this.renderTarget=s,this.renderSurface=e;const a=this.getGpuRenderTarget(s);(s.pixelWidth!==a.width||s.pixelHeight!==a.height)&&(this.adaptor.resizeGpuRenderTarget(s),a.width=s.pixelWidth,a.height=s.pixelHeight);const l=s.colorTexture,u=this.viewport,c=l.pixelWidth,h=l.pixelHeight;if(!i&&e instanceof se&&(i=e.frame),i){const d=l._resolution;u.x=i.x*d+.5|0,u.y=i.y*d+.5|0,u.width=i.width*d+.5|0,u.height=i.height*d+.5|0}else u.x=0,u.y=0,u.width=c,u.height=h;return qx(this.projectionMatrix,0,0,u.width/l.resolution,u.height/l.resolution,!s.isRoot),this.adaptor.startRenderPass(s,t,r,u),o&&this.onRenderTargetChange.emit(s),s}clear(e,t=Tt.ALL,r){t&&(e&&(e=this.getRenderTarget(e)),this.adaptor.clear(e||this.renderTarget,t,r,this.viewport))}contextChange(){this._gpuRenderTargetHash=Object.create(null)}push(e,t=Tt.ALL,r,i){const s=this.bind(e,t,r,i);return this._renderTargetStack.push({renderTarget:s,frame:i}),s}pop(){this._renderTargetStack.pop();const e=this._renderTargetStack[this._renderTargetStack.length-1];this.bind(e.renderTarget,!1,null,e.frame)}getRenderTarget(e){return e.isTexture&&(e=e.source),this._renderSurfaceToRenderTargetHash.get(e)??this._initRenderTarget(e)}copyToTexture(e,t,r,i,s){r.x<0&&(i.width+=r.x,s.x-=r.x,r.x=0),r.y<0&&(i.height+=r.y,s.y-=r.y,r.y=0);const{pixelWidth:o,pixelHeight:a}=e;return i.width=Math.min(i.width,o-r.x),i.height=Math.min(i.height,a-r.y),this.adaptor.copyToTexture(e,t,r,i,s)}ensureDepthStencil(){this.renderTarget.stencil||(this.renderTarget.stencil=!0,this.adaptor.startRenderPass(this.renderTarget,!1,null,this.viewport))}destroy(){this._renderer=null,this._renderSurfaceToRenderTargetHash.forEach((e,t)=>{e!==t&&e.destroy()}),this._renderSurfaceToRenderTargetHash.clear(),this._gpuRenderTargetHash=Object.create(null)}_initRenderTarget(e){let t=null;return yn.test(e)&&(e=bd(e).source),e instanceof va?t=e:e instanceof Je&&(t=new va({colorTextures:[e]}),yn.test(e.source.resource)&&(t.isRoot=!0),e.once("destroy",()=>{t.destroy(),this._renderSurfaceToRenderTargetHash.delete(e);const r=this._gpuRenderTargetHash[t.uid];r&&(this._gpuRenderTargetHash[t.uid]=null,this.adaptor.destroyGpuRenderTarget(r))})),this._renderSurfaceToRenderTargetHash.set(e,t),t}getGpuRenderTarget(e){return this._gpuRenderTargetHash[e.uid]||(this._gpuRenderTargetHash[e.uid]=this.adaptor.initGpuRenderTarget(e))}}class wd extends Sd{constructor(e){super(e),this.adaptor=new Xx,this.adaptor.init(e,this)}}wd.extension={type:[M.WebGLSystem],name:"renderTarget"};class fl extends At{constructor({buffer:e,offset:t,size:r}){super(),this.uid=Xe("buffer"),this._resourceType="bufferResource",this._touched=0,this._resourceId=Xe("resource"),this._bufferResource=!0,this.destroyed=!1,this.buffer=e,this.offset=t|0,this.size=r,this.buffer.on("change",this.onBufferChange,this)}onBufferChange(){this._resourceId=Xe("resource"),this.emit("change",this)}destroy(e=!1){this.destroyed=!0,e&&this.buffer.destroy(),this.emit("change",this),this.buffer=null}}function Kx(n,e){const t=[],r=[`
        var g = s.groups;
        var sS = r.shader;
        var p = s.glProgram;
        var ugS = r.uniformGroup;
        var resources;
    `];let i=!1,s=0,o=0;const a=e._getProgramData(n.glProgram);for(const u in n.groups){const c=n.groups[u];t.push(`
            resources = g[${u}].resources;
        `);for(const h in c.resources){const d=c.resources[h];if(d instanceof gt)d.ubo?t.push(`
                        sS.bindUniformBlock(
                            resources[${h}],
                            sS._uniformBindMap[${u}[${h}],
                            ${s++}
                        );
                    `):t.push(`
                        ugS.updateUniformGroup(resources[${h}], p, sD);
                    `);else if(d instanceof fl)t.push(`
                    sS.bindUniformBlock(
                        resources[${h}],
                        sS._uniformBindMap[${u}[${h}],
                        ${s++}
                    );
                `);else if(d instanceof Je){const f=n._uniformBindMap[u][h],p=a.uniformData[f];p&&(i||(i=!0,r.push(`
                        var tS = r.texture;
                        `)),e._gl.uniform1i(p.location,o),t.push(`
                        tS.bind(resources[${h}], ${o});
                    `),o++)}}}const l=[...r,...t].join(`
`);return new Function("r","s","sD",l)}class Zx{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBlockBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBlockBindings=null,this.program=null}}function oc(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}function Bo(n){const e=new Array(n);for(let t=0;t<e.length;t++)e[t]=!1;return e}function Td(n,e){switch(n){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Bo(2*e);case"bvec3":return Bo(3*e);case"bvec4":return Bo(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}let ji=null;const ac={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"},Qx={float:"float32",vec2:"float32x2",vec3:"float32x3",vec4:"float32x4",int:"sint32",ivec2:"sint32x2",ivec3:"sint32x3",ivec4:"sint32x4",uint:"uint32",uvec2:"uint32x2",uvec3:"uint32x3",uvec4:"uint32x4",bool:"uint32",bvec2:"uint32x2",bvec3:"uint32x3",bvec4:"uint32x4"};function Cd(n,e){if(!ji){const t=Object.keys(ac);ji={};for(let r=0;r<t.length;++r){const i=t[r];ji[n[i]]=ac[i]}}return ji[e]}function Jx(n,e){const t=Cd(n,e);return Qx[t]||"float32"}function $x(n,e,t=!1){const r={},i=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES);for(let o=0;o<i;o++){const a=e.getActiveAttrib(n,o);if(a.name.startsWith("gl_"))continue;const l=Jx(e,a.type);r[a.name]={location:0,format:l,stride:ti(l).stride,offset:0,instance:!1,start:0}}const s=Object.keys(r);if(t){s.sort((o,a)=>o>a?1:-1);for(let o=0;o<s.length;o++)r[s[o]].location=o,e.bindAttribLocation(n,o,s[o]);e.linkProgram(n)}else for(let o=0;o<s.length;o++)r[s[o]].location=e.getAttribLocation(n,s[o]);return r}function ey(n,e){if(!e.ACTIVE_UNIFORM_BLOCKS)return{};const t={},r=e.getProgramParameter(n,e.ACTIVE_UNIFORM_BLOCKS);for(let i=0;i<r;i++){const s=e.getActiveUniformBlockName(n,i),o=e.getUniformBlockIndex(n,s),a=e.getActiveUniformBlockParameter(n,i,e.UNIFORM_BLOCK_DATA_SIZE);t[s]={name:s,index:o,size:a}}return t}function ty(n,e){const t={},r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const s=e.getActiveUniform(n,i),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=Cd(e,s.type);t[o]={name:o,index:i,type:l,size:s.size,isArray:a,value:Td(l,s.size)}}return t}function lc(n,e){const t=n.getShaderSource(e).split(`
`).map((u,c)=>`${c}: ${u}`),r=n.getShaderInfoLog(e),i=r.split(`
`),s={},o=i.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!s[u]?(s[u]=!0,!0):!1),a=[""];o.forEach(u=>{t[u-1]=`%c${t[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=t.join(`
`);a[0]=l,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function ny(n,e,t,r){n.getProgramParameter(e,n.LINK_STATUS)||(n.getShaderParameter(t,n.COMPILE_STATUS)||lc(n,t),n.getShaderParameter(r,n.COMPILE_STATUS)||lc(n,r),console.error("PixiJS Error: Could not initialize shader."),n.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(e)))}function ry(n,e){const t=oc(n,n.VERTEX_SHADER,e.vertex),r=oc(n,n.FRAGMENT_SHADER,e.fragment),i=n.createProgram();n.attachShader(i,t),n.attachShader(i,r);const s=e.transformFeedbackVaryings;s&&(typeof n.transformFeedbackVaryings!="function"?de("TransformFeedback is not supported but TransformFeedbackVaryings are given."):n.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?n.SEPARATE_ATTRIBS:n.INTERLEAVED_ATTRIBS)),n.linkProgram(i),n.getProgramParameter(i,n.LINK_STATUS)||ny(n,i,t,r),e._attributeData=$x(i,n,!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertex)),e._uniformData=ty(i,n),e._uniformBlockData=ey(i,n),n.deleteShader(t),n.deleteShader(r);const o={};for(const l in e._uniformData){const u=e._uniformData[l];o[l]={location:n.getUniformLocation(i,l),value:Td(u.type,u.size)}}return new Zx(i,o)}const Xi={textureCount:0,blockIndex:0};class Pd{constructor(e){this._activeProgram=null,this._programDataHash=Object.create(null),this._nextIndex=0,this._boundUniformsIdsToIndexHash=Object.create(null),this._boundIndexToUniformsHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._renderer=e}contextChange(e){this._gl=e,this._maxBindings=e.MAX_UNIFORM_BUFFER_BINDINGS?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0,this._programDataHash=Object.create(null),this._boundUniformsIdsToIndexHash=Object.create(null),this._boundIndexToUniformsHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._activeProgram=null,this.maxTextures=wr()}bind(e,t){if(this._setProgram(e.glProgram),t)return;Xi.textureCount=0,Xi.blockIndex=0;let r=this._shaderSyncFunctions[e.glProgram._key];r||(r=this._shaderSyncFunctions[e.glProgram._key]=this._generateShaderSync(e,this)),r(this._renderer,e,Xi)}updateUniformGroup(e){this._renderer.uniformGroup.updateUniformGroup(e,this._activeProgram,Xi)}bindUniformBlock(e,t,r=0){const i=this._renderer.buffer,s=this._getProgramData(this._activeProgram),o=e._bufferResource;o&&this._renderer.ubo.updateUniformGroup(e),i.updateBuffer(e.buffer);let a=this._boundUniformsIdsToIndexHash[e.uid];if(a===void 0){const c=this._nextIndex++%this._maxBindings,h=this._boundIndexToUniformsHash[c];h&&(this._boundUniformsIdsToIndexHash[h.uid]=void 0),a=this._boundUniformsIdsToIndexHash[e.uid]=c,this._boundIndexToUniformsHash[c]=e,o?i.bindBufferRange(e.buffer,c,e.offset):i.bindBufferBase(e.buffer,c)}const l=this._gl,u=this._activeProgram._uniformBlockData[t].index;s.uniformBlockBindings[r]!==a&&(s.uniformBlockBindings[r]=a,l.uniformBlockBinding(s.program,u,a))}_setProgram(e){if(this._activeProgram===e)return;this._activeProgram=e;const t=this._getProgramData(e);this._gl.useProgram(t.program)}_getProgramData(e){return this._programDataHash[e._key]||this._createProgramData(e)}_createProgramData(e){const t=e._key;return this._programDataHash[t]=ry(this._gl,e),this._programDataHash[t]}destroy(){for(const e of Object.keys(this._programDataHash))this._programDataHash[e].destroy(),this._programDataHash[e]=null;this._programDataHash=null,this._boundUniformsIdsToIndexHash=null}_generateShaderSync(e,t){return Kx(e,t)}}Pd.extension={type:[M.WebGLSystem],name:"shader"};const iy={f32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1f(location, v);
        }`,"vec2<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2f(location, v[0], v[1]);
        }`,"vec3<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3f(location, v[0], v[1], v[2]);
        }`,"vec4<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4f(location, v[0], v[1], v[2], v[3]);
        }`,i32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,"vec2<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,"vec3<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,"vec4<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,u32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1ui(location, v);
        }`,"vec2<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2ui(location, v[0], v[1]);
        }`,"vec3<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3ui(location, v[0], v[1], v[2]);
        }`,"vec4<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
        }`,bool:`if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,"vec2<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,"vec3<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,"vec4<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,"mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);"},sy={f32:"gl.uniform1fv(location, v);","vec2<f32>":"gl.uniform2fv(location, v);","vec3<f32>":"gl.uniform3fv(location, v);","vec4<f32>":"gl.uniform4fv(location, v);","mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);",i32:"gl.uniform1iv(location, v);","vec2<i32>":"gl.uniform2iv(location, v);","vec3<i32>":"gl.uniform3iv(location, v);","vec4<i32>":"gl.uniform4iv(location, v);",u32:"gl.uniform1iv(location, v);","vec2<u32>":"gl.uniform2iv(location, v);","vec3<u32>":"gl.uniform3iv(location, v);","vec4<u32>":"gl.uniform4iv(location, v);",bool:"gl.uniform1iv(location, v);","vec2<bool>":"gl.uniform2iv(location, v);","vec3<bool>":"gl.uniform3iv(location, v);","vec4<bool>":"gl.uniform4iv(location, v);"};function oy(n,e){const t=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
        var name = null;
    `];for(const r in n.uniforms){if(!e[r]){n.uniforms[r]instanceof gt?n.uniforms[r].ubo?t.push(`
                        renderer.shader.bindUniformBlock(uv.${r}, "${r}");
                    `):t.push(`
                        renderer.shader.updateUniformGroup(uv.${r});
                    `):n.uniforms[r]instanceof fl&&t.push(`
                        renderer.shader.bindBufferResource(uv.${r}, "${r}");
                    `);continue}const i=n.uniformStructures[r];let s=!1;for(let o=0;o<Un.length;o++){const a=Un[o];if(i.type===a.type&&a.test(i)){t.push(`name = "${r}";`,Un[o].uniform),s=!0;break}}if(!s){const a=(i.size===1?iy:sy)[i.type].replace("location",`ud["${r}"].location`);t.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${a};`)}}return new Function("ud","uv","renderer","syncData",t.join(`
`))}class Ad{constructor(e){this._cache={},this._uniformGroupSyncHash={},this._renderer=e,this.gl=null,this._cache={}}contextChange(e){this.gl=e}updateUniformGroup(e,t,r){const i=this._renderer.shader._getProgramData(t);(!e.isStatic||e._dirtyId!==i.uniformDirtyGroups[e.uid])&&(i.uniformDirtyGroups[e.uid]=e._dirtyId,this._getUniformSyncFunction(e,t)(i.uniformData,e.uniforms,this._renderer,r))}_getUniformSyncFunction(e,t){return this._uniformGroupSyncHash[e._signature]?.[t._key]||this._createUniformSyncFunction(e,t)}_createUniformSyncFunction(e,t){const r=this._uniformGroupSyncHash[e._signature]||(this._uniformGroupSyncHash[e._signature]={}),i=this._getSignature(e,t._uniformData,"u");return this._cache[i]||(this._cache[i]=this._generateUniformsSync(e,t._uniformData)),r[t._key]=this._cache[i],r[t._key]}_generateUniformsSync(e,t){return oy(e,t)}_getSignature(e,t,r){const i=e.uniforms,s=[`${r}-`];for(const o in i)s.push(o),t[o]&&s.push(t[o].type);return s.join("-")}destroy(){this._renderer=null,this._cache=null}}Ad.extension={type:[M.WebGLSystem],name:"uniformGroup"};function ay(n){const e={};if(e.normal=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e.add=[n.ONE,n.ONE],e.multiply=[n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e.screen=[n.ONE,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e.none=[0,0],e["normal-npm"]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e["add-npm"]=[n.SRC_ALPHA,n.ONE,n.ONE,n.ONE],e["screen-npm"]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e.erase=[n.ZERO,n.ONE_MINUS_SRC_ALPHA],!(n instanceof Se.get().getWebGLRenderingContext()))e.min=[n.ONE,n.ONE,n.ONE,n.ONE,n.MIN,n.MIN],e.max=[n.ONE,n.ONE,n.ONE,n.ONE,n.MAX,n.MAX];else{const r=n.getExtension("EXT_blend_minmax");r&&(e.min=[n.ONE,n.ONE,n.ONE,n.ONE,r.MIN_EXT,r.MIN_EXT],e.max=[n.ONE,n.ONE,n.ONE,n.ONE,r.MAX_EXT,r.MAX_EXT])}return e}const ly=0,uy=1,cy=2,hy=3,fy=4,dy=5,Ed=class ba{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode="none",this._blendEq=!1,this.map=[],this.map[ly]=this.setBlend,this.map[uy]=this.setOffset,this.map[cy]=this.setCullFace,this.map[hy]=this.setDepthTest,this.map[fy]=this.setFrontFace,this.map[dy]=this.setDepthMask,this.checks=[],this.defaultState=pn.for2d()}contextChange(e){this.gl=e,this.blendModesMap=ay(e),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,r=0;for(;t;)t&1&&this.map[r].call(this,!!(e.data&1<<r)),t=t>>1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this._updateCheck(ba._checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this._updateCheck(ba._checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(this.blendModesMap[e]||(e="normal"),e===this.blendMode)return;this.blendMode=e;const t=this.blendModesMap[e],r=this.gl;t.length===2?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode="",this.setBlendMode("normal")}_updateCheck(e,t){const r=this.checks.indexOf(e);t&&r===-1?this.checks.push(e):!t&&r!==-1&&this.checks.splice(r,1)}static _checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static _checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null,this.checks.length=0}};Ed.extension={type:[M.WebGLSystem],name:"state"};let py=Ed;class my{constructor(e){this.target=ld.TEXTURE_2D,this.texture=e,this.width=-1,this.height=-1,this.type=Ce.UNSIGNED_BYTE,this.internalFormat=_a.RGBA,this.format=_a.RGBA,this.samplerType=0}}const gy={id:"buffer",upload(n,e,t){e.width===n.width||e.height===n.height?t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,e.format,e.type,n.resource):t.texImage2D(e.target,0,e.internalFormat,n.width,n.height,0,e.format,e.type,n.resource),e.width=n.width,e.height=n.height}},_y={"bc1-rgba-unorm":!0,"bc1-rgba-unorm-srgb":!0,"bc2-rgba-unorm":!0,"bc2-rgba-unorm-srgb":!0,"bc3-rgba-unorm":!0,"bc3-rgba-unorm-srgb":!0,"bc4-r-unorm":!0,"bc4-r-snorm":!0,"bc5-rg-unorm":!0,"bc5-rg-snorm":!0,"bc6h-rgb-ufloat":!0,"bc6h-rgb-float":!0,"bc7-rgba-unorm":!0,"bc7-rgba-unorm-srgb":!0,"etc2-rgb8unorm":!0,"etc2-rgb8unorm-srgb":!0,"etc2-rgb8a1unorm":!0,"etc2-rgb8a1unorm-srgb":!0,"etc2-rgba8unorm":!0,"etc2-rgba8unorm-srgb":!0,"eac-r11unorm":!0,"eac-r11snorm":!0,"eac-rg11unorm":!0,"eac-rg11snorm":!0,"astc-4x4-unorm":!0,"astc-4x4-unorm-srgb":!0,"astc-5x4-unorm":!0,"astc-5x4-unorm-srgb":!0,"astc-5x5-unorm":!0,"astc-5x5-unorm-srgb":!0,"astc-6x5-unorm":!0,"astc-6x5-unorm-srgb":!0,"astc-6x6-unorm":!0,"astc-6x6-unorm-srgb":!0,"astc-8x5-unorm":!0,"astc-8x5-unorm-srgb":!0,"astc-8x6-unorm":!0,"astc-8x6-unorm-srgb":!0,"astc-8x8-unorm":!0,"astc-8x8-unorm-srgb":!0,"astc-10x5-unorm":!0,"astc-10x5-unorm-srgb":!0,"astc-10x6-unorm":!0,"astc-10x6-unorm-srgb":!0,"astc-10x8-unorm":!0,"astc-10x8-unorm-srgb":!0,"astc-10x10-unorm":!0,"astc-10x10-unorm-srgb":!0,"astc-12x10-unorm":!0,"astc-12x10-unorm-srgb":!0,"astc-12x12-unorm":!0,"astc-12x12-unorm-srgb":!0},vy={id:"compressed",upload(n,e,t){t.pixelStorei(t.UNPACK_ALIGNMENT,4);let r=n.pixelWidth,i=n.pixelHeight;const s=!!_y[n.format];for(let o=0;o<n.resource.length;o++){const a=n.resource[o];s?t.compressedTexImage2D(t.TEXTURE_2D,o,e.internalFormat,r,i,0,a):t.texImage2D(t.TEXTURE_2D,o,e.internalFormat,r,i,0,e.format,e.type,a),r=Math.max(r>>1,1),i=Math.max(i>>1,1)}}},Md={id:"image",upload(n,e,t,r){const i=n.alphaMode==="premultiply-alpha-on-upload";t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i);const s=e.width,o=e.height,a=n.pixelWidth,l=n.pixelHeight,u=n.resourceWidth,c=n.resourceHeight;u<a||c<l?((s!==a||o!==l)&&t.texImage2D(e.target,0,e.internalFormat,a,l,0,e.format,e.type,null),r===2?t.texSubImage2D(t.TEXTURE_2D,0,0,0,u,c,e.format,e.type,n.resource):t.texSubImage2D(t.TEXTURE_2D,0,0,0,e.format,e.type,n.resource)):s===a||o===l?t.texSubImage2D(t.TEXTURE_2D,0,0,0,e.format,e.type,n.resource):r===2?t.texImage2D(e.target,0,e.internalFormat,a,l,0,e.format,e.type,n.resource):t.texImage2D(e.target,0,e.internalFormat,e.format,e.type,n.resource),e.width=a,e.height=l}},by={id:"video",upload(n,e,t,r){if(!n.isValid){t.texImage2D(e.target,0,e.internalFormat,1,1,0,e.format,e.type,null);return}Md.upload(n,e,t,r)}},uc={linear:9729,nearest:9728},xy={linear:{linear:9987,nearest:9985},nearest:{linear:9986,nearest:9984}},Io={"clamp-to-edge":33071,repeat:10497,"mirror-repeat":33648},yy={never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519};function cc(n,e,t,r,i,s,o,a){const l=s;if(!a||n.addressModeU!=="repeat"||n.addressModeV!=="repeat"||n.addressModeW!=="repeat"){const u=Io[o?"clamp-to-edge":n.addressModeU],c=Io[o?"clamp-to-edge":n.addressModeV],h=Io[o?"clamp-to-edge":n.addressModeW];e[i](l,e.TEXTURE_WRAP_S,u),e[i](l,e.TEXTURE_WRAP_T,c),e.TEXTURE_WRAP_R&&e[i](l,e.TEXTURE_WRAP_R,h)}if((!a||n.magFilter!=="linear")&&e[i](l,e.TEXTURE_MAG_FILTER,uc[n.magFilter]),t){if(!a||n.mipmapFilter!=="linear"){const u=xy[n.minFilter][n.mipmapFilter];e[i](l,e.TEXTURE_MIN_FILTER,u)}}else e[i](l,e.TEXTURE_MIN_FILTER,uc[n.minFilter]);if(r&&n.maxAnisotropy>1){const u=Math.min(n.maxAnisotropy,e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));e[i](l,r.TEXTURE_MAX_ANISOTROPY_EXT,u)}n.compare&&e[i](l,e.TEXTURE_COMPARE_FUNC,yy[n.compare])}function Sy(n){return{r8unorm:n.RED,r8snorm:n.RED,r8uint:n.RED,r8sint:n.RED,r16uint:n.RED,r16sint:n.RED,r16float:n.RED,rg8unorm:n.RG,rg8snorm:n.RG,rg8uint:n.RG,rg8sint:n.RG,r32uint:n.RED,r32sint:n.RED,r32float:n.RED,rg16uint:n.RG,rg16sint:n.RG,rg16float:n.RG,rgba8unorm:n.RGBA,"rgba8unorm-srgb":n.RGBA,rgba8snorm:n.RGBA,rgba8uint:n.RGBA,rgba8sint:n.RGBA,bgra8unorm:n.RGBA,"bgra8unorm-srgb":n.RGBA,rgb9e5ufloat:n.RGB,rgb10a2unorm:n.RGBA,rg11b10ufloat:n.RGB,rg32uint:n.RG,rg32sint:n.RG,rg32float:n.RG,rgba16uint:n.RGBA,rgba16sint:n.RGBA,rgba16float:n.RGBA,rgba32uint:n.RGBA,rgba32sint:n.RGBA,rgba32float:n.RGBA,stencil8:n.STENCIL_INDEX8,depth16unorm:n.DEPTH_COMPONENT,depth24plus:n.DEPTH_COMPONENT,"depth24plus-stencil8":n.DEPTH_STENCIL,depth32float:n.DEPTH_COMPONENT,"depth32float-stencil8":n.DEPTH_STENCIL}}function wy(n,e){let t={},r=n.RGBA;return n instanceof Se.get().getWebGLRenderingContext()?e.srgb&&(t={"rgba8unorm-srgb":e.srgb.SRGB8_ALPHA8_EXT,"bgra8unorm-srgb":e.srgb.SRGB8_ALPHA8_EXT}):(t={"rgba8unorm-srgb":n.SRGB8_ALPHA8,"bgra8unorm-srgb":n.SRGB8_ALPHA8},r=n.RGBA8),{r8unorm:n.R8,r8snorm:n.R8_SNORM,r8uint:n.R8UI,r8sint:n.R8I,r16uint:n.R16UI,r16sint:n.R16I,r16float:n.R16F,rg8unorm:n.RG8,rg8snorm:n.RG8_SNORM,rg8uint:n.RG8UI,rg8sint:n.RG8I,r32uint:n.R32UI,r32sint:n.R32I,r32float:n.R32F,rg16uint:n.RG16UI,rg16sint:n.RG16I,rg16float:n.RG16F,rgba8unorm:n.RGBA,...t,rgba8snorm:n.RGBA8_SNORM,rgba8uint:n.RGBA8UI,rgba8sint:n.RGBA8I,bgra8unorm:r,rgb9e5ufloat:n.RGB9_E5,rgb10a2unorm:n.RGB10_A2,rg11b10ufloat:n.R11F_G11F_B10F,rg32uint:n.RG32UI,rg32sint:n.RG32I,rg32float:n.RG32F,rgba16uint:n.RGBA16UI,rgba16sint:n.RGBA16I,rgba16float:n.RGBA16F,rgba32uint:n.RGBA32UI,rgba32sint:n.RGBA32I,rgba32float:n.RGBA32F,stencil8:n.STENCIL_INDEX8,depth16unorm:n.DEPTH_COMPONENT16,depth24plus:n.DEPTH_COMPONENT24,"depth24plus-stencil8":n.DEPTH24_STENCIL8,depth32float:n.DEPTH_COMPONENT32F,"depth32float-stencil8":n.DEPTH32F_STENCIL8,...e.s3tc?{"bc1-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT,"bc2-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT,"bc3-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT}:{},...e.s3tc_sRGB?{"bc1-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,"bc2-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,"bc3-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}:{},...e.rgtc?{"bc4-r-unorm":e.rgtc.COMPRESSED_RED_RGTC1_EXT,"bc4-r-snorm":e.rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT,"bc5-rg-unorm":e.rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT,"bc5-rg-snorm":e.rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}:{},...e.bptc?{"bc6h-rgb-float":e.bptc.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,"bc6h-rgb-ufloat":e.bptc.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,"bc7-rgba-unorm":e.bptc.COMPRESSED_RGBA_BPTC_UNORM_EXT,"bc7-rgba-unorm-srgb":e.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT}:{},...e.etc?{"etc2-rgb8unorm":e.etc.COMPRESSED_RGB8_ETC2,"etc2-rgb8unorm-srgb":e.etc.COMPRESSED_SRGB8_ETC2,"etc2-rgb8a1unorm":e.etc.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgb8a1unorm-srgb":e.etc.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgba8unorm":e.etc.COMPRESSED_RGBA8_ETC2_EAC,"etc2-rgba8unorm-srgb":e.etc.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,"eac-r11unorm":e.etc.COMPRESSED_R11_EAC,"eac-rg11unorm":e.etc.COMPRESSED_SIGNED_RG11_EAC}:{},...e.astc?{"astc-4x4-unorm":e.astc.COMPRESSED_RGBA_ASTC_4x4_KHR,"astc-4x4-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,"astc-5x4-unorm":e.astc.COMPRESSED_RGBA_ASTC_5x4_KHR,"astc-5x4-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR,"astc-5x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_5x5_KHR,"astc-5x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,"astc-6x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_6x5_KHR,"astc-6x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,"astc-6x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_6x6_KHR,"astc-6x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,"astc-8x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x5_KHR,"astc-8x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,"astc-8x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x6_KHR,"astc-8x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,"astc-8x8-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x8_KHR,"astc-8x8-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,"astc-10x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x5_KHR,"astc-10x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,"astc-10x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x6_KHR,"astc-10x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,"astc-10x8-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x8_KHR,"astc-10x8-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,"astc-10x10-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x10_KHR,"astc-10x10-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,"astc-12x10-unorm":e.astc.COMPRESSED_RGBA_ASTC_12x10_KHR,"astc-12x10-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,"astc-12x12-unorm":e.astc.COMPRESSED_RGBA_ASTC_12x12_KHR,"astc-12x12-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR}:{}}}function Ty(n){return{r8unorm:n.UNSIGNED_BYTE,r8snorm:n.BYTE,r8uint:n.UNSIGNED_BYTE,r8sint:n.BYTE,r16uint:n.UNSIGNED_SHORT,r16sint:n.SHORT,r16float:n.HALF_FLOAT,rg8unorm:n.UNSIGNED_BYTE,rg8snorm:n.BYTE,rg8uint:n.UNSIGNED_BYTE,rg8sint:n.BYTE,r32uint:n.UNSIGNED_INT,r32sint:n.INT,r32float:n.FLOAT,rg16uint:n.UNSIGNED_SHORT,rg16sint:n.SHORT,rg16float:n.HALF_FLOAT,rgba8unorm:n.UNSIGNED_BYTE,"rgba8unorm-srgb":n.UNSIGNED_BYTE,rgba8snorm:n.BYTE,rgba8uint:n.UNSIGNED_BYTE,rgba8sint:n.BYTE,bgra8unorm:n.UNSIGNED_BYTE,"bgra8unorm-srgb":n.UNSIGNED_BYTE,rgb9e5ufloat:n.UNSIGNED_INT_5_9_9_9_REV,rgb10a2unorm:n.UNSIGNED_INT_2_10_10_10_REV,rg11b10ufloat:n.UNSIGNED_INT_10F_11F_11F_REV,rg32uint:n.UNSIGNED_INT,rg32sint:n.INT,rg32float:n.FLOAT,rgba16uint:n.UNSIGNED_SHORT,rgba16sint:n.SHORT,rgba16float:n.HALF_FLOAT,rgba32uint:n.UNSIGNED_INT,rgba32sint:n.INT,rgba32float:n.FLOAT,stencil8:n.UNSIGNED_BYTE,depth16unorm:n.UNSIGNED_SHORT,depth24plus:n.UNSIGNED_INT,"depth24plus-stencil8":n.UNSIGNED_INT_24_8,depth32float:n.FLOAT,"depth32float-stencil8":n.FLOAT_32_UNSIGNED_INT_24_8_REV}}const Cy=4;class kd{constructor(e){this.managedTextures=[],this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundTextures=[],this._activeTextureLocation=-1,this._boundSamplers=Object.create(null),this._uploads={image:Md,buffer:gy,video:by,compressed:vy},this._useSeparateSamplers=!1,this._renderer=e}contextChange(e){this._gl=e,this._mapFormatToInternalFormat||(this._mapFormatToInternalFormat=wy(e,this._renderer.context.extensions),this._mapFormatToType=Ty(e),this._mapFormatToFormat=Sy(e)),this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundSamplers=Object.create(null);for(let t=0;t<16;t++)this.bind(se.EMPTY,t)}initSource(e){this.bind(e)}bind(e,t=0){const r=e.source;e?(this.bindSource(r,t),this._useSeparateSamplers&&this._bindSampler(r.style,t)):(this.bindSource(null,t),this._useSeparateSamplers&&this._bindSampler(null,t))}bindSource(e,t=0){const r=this._gl;if(e._touched=this._renderer.textureGC.count,this._boundTextures[t]!==e){this._boundTextures[t]=e,this._activateLocation(t),e=e||se.EMPTY.source;const i=this.getGlSource(e);r.bindTexture(i.target,i.texture)}}_bindSampler(e,t=0){const r=this._gl;if(!e){this._boundSamplers[t]=null,r.bindSampler(t,null);return}const i=this._getGlSampler(e);this._boundSamplers[t]!==i&&(this._boundSamplers[t]=i,r.bindSampler(t,i))}unbind(e){const t=e.source,r=this._boundTextures,i=this._gl;for(let s=0;s<r.length;s++)if(r[s]===t){this._activateLocation(s);const o=this.getGlSource(t);i.bindTexture(o.target,null),r[s]=null}}_activateLocation(e){this._activeTextureLocation!==e&&(this._activeTextureLocation=e,this._gl.activeTexture(this._gl.TEXTURE0+e))}_initSource(e){const t=this._gl,r=new my(t.createTexture());if(r.type=this._mapFormatToType[e.format],r.internalFormat=this._mapFormatToInternalFormat[e.format],r.format=this._mapFormatToFormat[e.format],e.autoGenerateMipmaps&&(this._renderer.context.supports.nonPowOf2mipmaps||e.isPowerOfTwo)){const i=Math.max(e.width,e.height);e.mipLevelCount=Math.floor(Math.log2(i))+1}return this._glTextures[e.uid]=r,this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceUpdate,this),e.on("styleChange",this.onStyleChange,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),this.updateStyle(e,!1),r}onStyleChange(e){this.updateStyle(e,!1)}updateStyle(e,t){const r=this._gl,i=this.getGlSource(e);r.bindTexture(r.TEXTURE_2D,i.texture),this._boundTextures[this._activeTextureLocation]=e,cc(e.style,r,e.mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"texParameteri",r.TEXTURE_2D,!this._renderer.context.supports.nonPowOf2wrapping&&!e.isPowerOfTwo,t)}onSourceUnload(e){const t=this._glTextures[e.uid];t&&(this.unbind(e),this._glTextures[e.uid]=null,this._gl.deleteTexture(t.texture))}onSourceUpdate(e){const t=this._gl,r=this.getGlSource(e);t.bindTexture(t.TEXTURE_2D,r.texture),this._boundTextures[this._activeTextureLocation]=e,this._uploads[e.uploadMethodId]?this._uploads[e.uploadMethodId].upload(e,r,t,this._renderer.context.webGLVersion):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.pixelWidth,e.pixelHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e,!1)}onUpdateMipmaps(e,t=!0){t&&this.bindSource(e,0);const r=this.getGlSource(e);this._gl.generateMipmap(r.target)}onSourceDestroy(e){e.off("destroy",this.onSourceDestroy,this),e.off("update",this.onSourceUpdate,this),e.off("resize",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("styleChange",this.onStyleChange,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}_initSampler(e){const t=this._gl,r=this._gl.createSampler();return this._glSamplers[e._resourceId]=r,cc(e,t,this._boundTextures[this._activeTextureLocation].mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"samplerParameteri",r,!1,!0),this._glSamplers[e._resourceId]}_getGlSampler(e){return this._glSamplers[e._resourceId]||this._initSampler(e)}getGlSource(e){return this._glTextures[e.uid]||this._initSource(e)}generateCanvas(e){const{pixels:t,width:r,height:i}=this.getPixels(e),s=Se.get().createCanvas();s.width=r,s.height=i;const o=s.getContext("2d");if(o){const a=o.createImageData(r,i);a.data.set(t),o.putImageData(a,0,0)}return s}getPixels(e){const t=e.source.resolution,r=e.frame,i=Math.max(Math.round(r.width*t),1),s=Math.max(Math.round(r.height*t),1),o=new Uint8Array(Cy*i*s),a=this._renderer,l=a.renderTarget.getRenderTarget(e),u=a.renderTarget.getGpuRenderTarget(l),c=a.gl;return c.bindFramebuffer(c.FRAMEBUFFER,u.resolveTargetFramebuffer),c.readPixels(Math.round(r.x*t),Math.round(r.y*t),i,s,c.RGBA,c.UNSIGNED_BYTE,o),{pixels:new Uint8ClampedArray(o.buffer),width:i,height:s}}destroy(){this.managedTextures.slice().forEach(e=>this.onSourceDestroy(e)),this.managedTextures=null,this._renderer=null}}kd.extension={type:[M.WebGLSystem],name:"texture"};class Rd{init(){const e=new gt({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new ue,type:"mat3x3<f32>"},uRound:{value:0,type:"f32"}}),t=wr(),r=hi({name:"graphics",bits:[Xa,Ya(t),ul,di]});this.shader=new Wt({glProgram:r,resources:{localUniforms:e,batchSamplers:Ka(t)}})}execute(e,t){const r=t.context,i=r.customShader||this.shader,s=e.renderer,o=s.graphicsContext,{batcher:a,instructions:l}=o.getContextRenderData(r);i.groups[0]=s.globalUniforms.bindGroup,s.state.set(e.state),s.shader.bind(i),s.geometry.bind(a.geometry,i.glProgram);const u=l.instructions;for(let c=0;c<l.instructionSize;c++){const h=u[c];if(h.size){for(let d=0;d<h.textures.count;d++)s.texture.bind(h.textures.textures[d],d);s.geometry.draw("triangle-list",h.size,h.start)}}}destroy(){this.shader.destroy(!0),this.shader=null}}Rd.extension={type:[M.WebGLPipesAdaptor],name:"graphics"};class Bd{init(){const e=hi({name:"mesh",bits:[ul,Mx,di]});this._shader=new Wt({glProgram:e,resources:{uTexture:se.EMPTY.source,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new ue}}}})}execute(e,t){const r=e.renderer;let i=t._shader;if(i){if(!i.glProgram){de("Mesh shader has no glProgram",t.shader);return}}else{i=this._shader;const s=t.texture,o=s.source;i.resources.uTexture=o,i.resources.uSampler=o.style,i.resources.textureUniforms.uniforms.uTextureMatrix=s.textureMatrix.mapCoord}i.groups[100]=r.globalUniforms.bindGroup,i.groups[101]=e.localUniformsBindGroup,r.encoder.draw({geometry:t._geometry,shader:i,state:t.state})}destroy(){this._shader.destroy(!0),this._shader=null}}Bd.extension={type:[M.WebGLPipesAdaptor],name:"mesh"};class Id{constructor(e){this._renderer=e}addRenderable(e,t){this._renderer.renderPipes.batch.break(t),t.add(e)}execute(e){e.isRenderable&&e.render(this._renderer)}destroy(){this._renderer=null}}Id.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"customRender"};function Fd(n,e){const t=n.instructionSet,r=t.instructions;for(let i=0;i<t.instructionSize;i++){const s=r[i];e[s.renderPipeId].execute(s)}}class Od{constructor(e){this._renderer=e}addRenderGroup(e,t){this._renderer.renderPipes.batch.break(t),t.add(e)}execute(e){e.isRenderable&&(this._renderer.globalUniforms.push({worldTransformMatrix:e.worldTransform,worldColor:e.worldColorAlpha}),Fd(e,this._renderer.renderPipes),this._renderer.globalUniforms.pop())}destroy(){this._renderer=null}}Od.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"renderGroup"};function dl(n,e){e||(e=0);for(let t=e;t<n.length&&n[t];t++)n[t]=null}function Ud(n,e=[]){e.push(n);for(let t=0;t<n.renderGroupChildren.length;t++)Ud(n.renderGroupChildren[t],e);return e}function Py(n,e,t){const r=n>>16&255,i=n>>8&255,s=n&255,o=e>>16&255,a=e>>8&255,l=e&255,u=r+(o-r)*t,c=i+(a-i)*t,h=s+(l-s)*t;return(u<<16)+(c<<8)+h}const Fo=16777215;function Gd(n,e){return n===Fo||e===Fo?n+e-Fo:Py(n,e,.5)}const Ay=new Ge,hc=jr|gs|Da;function Dd(n,e=!1){Ey(n);const t=n.childrenToUpdate,r=n.updateTick++;for(const i in t){const s=Number(i),o=t[i],a=o.list,l=o.index;for(let u=0;u<l;u++){const c=a[u];c.parentRenderGroup===n&&c.relativeRenderGroupDepth===s&&zd(c,r,0)}dl(a,l),o.index=0}if(e)for(let i=0;i<n.renderGroupChildren.length;i++)Dd(n.renderGroupChildren[i],e)}function Ey(n){const e=n.root;let t;if(n.renderGroupParent){const r=n.renderGroupParent;n.worldTransform.appendFrom(e.relativeGroupTransform,r.worldTransform),n.worldColor=Gd(e.groupColor,r.worldColor),t=e.groupAlpha*r.worldAlpha}else n.worldTransform.copyFrom(e.localTransform),n.worldColor=e.localColor,t=e.localAlpha;t=t<0?0:t>1?1:t,n.worldAlpha=t,n.worldColorAlpha=n.worldColor+((t*255|0)<<24)}function zd(n,e,t){if(e===n.updateTick)return;n.updateTick=e,n.didChange=!1;const r=n.localTransform;n.updateLocalTransform();const i=n.parent;if(i&&!i.renderGroup?(t=t|n._updateFlags,n.relativeGroupTransform.appendFrom(r,i.relativeGroupTransform),t&hc&&fc(n,i,t)):(t=n._updateFlags,n.relativeGroupTransform.copyFrom(r),t&hc&&fc(n,Ay,t)),!n.renderGroup){const s=n.children,o=s.length;for(let l=0;l<o;l++)zd(s[l],e,t);const a=n.parentRenderGroup;n.renderPipeId&&!a.structureDidChange&&a.updateRenderable(n)}}function fc(n,e,t){if(t&gs){n.groupColor=Gd(n.localColor,e.groupColor);let r=n.localAlpha*e.groupAlpha;r=r<0?0:r>1?1:r,n.groupAlpha=r,n.groupColorAlpha=n.groupColor+((r*255|0)<<24)}t&Da&&(n.groupBlendMode=n.localBlendMode==="inherit"?e.groupBlendMode:n.localBlendMode),t&jr&&(n.globalDisplayStatus=n.localDisplayStatus&e.globalDisplayStatus),n._updateFlags=0}function My(n,e){const{list:t,index:r}=n.childrenRenderablesToUpdate;let i=!1;for(let s=0;s<r;s++){const o=t[s];if(i=e[o.renderPipeId].validateRenderable(o),i)break}return n.structureDidChange=i,i}const ky=new ue;class Ld{constructor(e){this._renderer=e}render({container:e,transform:t}){e.isRenderGroup=!0;const r=e.parent,i=e.renderGroup.renderGroupParent;e.parent=null,e.renderGroup.renderGroupParent=null;const s=this._renderer,o=Ud(e.renderGroup,[]);let a=ky;t&&(a=a.copyFrom(e.renderGroup.localTransform),e.renderGroup.localTransform.copyFrom(t));const l=s.renderPipes;for(let u=0;u<o.length;u++){const c=o[u];c.runOnRender(),c.instructionSet.renderPipes=l,c.structureDidChange?dl(c.childrenRenderablesToUpdate.list,0):My(c,l),Dd(c),c.structureDidChange?(c.structureDidChange=!1,kx(c,s)):Ry(c),c.childrenRenderablesToUpdate.index=0,s.renderPipes.batch.upload(c.instructionSet)}s.globalUniforms.start({worldTransformMatrix:t?e.renderGroup.localTransform:e.renderGroup.worldTransform,worldColor:e.renderGroup.worldColorAlpha}),Fd(e.renderGroup,l),l.uniformBatch&&l.uniformBatch.renderEnd(),t&&e.renderGroup.localTransform.copyFrom(a),e.parent=r,e.renderGroup.renderGroupParent=i}destroy(){this._renderer=null}}Ld.extension={type:[M.WebGLSystem,M.WebGPUSystem,M.CanvasSystem],name:"renderGroup"};function Ry(n){const{list:e,index:t}=n.childrenRenderablesToUpdate;for(let r=0;r<t;r++){const i=e[r];i.didViewUpdate&&n.updateRenderable(i)}dl(e,t)}class pl{constructor(){this.batcherName="default",this.attributeSize=4,this.indexSize=6,this.packAsQuad=!0,this.roundPixels=0,this._attributeStart=0,this._batcher=null,this._batch=null}get blendMode(){return this.renderable.groupBlendMode}get color(){return this.renderable.groupColorAlpha}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.bounds=null}}class Nd{constructor(e){this._gpuSpriteHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e}addRenderable(e,t){const r=this._getGpuSprite(e);e._didSpriteUpdate&&this._updateBatchableSprite(e,r),this._renderer.renderPipes.batch.addToBatch(r,t)}updateRenderable(e){const t=this._gpuSpriteHash[e.uid];e._didSpriteUpdate&&this._updateBatchableSprite(e,t),t._batcher.updateElement(t)}validateRenderable(e){const t=e._texture,r=this._getGpuSprite(e);return r.texture._source!==t._source?!r._batcher.checkAndUpdateTexture(r,t):!1}destroyRenderable(e){const t=this._gpuSpriteHash[e.uid];Te.return(t),this._gpuSpriteHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}_updateBatchableSprite(e,t){e._didSpriteUpdate=!1,t.bounds=e.bounds,t.texture=e._texture}_getGpuSprite(e){return this._gpuSpriteHash[e.uid]||this._initGPUSprite(e)}_initGPUSprite(e){const t=Te.get(pl);return t.renderable=e,t.transform=e.groupTransform,t.texture=e._texture,t.bounds=e.bounds,t.roundPixels=this._renderer._roundPixels|e._roundPixels,this._gpuSpriteHash[e.uid]=t,e._didSpriteUpdate=!1,e.on("destroyed",this._destroyRenderableBound),t}destroy(){for(const e in this._gpuSpriteHash)Te.return(this._gpuSpriteHash[e]);this._gpuSpriteHash=null,this._renderer=null}}Nd.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"sprite"};const ml=class Hd{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new me(0),this.color=this._backgroundColor,this.alpha=1}init(e){e={...Hd.defaultOptions,...e},this.clearBeforeRender=e.clearBeforeRender,this.color=e.background||e.backgroundColor||this._backgroundColor,this.alpha=e.backgroundAlpha,this._backgroundColor.setAlpha(e.backgroundAlpha)}get color(){return this._backgroundColor}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get colorRgba(){return this._backgroundColor.toArray()}destroy(){}};ml.extension={type:[M.WebGLSystem,M.WebGPUSystem,M.CanvasSystem],name:"background",priority:0};ml.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};let By=ml;const Zr={};pe.handle(M.BlendMode,n=>{if(!n.name)throw new Error("BlendMode extension must have a name property");Zr[n.name]=n.ref},n=>{delete Zr[n.name]});class Vd{constructor(e){this._isAdvanced=!1,this._filterHash=Object.create(null),this._renderer=e}setBlendMode(e,t,r){if(this._activeBlendMode===t){this._isAdvanced&&this._renderableList.push(e);return}this._activeBlendMode=t,this._isAdvanced&&this._endAdvancedBlendMode(r),this._isAdvanced=!!Zr[t],this._isAdvanced&&(this._beginAdvancedBlendMode(r),this._renderableList.push(e))}_beginAdvancedBlendMode(e){this._renderer.renderPipes.batch.break(e);const t=this._activeBlendMode;if(!Zr[t]){de(`Unable to assign BlendMode: '${t}'. You may want to include: import 'pixi.js/advanced-blend-modes'`);return}let r=this._filterHash[t];r||(r=this._filterHash[t]=new ps,r.filters=[new Zr[t]]);const i={renderPipeId:"filter",action:"pushFilter",renderables:[],filterEffect:r,canBundle:!1};this._renderableList=i.renderables,e.add(i)}_endAdvancedBlendMode(e){this._renderableList=null,this._renderer.renderPipes.batch.break(e),e.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}buildStart(){this._isAdvanced=!1}buildEnd(e){this._isAdvanced&&this._endAdvancedBlendMode(e)}destroy(){this._renderer=null,this._renderableList=null;for(const e in this._filterHash)this._filterHash[e].destroy();this._filterHash=null}}Vd.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"blendMode"};const Oo={png:"image/png",jpg:"image/jpeg",webp:"image/webp"},gl=class Wd{constructor(e){this._renderer=e}_normalizeOptions(e,t={}){return e instanceof Ge||e instanceof se?{target:e,...t}:{...t,...e}}async image(e){const t=new Image;return t.src=await this.base64(e),t}async base64(e){e=this._normalizeOptions(e,Wd.defaultImageOptions);const{format:t,quality:r}=e,i=this.canvas(e);if(i.toBlob!==void 0)return new Promise((s,o)=>{i.toBlob(a=>{if(!a){o(new Error("ICanvas.toBlob failed!"));return}const l=new FileReader;l.onload=()=>s(l.result),l.onerror=o,l.readAsDataURL(a)},Oo[t],r)});if(i.toDataURL!==void 0)return i.toDataURL(Oo[t],r);if(i.convertToBlob!==void 0){const s=await i.convertToBlob({type:Oo[t],quality:r});return new Promise((o,a)=>{const l=new FileReader;l.onload=()=>o(l.result),l.onerror=a,l.readAsDataURL(s)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e){e=this._normalizeOptions(e);const t=e.target,r=this._renderer;if(t instanceof se)return r.texture.generateCanvas(t);const i=r.textureGenerator.generateTexture(e),s=r.texture.generateCanvas(i);return i.destroy(),s}pixels(e){e=this._normalizeOptions(e);const t=e.target,r=this._renderer,i=t instanceof se?t:r.textureGenerator.generateTexture(e),s=r.texture.getPixels(i);return t instanceof Ge&&i.destroy(),s}texture(e){return e=this._normalizeOptions(e),e.target instanceof se?e.target:this._renderer.textureGenerator.generateTexture(e)}download(e){e=this._normalizeOptions(e);const t=this.canvas(e),r=document.createElement("a");r.download=e.filename??"image.png",r.href=t.toDataURL("image/png"),document.body.appendChild(r),r.click(),document.body.removeChild(r)}log(e){const t=e.width??200;e=this._normalizeOptions(e);const r=this.canvas(e),i=r.toDataURL();console.log(`[Pixi Texture] ${r.width}px ${r.height}px`);const s=["font-size: 1px;",`padding: ${t}px 300px;`,`background: url(${i}) no-repeat;`,"background-size: contain;"].join(" ");console.log("%c ",s)}destroy(){this._renderer=null}};gl.extension={type:[M.WebGLSystem,M.WebGPUSystem],name:"extract"};gl.defaultImageOptions={format:"png",quality:1};let Iy=gl;class _l extends se{static create(e){return new _l({source:new Je(e)})}resize(e,t,r){return this.source.resize(e,t,r),this}}const Fy=new Re,Oy=new vt,Uy=[0,0,0,0];class jd{constructor(e){this._renderer=e}generateTexture(e){e instanceof Ge&&(e={target:e,frame:void 0,textureSourceOptions:{},resolution:void 0});const t=e.resolution||this._renderer.resolution,r=e.antialias||this._renderer.view.antialias,i=e.target;let s=e.clearColor;s?s=Array.isArray(s)&&s.length===4?s:me.shared.setValue(s).toArray():s=Uy;const o=e.frame?.copyTo(Fy)||Ga(i,Oy).rectangle;o.width=Math.max(o.width,1/t)|0,o.height=Math.max(o.height,1/t)|0;const a=_l.create({...e.textureSourceOptions,width:o.width,height:o.height,resolution:t,antialias:r}),l=ue.shared.translate(-o.x,-o.y);return this._renderer.render({container:i,transform:l,target:a,clearColor:s}),a.source.updateMipmaps(),a}destroy(){this._renderer=null}}jd.extension={type:[M.WebGLSystem,M.WebGPUSystem],name:"textureGenerator"};function Is(n,e,t){const r=(n>>24&255)/255;e[t++]=(n&255)/255*r,e[t++]=(n>>8&255)/255*r,e[t++]=(n>>16&255)/255*r,e[t++]=r}class Xd{constructor(e){this._stackIndex=0,this._globalUniformDataStack=[],this._uniformsPool=[],this._activeUniforms=[],this._bindGroupPool=[],this._activeBindGroups=[],this._renderer=e}reset(){this._stackIndex=0;for(let e=0;e<this._activeUniforms.length;e++)this._uniformsPool.push(this._activeUniforms[e]);for(let e=0;e<this._activeBindGroups.length;e++)this._bindGroupPool.push(this._activeBindGroups[e]);this._activeUniforms.length=0,this._activeBindGroups.length=0}start(e){this.reset(),this.push(e)}bind({size:e,projectionMatrix:t,worldTransformMatrix:r,worldColor:i,offset:s}){const o=this._renderer.renderTarget.renderTarget,a=this._stackIndex?this._globalUniformDataStack[this._stackIndex-1]:{projectionData:o,worldTransformMatrix:new ue,worldColor:4294967295,offset:new ke},l={projectionMatrix:t||this._renderer.renderTarget.projectionMatrix,resolution:e||o.size,worldTransformMatrix:r||a.worldTransformMatrix,worldColor:i||a.worldColor,offset:s||a.offset,bindGroup:null},u=this._uniformsPool.pop()||this._createUniforms();this._activeUniforms.push(u);const c=u.uniforms;c.uProjectionMatrix=l.projectionMatrix,c.uResolution=l.resolution,c.uWorldTransformMatrix.copyFrom(l.worldTransformMatrix),c.uWorldTransformMatrix.tx-=l.offset.x,c.uWorldTransformMatrix.ty-=l.offset.y,Is(l.worldColor,c.uWorldColorAlpha,0),u.update();let h;this._renderer.renderPipes.uniformBatch?h=this._renderer.renderPipes.uniformBatch.getUniformBindGroup(u,!1):(h=this._bindGroupPool.pop()||new hn,this._activeBindGroups.push(h),h.setResource(u,0)),l.bindGroup=h,this._currentGlobalUniformData=l}push(e){this.bind(e),this._globalUniformDataStack[this._stackIndex++]=this._currentGlobalUniformData}pop(){this._currentGlobalUniformData=this._globalUniformDataStack[--this._stackIndex-1],this._renderer.type===Pt.WEBGL&&this._currentGlobalUniformData.bindGroup.resources[0].update()}get bindGroup(){return this._currentGlobalUniformData.bindGroup}get uniformGroup(){return this._currentGlobalUniformData.bindGroup.resources[0]}_createUniforms(){return new gt({uProjectionMatrix:{value:new ue,type:"mat3x3<f32>"},uWorldTransformMatrix:{value:new ue,type:"mat3x3<f32>"},uWorldColorAlpha:{value:new Float32Array(4),type:"vec4<f32>"},uResolution:{value:[0,0],type:"vec2<f32>"}},{isStatic:!0})}destroy(){this._renderer=null}}Xd.extension={type:[M.WebGLSystem,M.WebGPUSystem,M.CanvasSystem],name:"globalUniforms"};let Gy=1;class qd{constructor(){this._tasks=[]}init(){$t.system.add(this._update,this)}repeat(e,t){const r=Gy++;return this._tasks.push({func:e,duration:t,start:performance.now(),last:performance.now(),repeat:!0,id:r}),r}cancel(e){for(let t=0;t<this._tasks.length;t++)if(this._tasks[t].id===e){this._tasks.splice(t,1);return}}_update(){const e=performance.now();for(let t=0;t<this._tasks.length;t++){const r=this._tasks[t];if(e-r.last>=r.duration){const i=e-r.start;r.func(i),r.last=e}}}destroy(){$t.system.remove(this._update,this),this._tasks.length=0}}qd.extension={type:[M.WebGLSystem,M.WebGPUSystem,M.CanvasSystem],name:"scheduler",priority:0};let dc=!1;function Dy(n){if(!dc){if(Se.get().getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){const e=[`%c  %c  %c  %c  %c PixiJS %c v${vs} (${n}) http://www.pixijs.com/

`,"background: #E72264; padding:5px 0;","background: #6CA2EA; padding:5px 0;","background: #B5D33D; padding:5px 0;","background: #FED23F; padding:5px 0;","color: #FFFFFF; background: #E72264; padding:5px 0;","color: #E72264; background: #FFFFFF; padding:5px 0;"];globalThis.console.log(...e)}else globalThis.console&&globalThis.console.log(`PixiJS ${vs} - ${n} - http://www.pixijs.com/`);dc=!0}}class vl{constructor(e){this._renderer=e}init(e){if(e.hello){let t=this._renderer.name;this._renderer.type===Pt.WEBGL&&(t+=` ${this._renderer.context.webGLVersion}`),Dy(t)}}}vl.extension={type:[M.WebGLSystem,M.WebGPUSystem,M.CanvasSystem],name:"hello",priority:-2};vl.defaultOptions={hello:!1};const bl=class Yd{constructor(e){this._managedRenderables=[],this._renderer=e}init(e){e={...Yd.defaultOptions,...e},this.maxUnusedTime=e.renderableGCMaxUnusedTime,this._frequency=e.renderableGCFrequency,this.enabled=e.renderableGCActive}get enabled(){return!!this._handler}set enabled(e){this.enabled!==e&&(e?this._handler=this._renderer.scheduler.repeat(()=>this.run(),this._frequency):this._renderer.scheduler.cancel(this._handler))}prerender(){this._now=performance.now()}addRenderable(e,t){this.enabled&&(e._lastUsed=this._now,e._lastInstructionTick===-1&&(this._managedRenderables.push(e),e.once("destroyed",this._removeRenderable,this)),e._lastInstructionTick=t.tick)}run(){const e=performance.now(),t=this._managedRenderables,r=this._renderer.renderPipes;let i=0;for(let s=0;s<t.length;s++){const o=t[s];if(o===null){i++;continue}const l=(o.renderGroup??o.parentRenderGroup)?.instructionSet?.tick??-1;o._lastInstructionTick!==l&&e-o._lastUsed>this.maxUnusedTime?(o.destroyed||r[o.renderPipeId].destroyRenderable(o),o._lastInstructionTick=-1,i++,o.off("destroyed",this._removeRenderable,this)):t[s-i]=o}t.length=t.length-i}destroy(){this.enabled=!1,this._renderer=null,this._managedRenderables.length=0}_removeRenderable(e){const t=this._managedRenderables.indexOf(e);t>=0&&(e.off("destroyed",this._removeRenderable,this),this._managedRenderables[t]=null)}};bl.extension={type:[M.WebGLSystem,M.WebGPUSystem],name:"renderableGC"};bl.defaultOptions={renderableGCActive:!0,renderableGCMaxUnusedTime:6e4,renderableGCFrequency:3e4};let zy=bl;const xl=class Kd{constructor(e){this._renderer=e,this.count=0,this.checkCount=0}init(e){e={...Kd.defaultOptions,...e},this.checkCountMax=e.textureGCCheckCountMax,this.maxIdle=e.textureGCAMaxIdle??e.textureGCMaxIdle,this.active=e.textureGCActive}postrender(){this._renderer.renderingToScreen&&(this.count++,this.active&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this._renderer.texture.managedTextures;for(let t=0;t<e.length;t++){const r=e[t];r.autoGarbageCollect&&r.resource&&r._touched>-1&&this.count-r._touched>this.maxIdle&&(r._touched=-1,r.unload())}}destroy(){this._renderer=null}};xl.extension={type:[M.WebGLSystem,M.WebGPUSystem],name:"textureGC"};xl.defaultOptions={textureGCActive:!0,textureGCAMaxIdle:null,textureGCMaxIdle:60*60,textureGCCheckCountMax:600};let Ly=xl;const yl=class Zd{get autoDensity(){return this.texture.source.autoDensity}set autoDensity(e){this.texture.source.autoDensity=e}get resolution(){return this.texture.source._resolution}set resolution(e){this.texture.source.resize(this.texture.source.width,this.texture.source.height,e)}init(e){e={...Zd.defaultOptions,...e},e.view&&(ie(we,"ViewSystem.view has been renamed to ViewSystem.canvas"),e.canvas=e.view),this.screen=new Re(0,0,e.width,e.height),this.canvas=e.canvas||Se.get().createCanvas(),this.antialias=!!e.antialias,this.texture=bd(this.canvas,e),this.renderTarget=new va({colorTextures:[this.texture],depth:!!e.depth,isRoot:!0}),this.texture.source.transparent=e.backgroundAlpha<1,this.resolution=e.resolution}resize(e,t,r){this.texture.source.resize(e,t,r),this.screen.width=this.texture.frame.width,this.screen.height=this.texture.frame.height}destroy(e=!1){(typeof e=="boolean"?e:!!e?.removeView)&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}};yl.extension={type:[M.WebGLSystem,M.WebGPUSystem,M.CanvasSystem],name:"view",priority:0};yl.defaultOptions={width:800,height:600,autoDensity:!1,antialias:!1};let Qd=yl;const Jd=[By,Xd,vl,Qd,Ld,Ly,jd,Iy,sf,zy,qd],$d=[Vd,ed,Nd,Od,nd,id,rd,Id],Ny=[...Jd,vd,Lx,Ox,sd,kd,wd,ud,Ad,Pd,fd,py,dd,hd],Hy=[...$d],Vy=[Qf,Bd,Rd],ep=[],tp=[],np=[];pe.handleByNamedList(M.WebGLSystem,ep);pe.handleByNamedList(M.WebGLPipes,tp);pe.handleByNamedList(M.WebGLPipesAdaptor,np);pe.add(...Ny,...Hy,...Vy);class Wy extends Es{constructor(){const e={name:"webgl",type:Pt.WEBGL,systems:ep,renderPipes:tp,renderPipeAdaptors:np};super(e)}}const jy=Object.freeze(Object.defineProperty({__proto__:null,WebGLRenderer:Wy},Symbol.toStringTag,{value:"Module"}));class rp{constructor(e){this._hash=Object.create(null),this._renderer=e}contextChange(e){this._gpu=e}getBindGroup(e,t,r){return e._updateKey(),this._hash[e._key]||this._createBindGroup(e,t,r)}_createBindGroup(e,t,r){const i=this._gpu.device,s=t.layout[r],o=[],a=this._renderer;for(const c in s){const h=e.resources[c]??e.resources[s[c]];let d;if(h._resourceType==="uniformGroup"){const f=h;a.ubo.updateUniformGroup(f);const p=f.buffer;d={buffer:a.buffer.getGPUBuffer(p),offset:0,size:p.descriptor.size}}else if(h._resourceType==="buffer"){const f=h;d={buffer:a.buffer.getGPUBuffer(f),offset:0,size:f.descriptor.size}}else if(h._resourceType==="bufferResource"){const f=h;d={buffer:a.buffer.getGPUBuffer(f.buffer),offset:f.offset,size:f.size}}else if(h._resourceType==="textureSampler"){const f=h;d=a.texture.getGpuSampler(f)}else if(h._resourceType==="textureSource"){const f=h;d=a.texture.getGpuSource(f).createView({})}o.push({binding:s[c],resource:d})}const l=a.shader.getProgramData(t).bindGroups[r],u=i.createBindGroup({layout:l,entries:o});return this._hash[e._key]=u,u}destroy(){for(const e of Object.keys(this._hash))this._hash[e]=null;this._hash=null,this._renderer=null}}rp.extension={type:[M.WebGPUSystem],name:"bindGroup"};class ip{constructor(){this._gpuBuffers=Object.create(null),this._managedBuffers=[]}contextChange(e){this._gpu=e}getGPUBuffer(e){return this._gpuBuffers[e.uid]||this.createGPUBuffer(e)}updateBuffer(e){const t=this._gpuBuffers[e.uid]||this.createGPUBuffer(e),r=e.data;return e._updateID&&r&&(e._updateID=0,this._gpu.device.queue.writeBuffer(t,0,r.buffer,0,(e._updateSize||r.byteLength)+3&-4)),t}destroyAll(){for(const e in this._gpuBuffers)this._gpuBuffers[e].destroy();this._gpuBuffers={}}createGPUBuffer(e){this._gpuBuffers[e.uid]||(e.on("update",this.updateBuffer,this),e.on("change",this.onBufferChange,this),e.on("destroy",this.onBufferDestroy,this),this._managedBuffers.push(e));const t=this._gpu.device.createBuffer(e.descriptor);return e._updateID=0,e.data&&(ua(e.data.buffer,t.getMappedRange()),t.unmap()),this._gpuBuffers[e.uid]=t,t}onBufferChange(e){this._gpuBuffers[e.uid].destroy(),e._updateID=0,this._gpuBuffers[e.uid]=this.createGPUBuffer(e)}onBufferDestroy(e){this._managedBuffers.splice(this._managedBuffers.indexOf(e),1),this._destroyBuffer(e)}destroy(){this._managedBuffers.forEach(e=>this._destroyBuffer(e)),this._managedBuffers=null,this._gpuBuffers=null}_destroyBuffer(e){this._gpuBuffers[e.uid].destroy(),e.off("update",this.updateBuffer,this),e.off("change",this.onBufferChange,this),e.off("destroy",this.onBufferDestroy,this),this._gpuBuffers[e.uid]=null}}ip.extension={type:[M.WebGPUSystem],name:"buffer"};class Xy{constructor({minUniformOffsetAlignment:e}){this._minUniformOffsetAlignment=256,this.byteIndex=0,this._minUniformOffsetAlignment=e,this.data=new Float32Array(65535)}clear(){this.byteIndex=0}addEmptyGroup(e){if(e>this._minUniformOffsetAlignment/4)throw new Error(`UniformBufferBatch: array is too large: ${e*4}`);const t=this.byteIndex;let r=t+e*4;if(r=Math.ceil(r/this._minUniformOffsetAlignment)*this._minUniformOffsetAlignment,r>this.data.length*4)throw new Error("UniformBufferBatch: ubo batch got too big");return this.byteIndex=r,t}addGroup(e){const t=this.addEmptyGroup(e.length);for(let r=0;r<e.length;r++)this.data[t/4+r]=e[r];return t}destroy(){this._buffer.destroy(),this._buffer=null,this.data=null}}class sp{constructor(e){this._colorMaskCache=15,this._renderer=e}setMask(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.pipeline.setColorMask(e))}destroy(){this._renderer=null,this._colorMaskCache=null}}sp.extension={type:[M.WebGPUSystem],name:"colorMask"};class Sl{constructor(e){this._renderer=e}async init(e){return this._initPromise?this._initPromise:(this._initPromise=this._createDeviceAndAdaptor(e).then(t=>{this.gpu=t,this._renderer.runners.contextChange.emit(this.gpu)}),this._initPromise)}contextChange(e){this._renderer.gpu=e}async _createDeviceAndAdaptor(e){const t=await Se.get().getNavigator().gpu.requestAdapter({powerPreference:e.powerPreference,forceFallbackAdapter:e.forceFallbackAdapter}),r=["texture-compression-bc","texture-compression-astc","texture-compression-etc2"].filter(s=>t.features.has(s)),i=await t.requestDevice({requiredFeatures:r});return{adapter:t,device:i}}destroy(){this.gpu=null,this._renderer=null}}Sl.extension={type:[M.WebGPUSystem],name:"device"};Sl.defaultOptions={powerPreference:void 0,forceFallbackAdapter:!1};class op{constructor(e){this._boundBindGroup=Object.create(null),this._boundVertexBuffer=Object.create(null),this._renderer=e}renderStart(){this.commandFinished=new Promise(e=>{this._resolveCommandFinished=e}),this.commandEncoder=this._renderer.gpu.device.createCommandEncoder()}beginRenderPass(e){this.endRenderPass(),this._clearCache(),this.renderPassEncoder=this.commandEncoder.beginRenderPass(e.descriptor)}endRenderPass(){this.renderPassEncoder&&this.renderPassEncoder.end(),this.renderPassEncoder=null}setViewport(e){this.renderPassEncoder.setViewport(e.x,e.y,e.width,e.height,0,1)}setPipelineFromGeometryProgramAndState(e,t,r,i){const s=this._renderer.pipeline.getPipeline(e,t,r,i);this.setPipeline(s)}setPipeline(e){this._boundPipeline!==e&&(this._boundPipeline=e,this.renderPassEncoder.setPipeline(e))}_setVertexBuffer(e,t){this._boundVertexBuffer[e]!==t&&(this._boundVertexBuffer[e]=t,this.renderPassEncoder.setVertexBuffer(e,this._renderer.buffer.updateBuffer(t)))}_setIndexBuffer(e){if(this._boundIndexBuffer===e)return;this._boundIndexBuffer=e;const t=e.data.BYTES_PER_ELEMENT===2?"uint16":"uint32";this.renderPassEncoder.setIndexBuffer(this._renderer.buffer.updateBuffer(e),t)}resetBindGroup(e){this._boundBindGroup[e]=null}setBindGroup(e,t,r){if(this._boundBindGroup[e]===t)return;this._boundBindGroup[e]=t,t._touch(this._renderer.textureGC.count);const i=this._renderer.bindGroup.getBindGroup(t,r,e);this.renderPassEncoder.setBindGroup(e,i)}setGeometry(e,t){const r=this._renderer.pipeline.getBufferNamesToBind(e,t);for(const i in r)this._setVertexBuffer(i,e.attributes[r[i]].buffer);e.indexBuffer&&this._setIndexBuffer(e.indexBuffer)}_setShaderBindGroups(e,t){for(const r in e.groups){const i=e.groups[r];t||this._syncBindGroup(i),this.setBindGroup(r,i,e.gpuProgram)}}_syncBindGroup(e){for(const t in e.resources){const r=e.resources[t];r.isUniformGroup&&this._renderer.ubo.updateUniformGroup(r)}}draw(e){const{geometry:t,shader:r,state:i,topology:s,size:o,start:a,instanceCount:l,skipSync:u}=e;this.setPipelineFromGeometryProgramAndState(t,r.gpuProgram,i,s),this.setGeometry(t,r.gpuProgram),this._setShaderBindGroups(r,u),t.indexBuffer?this.renderPassEncoder.drawIndexed(o||t.indexBuffer.data.length,l||t.instanceCount,a||0):this.renderPassEncoder.draw(o||t.getSize(),l||t.instanceCount,a||0)}finishRenderPass(){this.renderPassEncoder&&(this.renderPassEncoder.end(),this.renderPassEncoder=null)}postrender(){this.finishRenderPass(),this._gpu.device.queue.submit([this.commandEncoder.finish()]),this._resolveCommandFinished(),this.commandEncoder=null}restoreRenderPass(){const e=this._renderer.renderTarget.adaptor.getDescriptor(this._renderer.renderTarget.renderTarget,!1,[0,0,0,1]);this.renderPassEncoder=this.commandEncoder.beginRenderPass(e);const t=this._boundPipeline,r={...this._boundVertexBuffer},i=this._boundIndexBuffer,s={...this._boundBindGroup};this._clearCache();const o=this._renderer.renderTarget.viewport;this.renderPassEncoder.setViewport(o.x,o.y,o.width,o.height,0,1),this.setPipeline(t);for(const a in r)this._setVertexBuffer(a,r[a]);for(const a in s)this.setBindGroup(a,s[a],null);this._setIndexBuffer(i)}_clearCache(){for(let e=0;e<16;e++)this._boundBindGroup[e]=null,this._boundVertexBuffer[e]=null;this._boundIndexBuffer=null,this._boundPipeline=null}destroy(){this._renderer=null,this._gpu=null,this._boundBindGroup=null,this._boundVertexBuffer=null,this._boundIndexBuffer=null,this._boundPipeline=null}contextChange(e){this._gpu=e}}op.extension={type:[M.WebGPUSystem],name:"encoder",priority:1};class ap{constructor(e){this._renderTargetStencilState=Object.create(null),this._renderer=e,e.renderTarget.onRenderTargetChange.add(this)}onRenderTargetChange(e){let t=this._renderTargetStencilState[e.uid];t||(t=this._renderTargetStencilState[e.uid]={stencilMode:nt.DISABLED,stencilReference:0}),this._activeRenderTarget=e,this.setStencilMode(t.stencilMode,t.stencilReference)}setStencilMode(e,t){const r=this._renderTargetStencilState[this._activeRenderTarget.uid];r.stencilMode=e,r.stencilReference=t;const i=this._renderer;i.pipeline.setStencilMode(e),i.encoder.renderPassEncoder.setStencilReference(t)}destroy(){this._renderer.renderTarget.onRenderTargetChange.remove(this),this._renderer=null,this._activeRenderTarget=null,this._renderTargetStencilState=null}}ap.extension={type:[M.WebGPUSystem],name:"stencil"};const es={i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},f16:{align:2,size:2},"vec2<i32>":{align:8,size:8},"vec2<u32>":{align:8,size:8},"vec2<f32>":{align:8,size:8},"vec2<f16>":{align:4,size:4},"vec3<i32>":{align:16,size:12},"vec3<u32>":{align:16,size:12},"vec3<f32>":{align:16,size:12},"vec3<f16>":{align:8,size:6},"vec4<i32>":{align:16,size:16},"vec4<u32>":{align:16,size:16},"vec4<f32>":{align:16,size:16},"vec4<f16>":{align:8,size:8},"mat2x2<f32>":{align:8,size:16},"mat2x2<f16>":{align:4,size:8},"mat3x2<f32>":{align:8,size:24},"mat3x2<f16>":{align:4,size:12},"mat4x2<f32>":{align:8,size:32},"mat4x2<f16>":{align:4,size:16},"mat2x3<f32>":{align:16,size:32},"mat2x3<f16>":{align:8,size:16},"mat3x3<f32>":{align:16,size:48},"mat3x3<f16>":{align:8,size:24},"mat4x3<f32>":{align:16,size:64},"mat4x3<f16>":{align:8,size:32},"mat2x4<f32>":{align:16,size:32},"mat2x4<f16>":{align:8,size:16},"mat3x4<f32>":{align:16,size:48},"mat3x4<f16>":{align:8,size:24},"mat4x4<f32>":{align:16,size:64},"mat4x4<f16>":{align:8,size:32}};function qy(n){const e=n.map(r=>({data:r,offset:0,size:0}));let t=0;for(let r=0;r<e.length;r++){const i=e[r];let s=es[i.data.type].size;const o=es[i.data.type].align;if(!es[i.data.type])throw new Error(`[Pixi.js] WebGPU UniformBuffer: Unknown type ${i.data.type}`);i.data.size>1&&(s=Math.max(s,o)*i.data.size),t=Math.ceil(t/o)*o,i.size=s,i.offset=t,t+=s}return t=Math.ceil(t/16)*16,{uboElements:e,size:t}}function Yy(n,e){const{size:t,align:r}=es[n.data.type],i=(r-t)/4;return`
         v = uv.${n.data.name};
         ${e!==0?`offset += ${e};`:""}

         arrayOffset = offset;

         t = 0;

         for(var i=0; i < ${n.data.size*(t/4)}; i++)
         {
             for(var j = 0; j < ${t/4}; j++)
             {
                 data[arrayOffset++] = v[t++];
             }
             ${i!==0?`arrayOffset += ${i};`:""}
         }
     `}function Ky(n){return gd(n,"uboWgsl",Yy,Vx)}class lp extends pd{constructor(){super({createUboElements:qy,generateUboSync:Ky})}}lp.extension={type:[M.WebGPUSystem],name:"ubo"};const gn=128;class up{constructor(e){this._bindGroupHash=Object.create(null),this._buffers=[],this._bindGroups=[],this._bufferResources=[],this._renderer=e,this._batchBuffer=new Xy({minUniformOffsetAlignment:gn});const t=256/gn;for(let r=0;r<t;r++){let i=Ee.UNIFORM|Ee.COPY_DST;r===0&&(i|=Ee.COPY_SRC),this._buffers.push(new Vt({data:this._batchBuffer.data,usage:i}))}}renderEnd(){this._uploadBindGroups(),this._resetBindGroups()}_resetBindGroups(){for(const e in this._bindGroupHash)this._bindGroupHash[e]=null;this._batchBuffer.clear()}getUniformBindGroup(e,t){if(!t&&this._bindGroupHash[e.uid])return this._bindGroupHash[e.uid];this._renderer.ubo.ensureUniformGroup(e);const r=e.buffer.data,i=this._batchBuffer.addEmptyGroup(r.length);return this._renderer.ubo.syncUniformGroup(e,this._batchBuffer.data,i/4),this._bindGroupHash[e.uid]=this._getBindGroup(i/gn),this._bindGroupHash[e.uid]}getUboResource(e){this._renderer.ubo.updateUniformGroup(e);const t=e.buffer.data,r=this._batchBuffer.addGroup(t);return this._getBufferResource(r/gn)}getArrayBindGroup(e){const t=this._batchBuffer.addGroup(e);return this._getBindGroup(t/gn)}getArrayBufferResource(e){const r=this._batchBuffer.addGroup(e)/gn;return this._getBufferResource(r)}_getBufferResource(e){if(!this._bufferResources[e]){const t=this._buffers[e%2];this._bufferResources[e]=new fl({buffer:t,offset:(e/2|0)*256,size:gn})}return this._bufferResources[e]}_getBindGroup(e){if(!this._bindGroups[e]){const t=new hn({0:this._getBufferResource(e)});this._bindGroups[e]=t}return this._bindGroups[e]}_uploadBindGroups(){const e=this._renderer.buffer,t=this._buffers[0];t.update(this._batchBuffer.byteIndex),e.updateBuffer(t);const r=this._renderer.gpu.device.createCommandEncoder();for(let i=1;i<this._buffers.length;i++){const s=this._buffers[i];r.copyBufferToBuffer(e.getGPUBuffer(t),gn,e.getGPUBuffer(s),0,this._batchBuffer.byteIndex)}this._renderer.gpu.device.queue.submit([r.finish()])}destroy(){for(let e=0;e<this._bindGroups.length;e++)this._bindGroups[e].destroy();this._bindGroups=null,this._bindGroupHash=null;for(let e=0;e<this._buffers.length;e++)this._buffers[e].destroy();this._buffers=null;for(let e=0;e<this._bufferResources.length;e++)this._bufferResources[e].destroy();this._bufferResources=null,this._batchBuffer.destroy(),this._bindGroupHash=null,this._renderer=null}}up.extension={type:[M.WebGPUPipes],name:"uniformBatch"};const Zy={"point-list":0,"line-list":1,"line-strip":2,"triangle-list":3,"triangle-strip":4};function Qy(n,e,t,r,i){return n<<24|e<<16|t<<10|r<<5|i}function Jy(n,e,t,r){return t<<6|n<<3|r<<1|e}class cp{constructor(e){this._moduleCache=Object.create(null),this._bufferLayoutsCache=Object.create(null),this._bindingNamesCache=Object.create(null),this._pipeCache=Object.create(null),this._pipeStateCaches=Object.create(null),this._colorMask=15,this._multisampleCount=1,this._renderer=e}contextChange(e){this._gpu=e,this.setStencilMode(nt.DISABLED),this._updatePipeHash()}setMultisampleCount(e){this._multisampleCount!==e&&(this._multisampleCount=e,this._updatePipeHash())}setRenderTarget(e){this._multisampleCount=e.msaaSamples,this._depthStencilAttachment=e.descriptor.depthStencilAttachment?1:0,this._updatePipeHash()}setColorMask(e){this._colorMask!==e&&(this._colorMask=e,this._updatePipeHash())}setStencilMode(e){this._stencilMode!==e&&(this._stencilMode=e,this._stencilState=Hn[e],this._updatePipeHash())}setPipeline(e,t,r,i){const s=this.getPipeline(e,t,r);i.setPipeline(s)}getPipeline(e,t,r,i){e._layoutKey||(ad(e,t.attributeData),this._generateBufferKey(e)),i=i||e.topology;const s=Qy(e._layoutKey,t._layoutKey,r.data,r._blendModeId,Zy[i]);return this._pipeCache[s]?this._pipeCache[s]:(this._pipeCache[s]=this._createPipeline(e,t,r,i),this._pipeCache[s])}_createPipeline(e,t,r,i){const s=this._gpu.device,o=this._createVertexBufferLayouts(e,t),a=this._renderer.state.getColorTargets(r);a[0].writeMask=this._stencilMode===nt.RENDERING_MASK_ADD?0:this._colorMask;const l=this._renderer.shader.getProgramData(t).pipeline,u={vertex:{module:this._getModule(t.vertex.source),entryPoint:t.vertex.entryPoint,buffers:o},fragment:{module:this._getModule(t.fragment.source),entryPoint:t.fragment.entryPoint,targets:a},primitive:{topology:i,cullMode:r.cullMode},layout:l,multisample:{count:this._multisampleCount},label:"PIXI Pipeline"};return this._depthStencilAttachment&&(u.depthStencil={...this._stencilState,format:"depth24plus-stencil8",depthWriteEnabled:r.depthTest,depthCompare:r.depthTest?"less":"always"}),s.createRenderPipeline(u)}_getModule(e){return this._moduleCache[e]||this._createModule(e)}_createModule(e){const t=this._gpu.device;return this._moduleCache[e]=t.createShaderModule({code:e}),this._moduleCache[e]}_generateBufferKey(e){const t=[];let r=0;const i=Object.keys(e.attributes).sort();for(let o=0;o<i.length;o++){const a=e.attributes[i[o]];t[r++]=a.offset,t[r++]=a.format,t[r++]=a.stride,t[r++]=a.instance}const s=t.join("|");return e._layoutKey=ei(s,"geometry"),e._layoutKey}_generateAttributeLocationsKey(e){const t=[];let r=0;const i=Object.keys(e.attributeData).sort();for(let o=0;o<i.length;o++){const a=e.attributeData[i[o]];t[r++]=a.location}const s=t.join("|");return e._attributeLocationsKey=ei(s,"programAttributes"),e._attributeLocationsKey}getBufferNamesToBind(e,t){const r=e._layoutKey<<16|t._attributeLocationsKey;if(this._bindingNamesCache[r])return this._bindingNamesCache[r];const i=this._createVertexBufferLayouts(e,t),s=Object.create(null),o=t.attributeData;for(let a=0;a<i.length;a++)for(const l in o)if(o[l].location===a){s[a]=l;break}return this._bindingNamesCache[r]=s,s}_createVertexBufferLayouts(e,t){t._attributeLocationsKey||this._generateAttributeLocationsKey(t);const r=e._layoutKey<<16|t._attributeLocationsKey;if(this._bufferLayoutsCache[r])return this._bufferLayoutsCache[r];const i=[];return e.buffers.forEach(s=>{const o={arrayStride:0,stepMode:"vertex",attributes:[]},a=o.attributes;for(const l in t.attributeData){const u=e.attributes[l];(u.divisor??1)!==1&&de(`Attribute ${l} has an invalid divisor value of '${u.divisor}'. WebGPU only supports a divisor value of 1`),u.buffer===s&&(o.arrayStride=u.stride,o.stepMode=u.instance?"instance":"vertex",a.push({shaderLocation:t.attributeData[l].location,offset:u.offset,format:u.format}))}a.length&&i.push(o)}),this._bufferLayoutsCache[r]=i,i}_updatePipeHash(){const e=Jy(this._stencilMode,this._multisampleCount,this._colorMask,this._depthStencilAttachment);this._pipeStateCaches[e]||(this._pipeStateCaches[e]=Object.create(null)),this._pipeCache=this._pipeStateCaches[e]}destroy(){this._renderer=null,this._bufferLayoutsCache=null}}cp.extension={type:[M.WebGPUSystem],name:"pipeline"};class $y{constructor(){this.contexts=[],this.msaaTextures=[],this.msaaSamples=1}}class e2{init(e,t){this._renderer=e,this._renderTargetSystem=t}copyToTexture(e,t,r,i,s){const o=this._renderer,a=this._getGpuColorTexture(e),l=o.texture.getGpuSource(t.source);return o.encoder.commandEncoder.copyTextureToTexture({texture:a,origin:r},{texture:l,origin:s},i),t}startRenderPass(e,t=!0,r,i){const o=this._renderTargetSystem.getGpuRenderTarget(e),a=this.getDescriptor(e,t,r);o.descriptor=a,this._renderer.pipeline.setRenderTarget(o),this._renderer.encoder.beginRenderPass(o),this._renderer.encoder.setViewport(i)}finishRenderPass(){this._renderer.encoder.endRenderPass()}_getGpuColorTexture(e){const t=this._renderTargetSystem.getGpuRenderTarget(e);return t.contexts[0]?t.contexts[0].getCurrentTexture():this._renderer.texture.getGpuSource(e.colorTextures[0].source)}getDescriptor(e,t,r){typeof t=="boolean"&&(t=t?Tt.ALL:Tt.NONE);const i=this._renderTargetSystem,s=i.getGpuRenderTarget(e),o=e.colorTextures.map((u,c)=>{const h=s.contexts[c];let d,f;h?d=h.getCurrentTexture().createView():d=this._renderer.texture.getGpuSource(u).createView({mipLevelCount:1}),s.msaaTextures[c]&&(f=d,d=this._renderer.texture.getTextureView(s.msaaTextures[c]));const p=t&Tt.COLOR?"clear":"load";return r??(r=i.defaultClearColor),{view:d,resolveTarget:f,clearValue:r,storeOp:"store",loadOp:p}});let a;if((e.stencil||e.depth)&&!e.depthStencilTexture&&(e.ensureDepthStencilTexture(),e.depthStencilTexture.source.sampleCount=s.msaa?4:1),e.depthStencilTexture){const u=t&Tt.STENCIL?"clear":"load",c=t&Tt.DEPTH?"clear":"load";a={view:this._renderer.texture.getGpuSource(e.depthStencilTexture.source).createView(),stencilStoreOp:"store",stencilLoadOp:u,depthClearValue:1,depthLoadOp:c,depthStoreOp:"store"}}return{colorAttachments:o,depthStencilAttachment:a}}clear(e,t=!0,r,i){if(!t)return;const{gpu:s,encoder:o}=this._renderer,a=s.device;if(o.commandEncoder===null){const u=a.createCommandEncoder(),c=this.getDescriptor(e,t,r),h=u.beginRenderPass(c);h.setViewport(i.x,i.y,i.width,i.height,0,1),h.end();const d=u.finish();a.queue.submit([d])}else this.startRenderPass(e,t,r,i)}initGpuRenderTarget(e){e.isRoot=!0;const t=new $y;return e.colorTextures.forEach((r,i)=>{if(yn.test(r.resource)){const s=r.resource.getContext("webgpu"),o=r.transparent?"premultiplied":"opaque";try{s.configure({device:this._renderer.gpu.device,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,format:"bgra8unorm",alphaMode:o})}catch(a){console.error(a)}t.contexts[i]=s}if(t.msaa=r.source.antialias,r.source.antialias){const s=new Je({width:0,height:0,sampleCount:4});t.msaaTextures[i]=s}}),t.msaa&&(t.msaaSamples=4,e.depthStencilTexture&&(e.depthStencilTexture.source.sampleCount=4)),t}destroyGpuRenderTarget(e){e.contexts.forEach(t=>{t.unconfigure()}),e.msaaTextures.forEach(t=>{t.destroy()}),e.msaaTextures.length=0,e.contexts.length=0}ensureDepthStencilTexture(e){const t=this._renderTargetSystem.getGpuRenderTarget(e);e.depthStencilTexture&&t.msaa&&(e.depthStencilTexture.source.sampleCount=4)}resizeGpuRenderTarget(e){const t=this._renderTargetSystem.getGpuRenderTarget(e);t.width=e.width,t.height=e.height,t.msaa&&e.colorTextures.forEach((r,i)=>{t.msaaTextures[i]?.resize(r.source.width,r.source.height,r.source._resolution)})}}class hp extends Sd{constructor(e){super(e),this.adaptor=new e2,this.adaptor.init(e,this)}}hp.extension={type:[M.WebGPUSystem],name:"renderTarget"};class fp{constructor(){this._gpuProgramData=Object.create(null)}contextChange(e){this._gpu=e,this.maxTextures=e.device.limits.maxSampledTexturesPerShaderStage}getProgramData(e){return this._gpuProgramData[e._layoutKey]||this._createGPUProgramData(e)}_createGPUProgramData(e){const t=this._gpu.device,r=e.gpuLayout.map(s=>t.createBindGroupLayout({entries:s})),i={bindGroupLayouts:r};return this._gpuProgramData[e._layoutKey]={bindGroups:r,pipeline:t.createPipelineLayout(i)},this._gpuProgramData[e._layoutKey]}destroy(){this._gpu=null,this._gpuProgramData=null}}fp.extension={type:[M.WebGPUSystem],name:"shader"};const bt={};bt.normal={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"}};bt.add={alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one",operation:"add"}};bt.multiply={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"dst",dstFactor:"one-minus-src-alpha",operation:"add"}};bt.screen={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src",operation:"add"}};bt.overlay={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src",operation:"add"}};bt.none={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"zero",dstFactor:"zero",operation:"add"}};bt["normal-npm"]={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"}};bt["add-npm"]={alpha:{srcFactor:"one",dstFactor:"one",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one",operation:"add"}};bt["screen-npm"]={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src",operation:"add"}};bt.erase={alpha:{srcFactor:"zero",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"zero",dstFactor:"one-minus-src",operation:"add"}};bt.min={alpha:{srcFactor:"one",dstFactor:"one",operation:"min"},color:{srcFactor:"one",dstFactor:"one",operation:"min"}};bt.max={alpha:{srcFactor:"one",dstFactor:"one",operation:"max"},color:{srcFactor:"one",dstFactor:"one",operation:"max"}};class dp{constructor(){this.defaultState=new pn,this.defaultState.blend=!0}contextChange(e){this.gpu=e}getColorTargets(e){return[{format:"bgra8unorm",writeMask:0,blend:bt[e.blendMode]||bt.normal}]}destroy(){this.gpu=null}}dp.extension={type:[M.WebGPUSystem],name:"state"};const t2={type:"image",upload(n,e,t){const r=n.resource,i=(n.pixelWidth|0)*(n.pixelHeight|0),s=r.byteLength/i;t.device.queue.writeTexture({texture:e},r,{offset:0,rowsPerImage:n.pixelHeight,bytesPerRow:n.pixelHeight*s},{width:n.pixelWidth,height:n.pixelHeight,depthOrArrayLayers:1})}},pp={"bc1-rgba-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"bc2-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc3-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc7-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"etc1-rgb-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"etc2-rgba8unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"astc-4x4-unorm":{blockBytes:16,blockWidth:4,blockHeight:4}},n2={blockBytes:4,blockWidth:1,blockHeight:1},r2={type:"compressed",upload(n,e,t){let r=n.pixelWidth,i=n.pixelHeight;const s=pp[n.format]||n2;for(let o=0;o<n.resource.length;o++){const a=n.resource[o],l=Math.ceil(r/s.blockWidth)*s.blockBytes;t.device.queue.writeTexture({texture:e,mipLevel:o},a,{offset:0,bytesPerRow:l},{width:Math.ceil(r/s.blockWidth)*s.blockWidth,height:Math.ceil(i/s.blockHeight)*s.blockHeight,depthOrArrayLayers:1}),r=Math.max(r>>1,1),i=Math.max(i>>1,1)}}},mp={type:"image",upload(n,e,t){const r=n.resource;if(!r)return;const i=Math.min(e.width,n.resourceWidth||n.pixelWidth),s=Math.min(e.height,n.resourceHeight||n.pixelHeight),o=n.alphaMode==="premultiply-alpha-on-upload";t.device.queue.copyExternalImageToTexture({source:r},{texture:e,premultipliedAlpha:o},{width:i,height:s})}},i2={type:"video",upload(n,e,t){mp.upload(n,e,t)}};class s2{constructor(e){this.device=e,this.sampler=e.createSampler({minFilter:"linear"}),this.pipelines={}}_getMipmapPipeline(e){let t=this.pipelines[e];return t||(this.mipmapShaderModule||(this.mipmapShaderModule=this.device.createShaderModule({code:`
                        var<private> pos : array<vec2<f32>, 3> = array<vec2<f32>, 3>(
                        vec2<f32>(-1.0, -1.0), vec2<f32>(-1.0, 3.0), vec2<f32>(3.0, -1.0));

                        struct VertexOutput {
                        @builtin(position) position : vec4<f32>,
                        @location(0) texCoord : vec2<f32>,
                        };

                        @vertex
                        fn vertexMain(@builtin(vertex_index) vertexIndex : u32) -> VertexOutput {
                        var output : VertexOutput;
                        output.texCoord = pos[vertexIndex] * vec2<f32>(0.5, -0.5) + vec2<f32>(0.5);
                        output.position = vec4<f32>(pos[vertexIndex], 0.0, 1.0);
                        return output;
                        }

                        @group(0) @binding(0) var imgSampler : sampler;
                        @group(0) @binding(1) var img : texture_2d<f32>;

                        @fragment
                        fn fragmentMain(@location(0) texCoord : vec2<f32>) -> @location(0) vec4<f32> {
                        return textureSample(img, imgSampler, texCoord);
                        }
                    `})),t=this.device.createRenderPipeline({layout:"auto",vertex:{module:this.mipmapShaderModule,entryPoint:"vertexMain"},fragment:{module:this.mipmapShaderModule,entryPoint:"fragmentMain",targets:[{format:e}]}}),this.pipelines[e]=t),t}generateMipmap(e){const t=this._getMipmapPipeline(e.format);if(e.dimension==="3d"||e.dimension==="1d")throw new Error("Generating mipmaps for non-2d textures is currently unsupported!");let r=e;const i=e.depthOrArrayLayers||1,s=e.usage&GPUTextureUsage.RENDER_ATTACHMENT;if(!s){const l={size:{width:Math.ceil(e.width/2),height:Math.ceil(e.height/2),depthOrArrayLayers:i},format:e.format,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC|GPUTextureUsage.RENDER_ATTACHMENT,mipLevelCount:e.mipLevelCount-1};r=this.device.createTexture(l)}const o=this.device.createCommandEncoder({}),a=t.getBindGroupLayout(0);for(let l=0;l<i;++l){let u=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:"2d",baseArrayLayer:l,arrayLayerCount:1}),c=s?1:0;for(let h=1;h<e.mipLevelCount;++h){const d=r.createView({baseMipLevel:c++,mipLevelCount:1,dimension:"2d",baseArrayLayer:l,arrayLayerCount:1}),f=o.beginRenderPass({colorAttachments:[{view:d,storeOp:"store",loadOp:"clear",clearValue:{r:0,g:0,b:0,a:0}}]}),p=this.device.createBindGroup({layout:a,entries:[{binding:0,resource:this.sampler},{binding:1,resource:u}]});f.setPipeline(t),f.setBindGroup(0,p),f.draw(3,1,0,0),f.end(),u=d}}if(!s){const l={width:Math.ceil(e.width/2),height:Math.ceil(e.height/2),depthOrArrayLayers:i};for(let u=1;u<e.mipLevelCount;++u)o.copyTextureToTexture({texture:r,mipLevel:u-1},{texture:e,mipLevel:u},l),l.width=Math.ceil(l.width/2),l.height=Math.ceil(l.height/2)}return this.device.queue.submit([o.finish()]),s||r.destroy(),e}}class gp{constructor(e){this.managedTextures=[],this._gpuSources=Object.create(null),this._gpuSamplers=Object.create(null),this._bindGroupHash=Object.create(null),this._textureViewHash=Object.create(null),this._uploads={image:mp,buffer:t2,video:i2,compressed:r2},this._renderer=e}contextChange(e){this._gpu=e}initSource(e){if(e.autoGenerateMipmaps){const l=Math.max(e.pixelWidth,e.pixelHeight);e.mipLevelCount=Math.floor(Math.log2(l))+1}let t=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST;e.uploadMethodId!=="compressed"&&(t|=GPUTextureUsage.RENDER_ATTACHMENT,t|=GPUTextureUsage.COPY_SRC);const r=pp[e.format]||{blockBytes:4,blockWidth:1,blockHeight:1},i=Math.ceil(e.pixelWidth/r.blockWidth)*r.blockWidth,s=Math.ceil(e.pixelHeight/r.blockHeight)*r.blockHeight,o={label:e.label,size:{width:i,height:s},format:e.format,sampleCount:e.sampleCount,mipLevelCount:e.mipLevelCount,dimension:e.dimension,usage:t},a=this._gpu.device.createTexture(o);return this._gpuSources[e.uid]=a,this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceResize,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),a}onSourceUpdate(e){const t=this.getGpuSource(e);t&&(this._uploads[e.uploadMethodId]&&this._uploads[e.uploadMethodId].upload(e,t,this._gpu),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e))}onSourceUnload(e){const t=this._gpuSources[e.uid];t&&(this._gpuSources[e.uid]=null,t.destroy())}onUpdateMipmaps(e){this._mipmapGenerator||(this._mipmapGenerator=new s2(this._gpu.device));const t=this.getGpuSource(e);this._mipmapGenerator.generateMipmap(t)}onSourceDestroy(e){e.off("update",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("destroy",this.onSourceDestroy,this),e.off("resize",this.onSourceResize,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}onSourceResize(e){const t=this._gpuSources[e.uid];t?(t.width!==e.pixelWidth||t.height!==e.pixelHeight)&&(this._textureViewHash[e.uid]=null,this._bindGroupHash[e.uid]=null,this.onSourceUnload(e),this.initSource(e)):this.initSource(e)}_initSampler(e){return this._gpuSamplers[e._resourceId]=this._gpu.device.createSampler(e),this._gpuSamplers[e._resourceId]}getGpuSampler(e){return this._gpuSamplers[e._resourceId]||this._initSampler(e)}getGpuSource(e){return this._gpuSources[e.uid]||this.initSource(e)}getTextureBindGroup(e){return this._bindGroupHash[e.uid]??this._createTextureBindGroup(e)}_createTextureBindGroup(e){const t=e.source;return this._bindGroupHash[e.uid]=new hn({0:t,1:t.style,2:new gt({uTextureMatrix:{type:"mat3x3<f32>",value:e.textureMatrix.mapCoord}})}),this._bindGroupHash[e.uid]}getTextureView(e){const t=e.source;return this._textureViewHash[t.uid]??this._createTextureView(t)}_createTextureView(e){return this._textureViewHash[e.uid]=this.getGpuSource(e).createView(),this._textureViewHash[e.uid]}generateCanvas(e){const t=this._renderer,r=t.gpu.device.createCommandEncoder(),i=Se.get().createCanvas();i.width=e.source.pixelWidth,i.height=e.source.pixelHeight;const s=i.getContext("webgpu");return s.configure({device:t.gpu.device,usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC,format:Se.get().getNavigator().gpu.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),r.copyTextureToTexture({texture:t.texture.getGpuSource(e.source),origin:{x:0,y:0}},{texture:s.getCurrentTexture()},{width:i.width,height:i.height}),t.gpu.device.queue.submit([r.finish()]),i}getPixels(e){const t=this.generateCanvas(e),r=fn.getOptimalCanvasAndContext(t.width,t.height),i=r.context;i.drawImage(t,0,0);const{width:s,height:o}=t,a=i.getImageData(0,0,s,o),l=new Uint8ClampedArray(a.data.buffer);return fn.returnCanvasAndContext(r),{pixels:l,width:s,height:o}}destroy(){this.managedTextures.slice().forEach(e=>this.onSourceDestroy(e)),this.managedTextures=null;for(const e of Object.keys(this._bindGroupHash)){const t=Number(e);this._bindGroupHash[t]?.destroy(),this._bindGroupHash[t]=null}this._gpu=null,this._mipmapGenerator=null,this._gpuSources=null,this._bindGroupHash=null,this._textureViewHash=null,this._gpuSamplers=null}}gp.extension={type:[M.WebGPUSystem],name:"texture"};class _p{init(){const e=new gt({uTransformMatrix:{value:new ue,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),t=ci({name:"graphics",bits:[ja,qa(wr()),Ax,fi]});this.shader=new Wt({gpuProgram:t,resources:{localUniforms:e}})}execute(e,t){const r=t.context,i=r.customShader||this.shader,s=e.renderer,o=s.graphicsContext,{batcher:a,instructions:l}=o.getContextRenderData(r),u=s.encoder;u.setPipelineFromGeometryProgramAndState(a.geometry,i.gpuProgram,e.state),u.setGeometry(a.geometry,i.gpuProgram);const c=s.globalUniforms.bindGroup;u.setBindGroup(0,c,i.gpuProgram);const h=s.renderPipes.uniformBatch.getUniformBindGroup(i.resources.localUniforms,!0);u.setBindGroup(2,h,i.gpuProgram);const d=l.instructions;for(let f=0;f<l.instructionSize;f++){const p=d[f];if(i.groups[1]=p.bindGroup,!p.gpuBindGroup){const g=p.textures;p.bindGroup=Wa(g.textures,g.count),p.gpuBindGroup=s.bindGroup.getBindGroup(p.bindGroup,i.gpuProgram,1)}u.setBindGroup(1,p.bindGroup,i.gpuProgram),u.renderPassEncoder.drawIndexed(p.size,1,p.start)}}destroy(){this.shader.destroy(!0),this.shader=null}}_p.extension={type:[M.WebGPUPipesAdaptor],name:"graphics"};class vp{init(){const e=ci({name:"mesh",bits:[Kr,Ex,fi]});this._shader=new Wt({gpuProgram:e,resources:{uTexture:se.EMPTY._source,uSampler:se.EMPTY._source.style,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new ue}}}})}execute(e,t){const r=e.renderer;let i=t._shader;if(!i)i=this._shader,i.groups[2]=r.texture.getTextureBindGroup(t.texture);else if(!i.gpuProgram){de("Mesh shader has no gpuProgram",t.shader);return}const s=i.gpuProgram;if(s.autoAssignGlobalUniforms&&(i.groups[0]=r.globalUniforms.bindGroup),s.autoAssignLocalUniforms){const o=e.localUniforms;i.groups[1]=r.renderPipes.uniformBatch.getUniformBindGroup(o,!0)}r.encoder.draw({geometry:t._geometry,shader:i,state:t.state})}destroy(){this._shader.destroy(!0),this._shader=null}}vp.extension={type:[M.WebGPUPipesAdaptor],name:"mesh"};const o2=[...Jd,lp,op,Sl,ip,gp,hp,fp,dp,cp,sp,ap,rp],a2=[...$d,up],l2=[Jf,vp,_p],bp=[],xp=[],yp=[];pe.handleByNamedList(M.WebGPUSystem,bp);pe.handleByNamedList(M.WebGPUPipes,xp);pe.handleByNamedList(M.WebGPUPipesAdaptor,yp);pe.add(...o2,...a2,...l2);class u2 extends Es{constructor(){const e={name:"webgpu",type:Pt.WEBGPU,systems:bp,renderPipes:xp,renderPipeAdaptors:yp};super(e)}}const c2=Object.freeze(Object.defineProperty({__proto__:null,WebGPURenderer:u2},Symbol.toStringTag,{value:"Module"}));class Sp{constructor(e,t){this.state=pn.for2d(),this._graphicsBatchesHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this.renderer=e,this._adaptor=t,this._adaptor.init()}validateRenderable(e){const t=e.context,r=!!this._graphicsBatchesHash[e.uid],i=this.renderer.graphicsContext.updateGpuContext(t);return!!(i.isBatchable||r!==i.isBatchable)}addRenderable(e,t){const r=this.renderer.graphicsContext.updateGpuContext(e.context);e._didGraphicsUpdate&&(e._didGraphicsUpdate=!1,this._rebuild(e)),r.isBatchable?this._addToBatcher(e,t):(this.renderer.renderPipes.batch.break(t),t.add(e))}updateRenderable(e){const t=this._graphicsBatchesHash[e.uid];if(t)for(let r=0;r<t.length;r++){const i=t[r];i._batcher.updateElement(i)}}destroyRenderable(e){this._graphicsBatchesHash[e.uid]&&this._removeBatchForRenderable(e.uid),e.off("destroyed",this._destroyRenderableBound)}execute(e){if(!e.isRenderable)return;const t=this.renderer,r=e.context;if(!t.graphicsContext.getGpuContext(r).batches.length)return;const s=r.customShader||this._adaptor.shader;this.state.blendMode=e.groupBlendMode;const o=s.resources.localUniforms.uniforms;o.uTransformMatrix=e.groupTransform,o.uRound=t._roundPixels|e._roundPixels,Is(e.groupColorAlpha,o.uColor,0),this._adaptor.execute(this,e)}_rebuild(e){const t=!!this._graphicsBatchesHash[e.uid],r=this.renderer.graphicsContext.updateGpuContext(e.context);t&&this._removeBatchForRenderable(e.uid),r.isBatchable&&this._initBatchesForRenderable(e),e.batched=r.isBatchable}_addToBatcher(e,t){const r=this.renderer.renderPipes.batch,i=this._getBatchesForRenderable(e);for(let s=0;s<i.length;s++){const o=i[s];r.addToBatch(o,t)}}_getBatchesForRenderable(e){return this._graphicsBatchesHash[e.uid]||this._initBatchesForRenderable(e)}_initBatchesForRenderable(e){const t=e.context,r=this.renderer.graphicsContext.getGpuContext(t),i=this.renderer._roundPixels|e._roundPixels,s=r.batches.map(o=>{const a=Te.get(Qa);return o.copyTo(a),a.renderable=e,a.roundPixels=i,a});return this._graphicsBatchesHash[e.uid]===void 0&&e.on("destroyed",this._destroyRenderableBound),this._graphicsBatchesHash[e.uid]=s,s}_removeBatchForRenderable(e){this._graphicsBatchesHash[e].forEach(t=>{Te.return(t)}),this._graphicsBatchesHash[e]=null}destroy(){this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null;for(const e in this._graphicsBatchesHash)this._removeBatchForRenderable(e);this._graphicsBatchesHash=null}}Sp.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"graphics"};const wp=class Tp extends ol{constructor(...e){super({});let t=e[0]??{};typeof t=="number"&&(ie(we,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),t={width:t,height:e[1],verticesX:e[2],verticesY:e[3]}),this.build(t)}build(e){e={...Tp.defaultOptions,...e},this.verticesX=this.verticesX??e.verticesX,this.verticesY=this.verticesY??e.verticesY,this.width=this.width??e.width,this.height=this.height??e.height;const t=this.verticesX*this.verticesY,r=[],i=[],s=[],o=this.verticesX-1,a=this.verticesY-1,l=this.width/o,u=this.height/a;for(let h=0;h<t;h++){const d=h%this.verticesX,f=h/this.verticesX|0;r.push(d*l,f*u),i.push(d/o,f/a)}const c=o*a;for(let h=0;h<c;h++){const d=h%o,f=h/o|0,p=f*this.verticesX+d,g=f*this.verticesX+d+1,m=(f+1)*this.verticesX+d,v=(f+1)*this.verticesX+d+1;s.push(p,g,m,g,v,m)}this.buffers[0].data=new Float32Array(r),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint32Array(s),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};wp.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let h2=wp;class wl{constructor(){this.batcherName="default",this.packAsQuad=!1,this.indexOffset=0,this.attributeOffset=0,this.roundPixels=0,this._batcher=null,this._batch=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}get blendMode(){return this.renderable.groupBlendMode}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.geometry=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}get uvs(){const t=this.geometry.getBuffer("aUV"),r=t.data;let i=r;const s=this.texture.textureMatrix;return s.isSimple||(i=this._transformedUvs,(this._textureMatrixUpdateId!==s._updateID||this._uvUpdateId!==t._updateID)&&((!i||i.length<r.length)&&(i=this._transformedUvs=new Float32Array(r.length)),this._textureMatrixUpdateId=s._updateID,this._uvUpdateId=t._updateID,s.multiplyUvs(r,i))),i}get positions(){return this.geometry.positions}get indices(){return this.geometry.indices}get color(){return this.renderable.groupColorAlpha}get groupTransform(){return this.renderable.groupTransform}get attributeSize(){return this.geometry.positions.length/2}get indexSize(){return this.geometry.indices.length}}class Cp{constructor(e,t){this.localUniforms=new gt({uTransformMatrix:{value:new ue,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),this.localUniformsBindGroup=new hn({0:this.localUniforms}),this._meshDataHash=Object.create(null),this._gpuBatchableMeshHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this.renderer=e,this._adaptor=t,this._adaptor.init()}validateRenderable(e){const t=this._getMeshData(e),r=t.batched,i=e.batched;if(t.batched=i,r!==i)return!0;if(i){const s=e._geometry;if(s.indices.length!==t.indexSize||s.positions.length!==t.vertexSize)return t.indexSize=s.indices.length,t.vertexSize=s.positions.length,!0;const o=this._getBatchableMesh(e),a=e.texture;if(o.texture._source!==a._source&&o.texture._source!==a._source)return!o._batcher.checkAndUpdateTexture(o,a)}return!1}addRenderable(e,t){const r=this.renderer.renderPipes.batch,{batched:i}=this._getMeshData(e);if(i){const s=this._getBatchableMesh(e);s.texture=e._texture,s.geometry=e._geometry,r.addToBatch(s,t)}else r.break(t),t.add(e)}updateRenderable(e){if(e.batched){const t=this._gpuBatchableMeshHash[e.uid];t.texture=e._texture,t.geometry=e._geometry,t._batcher.updateElement(t)}}destroyRenderable(e){this._meshDataHash[e.uid]=null;const t=this._gpuBatchableMeshHash[e.uid];t&&(Te.return(t),this._gpuBatchableMeshHash[e.uid]=null),e.off("destroyed",this._destroyRenderableBound)}execute(e){if(!e.isRenderable)return;e.state.blendMode=bs(e.groupBlendMode,e.texture._source);const t=this.localUniforms;t.uniforms.uTransformMatrix=e.groupTransform,t.uniforms.uRound=this.renderer._roundPixels|e._roundPixels,t.update(),Is(e.groupColorAlpha,t.uniforms.uColor,0),this._adaptor.execute(this,e)}_getMeshData(e){return this._meshDataHash[e.uid]||this._initMeshData(e)}_initMeshData(e){return this._meshDataHash[e.uid]={batched:e.batched,indexSize:e._geometry.indices?.length,vertexSize:e._geometry.positions?.length},e.on("destroyed",this._destroyRenderableBound),this._meshDataHash[e.uid]}_getBatchableMesh(e){return this._gpuBatchableMeshHash[e.uid]||this._initBatchableMesh(e)}_initBatchableMesh(e){const t=Te.get(wl);return t.renderable=e,t.texture=e._texture,t.transform=e.groupTransform,t.roundPixels=this.renderer._roundPixels|e._roundPixels,this._gpuBatchableMeshHash[e.uid]=t,t}destroy(){for(const e in this._gpuBatchableMeshHash)this._gpuBatchableMeshHash[e]&&Te.return(this._gpuBatchableMeshHash[e]);this._gpuBatchableMeshHash=null,this._meshDataHash=null,this.localUniforms=null,this.localUniformsBindGroup=null,this._adaptor.destroy(),this._adaptor=null,this.renderer=null}}Cp.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"mesh"};const Pp=class Ap extends h2{constructor(e={}){e={...Ap.defaultOptions,...e},super({width:e.width,height:e.height,verticesX:4,verticesY:4}),this.update(e)}update(e){this.width=e.width??this.width,this.height=e.height??this.height,this._originalWidth=e.originalWidth??this._originalWidth,this._originalHeight=e.originalHeight??this._originalHeight,this._leftWidth=e.leftWidth??this._leftWidth,this._rightWidth=e.rightWidth??this._rightWidth,this._topHeight=e.topHeight??this._topHeight,this._bottomHeight=e.bottomHeight??this._bottomHeight,this.updateUvs(),this.updatePositions()}updatePositions(){const e=this.positions,t=this._leftWidth+this._rightWidth,r=this.width>t?1:this.width/t,i=this._topHeight+this._bottomHeight,s=this.height>i?1:this.height/i,o=Math.min(r,s);e[9]=e[11]=e[13]=e[15]=this._topHeight*o,e[17]=e[19]=e[21]=e[23]=this.height-this._bottomHeight*o,e[25]=e[27]=e[29]=e[31]=this.height,e[2]=e[10]=e[18]=e[26]=this._leftWidth*o,e[4]=e[12]=e[20]=e[28]=this.width-this._rightWidth*o,e[6]=e[14]=e[22]=e[30]=this.width,this.getBuffer("aPosition").update()}updateUvs(){const e=this.uvs;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1;const t=1/this._originalWidth,r=1/this._originalHeight;e[2]=e[10]=e[18]=e[26]=t*this._leftWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[4]=e[12]=e[20]=e[28]=1-t*this._rightWidth,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.getBuffer("aUV").update()}};Pp.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let f2=Pp;class Ep{constructor(e){this._gpuSpriteHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e}addRenderable(e,t){const r=this._getGpuSprite(e);e._didSpriteUpdate&&this._updateBatchableSprite(e,r),this._renderer.renderPipes.batch.addToBatch(r,t)}updateRenderable(e){const t=this._gpuSpriteHash[e.uid];e._didSpriteUpdate&&this._updateBatchableSprite(e,t),t._batcher.updateElement(t)}validateRenderable(e){const t=e._texture,r=this._getGpuSprite(e);return r.texture._source!==t._source?!r._batcher.checkAndUpdateTexture(r,t):!1}destroyRenderable(e){const t=this._gpuSpriteHash[e.uid];Te.return(t.geometry),Te.return(t),this._gpuSpriteHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}_updateBatchableSprite(e,t){e._didSpriteUpdate=!1,t.geometry.update(e),t.texture=e._texture}_getGpuSprite(e){return this._gpuSpriteHash[e.uid]||this._initGPUSprite(e)}_initGPUSprite(e){const t=Te.get(wl);return t.geometry=Te.get(f2),t.renderable=e,t.transform=e.groupTransform,t.texture=e._texture,t.roundPixels=this._renderer._roundPixels|e._roundPixels,e._didSpriteUpdate=!0,this._gpuSpriteHash[e.uid]=t,e.on("destroyed",this._destroyRenderableBound),t}destroy(){for(const e in this._gpuSpriteHash)this._gpuSpriteHash[e].geometry.destroy();this._gpuSpriteHash=null,this._renderer=null}}Ep.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"nineSliceSprite"};const d2={name:"tiling-bit",vertex:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`
            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;

            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;
        `},fragment:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`

            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);
            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;
            var unclamped = coord;
            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);

            var bias = 0.;

            if(unclamped.x == coord.x && unclamped.y == coord.y)
            {
                bias = -32.;
            } 

            outColor = textureSampleBias(uTexture, uSampler, coord, bias);
        `}},p2={name:"tiling-bit",vertex:{header:`
            uniform mat3 uTextureTransform;
            uniform vec4 uSizeAnchor;
        
        `,main:`
            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;

            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;
        `},fragment:{header:`
            uniform sampler2D uTexture;
            uniform mat3 uMapCoord;
            uniform vec4 uClampFrame;
            uniform vec2 uClampOffset;
        `,main:`

        vec2 coord = vUV + ceil(uClampOffset - vUV);
        coord = (uMapCoord * vec3(coord, 1.0)).xy;
        vec2 unclamped = coord;
        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);
        
        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0
    
        `}};let Uo,Go;class m2 extends Wt{constructor(){Uo??(Uo=ci({name:"tiling-sprite-shader",bits:[Kr,d2,fi]})),Go??(Go=hi({name:"tiling-sprite-shader",bits:[ul,p2,di]}));const e=new gt({uMapCoord:{value:new ue,type:"mat3x3<f32>"},uClampFrame:{value:new Float32Array([0,0,1,1]),type:"vec4<f32>"},uClampOffset:{value:new Float32Array([0,0]),type:"vec2<f32>"},uTextureTransform:{value:new ue,type:"mat3x3<f32>"},uSizeAnchor:{value:new Float32Array([100,100,.5,.5]),type:"vec4<f32>"}});super({glProgram:Go,gpuProgram:Uo,resources:{localUniforms:new gt({uTransformMatrix:{value:new ue,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),tilingUniforms:e,uTexture:se.EMPTY.source,uSampler:se.EMPTY.source.style}})}updateUniforms(e,t,r,i,s,o){const a=this.resources.tilingUniforms,l=o.width,u=o.height,c=o.textureMatrix,h=a.uniforms.uTextureTransform;h.set(r.a*l/e,r.b*l/t,r.c*u/e,r.d*u/t,r.tx/e,r.ty/t),h.invert(),a.uniforms.uMapCoord=c.mapCoord,a.uniforms.uClampFrame=c.uClampFrame,a.uniforms.uClampOffset=c.uClampOffset,a.uniforms.uTextureTransform=h,a.uniforms.uSizeAnchor[0]=e,a.uniforms.uSizeAnchor[1]=t,a.uniforms.uSizeAnchor[2]=i,a.uniforms.uSizeAnchor[3]=s,o&&(this.resources.uTexture=o.source,this.resources.uSampler=o.source.style)}}class g2 extends ol{constructor(){super({positions:new Float32Array([0,0,1,0,1,1,0,1]),uvs:new Float32Array([0,0,1,0,1,1,0,1]),indices:new Uint32Array([0,1,2,0,2,3])})}}function _2(n,e){const t=n.anchor.x,r=n.anchor.y;e[0]=-t*n.width,e[1]=-r*n.height,e[2]=(1-t)*n.width,e[3]=-r*n.height,e[4]=(1-t)*n.width,e[5]=(1-r)*n.height,e[6]=-t*n.width,e[7]=(1-r)*n.height}function v2(n,e,t,r){let i=0;const s=n.length/e,o=r.a,a=r.b,l=r.c,u=r.d,c=r.tx,h=r.ty;for(t*=e;i<s;){const d=n[t],f=n[t+1];n[t]=o*d+l*f+c,n[t+1]=a*d+u*f+h,t+=e,i++}}function b2(n,e){const t=n.texture,r=t.frame.width,i=t.frame.height;let s=0,o=0;n._applyAnchorToTexture&&(s=n.anchor.x,o=n.anchor.y),e[0]=e[6]=-s,e[2]=e[4]=1-s,e[1]=e[3]=-o,e[5]=e[7]=1-o;const a=ue.shared;a.copyFrom(n._tileTransform.matrix),a.tx/=n.width,a.ty/=n.height,a.invert(),a.scale(n.width/r,n.height/i),v2(e,2,0,a)}const qi=new g2;class Mp{constructor(e){this._state=pn.default2d,this._tilingSpriteDataHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e}validateRenderable(e){const t=this._getTilingSpriteData(e),r=t.canBatch;this._updateCanBatch(e);const i=t.canBatch;if(i&&i===r){const{batchableMesh:s}=t;if(s&&s.texture._source!==e.texture._source)return!s._batcher.checkAndUpdateTexture(s,e.texture)}return r!==i}addRenderable(e,t){const r=this._renderer.renderPipes.batch;this._updateCanBatch(e);const i=this._getTilingSpriteData(e),{geometry:s,canBatch:o}=i;if(o){i.batchableMesh||(i.batchableMesh=new wl);const a=i.batchableMesh;e._didTilingSpriteUpdate&&(e._didTilingSpriteUpdate=!1,this._updateBatchableMesh(e),a.geometry=s,a.renderable=e,a.transform=e.groupTransform,a.texture=e._texture),a.roundPixels=this._renderer._roundPixels|e._roundPixels,r.addToBatch(a,t)}else r.break(t),i.shader||(i.shader=new m2),this.updateRenderable(e),t.add(e)}execute(e){const{shader:t}=this._tilingSpriteDataHash[e.uid];t.groups[0]=this._renderer.globalUniforms.bindGroup;const r=t.resources.localUniforms.uniforms;r.uTransformMatrix=e.groupTransform,r.uRound=this._renderer._roundPixels|e._roundPixels,Is(e.groupColorAlpha,r.uColor,0),this._state.blendMode=bs(e.groupBlendMode,e.texture._source),this._renderer.encoder.draw({geometry:qi,shader:t,state:this._state})}updateRenderable(e){const t=this._getTilingSpriteData(e),{canBatch:r}=t;if(r){const{batchableMesh:i}=t;e._didTilingSpriteUpdate&&this._updateBatchableMesh(e),i._batcher.updateElement(i)}else if(e._didTilingSpriteUpdate){const{shader:i}=t;i.updateUniforms(e.width,e.height,e._tileTransform.matrix,e.anchor.x,e.anchor.y,e.texture)}e._didTilingSpriteUpdate=!1}destroyRenderable(e){const t=this._getTilingSpriteData(e);t.batchableMesh=null,t.shader?.destroy(),this._tilingSpriteDataHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}_getTilingSpriteData(e){return this._tilingSpriteDataHash[e.uid]||this._initTilingSpriteData(e)}_initTilingSpriteData(e){const t=new ol({indices:qi.indices,positions:qi.positions.slice(),uvs:qi.uvs.slice()});return this._tilingSpriteDataHash[e.uid]={canBatch:!0,renderable:e,geometry:t},e.on("destroyed",this._destroyRenderableBound),this._tilingSpriteDataHash[e.uid]}_updateBatchableMesh(e){const t=this._getTilingSpriteData(e),{geometry:r}=t,i=e.texture.source.style;i.addressMode!=="repeat"&&(i.addressMode="repeat",i.update()),b2(e,r.uvs),_2(e,r.positions)}destroy(){for(const e in this._tilingSpriteDataHash)this.destroyRenderable(this._tilingSpriteDataHash[e].renderable);this._tilingSpriteDataHash=null,this._renderer=null}_updateCanBatch(e){const t=this._getTilingSpriteData(e),r=e.texture;let i=!0;return this._renderer.type===Pt.WEBGL&&(i=this._renderer.context.supports.nonPowOf2wrapping),t.canBatch=r.textureMatrix.isSimple&&(i||r.source.isPowerOfTwo),t.canBatch}}Mp.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"tilingSprite"};const x2={name:"local-uniform-msdf-bit",vertex:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32,
                uRound:f32,
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `},fragment:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
         `,main:` 
            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));
        `}},y2={name:"local-uniform-msdf-bit",vertex:{header:`
            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix *= uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `},fragment:{header:`
            uniform float uDistance;
         `,main:` 
            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));
        `}},S2={name:"msdf-bit",fragment:{header:`
            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {
                
                // MSDF
                var median = msdfColor.r + msdfColor.g + msdfColor.b -
                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));
            
                // SDF
                median = min(median, msdfColor.a);

                var screenPxDistance = distance * (median - 0.5);
                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);
                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));
                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);
                var coverage: f32 = pow(shapeColor.a * alpha, gamma);

                return coverage;
             
            }
        `}},w2={name:"msdf-bit",fragment:{header:`
            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {
                
                // MSDF
                float median = msdfColor.r + msdfColor.g + msdfColor.b -
                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));
               
                // SDF
                median = min(median, msdfColor.a);
            
                float screenPxDistance = distance * (median - 0.5);
                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);
           
                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));
                float gamma = mix(1.0, 1.0 / 2.2, luma);
                float coverage = pow(shapeColor.a * alpha, gamma);  
              
                return coverage;
            }
        `}};let Do,zo;class T2 extends Wt{constructor(){const e=new gt({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new ue,type:"mat3x3<f32>"},uDistance:{value:4,type:"f32"},uRound:{value:0,type:"f32"}}),t=wr();Do??(Do=ci({name:"sdf-shader",bits:[ja,qa(t),x2,S2,fi]})),zo??(zo=hi({name:"sdf-shader",bits:[Xa,Ya(t),y2,w2,di]})),super({glProgram:zo,gpuProgram:Do,resources:{localUniforms:e,batchSamplers:Ka(t)}})}}class kp{constructor(e){this._gpuBitmapText={},this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e}validateRenderable(e){const t=this._getGpuBitmapText(e);return e._didTextUpdate&&(e._didTextUpdate=!1,this._updateContext(e,t)),this._renderer.renderPipes.graphics.validateRenderable(t)}addRenderable(e,t){const r=this._getGpuBitmapText(e);pc(e,r),e._didTextUpdate&&(e._didTextUpdate=!1,this._updateContext(e,r)),this._renderer.renderPipes.graphics.addRenderable(r,t),r.context.customShader&&this._updateDistanceField(e)}destroyRenderable(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableByUid(e.uid)}_destroyRenderableByUid(e){const t=this._gpuBitmapText[e].context;t.customShader&&(Te.return(t.customShader),t.customShader=null),Te.return(this._gpuBitmapText[e]),this._gpuBitmapText[e]=null}updateRenderable(e){const t=this._getGpuBitmapText(e);pc(e,t),this._renderer.renderPipes.graphics.updateRenderable(t),t.context.customShader&&this._updateDistanceField(e)}_updateContext(e,t){const{context:r}=t,i=pa.getFont(e.text,e._style);r.clear(),i.distanceField.type!=="none"&&(r.customShader||(r.customShader=Te.get(T2)));const s=Array.from(e.text),o=e._style;let a=i.baseLineOffset;const l=kf(s,o,i,!0);let u=0;const c=o.padding,h=l.scale;let d=l.width,f=l.height+l.offsetY;o._stroke&&(d+=o._stroke.width/h,f+=o._stroke.width/h),r.translate(-e._anchor._x*d-c,-e._anchor._y*f-c).scale(h,h);const p=i.applyFillAsTint?o._fill.color:16777215;for(let g=0;g<l.lines.length;g++){const m=l.lines[g];for(let v=0;v<m.charPositions.length;v++){const x=s[u++],S=i.chars[x];S?.texture&&r.texture(S.texture,p||"black",Math.round(m.charPositions[v]+S.xOffset),Math.round(a+S.yOffset))}a+=i.lineHeight}}_getGpuBitmapText(e){return this._gpuBitmapText[e.uid]||this.initGpuText(e)}initGpuText(e){const t=Te.get(ai);return this._gpuBitmapText[e.uid]=t,this._updateContext(e,t),e.on("destroyed",this._destroyRenderableBound),this._gpuBitmapText[e.uid]}_updateDistanceField(e){const t=this._getGpuBitmapText(e).context,r=e._style.fontFamily,i=Oe.get(`${r}-bitmap`),{a:s,b:o,c:a,d:l}=e.groupTransform,u=Math.sqrt(s*s+o*o),c=Math.sqrt(a*a+l*l),h=(Math.abs(u)+Math.abs(c))/2,d=i.baseRenderedFontSize/e._style.fontSize,f=h*i.distanceField.range*(1/d);t.customShader.resources.localUniforms.uniforms.uDistance=f}destroy(){for(const e in this._gpuBitmapText)this._destroyRenderableByUid(e);this._gpuBitmapText=null,this._renderer=null}}kp.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"bitmapText"};function pc(n,e){e.groupTransform=n.groupTransform,e.groupColorAlpha=n.groupColorAlpha,e.groupColor=n.groupColor,e.groupBlendMode=n.groupBlendMode,e.globalDisplayStatus=n.globalDisplayStatus,e.groupTransform=n.groupTransform,e.localDisplayStatus=n.localDisplayStatus,e.groupAlpha=n.groupAlpha,e._roundPixels=n._roundPixels}class Rp{constructor(e){this._gpuText=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e,this._renderer.runners.resolutionChange.add(this)}resolutionChange(){for(const e in this._gpuText){const t=this._gpuText[e];if(!t)continue;const r=t.batchableSprite.renderable;r._autoResolution&&(r._resolution=this._renderer.resolution,r.onViewUpdate())}}validateRenderable(e){const t=this._getGpuText(e),r=e._getKey();return t.textureNeedsUploading?(t.textureNeedsUploading=!1,!0):t.currentKey!==r}addRenderable(e,t){const i=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),this._renderer.renderPipes.batch.addToBatch(i,t)}updateRenderable(e){const r=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),r._batcher.updateElement(r)}destroyRenderable(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableById(e.uid)}_destroyRenderableById(e){const t=this._gpuText[e];this._renderer.htmlText.decreaseReferenceCount(t.currentKey),Te.return(t.batchableSprite),this._gpuText[e]=null}_updateText(e){const t=e._getKey(),r=this._getGpuText(e),i=r.batchableSprite;r.currentKey!==t&&this._updateGpuText(e).catch(o=>{console.error(o)}),e._didTextUpdate=!1;const s=e._style.padding;ds(i.bounds,e._anchor,i.texture,s)}async _updateGpuText(e){e._didTextUpdate=!1;const t=this._getGpuText(e);if(t.generatingTexture)return;const r=e._getKey();this._renderer.htmlText.decreaseReferenceCount(t.currentKey),t.generatingTexture=!0,t.currentKey=r;const i=e.resolution??this._renderer.resolution,s=await this._renderer.htmlText.getManagedTexture(e.text,i,e._style,e._getKey()),o=t.batchableSprite;o.texture=t.texture=s,t.generatingTexture=!1,t.textureNeedsUploading=!0,e.onViewUpdate();const a=e._style.padding;ds(o.bounds,e._anchor,o.texture,a)}_getGpuText(e){return this._gpuText[e.uid]||this.initGpuText(e)}initGpuText(e){const t={texture:se.EMPTY,currentKey:"--",batchableSprite:Te.get(pl),textureNeedsUploading:!1,generatingTexture:!1},r=t.batchableSprite;return r.renderable=e,r.transform=e.groupTransform,r.texture=se.EMPTY,r.bounds={minX:0,maxX:1,minY:0,maxY:0},r.roundPixels=this._renderer._roundPixels|e._roundPixels,e._resolution=e._autoResolution?this._renderer.resolution:e.resolution,this._gpuText[e.uid]=t,e.on("destroyed",this._destroyRenderableBound),t}destroy(){for(const e in this._gpuText)this._destroyRenderableById(e);this._gpuText=null,this._renderer=null}}Rp.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"htmlText"};function C2(){const{userAgent:n}=Se.get().getNavigator();return/^((?!chrome|android).)*safari/i.test(n)}const P2=new vt;function Bp(n,e,t,r){const i=P2;i.minX=0,i.minY=0,i.maxX=n.width/r|0,i.maxY=n.height/r|0;const s=Me.getOptimalTexture(i.width,i.height,r,!1);return s.source.uploadMethodId="image",s.source.resource=n,s.source.alphaMode="premultiply-alpha-on-upload",s.frame.width=e/r,s.frame.height=t/r,s.source.emit("update",s.source),s.updateUvs(),s}function A2(n,e){const t=e.fontFamily,r=[],i={},s=/font-family:([^;"\s]+)/g,o=n.match(s);function a(l){i[l]||(r.push(l),i[l]=!0)}if(Array.isArray(t))for(let l=0;l<t.length;l++)a(t[l]);else a(t);o&&o.forEach(l=>{const u=l.split(":")[1].trim();a(u)});for(const l in e.tagStyles){const u=e.tagStyles[l].fontFamily;a(u)}return r}async function E2(n){const t=await(await Se.get().fetch(n)).blob(),r=new FileReader;return await new Promise((s,o)=>{r.onloadend=()=>s(r.result),r.onerror=o,r.readAsDataURL(t)})}async function mc(n,e){const t=await E2(e);return`@font-face {
        font-family: "${n.fontFamily}";
        src: url('${t}');
        font-weight: ${n.fontWeight};
        font-style: ${n.fontStyle};
    }`}const Yi=new Map;async function M2(n,e,t){const r=n.filter(i=>Oe.has(`${i}-and-url`)).map((i,s)=>{if(!Yi.has(i)){const{url:o}=Oe.get(`${i}-and-url`);s===0?Yi.set(i,mc({fontWeight:e.fontWeight,fontStyle:e.fontStyle,fontFamily:i},o)):Yi.set(i,mc({fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontFamily:i},o))}return Yi.get(i)});return(await Promise.all(r)).join(`
`)}function k2(n,e,t,r,i){const{domElement:s,styleElement:o,svgRoot:a}=i;s.innerHTML=`<style>${e.cssStyle}</style><div style='padding:0;'>${n}</div>`,s.setAttribute("style",`transform: scale(${t});transform-origin: top left; display: inline-block`),o.textContent=r;const{width:l,height:u}=i.image;return a.setAttribute("width",l.toString()),a.setAttribute("height",u.toString()),new XMLSerializer().serializeToString(a)}function R2(n,e){const t=fn.getOptimalCanvasAndContext(n.width,n.height,e),{context:r}=t;return r.clearRect(0,0,n.width,n.height),r.drawImage(n,0,0),fn.returnCanvasAndContext(t),t.canvas}function B2(n,e,t){return new Promise(async r=>{t&&await new Promise(i=>setTimeout(i,100)),n.onload=()=>{r()},n.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(e)}`,n.crossOrigin="anonymous"})}class Tl{constructor(e){this._activeTextures={},this._renderer=e,this._createCanvas=e.type===Pt.WEBGPU}getTexture(e){return this._buildTexturePromise(e.text,e.resolution,e.style)}getManagedTexture(e,t,r,i){if(this._activeTextures[i])return this._increaseReferenceCount(i),this._activeTextures[i].promise;const s=this._buildTexturePromise(e,t,r).then(o=>(this._activeTextures[i].texture=o,o));return this._activeTextures[i]={texture:null,promise:s,usageCount:1},s}async _buildTexturePromise(e,t,r){const i=Te.get(Zf),s=A2(e,r),o=await M2(s,r,al.defaultTextStyle),a=Px(e,r,o,i),l=Math.ceil(Math.ceil(Math.max(1,a.width)+r.padding*2)*t),u=Math.ceil(Math.ceil(Math.max(1,a.height)+r.padding*2)*t),c=i.image,h=2;c.width=(l|0)+h,c.height=(u|0)+h;const d=k2(e,r,t,o,i);await B2(c,d,C2()&&s.length>0);let f=c;this._createCanvas&&(f=R2(c,t));const p=Bp(f,c.width-h,c.height-h,t);return this._createCanvas&&this._renderer.texture.initSource(p.source),Te.return(i),p}_increaseReferenceCount(e){this._activeTextures[e].usageCount++}decreaseReferenceCount(e){const t=this._activeTextures[e];t&&(t.usageCount--,t.usageCount===0&&(t.texture?this._cleanUp(t):t.promise.then(r=>{t.texture=r,this._cleanUp(t)}).catch(()=>{de("HTMLTextSystem: Failed to clean texture")}),this._activeTextures[e]=null))}_cleanUp(e){Me.returnTexture(e.texture),e.texture.source.resource=null,e.texture.source.uploadMethodId="unknown"}getReferenceCount(e){return this._activeTextures[e].usageCount}destroy(){this._activeTextures=null}}Tl.extension={type:[M.WebGLSystem,M.WebGPUSystem,M.CanvasSystem],name:"htmlText"};Tl.defaultFontOptions={fontFamily:"Arial",fontStyle:"normal",fontWeight:"normal"};class Ip{constructor(e){this._gpuText=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e,this._renderer.runners.resolutionChange.add(this)}resolutionChange(){for(const e in this._gpuText){const t=this._gpuText[e];if(!t)continue;const r=t.batchableSprite.renderable;r._autoResolution&&(r._resolution=this._renderer.resolution,r.onViewUpdate())}}validateRenderable(e){const t=this._getGpuText(e),r=e._getKey();if(t.currentKey!==r){const{width:i,height:s}=this._renderer.canvasText.getTextureSize(e.text,e.resolution,e._style);return!(this._renderer.canvasText.getReferenceCount(t.currentKey)===1&&i===t.texture._source.width&&s===t.texture._source.height)}return!1}addRenderable(e,t){const i=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),this._renderer.renderPipes.batch.addToBatch(i,t)}updateRenderable(e){const r=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),r._batcher.updateElement(r)}destroyRenderable(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableById(e.uid)}_destroyRenderableById(e){const t=this._gpuText[e];this._renderer.canvasText.decreaseReferenceCount(t.currentKey),Te.return(t.batchableSprite),this._gpuText[e]=null}_updateText(e){const t=e._getKey(),r=this._getGpuText(e),i=r.batchableSprite;r.currentKey!==t&&this._updateGpuText(e),e._didTextUpdate=!1;const s=e._style.padding;ds(i.bounds,e._anchor,i.texture,s)}_updateGpuText(e){const t=this._getGpuText(e),r=t.batchableSprite;t.texture&&this._renderer.canvasText.decreaseReferenceCount(t.currentKey),t.texture=r.texture=this._renderer.canvasText.getManagedTexture(e),t.currentKey=e._getKey(),r.texture=t.texture}_getGpuText(e){return this._gpuText[e.uid]||this.initGpuText(e)}initGpuText(e){const t={texture:null,currentKey:"--",batchableSprite:Te.get(pl)};return t.batchableSprite.renderable=e,t.batchableSprite.transform=e.groupTransform,t.batchableSprite.bounds={minX:0,maxX:1,minY:0,maxY:0},t.batchableSprite.roundPixels=this._renderer._roundPixels|e._roundPixels,this._gpuText[e.uid]=t,e._resolution=e._autoResolution?this._renderer.resolution:e.resolution,this._updateText(e),e.on("destroyed",this._destroyRenderableBound),t}destroy(){for(const e in this._gpuText)this._destroyRenderableById(e);this._gpuText=null,this._renderer=null}}Ip.extension={type:[M.WebGLPipes,M.WebGPUPipes,M.CanvasPipes],name:"text"};function gc(n,e,t){for(let r=0,i=4*t*e;r<e;++r,i+=4)if(n[i+3]!==0)return!1;return!0}function _c(n,e,t,r,i){const s=4*e;for(let o=r,a=r*s+4*t;o<=i;++o,a+=s)if(n[a+3]!==0)return!1;return!0}function I2(n,e=1){const{width:t,height:r}=n,i=n.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const o=i.getImageData(0,0,t,r).data;let a=0,l=0,u=t-1,c=r-1;for(;l<r&&gc(o,t,l);)++l;if(l===r)return Re.EMPTY;for(;gc(o,t,c);)--c;for(;_c(o,t,a,l,c);)++a;for(;_c(o,t,u,l,c);)--u;return++u,++c,new Re(a/e,l/e,(u-a)/e,(c-l)/e)}class Fp{constructor(e){this._activeTextures={},this._renderer=e}getTextureSize(e,t,r){const i=Qt.measureText(e||" ",r);let s=Math.ceil(Math.ceil(Math.max(1,i.width)+r.padding*2)*t),o=Math.ceil(Math.ceil(Math.max(1,i.height)+r.padding*2)*t);return s=Math.ceil(s-1e-6),o=Math.ceil(o-1e-6),s=_r(s),o=_r(o),{width:s,height:o}}getTexture(e,t,r,i){typeof e=="string"&&(ie("8.0.0","CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments"),e={text:e,style:r,resolution:t}),e.style instanceof dn||(e.style=new dn(e.style));const{texture:s,canvasAndContext:o}=this.createTextureAndCanvas(e);return this._renderer.texture.initSource(s._source),fn.returnCanvasAndContext(o),s}createTextureAndCanvas(e){const{text:t,style:r}=e,i=e.resolution??this._renderer.resolution,s=Qt.measureText(t||" ",r),o=Math.ceil(Math.ceil(Math.max(1,s.width)+r.padding*2)*i),a=Math.ceil(Math.ceil(Math.max(1,s.height)+r.padding*2)*i),l=fn.getOptimalCanvasAndContext(o,a),{canvas:u}=l;this.renderTextToCanvas(t,r,i,l);const c=Bp(u,o,a,i);if(r.trim){const h=I2(u,i);c.frame.copyFrom(h),c.updateUvs()}return{texture:c,canvasAndContext:l}}getManagedTexture(e){e._resolution=e._autoResolution?this._renderer.resolution:e.resolution;const t=e._getKey();if(this._activeTextures[t])return this._increaseReferenceCount(t),this._activeTextures[t].texture;const{texture:r,canvasAndContext:i}=this.createTextureAndCanvas(e);return this._activeTextures[t]={canvasAndContext:i,texture:r,usageCount:1},r}_increaseReferenceCount(e){this._activeTextures[e].usageCount++}decreaseReferenceCount(e){const t=this._activeTextures[e];if(t.usageCount--,t.usageCount===0){fn.returnCanvasAndContext(t.canvasAndContext),Me.returnTexture(t.texture);const r=t.texture.source;r.resource=null,r.uploadMethodId="unknown",r.alphaMode="no-premultiply-alpha",this._activeTextures[e]=null}}getReferenceCount(e){return this._activeTextures[e].usageCount}renderTextToCanvas(e,t,r,i){const{canvas:s,context:o}=i,a=ys(t),l=Qt.measureText(e||" ",t),u=l.lines,c=l.lineHeight,h=l.lineWidths,d=l.maxLineWidth,f=l.fontProperties,p=s.height;o.resetTransform(),o.scale(r,r);const g=t.padding*2;if(o.clearRect(0,0,l.width+4+g,l.height+4+g),t._stroke?.width){const S=t._stroke;o.lineWidth=S.width,o.miterLimit=S.miterLimit,o.lineJoin=S.join,o.lineCap=S.cap}o.font=a;let m,v;const x=t.dropShadow?2:1;for(let S=0;S<x;++S){const y=t.dropShadow&&S===0,b=y?Math.ceil(Math.max(1,p)+t.padding*2):0,B=b*r;if(y){o.fillStyle="black",o.strokeStyle="black";const E=t.dropShadow,_=E.color,I=E.alpha;o.shadowColor=me.shared.setValue(_).setAlpha(I).toRgbaString();const re=E.blur*r,Y=E.distance*r;o.shadowBlur=re,o.shadowOffsetX=Math.cos(E.angle)*Y,o.shadowOffsetY=Math.sin(E.angle)*Y+B}else o.globalAlpha=t._fill?.alpha??1,o.fillStyle=t._fill?Ss(t._fill,o):null,t._stroke?.width&&(o.strokeStyle=Ss(t._stroke,o)),o.shadowColor="black";let A=(c-f.fontSize)/2;c-f.fontSize<0&&(A=0);const U=t._stroke?.width??0;for(let E=0;E<u.length;E++)m=U/2,v=U/2+E*c+f.ascent+A,t.align==="right"?m+=d-h[E]:t.align==="center"&&(m+=(d-h[E])/2),t._stroke?.width&&this._drawLetterSpacing(u[E],t,i,m+t.padding,v+t.padding-b,!0),t._fill!==void 0&&this._drawLetterSpacing(u[E],t,i,m+t.padding,v+t.padding-b)}}_drawLetterSpacing(e,t,r,i,s,o=!1){const{context:a}=r,l=t.letterSpacing;let u=!1;if(Qt.experimentalLetterSpacingSupported&&(Qt.experimentalLetterSpacing?(a.letterSpacing=`${l}px`,a.textLetterSpacing=`${l}px`,u=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px")),l===0||u){o?a.strokeText(e,i,s):a.fillText(e,i,s);return}let c=i;const h=Qt.graphemeSegmenter(e);let d=a.measureText(e).width,f=0;for(let p=0;p<h.length;++p){const g=h[p];o?a.strokeText(g,c,s):a.fillText(g,c,s);let m="";for(let v=p+1;v<h.length;++v)m+=h[v];f=a.measureText(m).width,c+=d-f+l,d=f}}destroy(){this._activeTextures=null}}Fp.extension={type:[M.WebGLSystem,M.WebGPUSystem,M.CanvasSystem],name:"canvasText"};pe.add(U_,G_);var Pe=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Ae=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}`,F2=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uGamma;
uniform float uContrast;
uniform float uSaturation;
uniform float uBrightness;
uniform vec4 uColor;

void main()
{
    vec4 c = texture(uTexture, vTextureCoord);

    if (c.a > 0.0) {
        c.rgb /= c.a;

        vec3 rgb = pow(c.rgb, vec3(1. / uGamma));
        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, uSaturation), uContrast);
        rgb.r *= uColor.r;
        rgb.g *= uColor.g;
        rgb.b *= uColor.b;
        c.rgb = rgb * uBrightness;

        c.rgb *= c.a;
    }

    finalColor = c * uColor.a;
}
`,O2=`struct AdjustmentUniforms {
  uGamma: f32,
  uContrast: f32,
  uSaturation: f32,
  uBrightness: f32,
  uColor: vec4<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> adjustmentUniforms : AdjustmentUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
  var sample = textureSample(uTexture, uSampler, uv);
  let color = adjustmentUniforms.uColor;

  if (sample.a > 0.0) 
  {
    sample = vec4<f32>(sample.rgb / sample.a, sample.a);
    var rgb: vec3<f32> = pow(sample.rgb, vec3<f32>(1. / adjustmentUniforms.uGamma));
    rgb = mix(vec3<f32>(.5), mix(vec3<f32>(dot(vec3<f32>(.2125, .7154, .0721), rgb)), rgb, adjustmentUniforms.uSaturation), adjustmentUniforms.uContrast);
    rgb.r *= color.r;
    rgb.g *= color.g;
    rgb.b *= color.b;
    sample = vec4<f32>(rgb.rgb * adjustmentUniforms.uBrightness, sample.a);
    sample = vec4<f32>(sample.rgb * sample.a, sample.a);
  }

  return sample * color.a;
}`,U2=Object.defineProperty,G2=(n,e,t)=>e in n?U2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Op=(n,e,t)=>(G2(n,typeof e!="symbol"?e+"":e,t),t);const Up=class Gp extends xe{constructor(e){e={...Gp.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:O2,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:F2,name:"adjustment-filter"});super({gpuProgram:t,glProgram:r,resources:{adjustmentUniforms:{uGamma:{value:e.gamma,type:"f32"},uContrast:{value:e.contrast,type:"f32"},uSaturation:{value:e.saturation,type:"f32"},uBrightness:{value:e.brightness,type:"f32"},uColor:{value:[e.red,e.green,e.blue,e.alpha],type:"vec4<f32>"}}}}),Op(this,"uniforms"),this.uniforms=this.resources.adjustmentUniforms.uniforms}get gamma(){return this.uniforms.uGamma}set gamma(e){this.uniforms.uGamma=e}get contrast(){return this.uniforms.uContrast}set contrast(e){this.uniforms.uContrast=e}get saturation(){return this.uniforms.uSaturation}set saturation(e){this.uniforms.uSaturation=e}get brightness(){return this.uniforms.uBrightness}set brightness(e){this.uniforms.uBrightness=e}get red(){return this.uniforms.uColor[0]}set red(e){this.uniforms.uColor[0]=e}get green(){return this.uniforms.uColor[1]}set green(e){this.uniforms.uColor[1]=e}get blue(){return this.uniforms.uColor[2]}set blue(e){this.uniforms.uColor[2]=e}get alpha(){return this.uniforms.uColor[3]}set alpha(e){this.uniforms.uColor[3]=e}};Op(Up,"DEFAULT_OPTIONS",{gamma:1,contrast:1,saturation:1,brightness:1,red:1,green:1,blue:1,alpha:1});let D2=Up;var z2=`
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture(uTexture, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture(uTexture, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture(uTexture, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture(uTexture, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    finalColor = color;
}`,L2=`struct KawaseBlurUniforms {
  uOffset:vec2<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> kawaseBlurUniforms : KawaseBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uOffset = kawaseBlurUniforms.uOffset;
  var color: vec4<f32> = vec4<f32>(0.0);

  // Sample top left pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x - uOffset.x, uv.y + uOffset.y));
  // Sample top right pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x + uOffset.x, uv.y + uOffset.y));
  // Sample bottom right pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x + uOffset.x, uv.y - uOffset.y));
  // Sample bottom left pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x - uOffset.x, uv.y - uOffset.y));
  // Average
  color *= 0.25;

  return color;
}`,N2=`
precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uOffset;

uniform vec4 uInputClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Sample top right pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Sample bottom right pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Sample bottom left pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Average
    color *= 0.25;

    finalColor = color;
}
`,H2=`struct KawaseBlurUniforms {
  uOffset:vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> kawaseBlurUniforms : KawaseBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uOffset = kawaseBlurUniforms.uOffset;
  var color: vec4<f32> = vec4(0.0);

  // Sample top left pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x - uOffset.x, uv.y + uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Sample top right pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x + uOffset.x, uv.y + uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Sample bottom right pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x + uOffset.x, uv.y - uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Sample bottom left pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x - uOffset.x, uv.y - uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Average
  color *= 0.25;
    
  return color;
}`,V2=Object.defineProperty,W2=(n,e,t)=>e in n?V2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Bn=(n,e,t)=>(W2(n,typeof e!="symbol"?e+"":e,t),t);const Dp=class zp extends xe{constructor(...e){let t=e[0]??{};(typeof t=="number"||Array.isArray(t))&&(ie("6.0.0","KawaseBlurFilter constructor params are now options object. See params: { strength, quality, clamp, pixelSize }"),t={strength:t},e[1]!==void 0&&(t.quality=e[1]),e[2]!==void 0&&(t.clamp=e[2])),t={...zp.DEFAULT_OPTIONS,...t};const r=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:t?.clamp?H2:L2,entryPoint:"mainFragment"}}),i=_e.from({vertex:Pe,fragment:t?.clamp?N2:z2,name:"kawase-blur-filter"});super({gpuProgram:r,glProgram:i,resources:{kawaseBlurUniforms:{uOffset:{value:new Float32Array(2),type:"vec2<f32>"}}}}),Bn(this,"uniforms"),Bn(this,"_pixelSize",{x:0,y:0}),Bn(this,"_clamp"),Bn(this,"_kernels",[]),Bn(this,"_blur"),Bn(this,"_quality"),this.uniforms=this.resources.kawaseBlurUniforms.uniforms,this.pixelSize=t.pixelSize??{x:1,y:1},Array.isArray(t.strength)?this.kernels=t.strength:typeof t.strength=="number"&&(this._blur=t.strength,this.quality=t.quality??3),this._clamp=!!t.clamp}apply(e,t,r,i){const s=this.pixelSizeX/t.source.width,o=this.pixelSizeY/t.source.height;let a;if(this._quality===1||this._blur===0)a=this._kernels[0]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,t,r,i);else{const l=Me.getSameSizeTexture(t);let u=t,c=l,h;const d=this._quality-1;for(let f=0;f<d;f++)a=this._kernels[f]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,u,c,!0),h=u,u=c,c=h;a=this._kernels[d]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,u,r,i),Me.returnTexture(l)}}get strength(){return this._blur}set strength(e){this._blur=e,this._generateKernels()}get quality(){return this._quality}set quality(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}get kernels(){return this._kernels}set kernels(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max(...e)):(this._kernels=[0],this._quality=1)}get pixelSize(){return this._pixelSize}set pixelSize(e){if(typeof e=="number"){this.pixelSizeX=this.pixelSizeY=e;return}if(Array.isArray(e)){this.pixelSizeX=e[0],this.pixelSizeY=e[1];return}this._pixelSize=e}get pixelSizeX(){return this.pixelSize.x}set pixelSizeX(e){this.pixelSize.x=e}get pixelSizeY(){return this.pixelSize.y}set pixelSizeY(e){this.pixelSize.y=e}get clamp(){return this._clamp}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((e,t)=>e+t+.5,0))}_generateKernels(){const e=this._blur,t=this._quality,r=[e];if(e>0){let i=e;const s=e/t;for(let o=1;o<t;o++)i-=s,r.push(i)}this._kernels=r,this._updatePadding()}};Bn(Dp,"DEFAULT_OPTIONS",{strength:4,quality:3,clamp:!1,pixelSize:{x:1,y:1}});let Lp=Dp;var j2=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uMapTexture;
uniform float uBloomScale;
uniform float uBrightness;

void main() {
    vec4 color = texture(uTexture, vTextureCoord);
    color.rgb *= uBrightness;
    vec4 bloomColor = vec4(texture(uMapTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= uBloomScale;
    finalColor = color + bloomColor;
}
`,X2=`struct AdvancedBloomUniforms {
  uBloomScale: f32,
  uBrightness: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> advancedBloomUniforms : AdvancedBloomUniforms;
@group(1) @binding(1) var uMapTexture: texture_2d<f32>;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color = textureSample(uTexture, uSampler, uv);
  color = vec4<f32>(color.rgb * advancedBloomUniforms.uBrightness, color.a);

  var bloomColor = vec4<f32>(textureSample(uMapTexture, uSampler, uv).rgb, 0.0);
  bloomColor = vec4<f32>(bloomColor.rgb * advancedBloomUniforms.uBloomScale, bloomColor.a);
  
  return color + bloomColor;
}
`,q2=`
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uThreshold;

void main() {
    vec4 color = texture(uTexture, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > uThreshold) {
        finalColor = color;
    } else {
        finalColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`,Y2=`struct ExtractBrightnessUniforms {
  uThreshold: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> extractBrightnessUniforms : ExtractBrightnessUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  // A simple & fast algorithm for getting brightness.
  // It's inaccurate, but good enough for this feature.
  let max: f32 = max(max(color.r, color.g), color.b);
  let min: f32 = min(min(color.r, color.g), color.b);
  let brightness: f32 = (max + min) * 0.5;

  return select(vec4<f32>(0.), color, brightness > extractBrightnessUniforms.uThreshold);
}
`,K2=Object.defineProperty,Z2=(n,e,t)=>e in n?K2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Np=(n,e,t)=>(Z2(n,typeof e!="symbol"?e+"":e,t),t);const Hp=class Vp extends xe{constructor(e){e={...Vp.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:Y2,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:q2,name:"extract-brightness-filter"});super({gpuProgram:t,glProgram:r,resources:{extractBrightnessUniforms:{uThreshold:{value:e.threshold,type:"f32"}}}}),Np(this,"uniforms"),this.uniforms=this.resources.extractBrightnessUniforms.uniforms}get threshold(){return this.uniforms.uThreshold}set threshold(e){this.uniforms.uThreshold=e}};Np(Hp,"DEFAULT_OPTIONS",{threshold:.5});let Q2=Hp;var J2=Object.defineProperty,$2=(n,e,t)=>e in n?J2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,rr=(n,e,t)=>($2(n,typeof e!="symbol"?e+"":e,t),t);const eS=class Wp extends xe{constructor(e){e={...Wp.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:X2,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:j2,name:"advanced-bloom-filter"});super({gpuProgram:t,glProgram:r,resources:{advancedBloomUniforms:{uBloomScale:{value:e.bloomScale,type:"f32"},uBrightness:{value:e.brightness,type:"f32"}},uMapTexture:se.WHITE}}),rr(this,"uniforms"),rr(this,"bloomScale",1),rr(this,"brightness",1),rr(this,"_extractFilter"),rr(this,"_blurFilter"),this.uniforms=this.resources.advancedBloomUniforms.uniforms,this._extractFilter=new Q2({threshold:e.threshold}),this._blurFilter=new Lp({strength:e.kernels??e.blur,quality:e.kernels?void 0:e.quality}),Object.assign(this,e)}apply(e,t,r,i){const s=Me.getSameSizeTexture(t);this._extractFilter.apply(e,t,s,!0);const o=Me.getSameSizeTexture(t);this._blurFilter.apply(e,s,o,!0),this.uniforms.uBloomScale=this.bloomScale,this.uniforms.uBrightness=this.brightness,this.resources.uMapTexture=o.source,e.applyFilter(this,t,r,i),Me.returnTexture(o),Me.returnTexture(s)}get threshold(){return this._extractFilter.threshold}set threshold(e){this._extractFilter.threshold=e}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get blur(){return this._blurFilter.strength}set blur(e){this._blurFilter.strength=e}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){typeof e=="number"&&(e={x:e,y:e}),Array.isArray(e)&&(e={x:e[0],y:e[1]}),this._blurFilter.pixelSize=e}get pixelSizeX(){return this._blurFilter.pixelSizeX}set pixelSizeX(e){this._blurFilter.pixelSizeX=e}get pixelSizeY(){return this._blurFilter.pixelSizeY}set pixelSizeY(e){this._blurFilter.pixelSizeY=e}};rr(eS,"DEFAULT_OPTIONS",{threshold:.5,bloomScale:1,brightness:1,blur:8,quality:4,pixelSize:{x:1,y:1}});var tS=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uSize;
uniform vec3 uColor;
uniform float uReplaceColor;

uniform vec4 uInputSize;

vec2 mapCoord( vec2 coord )
{
    coord *= uInputSize.xy;
    coord += uInputSize.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= uInputSize.zw;
    coord /= uInputSize.xy;

    return coord;
}

vec2 pixelate(vec2 coord, vec2 size)
{
    return floor(coord / size) * size;
}

vec2 getMod(vec2 coord, vec2 size)
{
    return mod(coord, size) / size;
}

float character(float n, vec2 p)
{
    p = floor(p*vec2(4.0, 4.0) + 2.5);

    if (clamp(p.x, 0.0, 4.0) == p.x)
    {
        if (clamp(p.y, 0.0, 4.0) == p.y)
        {
            if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;
        }
    }
    return 0.0;
}

void main()
{
    vec2 coord = mapCoord(vTextureCoord);

    // get the grid position
    vec2 pixCoord = pixelate(coord, vec2(uSize));
    pixCoord = unmapCoord(pixCoord);

    // sample the color at grid position
    vec4 color = texture(uTexture, pixCoord);

    // brightness of the color as it's perceived by the human eye
    float gray = 0.3 * color.r + 0.59 * color.g + 0.11 * color.b;

    // determine the character to use
    float n =  65536.0;             // .
    if (gray > 0.2) n = 65600.0;    // :
    if (gray > 0.3) n = 332772.0;   // *
    if (gray > 0.4) n = 15255086.0; // o
    if (gray > 0.5) n = 23385164.0; // &
    if (gray > 0.6) n = 15252014.0; // 8
    if (gray > 0.7) n = 13199452.0; // @
    if (gray > 0.8) n = 11512810.0; // #

    // get the mod..
    vec2 modd = getMod(coord, vec2(uSize));

    finalColor = (uReplaceColor > 0.5 ? vec4(uColor, 1.) : color) * character( n, vec2(-1.0) + modd * 2.0);
}
`,nS=`struct AsciiUniforms {
    uSize: f32,
    uColor: vec3<f32>,
    uReplaceColor: f32,
};

struct GlobalFilterUniforms {
    uInputSize:vec4<f32>,
    uInputPixel:vec4<f32>,
    uInputClamp:vec4<f32>,
    uOutputFrame:vec4<f32>,
    uGlobalFrame:vec4<f32>,
    uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> asciiUniforms : AsciiUniforms;

@fragment
fn mainFragment(
    @location(0) uv: vec2<f32>,
    @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
    let pixelSize: f32 = asciiUniforms.uSize;
    let coord: vec2<f32> = mapCoord(uv);

    // get the rounded color..
    var pixCoord: vec2<f32> = pixelate(coord, vec2<f32>(pixelSize));
    pixCoord = unmapCoord(pixCoord);

    var color = textureSample(uTexture, uSampler, pixCoord);

    // determine the character to use
    let gray: f32 = 0.3 * color.r + 0.59 * color.g + 0.11 * color.b;
    
    var n: f32 = 65536.0; // .
    if (gray > 0.2) {
        n = 65600.0;    // :
    }
    if (gray > 0.3) {
        n = 332772.0;   // *
    }
    if (gray > 0.4) {
        n = 15255086.0; // o
    }
    if (gray > 0.5) {
        n = 23385164.0; // &
    }
    if (gray > 0.6) {
        n = 15252014.0; // 8
    }
    if (gray > 0.7) {
        n = 13199452.0; // @
    }
    if (gray > 0.8) {
        n = 11512810.0; // #
    }

    // get the mod..
    let modd: vec2<f32> = getMod(coord, vec2<f32>(pixelSize));
    return select(color, vec4<f32>(asciiUniforms.uColor, 1.), asciiUniforms.uReplaceColor > 0.5) * character(n, vec2<f32>(-1.0) + modd * 2.0);
}

fn pixelate(coord: vec2<f32>, size: vec2<f32>) -> vec2<f32>
{
    return floor( coord / size ) * size;
}

fn getMod(coord: vec2<f32>, size: vec2<f32>) -> vec2<f32>
{
    return moduloVec2( coord , size) / size;
}

fn character(n: f32, p: vec2<f32>) -> f32
{
    var q: vec2<f32> = floor(p*vec2<f32>(4.0, 4.0) + 2.5);

    if (clamp(q.x, 0.0, 4.0) == q.x)
    {
        if (clamp(q.y, 0.0, 4.0) == q.y)
        {
        if (i32(modulo(n/exp2(q.x + 5.0*q.y), 2.0)) == 1)
        {
            return 1.0;
        }
        }
    }

    return 0.0;
}

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

fn moduloVec2(x: vec2<f32>, y: vec2<f32>) -> vec2<f32>
{
  return x - y * floor(x/y);
}

fn mapCoord(coord: vec2<f32> ) -> vec2<f32>
{
    var mappedCoord: vec2<f32> = coord;
    mappedCoord *= gfu.uInputSize.xy;
    mappedCoord += gfu.uOutputFrame.xy;
    return mappedCoord;
}

fn unmapCoord(coord: vec2<f32> ) -> vec2<f32>
{
    var mappedCoord: vec2<f32> = coord;
    mappedCoord -= gfu.uOutputFrame.xy;
    mappedCoord /= gfu.uInputSize.xy;
    return mappedCoord;
}`,rS=Object.defineProperty,iS=(n,e,t)=>e in n?rS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xa=(n,e,t)=>(iS(n,typeof e!="symbol"?e+"":e,t),t);const sS=class jp extends xe{constructor(...e){let t=e[0]??{};typeof t=="number"&&(ie("6.0.0","AsciiFilter constructor params are now options object. See params: { size, color, replaceColor }"),t={size:t});const r=t?.color&&t.replaceColor!==!1;t={...jp.DEFAULT_OPTIONS,...t};const i=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:nS,entryPoint:"mainFragment"}}),s=_e.from({vertex:Pe,fragment:tS,name:"ascii-filter"});super({gpuProgram:i,glProgram:s,resources:{asciiUniforms:{uSize:{value:t.size,type:"f32"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uReplaceColor:{value:Number(r),type:"f32"}}}}),xa(this,"uniforms"),xa(this,"_color"),this.uniforms=this.resources.asciiUniforms.uniforms,this._color=new me,this.color=t.color??16777215}get size(){return this.uniforms.uSize}set size(e){this.uniforms.uSize=e}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,r,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get replaceColor(){return this.uniforms.uReplaceColor>.5}set replaceColor(e){this.uniforms.uReplaceColor=e?1:0}};xa(sS,"DEFAULT_OPTIONS",{size:8,color:16777215,replaceColor:!1});var oS=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uTransform;
uniform vec3 uLightColor;
uniform float uLightAlpha;
uniform vec3 uShadowColor;
uniform float uShadowAlpha;

uniform vec4 uInputSize;

void main(void) {
    vec2 transform = vec2(1.0 / uInputSize) * vec2(uTransform.x, uTransform.y);
    vec4 color = texture(uTexture, vTextureCoord);
    float light = texture(uTexture, vTextureCoord - transform).a;
    float shadow = texture(uTexture, vTextureCoord + transform).a;

    color.rgb = mix(color.rgb, uLightColor, clamp((color.a - light) * uLightAlpha, 0.0, 1.0));
    color.rgb = mix(color.rgb, uShadowColor, clamp((color.a - shadow) * uShadowAlpha, 0.0, 1.0));
    finalColor = vec4(color.rgb * color.a, color.a);
}
`,aS=`struct BevelUniforms {
  uLightColor: vec3<f32>,
  uLightAlpha: f32,
  uShadowColor: vec3<f32>,
  uShadowAlpha: f32,
  uTransform: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> bevelUniforms : BevelUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let transform = vec2<f32>(1.0 / gfu.uInputSize.xy) * vec2<f32>(bevelUniforms.uTransform.x, bevelUniforms.uTransform.y);
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let lightSample: f32 = textureSample(uTexture, uSampler, uv - transform).a;
  let shadowSample: f32 = textureSample(uTexture, uSampler, uv + transform).a;

  let light = vec4<f32>(bevelUniforms.uLightColor, bevelUniforms.uLightAlpha);
  let shadow = vec4<f32>(bevelUniforms.uShadowColor, bevelUniforms.uShadowAlpha);

  color = vec4<f32>(mix(color.rgb, light.rgb, clamp((color.a - lightSample) * light.a, 0.0, 1.0)), color.a);
  color = vec4<f32>(mix(color.rgb, shadow.rgb, clamp((color.a - shadowSample) * shadow.a, 0.0, 1.0)), color.a);
  
  return vec4<f32>(color.rgb * color.a, color.a);
}`,lS=Object.defineProperty,uS=(n,e,t)=>e in n?lS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ir=(n,e,t)=>(uS(n,typeof e!="symbol"?e+"":e,t),t);const cS=class Xp extends xe{constructor(e){e={...Xp.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:aS,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:oS,name:"bevel-filter"});super({gpuProgram:t,glProgram:r,resources:{bevelUniforms:{uLightColor:{value:new Float32Array(3),type:"vec3<f32>"},uLightAlpha:{value:e.lightAlpha,type:"f32"},uShadowColor:{value:new Float32Array(3),type:"vec3<f32>"},uShadowAlpha:{value:e.shadowAlpha,type:"f32"},uTransform:{value:new Float32Array(2),type:"vec2<f32>"}}},padding:1}),ir(this,"uniforms"),ir(this,"_thickness"),ir(this,"_rotation"),ir(this,"_lightColor"),ir(this,"_shadowColor"),this.uniforms=this.resources.bevelUniforms.uniforms,this._lightColor=new me,this._shadowColor=new me,this.lightColor=e.lightColor??16777215,this.shadowColor=e.shadowColor??0,Object.assign(this,e)}get rotation(){return this._rotation/gr}set rotation(e){this._rotation=e*gr,this._updateTransform()}get thickness(){return this._thickness}set thickness(e){this._thickness=e,this._updateTransform()}get lightColor(){return this._lightColor.value}set lightColor(e){this._lightColor.setValue(e);const[t,r,i]=this._lightColor.toArray();this.uniforms.uLightColor[0]=t,this.uniforms.uLightColor[1]=r,this.uniforms.uLightColor[2]=i}get lightAlpha(){return this.uniforms.uLightAlpha}set lightAlpha(e){this.uniforms.uLightAlpha=e}get shadowColor(){return this._shadowColor.value}set shadowColor(e){this._shadowColor.setValue(e);const[t,r,i]=this._shadowColor.toArray();this.uniforms.uShadowColor[0]=t,this.uniforms.uShadowColor[1]=r,this.uniforms.uShadowColor[2]=i}get shadowAlpha(){return this.uniforms.uShadowAlpha}set shadowAlpha(e){this.uniforms.uShadowAlpha=e}_updateTransform(){this.uniforms.uTransform[0]=this.thickness*Math.cos(this._rotation),this.uniforms.uTransform[1]=this.thickness*Math.sin(this._rotation)}};ir(cS,"DEFAULT_OPTIONS",{rotation:45,thickness:2,lightColor:16777215,lightAlpha:.7,shadowColor:0,shadowAlpha:.7});var hS=Object.defineProperty,fS=(n,e,t)=>e in n?hS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ts=(n,e,t)=>(fS(n,typeof e!="symbol"?e+"":e,t),t);const dS=class qp extends sx{constructor(...e){let t=e[0]??{};if(typeof t=="number"||Array.isArray(t)||"x"in t&&"y"in t){ie("6.0.0","BloomFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }");let r=t;Array.isArray(r)&&(r={x:r[0],y:r[1]}),t={strength:r},e[1]!==void 0&&(t.quality=e[1]),e[2]!==void 0&&(t.resolution=e[2]),e[3]!==void 0&&(t.kernelSize=e[3])}t={...qp.DEFAULT_OPTIONS,...t},super(),ts(this,"_blurXFilter"),ts(this,"_blurYFilter"),ts(this,"_strength"),this._strength={x:2,y:2},t.strength&&(typeof t.strength=="number"?(this._strength.x=t.strength,this._strength.y=t.strength):(this._strength.x=t.strength.x,this._strength.y=t.strength.y)),this._blurXFilter=new Yr({...t,horizontal:!0,strength:this.strengthX}),this._blurYFilter=new Yr({...t,horizontal:!1,strength:this.strengthY}),this._blurYFilter.blendMode="screen",Object.assign(this,t)}apply(e,t,r,i){const s=Me.getSameSizeTexture(t);e.applyFilter(this,t,r,i),this._blurXFilter.apply(e,t,s,!0),this._blurYFilter.apply(e,s,r,!1),Me.returnTexture(s)}get strength(){return this._strength}set strength(e){this._strength=typeof e=="number"?{x:e,y:e}:e,this._updateStrength()}get strengthX(){return this.strength.x}set strengthX(e){this.strength.x=e,this._updateStrength()}get strengthY(){return this.strength.y}set strengthY(e){this.strength.y=e,this._updateStrength()}_updateStrength(){this._blurXFilter.blur=this.strengthX,this._blurYFilter.blur=this.strengthY}get blur(){return ie("6.0.0","BloomFilter.blur is deprecated, please use BloomFilter.strength instead"),this.strengthX}set blur(e){ie("6.0.0","BloomFilter.blur is deprecated, please use BloomFilter.strength instead"),this.strength=e}get blurX(){return ie("6.0.0","BloomFilter.blurX is deprecated, please use BloomFilter.strengthX instead"),this.strengthX}set blurX(e){ie("6.0.0","BloomFilter.blurX is deprecated, please use BloomFilter.strengthX instead"),this.strengthX=e}get blurY(){return ie("6.0.0","BloomFilter.blurY is deprecated, please use BloomFilter.strengthY instead"),this.strengthY}set blurY(e){ie("6.0.0","BloomFilter.blurY is deprecated, please use BloomFilter.strengthY instead"),this.strengthY=e}};ts(dS,"DEFAULT_OPTIONS",{strength:{x:2,y:2},quality:4,resolution:1,kernelSize:5});var pS=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uDimensions;
uniform vec2 uCenter;
uniform float uRadius;
uniform float uStrength;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

void main()
{
    vec2 coord = vTextureCoord * uInputSize.xy;
    coord -= uCenter * uDimensions.xy;
    float distance = length(coord);

    if (distance < uRadius) {
        float percent = distance / uRadius;
        if (uStrength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, uRadius / distance, percent), uStrength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + uStrength * 0.75) * uRadius / distance, 1.0 - percent);
        }
    }

    coord += uCenter * uDimensions.xy;
    coord /= uInputSize.xy;
    vec2 clampedCoord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    vec4 color = texture(uTexture, clampedCoord);

    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    finalColor = color;
}
`,mS=`struct BulgePinchUniforms {
  uDimensions: vec2<f32>,
  uCenter: vec2<f32>,
  uRadius: f32,
  uStrength: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> bulgePinchUniforms : BulgePinchUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let dimensions: vec2<f32> = bulgePinchUniforms.uDimensions;
  let center: vec2<f32> = bulgePinchUniforms.uCenter;
  let radius: f32 = bulgePinchUniforms.uRadius;
  let strength: f32 = bulgePinchUniforms.uStrength;
  var coord: vec2<f32> = (uv * gfu.uInputSize.xy) - center * dimensions.xy;

  let distance: f32 = length(coord);

  if (distance < radius) {
      let percent: f32 = distance / radius;
      if (strength > 0.0) {
          coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
      } else {
          coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
      }
  }
    coord += (center * dimensions.xy);
    coord /= gfu.uInputSize.xy;

    let clampedCoord: vec2<f32> = clamp(coord, gfu.uInputClamp.xy, gfu.uInputClamp.zw);
    var color: vec4<f32> = textureSample(uTexture, uSampler, clampedCoord);
    if (coord.x != clampedCoord.x && coord.y != clampedCoord.y) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    return color;
}

fn compareVec2(x: vec2<f32>, y: vec2<f32>) -> bool
{
  if (x.x == y.x && x.y == y.y)
  {
    return true;
  }

  return false;
}`,gS=Object.defineProperty,_S=(n,e,t)=>e in n?gS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Yp=(n,e,t)=>(_S(n,typeof e!="symbol"?e+"":e,t),t);const vS=class Kp extends xe{constructor(e){e={...Kp.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:mS,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:pS,name:"bulge-pinch-filter"});super({gpuProgram:t,glProgram:r,resources:{bulgePinchUniforms:{uDimensions:{value:[0,0],type:"vec2<f32>"},uCenter:{value:e.center,type:"vec2<f32>"},uRadius:{value:e.radius,type:"f32"},uStrength:{value:e.strength,type:"f32"}}}}),Yp(this,"uniforms"),this.uniforms=this.resources.bulgePinchUniforms.uniforms,Object.assign(this,e)}apply(e,t,r,i){this.uniforms.uDimensions[0]=t.frame.width,this.uniforms.uDimensions[1]=t.frame.height,e.applyFilter(this,t,r,i)}get center(){return this.uniforms.uCenter}set center(e){typeof e=="number"&&(e={x:e,y:e}),Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.uniforms.uCenter.x}set centerX(e){this.uniforms.uCenter.x=e}get centerY(){return this.uniforms.uCenter.y}set centerY(e){this.uniforms.uCenter.y=e}get radius(){return this.uniforms.uRadius}set radius(e){this.uniforms.uRadius=e}get strength(){return this.uniforms.uStrength}set strength(e){this.uniforms.uStrength=e}};Yp(vS,"DEFAULT_OPTIONS",{center:{x:.5,y:.5},radius:100,strength:1});var bS=`precision highp float;
in vec2 vTextureCoord;
in vec2 vFilterCoord;
out vec4 finalColor;

const int TYPE_LINEAR = 0;
const int TYPE_RADIAL = 1;
const int TYPE_CONIC = 2;
const int MAX_STOPS = 32;

uniform sampler2D uTexture;
uniform vec4 uOptions;
uniform vec2 uCounts;
uniform vec3 uColors[MAX_STOPS];
uniform vec4 uStops[MAX_STOPS];

const float PI = 3.1415926538;
const float PI_2 = PI*2.;

struct ColorStop {
    float offset;
    vec3 color;
    float alpha;
};

mat2 rotate2d(float angle){
    return mat2(cos(angle), -sin(angle),
    sin(angle), cos(angle));
}

float projectLinearPosition(vec2 pos, float angle){
    vec2 center = vec2(0.5);
    vec2 result = pos - center;
    result = rotate2d(angle) * result;
    result = result + center;
    return clamp(result.x, 0., 1.);
}

float projectRadialPosition(vec2 pos) {
    float r = distance(pos, vec2(0.5));
    return clamp(2.*r, 0., 1.);
}

float projectAnglePosition(vec2 pos, float angle) {
    vec2 center = pos - vec2(0.5);
    float polarAngle=atan(-center.y, center.x);
    return mod(polarAngle + angle, PI_2) / PI_2;
}

float projectPosition(vec2 pos, int type, float angle) {
    if (type == TYPE_LINEAR) {
        return projectLinearPosition(pos, angle);
    } else if (type == TYPE_RADIAL) {
        return projectRadialPosition(pos);
    } else if (type == TYPE_CONIC) {
        return projectAnglePosition(pos, angle);
    }

    return pos.y;
}

void main(void) {
    int uType = int(uOptions[0]);
    float uAngle = uOptions[1];
    float uAlpha = uOptions[2];
    float uReplace = uOptions[3];

    int uNumStops = int(uCounts[0]);
    float uMaxColors = uCounts[1];

    // current/original color
    vec4 currentColor = texture(uTexture, vTextureCoord);

    // skip calculations if gradient alpha is 0
    if (0.0 == uAlpha) {
        finalColor = currentColor;
        return;
    }

    // project position
    float y = projectPosition(vFilterCoord, int(uType), radians(uAngle));

    // check gradient bounds
    float offsetMin = uStops[0][0];
    float offsetMax = 0.0;

    int numStops = int(uNumStops);

    for (int i = 0; i < MAX_STOPS; i++) {
        if (i == numStops-1){ // last index
            offsetMax = uStops[i][0];
        }
    }

    if (y  < offsetMin || y > offsetMax) {
        finalColor = currentColor;
        return;
    }

    // limit colors
    if (uMaxColors > 0.) {
        float stepSize = 1./uMaxColors;
        float stepNumber = float(floor(y/stepSize));
        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment
    }

    // find color stops
    ColorStop from;
    ColorStop to;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (y >= uStops[i][0]) {
            from = ColorStop(uStops[i][0], uColors[i], uStops[i][1]);
            to = ColorStop(uStops[i+1][0], uColors[i+1], uStops[i+1][1]);
        }

        if (i == numStops-1){ // last index
            break;
        }
    }

    // mix colors from stops
    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);
    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);

    float segmentHeight = to.offset - from.offset;
    float relativePos = y - from.offset;// position from 0 to [segmentHeight]
    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].

    float gradientAlpha = uAlpha * currentColor.a;
    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

    if (uReplace < 0.5) {
        // mix resulting color with current color
        finalColor = gradientColor + currentColor*(1.-gradientColor.a);
    } else {
        // replace with gradient color
        finalColor = gradientColor;
    }
}
`,xS=`in vec2 aPosition;
out vec2 vTextureCoord;
out vec2 vFilterCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
    vFilterCoord = vTextureCoord * uInputSize.xy / uOutputFrame.zw;
}
`,vc=`struct BaseUniforms {
  uOptions: vec4<f32>,
  uCounts: vec2<f32>,
};

struct StopsUniforms {
  uColors: array<vec3<f32>, MAX_STOPS>,
  uStops: array<vec4<f32>, MAX_STOPS>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> baseUniforms : BaseUniforms;
@group(1) @binding(1) var<uniform> stopsUniforms : StopsUniforms;

struct VSOutput {
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>,
  @location(1) coord : vec2<f32>
};

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn filterCoord( vTextureCoord:vec2<f32> ) -> vec2<f32>
{
    return vTextureCoord * gfu.uInputSize.xy / gfu.uOutputFrame.zw;
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  let vTextureCoord: vec2<f32> = filterTextureCoord(aPosition);
  return VSOutput(
   filterVertexPosition(aPosition),
   vTextureCoord,
   filterCoord(vTextureCoord),
  );
}

struct ColorStop {
  offset: f32,
  color: vec3<f32>,
  alpha: f32,
};

fn rotate2d(angle: f32) -> mat2x2<f32>{
  return mat2x2(cos(angle), -sin(angle),
  sin(angle), cos(angle));
}

fn projectLinearPosition(pos: vec2<f32>, angle: f32) -> f32 {
  var center: vec2<f32> = vec2<f32>(0.5);
  var result: vec2<f32> = pos - center;
  result = rotate2d(angle) * result;
  result = result + center;
  return clamp(result.x, 0.0, 1.0);
}

fn projectRadialPosition(pos: vec2<f32>) -> f32 {
  var r: f32 = distance(pos, vec2<f32>(0.5));
  return clamp(2.0 * r, 0.0, 1.0);
}

fn projectAnglePosition(pos: vec2<f32>, angle: f32) -> f32 {
  var center: vec2<f32> = pos - vec2<f32>(0.5, 0.5);
  var polarAngle: f32 = atan2(-center.y, center.x);
  return ((polarAngle + angle) % PI_2) / PI_2;
}

fn projectPosition(pos: vec2<f32>, gradientType: i32, angle: f32) -> f32 {
  if (gradientType == TYPE_LINEAR) {
      return projectLinearPosition(pos, angle);
  } else if (gradientType == TYPE_RADIAL) {
      return projectRadialPosition(pos);
  } else if (gradientType == TYPE_CONIC) {
      return projectAnglePosition(pos, angle);
  }

  return pos.y;
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>,
  @location(1) coord : vec2<f32>
) -> @location(0) vec4<f32> {
  let uType: i32 = i32(baseUniforms.uOptions[0]);
  let uAngle: f32 = baseUniforms.uOptions[1];
  let uAlpha: f32 = baseUniforms.uOptions[2];
  let uReplace: f32 = baseUniforms.uOptions[3];

  let uNumStops: i32 = i32(baseUniforms.uCounts[0]);
  let uMaxColors: f32 = baseUniforms.uCounts[1];

  // current/original color
  var currentColor: vec4<f32> = textureSample(uTexture, uSampler, uv);

  // skip calculations if gradient alpha is 0
  if (uAlpha == 0.0) { return currentColor; }

  // project position
  var y: f32 = projectPosition(coord, uType, radians(uAngle));

  // check gradient bounds
  var offsetMin: f32 = stopsUniforms.uStops[0][0];
  var offsetMax: f32 = 0.0;

  let numStops: i32 = uNumStops;

  for (var i: i32 = 0; i < MAX_STOPS; i = i + 1) {
      if (i == numStops - 1) { // last index
          offsetMax = stopsUniforms.uStops[i][0];
      }
  }

  if (y  < offsetMin || y > offsetMax) { return currentColor; }

  // limit colors
  if (uMaxColors > 0.0) {
      var stepSize: f32 = 1.0 / uMaxColors;
      var stepNumber: f32 = floor(y / stepSize);
      y = stepSize * (stepNumber + 0.5); // offset by 0.5 to use color from middle of segment
  }

  // find color stops
  var stopFrom: ColorStop;
  var stopTo: ColorStop;

  for (var i: i32 = 0; i < MAX_STOPS; i = i + 1) {
      if (y >= stopsUniforms.uStops[i][0]) {
          stopFrom = ColorStop(stopsUniforms.uStops[i][0], stopsUniforms.uColors[i], stopsUniforms.uStops[i][1]);
          stopTo = ColorStop(stopsUniforms.uStops[i + 1][0], stopsUniforms.uColors[i + 1], stopsUniforms.uStops[i + 1][1]);
      }

      if (i == numStops - 1) { // last index
          break;
      }
  }

  // mix colors from stops
  var colorFrom: vec4<f32> = vec4<f32>(stopFrom.color * stopFrom.alpha, stopFrom.alpha);
  var colorTo: vec4<f32> = vec4<f32>(stopTo.color * stopTo.alpha, stopTo.alpha);

  var segmentHeight: f32 = stopTo.offset - stopFrom.offset;
  var relativePos: f32 = y - stopFrom.offset; // position from 0 to [segmentHeight]
  var relativePercent: f32 = relativePos / segmentHeight; // position in percent between [from.offset] and [to.offset].

  var gradientAlpha: f32 = uAlpha * currentColor.a;
  var gradientColor: vec4<f32> = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

  if (uReplace < 0.5) {
      // mix resulting color with current color
      return gradientColor + currentColor * (1.0 - gradientColor.a);
  } else {
      // replace with gradient color
      return gradientColor;
  }
}

const PI: f32 = 3.14159265358979323846264;
const PI_2: f32 = PI * 2.0;

const TYPE_LINEAR: i32 = 0;
const TYPE_RADIAL: i32 = 1;
const TYPE_CONIC: i32 = 2;
const MAX_STOPS: i32 = 32;`,Vn=Vn||{};Vn.stringify=function(){var n={"visit_linear-gradient":function(e){return n.visit_gradient(e)},"visit_repeating-linear-gradient":function(e){return n.visit_gradient(e)},"visit_radial-gradient":function(e){return n.visit_gradient(e)},"visit_repeating-radial-gradient":function(e){return n.visit_gradient(e)},visit_gradient:function(e){var t=n.visit(e.orientation);return t&&(t+=", "),e.type+"("+t+n.visit(e.colorStops)+")"},visit_shape:function(e){var t=e.value,r=n.visit(e.at),i=n.visit(e.style);return i&&(t+=" "+i),r&&(t+=" at "+r),t},"visit_default-radial":function(e){var t="",r=n.visit(e.at);return r&&(t+=r),t},"visit_extent-keyword":function(e){var t=e.value,r=n.visit(e.at);return r&&(t+=" at "+r),t},"visit_position-keyword":function(e){return e.value},visit_position:function(e){return n.visit(e.value.x)+" "+n.visit(e.value.y)},"visit_%":function(e){return e.value+"%"},visit_em:function(e){return e.value+"em"},visit_px:function(e){return e.value+"px"},visit_literal:function(e){return n.visit_color(e.value,e)},visit_hex:function(e){return n.visit_color("#"+e.value,e)},visit_rgb:function(e){return n.visit_color("rgb("+e.value.join(", ")+")",e)},visit_rgba:function(e){return n.visit_color("rgba("+e.value.join(", ")+")",e)},visit_color:function(e,t){var r=e,i=n.visit(t.length);return i&&(r+=" "+i),r},visit_angular:function(e){return e.value+"deg"},visit_directional:function(e){return"to "+e.value},visit_array:function(e){var t="",r=e.length;return e.forEach(function(i,s){t+=n.visit(i),s<r-1&&(t+=", ")}),t},visit:function(e){if(!e)return"";var t="";if(e instanceof Array)return n.visit_array(e,t);if(e.type){var r=n["visit_"+e.type];if(r)return r(e);throw Error("Missing visitor visit_"+e.type)}else throw Error("Invalid node.")}};return function(e){return n.visit(e)}}();var Vn=Vn||{};Vn.parse=function(){var n={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t(W){var le=new Error(e+": "+W);throw le.source=e,le}function r(){var W=i();return e.length>0&&t("Invalid input not EOF"),W}function i(){return S(s)}function s(){return o("linear-gradient",n.linearGradient,l)||o("repeating-linear-gradient",n.repeatingLinearGradient,l)||o("radial-gradient",n.radialGradient,h)||o("repeating-radial-gradient",n.repeatingRadialGradient,h)}function o(W,le,Z){return a(le,function(D){var oe=Z();return oe&&(C(n.comma)||t("Missing comma before color stops")),{type:W,orientation:oe,colorStops:S(y)}})}function a(W,le){var Z=C(W);if(Z){C(n.startCall)||t("Missing (");var D=le(Z);return C(n.endCall)||t("Missing )"),D}}function l(){return u()||c()}function u(){return j("directional",n.sideOrCorner,1)}function c(){return j("angular",n.angleValue,1)}function h(){var W,le=d(),Z;return le&&(W=[],W.push(le),Z=e,C(n.comma)&&(le=d(),le?W.push(le):e=Z)),W}function d(){var W=f()||p();if(W)W.at=m();else{var le=g();if(le){W=le;var Z=m();Z&&(W.at=Z)}else{var D=v();D&&(W={type:"default-radial",at:D})}}return W}function f(){var W=j("shape",/^(circle)/i,0);return W&&(W.style=Y()||g()),W}function p(){var W=j("shape",/^(ellipse)/i,0);return W&&(W.style=I()||g()),W}function g(){return j("extent-keyword",n.extentKeywords,1)}function m(){if(j("position",/^at/,0)){var W=v();return W||t("Missing positioning value"),W}}function v(){var W=x();if(W.x||W.y)return{type:"position",value:W}}function x(){return{x:I(),y:I()}}function S(W){var le=W(),Z=[];if(le)for(Z.push(le);C(n.comma);)le=W(),le?Z.push(le):t("One extra comma");return Z}function y(){var W=b();return W||t("Expected color definition"),W.length=I(),W}function b(){return A()||E()||U()||B()}function B(){return j("literal",n.literalColor,0)}function A(){return j("hex",n.hexColor,1)}function U(){return a(n.rgbColor,function(){return{type:"rgb",value:S(_)}})}function E(){return a(n.rgbaColor,function(){return{type:"rgba",value:S(_)}})}function _(){return C(n.number)[1]}function I(){return j("%",n.percentageValue,1)||re()||Y()}function re(){return j("position-keyword",n.positionKeywords,1)}function Y(){return j("px",n.pixelValue,1)||j("em",n.emValue,1)}function j(W,le,Z){var D=C(le);if(D)return{type:W,value:D[Z]}}function C(W){var le,Z;return Z=/^[\n\r\t\s]+/.exec(e),Z&&N(Z[0].length),le=W.exec(e),le&&N(le[0].length),le}function N(W){e=e.substr(W)}return function(W){return e=W.toString(),r()}}();var yS=Vn.parse;Vn.stringify;function SS(n){const e=yS(kS(n));if(e.length===0)throw new Error("Invalid CSS gradient.");if(e.length!==1)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");const t=e[0],r=wS(t.type),i=TS(t.colorStops),s=ES(t.orientation);return{type:r,stops:i,angle:s}}function wS(n){const e={"linear-gradient":0,"radial-gradient":1};if(!(n in e))throw new Error(`Unsupported gradient type "${n}"`);return e[n]}function TS(n){const e=PS(n),t=[],r=new me;for(let i=0;i<n.length;i++){const s=CS(n[i]),o=r.setValue(s).toArray();t.push({offset:e[i],color:o.slice(0,3),alpha:o[3]})}return t}function CS(n){switch(n.type){case"hex":return`#${n.value}`;case"literal":return n.value;default:return`${n.type}(${n.value.join(",")})`}}function PS(n){const e=[];for(let s=0;s<n.length;s++){const o=n[s];let a=-1;o.type==="literal"&&o.length&&"type"in o.length&&o.length.type==="%"&&"value"in o.length&&(a=parseFloat(o.length.value)/100),e.push(a)}const r=s=>{for(let o=s;o<e.length;o++)if(e[o]!==-1)return{indexDelta:o-s,offset:e[o]};return{indexDelta:e.length-1-s,offset:1}};let i=0;for(let s=0;s<e.length;s++){const o=e[s];if(o!==-1)i=o;else if(s===0)e[s]=0;else if(s+1===e.length)e[s]=1;else{const a=r(s),u=(a.offset-i)/(1+a.indexDelta);for(let c=0;c<=a.indexDelta;c++)e[s+c]=i+(c+1)*u;s+=a.indexDelta,i=e[s]}}return e.map(AS)}function AS(n){return n.toString().length>6?parseFloat(n.toString().substring(0,6)):n}function ES(n){if(typeof n>"u")return 0;if("type"in n&&"value"in n)switch(n.type){case"angular":return parseFloat(n.value);case"directional":return MS(n.value)}return 0}function MS(n){const e={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(n in e))throw new Error(`Unsupported directional value "${n}"`);return e[n]}function kS(n){let e=n.replace(/\s{2,}/gu," ");return e=e.replace(/;/g,""),e=e.replace(/ ,/g,","),e=e.replace(/\( /g,"("),e=e.replace(/ \)/g,")"),e.trim()}var RS=Object.defineProperty,BS=(n,e,t)=>e in n?RS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Dn=(n,e,t)=>(BS(n,typeof e!="symbol"?e+"":e,t),t);const Lo=90;function IS(n){return[...n].sort((e,t)=>e.offset-t.offset)}const yr=class ns extends xe{constructor(e){if(e&&"css"in e?e={...SS(e.css||""),alpha:e.alpha??ns.defaults.alpha,maxColors:e.maxColors??ns.defaults.maxColors}:e={...ns.defaults,...e},!e.stops||e.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");const t=ge.from({vertex:{source:vc,entryPoint:"mainVertex"},fragment:{source:vc,entryPoint:"mainFragment"}}),r=_e.from({vertex:xS,fragment:bS,name:"color-gradient-filter"}),i=32;super({gpuProgram:t,glProgram:r,resources:{baseUniforms:{uOptions:{value:[e.type,e.angle??Lo,e.alpha,e.replace?1:0],type:"vec4<f32>"},uCounts:{value:[e.stops.length,e.maxColors],type:"vec2<f32>"}},stopsUniforms:{uColors:{value:new Float32Array(i*3),type:"vec3<f32>",size:i},uStops:{value:new Float32Array(i*4),type:"vec4<f32>",size:i}}}}),Dn(this,"baseUniforms"),Dn(this,"stopsUniforms"),Dn(this,"_stops",[]),this.baseUniforms=this.resources.baseUniforms.uniforms,this.stopsUniforms=this.resources.stopsUniforms.uniforms,Object.assign(this,e)}get stops(){return this._stops}set stops(e){const t=IS(e),r=new me;let i,s,o;for(let a=0;a<t.length;a++){r.setValue(t[a].color);const l=a*3;[i,s,o]=r.toArray(),this.stopsUniforms.uColors[l]=i,this.stopsUniforms.uColors[l+1]=s,this.stopsUniforms.uColors[l+2]=o,this.stopsUniforms.uStops[a*4]=t[a].offset,this.stopsUniforms.uStops[a*4+1]=t[a].alpha}this.baseUniforms.uCounts[0]=t.length,this._stops=t}get type(){return this.baseUniforms.uOptions[0]}set type(e){this.baseUniforms.uOptions[0]=e}get angle(){return this.baseUniforms.uOptions[1]+Lo}set angle(e){this.baseUniforms.uOptions[1]=e-Lo}get alpha(){return this.baseUniforms.uOptions[2]}set alpha(e){this.baseUniforms.uOptions[2]=e}get maxColors(){return this.baseUniforms.uCounts[1]}set maxColors(e){this.baseUniforms.uCounts[1]=e}get replace(){return this.baseUniforms.uOptions[3]>.5}set replace(e){this.baseUniforms.uOptions[3]=e?1:0}};Dn(yr,"LINEAR",0);Dn(yr,"RADIAL",1);Dn(yr,"CONIC",2);Dn(yr,"defaults",{type:yr.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0,replace:!1});let bc=yr;var FS=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uMapTexture;
uniform float uMix;
uniform float uSize;
uniform float uSliceSize;
uniform float uSlicePixelSize;
uniform float uSliceInnerSize;

void main() {
    vec4 color = texture(uTexture, vTextureCoord.xy);
    vec4 adjusted;

    if (color.a > 0.0) {
        color.rgb /= color.a;
        float innerWidth = uSize - 1.0;
        float zSlice0 = min(floor(color.b * innerWidth), innerWidth);
        float zSlice1 = min(zSlice0 + 1.0, innerWidth);
        float xOffset = uSlicePixelSize * 0.5 + color.r * uSliceInnerSize;
        float s0 = xOffset + (zSlice0 * uSliceSize);
        float s1 = xOffset + (zSlice1 * uSliceSize);
        float yOffset = uSliceSize * 0.5 + color.g * (1.0 - uSliceSize);
        vec4 slice0Color = texture(uMapTexture, vec2(s0,yOffset));
        vec4 slice1Color = texture(uMapTexture, vec2(s1,yOffset));
        float zOffset = fract(color.b * innerWidth);
        adjusted = mix(slice0Color, slice1Color, zOffset);

        color.rgb *= color.a;
    }

    finalColor = vec4(mix(color, adjusted, uMix).rgb, color.a);

}`,OS=`struct ColorMapUniforms {
  uMix: f32,
  uSize: f32,
  uSliceSize: f32,
  uSlicePixelSize: f32,
  uSliceInnerSize: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> colorMapUniforms : ColorMapUniforms;
@group(1) @binding(1) var uMapTexture: texture_2d<f32>;
@group(1) @binding(2) var uMapSampler: sampler;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color:vec4<f32> = textureSample(uTexture, uSampler, uv);

  var adjusted: vec4<f32>;

  var altColor: vec4<f32> = vec4<f32>(color.rgb / color.a, color.a);
  let innerWidth: f32 = colorMapUniforms.uSize - 1.0;
  let zSlice0: f32 = min(floor(color.b * innerWidth), innerWidth);
  let zSlice1: f32 = min(zSlice0 + 1.0, innerWidth);
  let xOffset: f32 = colorMapUniforms.uSlicePixelSize * 0.5 + color.r * colorMapUniforms.uSliceInnerSize;
  let s0: f32 = xOffset + (zSlice0 * colorMapUniforms.uSliceSize);
  let s1: f32 = xOffset + (zSlice1 * colorMapUniforms.uSliceSize);
  let yOffset: f32 = colorMapUniforms.uSliceSize * 0.5 + color.g * (1.0 - colorMapUniforms.uSliceSize);
  let slice0Color: vec4<f32> = textureSample(uMapTexture, uMapSampler, vec2(s0,yOffset));
  let slice1Color: vec4<f32> = textureSample(uMapTexture, uMapSampler, vec2(s1,yOffset));
  let zOffset: f32 = fract(color.b * innerWidth);
  adjusted = mix(slice0Color, slice1Color, zOffset);
  altColor = vec4<f32>(color.rgb * color.a, color.a);

  let realColor: vec4<f32> = select(color, altColor, color.a > 0.0);

  return vec4<f32>(mix(realColor, adjusted, colorMapUniforms.uMix).rgb, realColor.a);
}`,US=Object.defineProperty,GS=(n,e,t)=>e in n?US(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ln=(n,e,t)=>(GS(n,typeof e!="symbol"?e+"":e,t),t);const DS=class Zp extends xe{constructor(...e){let t=e[0]??{};if((t instanceof se||t instanceof Je)&&(ie("6.0.0","ColorMapFilter constructor params are now options object. See params: { colorMap, nearest, mix }"),t={colorMap:t},e[1]!==void 0&&(t.nearest=e[1]),e[2]!==void 0&&(t.mix=e[2])),t={...Zp.DEFAULT_OPTIONS,...t},!t.colorMap)throw Error("No color map texture source was provided to ColorMapFilter");const r=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:OS,entryPoint:"mainFragment"}}),i=_e.from({vertex:Pe,fragment:FS,name:"color-map-filter"});super({gpuProgram:r,glProgram:i,resources:{colorMapUniforms:{uMix:{value:t.mix,type:"f32"},uSize:{value:0,type:"f32"},uSliceSize:{value:0,type:"f32"},uSlicePixelSize:{value:0,type:"f32"},uSliceInnerSize:{value:0,type:"f32"}},uMapTexture:t.colorMap.source,uMapSampler:t.colorMap.source.style}}),ln(this,"uniforms"),ln(this,"_size",0),ln(this,"_sliceSize",0),ln(this,"_slicePixelSize",0),ln(this,"_sliceInnerSize",0),ln(this,"_nearest",!1),ln(this,"_scaleMode","linear"),ln(this,"_colorMap"),this.uniforms=this.resources.colorMapUniforms.uniforms,Object.assign(this,t)}get mix(){return this.uniforms.uMix}set mix(e){this.uniforms.uMix=e}get colorSize(){return this._size}get colorMap(){return this._colorMap}set colorMap(e){if(!e||e===this.colorMap)return;const t=e instanceof se?e.source:e;t.style.scaleMode=this._scaleMode,t.autoGenerateMipmaps=!1,this._size=t.height,this._sliceSize=1/this._size,this._slicePixelSize=this._sliceSize/this._size,this._sliceInnerSize=this._slicePixelSize*(this._size-1),this.uniforms.uSize=this._size,this.uniforms.uSliceSize=this._sliceSize,this.uniforms.uSlicePixelSize=this._slicePixelSize,this.uniforms.uSliceInnerSize=this._sliceInnerSize,this.resources.uMapTexture=t,this._colorMap=e}get nearest(){return this._nearest}set nearest(e){this._nearest=e,this._scaleMode=e?"nearest":"linear";const t=this._colorMap;t&&t.source&&(t.source.scaleMode=this._scaleMode,t.source.autoGenerateMipmaps=!1,t.source.style.update(),t.source.update())}updateColorMap(){const e=this._colorMap;e?.source&&(e.source.update(),this.colorMap=e)}destroy(){this._colorMap?.destroy(),super.destroy()}};ln(DS,"DEFAULT_OPTIONS",{colorMap:se.WHITE,nearest:!1,mix:1});var zS=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uColor;
uniform float uAlpha;

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);
    finalColor = vec4(mix(c.rgb, uColor.rgb, c.a * uAlpha), c.a);
}
`,LS=`struct ColorOverlayUniforms {
    uColor: vec3<f32>,
    uAlpha: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> colorOverlayUniforms : ColorOverlayUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    let c = textureSample(uTexture, uSampler, uv);
    return vec4<f32>(mix(c.rgb, colorOverlayUniforms.uColor.rgb, c.a * colorOverlayUniforms.uAlpha), c.a);
}
`,NS=Object.defineProperty,HS=(n,e,t)=>e in n?NS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ya=(n,e,t)=>(HS(n,typeof e!="symbol"?e+"":e,t),t);const VS=class Qp extends xe{constructor(...e){let t=e[0]??{};(typeof t=="number"||Array.isArray(t)||t instanceof Float32Array)&&(ie("6.0.0","ColorOverlayFilter constructor params are now options object. See params: { color, alpha }"),t={color:t},e[1]!==void 0&&(t.alpha=e[1])),t={...Qp.DEFAULT_OPTIONS,...t};const r=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:LS,entryPoint:"mainFragment"}}),i=_e.from({vertex:Pe,fragment:zS,name:"color-overlay-filter"});super({gpuProgram:r,glProgram:i,resources:{colorOverlayUniforms:{uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:t.alpha,type:"f32"}}}}),ya(this,"uniforms"),ya(this,"_color"),this.uniforms=this.resources.colorOverlayUniforms.uniforms,this._color=new me,this.color=t.color??0}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,r,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}};ya(VS,"DEFAULT_OPTIONS",{color:0,alpha:1});var WS=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uOriginalColor;
uniform vec3 uTargetColor;
uniform float uTolerance;

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);
    vec3 colorDiff = uOriginalColor - (c.rgb / max(c.a, 0.0000000001));
    float colorDistance = length(colorDiff);
    float doReplace = step(colorDistance, uTolerance);
    finalColor = vec4(mix(c.rgb, (uTargetColor + colorDiff) * c.a, doReplace), c.a);
}
`,jS=`struct ColorReplaceUniforms {
  uOriginalColor: vec3<f32>,
  uTargetColor: vec3<f32>,
  uTolerance: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> colorReplaceUniforms : ColorReplaceUniforms;

@fragment
fn mainFragment(
   @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let sample: vec4<f32> = textureSample(uTexture, uSampler, uv);

  let colorDiff: vec3<f32> = colorReplaceUniforms.uOriginalColor - (sample.rgb / max(sample.a, 0.0000000001));
  let colorDistance: f32 = length(colorDiff);
  let doReplace: f32 = step(colorDistance, colorReplaceUniforms.uTolerance);

  return vec4<f32>(mix(sample.rgb, (colorReplaceUniforms.uTargetColor + colorDiff) * sample.a, doReplace), sample.a);
}`,XS=Object.defineProperty,qS=(n,e,t)=>e in n?XS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,rs=(n,e,t)=>(qS(n,typeof e!="symbol"?e+"":e,t),t);const YS=class Jp extends xe{constructor(...e){let t=e[0]??{};(typeof t=="number"||Array.isArray(t)||t instanceof Float32Array)&&(ie("6.0.0","ColorReplaceFilter constructor params are now options object. See params: { originalColor, targetColor, tolerance }"),t={originalColor:t},e[1]!==void 0&&(t.targetColor=e[1]),e[2]!==void 0&&(t.tolerance=e[2])),t={...Jp.DEFAULT_OPTIONS,...t};const r=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:jS,entryPoint:"mainFragment"}}),i=_e.from({vertex:Pe,fragment:WS,name:"color-replace-filter"});super({gpuProgram:r,glProgram:i,resources:{colorReplaceUniforms:{uOriginalColor:{value:new Float32Array(3),type:"vec3<f32>"},uTargetColor:{value:new Float32Array(3),type:"vec3<f32>"},uTolerance:{value:t.tolerance,type:"f32"}}}}),rs(this,"uniforms"),rs(this,"_originalColor"),rs(this,"_targetColor"),this.uniforms=this.resources.colorReplaceUniforms.uniforms,this._originalColor=new me,this._targetColor=new me,this.originalColor=t.originalColor??16711680,this.targetColor=t.targetColor??0,Object.assign(this,t)}get originalColor(){return this._originalColor.value}set originalColor(e){this._originalColor.setValue(e);const[t,r,i]=this._originalColor.toArray();this.uniforms.uOriginalColor[0]=t,this.uniforms.uOriginalColor[1]=r,this.uniforms.uOriginalColor[2]=i}get targetColor(){return this._targetColor.value}set targetColor(e){this._targetColor.setValue(e);const[t,r,i]=this._targetColor.toArray();this.uniforms.uTargetColor[0]=t,this.uniforms.uTargetColor[1]=r,this.uniforms.uTargetColor[2]=i}get tolerance(){return this.uniforms.uTolerance}set tolerance(e){this.uniforms.uTolerance=e}set newColor(e){ie("6.0.0","ColorReplaceFilter.newColor is deprecated, please use ColorReplaceFilter.targetColor instead"),this.targetColor=e}get newColor(){return ie("6.0.0","ColorReplaceFilter.newColor is deprecated, please use ColorReplaceFilter.targetColor instead"),this.targetColor}set epsilon(e){ie("6.0.0","ColorReplaceFilter.epsilon is deprecated, please use ColorReplaceFilter.tolerance instead"),this.tolerance=e}get epsilon(){return ie("6.0.0","ColorReplaceFilter.epsilon is deprecated, please use ColorReplaceFilter.tolerance instead"),this.tolerance}};rs(YS,"DEFAULT_OPTIONS",{originalColor:16711680,targetColor:0,tolerance:.4});var KS=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uTexelSize;
uniform mat3 uMatrix;

void main(void)
{
    vec4 c11 = texture(uTexture, vTextureCoord - uTexelSize); // top left
    vec4 c12 = texture(uTexture, vec2(vTextureCoord.x, vTextureCoord.y - uTexelSize.y)); // top center
    vec4 c13 = texture(uTexture, vec2(vTextureCoord.x + uTexelSize.x, vTextureCoord.y - uTexelSize.y)); // top right

    vec4 c21 = texture(uTexture, vec2(vTextureCoord.x - uTexelSize.x, vTextureCoord.y)); // mid left
    vec4 c22 = texture(uTexture, vTextureCoord); // mid center
    vec4 c23 = texture(uTexture, vec2(vTextureCoord.x + uTexelSize.x, vTextureCoord.y)); // mid right

    vec4 c31 = texture(uTexture, vec2(vTextureCoord.x - uTexelSize.x, vTextureCoord.y + uTexelSize.y)); // bottom left
    vec4 c32 = texture(uTexture, vec2(vTextureCoord.x, vTextureCoord.y + uTexelSize.y)); // bottom center
    vec4 c33 = texture(uTexture, vTextureCoord + uTexelSize); // bottom right

    finalColor =
        c11 * uMatrix[0][0] + c12 * uMatrix[0][1] + c13 * uMatrix[0][2] +
        c21 * uMatrix[1][0] + c22 * uMatrix[1][1] + c23 * uMatrix[1][2] +
        c31 * uMatrix[2][0] + c32 * uMatrix[2][1] + c33 * uMatrix[2][2];

    finalColor.a = c22.a;
}`,ZS=`struct ConvolutionUniforms {
    uMatrix: mat3x3<f32>,
    uTexelSize: vec2<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> convolutionUniforms : ConvolutionUniforms;

@fragment
fn mainFragment(
    @location(0) uv: vec2<f32>,
    @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
    let texelSize = convolutionUniforms.uTexelSize;
    let matrix = convolutionUniforms.uMatrix;

    let c11: vec4<f32> = textureSample(uTexture, uSampler, uv - texelSize); // top left
    let c12: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x, uv.y - texelSize.y)); // top center
    let c13: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x + texelSize.x, uv.y - texelSize.y)); // top right

    let c21: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x - texelSize.x, uv.y)); // mid left
    let c22: vec4<f32> = textureSample(uTexture, uSampler, uv); // mid center
    let c23: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x + texelSize.x, uv.y)); // mid right

    let c31: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x - texelSize.x, uv.y + texelSize.y)); // bottom left
    let c32: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x, uv.y + texelSize.y)); // bottom center
    let c33: vec4<f32> = textureSample(uTexture, uSampler, uv + texelSize); // bottom right

    var finalColor: vec4<f32> = vec4<f32>(
        c11 * matrix[0][0] + c12 * matrix[0][1] + c13 * matrix[0][2] +
        c21 * matrix[1][0] + c22 * matrix[1][1] + c23 * matrix[1][2] +
        c31 * matrix[2][0] + c32 * matrix[2][1] + c33 * matrix[2][2]
    );

    finalColor.a = c22.a;

    return finalColor;
}`,QS=Object.defineProperty,JS=(n,e,t)=>e in n?QS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$p=(n,e,t)=>(JS(n,typeof e!="symbol"?e+"":e,t),t);const $S=class em extends xe{constructor(...e){let t=e[0]??{};Array.isArray(t)&&(ie("6.0.0","ConvolutionFilter constructor params are now options object. See params: { matrix, width, height }"),t={matrix:t},e[1]!==void 0&&(t.width=e[1]),e[2]!==void 0&&(t.height=e[2])),t={...em.DEFAULT_OPTIONS,...t};const r=t.width??200,i=t.height??200,s=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:ZS,entryPoint:"mainFragment"}}),o=_e.from({vertex:Pe,fragment:KS,name:"convolution-filter"});super({gpuProgram:s,glProgram:o,resources:{convolutionUniforms:{uMatrix:{value:t.matrix,type:"mat3x3<f32>"},uTexelSize:{value:{x:1/r,y:1/i},type:"vec2<f32>"}}}}),$p(this,"uniforms"),this.uniforms=this.resources.convolutionUniforms.uniforms,this.width=r,this.height=i}get matrix(){return this.uniforms.uMatrix}set matrix(e){e.forEach((t,r)=>{this.uniforms.uMatrix[r]=t})}get width(){return 1/this.uniforms.uTexelSize.x}set width(e){this.uniforms.uTexelSize.x=1/e}get height(){return 1/this.uniforms.uTexelSize.y}set height(e){this.uniforms.uTexelSize.y=1/e}};$p($S,"DEFAULT_OPTIONS",{matrix:new Float32Array(9),width:200,height:200});var e3=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec4 uLine;
uniform vec2 uNoise;
uniform vec3 uVignette;
uniform float uSeed;
uniform float uTime;
uniform vec2 uDimensions;

uniform vec4 uInputSize;

const float SQRT_2 = 1.414213;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

float vignette(vec3 co, vec2 coord)
{
    float outter = SQRT_2 - uVignette[0] * SQRT_2;
    vec2 dir = vec2(0.5) - coord;
    dir.y *= uDimensions.y / uDimensions.x;
    float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);
    return darker + (1.0 - darker) * (1.0 - uVignette[1]);
}

float noise(vec2 coord)
{
    vec2 pixelCoord = coord * uInputSize.xy;
    pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
    pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
    return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}

vec3 interlaceLines(vec3 co, vec2 coord)
{
    vec3 color = co;

    float curvature = uLine[0];
    float lineWidth = uLine[1];
    float lineContrast = uLine[2];
    float verticalLine = uLine[3];

    vec2 dir = vec2(coord * uInputSize.xy / uDimensions - 0.5);

    float _c = curvature > 0. ? curvature : 1.;
    float k = curvature > 0. ? (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
    vec2 uv = dir * k;
    float v = verticalLine > 0.5 ? uv.x * uDimensions.x : uv.y * uDimensions.y;
    v *= min(1.0, 2.0 / lineWidth ) / _c;
    float j = 1. + cos(v * 1.2 - uTime) * 0.5 * lineContrast;
    color *= j;

    float segment = verticalLine > 0.5 ? mod((dir.x + .5) * uDimensions.x, 4.) : mod((dir.y + .5) * uDimensions.y, 4.);
    color *= 0.99 + ceil(segment) * 0.015;

    return color;
}

void main(void)
{
    finalColor = texture(uTexture, vTextureCoord);
    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions;

    if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
    {
        float n = noise(vTextureCoord);
        finalColor += vec4(n, n, n, finalColor.a);
    }

    if (uVignette[0] > 0.)
    {
        float v = vignette(finalColor.rgb, coord);
        finalColor *= vec4(v, v, v, finalColor.a);
    }

    if (uLine[1] > 0.0)
    {
        finalColor = vec4(interlaceLines(finalColor.rgb, vTextureCoord), finalColor.a);  
    }
}
`,t3=`struct CRTUniforms {
    uLine: vec4<f32>,
    uNoise: vec2<f32>,
    uVignette: vec3<f32>,
    uSeed: f32,
    uTime: f32,
    uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> crtUniforms : CRTUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let coord: vec2<f32> = uv * gfu.uInputSize.xy / crtUniforms.uDimensions;

  let uNoise = crtUniforms.uNoise;

  if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
  {
    color += vec4<f32>(vec3<f32>(noise(uv)), color.a);
  }

  if (crtUniforms.uVignette[0] > 0.)
  {
    color *= vec4<f32>(vec3<f32>(vignette(color.rgb, coord)), color.a);
  }

  if (crtUniforms.uLine[1] > 0.0)
  {
    color = vec4<f32>(vec3<f32>(interlaceLines(color.rgb, uv)), color.a);  
  }

  return color;
}

const SQRT_2: f32 = 1.414213;

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

fn rand(co: vec2<f32>) -> f32
{
  return fract(sin(dot(co, vec2<f32>(12.9898, 78.233))) * 43758.5453);
}

fn vignette(co: vec3<f32>, coord: vec2<f32>) -> f32
{
  let uVignette = crtUniforms.uVignette;
  let uDimensions = crtUniforms.uDimensions;
  
  let outter: f32 = SQRT_2 - uVignette[0] * SQRT_2;
  var dir: vec2<f32> = vec2<f32>(0.5) - coord;
  dir.y *= uDimensions.y / uDimensions.x;
  let darker: f32 = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);
  return darker + (1.0 - darker) * (1.0 - uVignette[1]);
}

fn noise(coord: vec2<f32>) -> f32
{
  let uNoise = crtUniforms.uNoise;
  let uSeed = crtUniforms.uSeed;

  var pixelCoord: vec2<f32> = coord * gfu.uInputSize.xy;
  pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
  pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
  return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}

fn interlaceLines(co: vec3<f32>, coord: vec2<f32>) -> vec3<f32>
{
  var color = co;

  let uDimensions = crtUniforms.uDimensions;

  let curvature: f32 = crtUniforms.uLine[0];
  let lineWidth: f32 = crtUniforms.uLine[1];
  let lineContrast: f32 = crtUniforms.uLine[2];
  let verticalLine: f32 = crtUniforms.uLine[3];

  let dir: vec2<f32> = vec2<f32>(coord * gfu.uInputSize.xy / uDimensions - 0.5);

  let _c: f32 = select(1., curvature, curvature > 0.);
  let k: f32 = select(1., (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c), curvature > 0.);
  let uv: vec2<f32> = dir * k;
  let v: f32 = select(uv.y * uDimensions.y, uv.x * uDimensions.x, verticalLine > 0.5) * min(1.0, 2.0 / lineWidth ) / _c;
  let j: f32 = 1. + cos(v * 1.2 - crtUniforms.uTime) * 0.5 * lineContrast;
  color *= j;

  let segment: f32 = select(modulo((dir.y + .5) * uDimensions.y, 4.), modulo((dir.x + .5) * uDimensions.x, 4.), verticalLine > 0.5);
  color *= 0.99 + ceil(segment) * 0.015;

  return color;
}`,n3=Object.defineProperty,r3=(n,e,t)=>e in n?n3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,is=(n,e,t)=>(r3(n,typeof e!="symbol"?e+"":e,t),t);const i3=class tm extends xe{constructor(e){e={...tm.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:t3,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:e3,name:"crt-filter"});super({gpuProgram:t,glProgram:r,resources:{crtUniforms:{uLine:{value:new Float32Array(4),type:"vec4<f32>"},uNoise:{value:new Float32Array(2),type:"vec2<f32>"},uVignette:{value:new Float32Array(3),type:"vec3<f32>"},uSeed:{value:e.seed,type:"f32"},uTime:{value:e.time,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),is(this,"uniforms"),is(this,"seed"),is(this,"time"),this.uniforms=this.resources.crtUniforms.uniforms,Object.assign(this,e)}apply(e,t,r,i){this.uniforms.uDimensions[0]=t.frame.width,this.uniforms.uDimensions[1]=t.frame.height,this.uniforms.uSeed=this.seed,this.uniforms.uTime=this.time,e.applyFilter(this,t,r,i)}get curvature(){return this.uniforms.uLine[0]}set curvature(e){this.uniforms.uLine[0]=e}get lineWidth(){return this.uniforms.uLine[1]}set lineWidth(e){this.uniforms.uLine[1]=e}get lineContrast(){return this.uniforms.uLine[2]}set lineContrast(e){this.uniforms.uLine[2]=e}get verticalLine(){return this.uniforms.uLine[3]>.5}set verticalLine(e){this.uniforms.uLine[3]=e?1:0}get noise(){return this.uniforms.uNoise[0]}set noise(e){this.uniforms.uNoise[0]=e}get noiseSize(){return this.uniforms.uNoise[1]}set noiseSize(e){this.uniforms.uNoise[1]=e}get vignetting(){return this.uniforms.uVignette[0]}set vignetting(e){this.uniforms.uVignette[0]=e}get vignettingAlpha(){return this.uniforms.uVignette[1]}set vignettingAlpha(e){this.uniforms.uVignette[1]=e}get vignettingBlur(){return this.uniforms.uVignette[2]}set vignettingBlur(e){this.uniforms.uVignette[2]=e}};is(i3,"DEFAULT_OPTIONS",{curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0,seed:0});var s3=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uAngle;
uniform float uScale;
uniform bool uGrayScale;

uniform vec4 uInputSize;

float pattern()
{
    float s = sin(uAngle), c = cos(uAngle);
    vec2 tex = vTextureCoord * uInputSize.xy;
    vec2 point = vec2(
        c * tex.x - s * tex.y,
        s * tex.x + c * tex.y
    ) * uScale;
    return (sin(point.x) * sin(point.y)) * 4.0;
    }

    void main()
    {
    vec4 color = texture(uTexture, vTextureCoord);
    vec3 colorRGB = vec3(color);

    if (uGrayScale)
    {
        colorRGB = vec3(color.r + color.g + color.b) / 3.0;
    }

    finalColor = vec4(colorRGB * 10.0 - 5.0 + pattern(), color.a);
}
`,o3=`struct DotUniforms {
  uScale:f32,
  uAngle:f32,
  uGrayScale:f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> dotUniforms : DotUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
  let color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let gray: vec3<f32> = vec3<f32>(dot(color.rgb, vec3<f32>(0.299, 0.587, 0.114)));
  // dotUniforms.uGrayScale == 1 doesn't ever pass so it is converted to a float and compared to 0.5 instead 
  let finalColor: vec3<f32> = select(color.rgb, gray, f32(dotUniforms.uGrayScale) >= 0.5);

  return vec4<f32>(finalColor * 10.0 - 5.0 + pattern(uv), color.a);
}

fn pattern(uv: vec2<f32>) -> f32
{
  let s: f32 = sin(dotUniforms.uAngle);
  let c: f32 = cos(dotUniforms.uAngle);
  
  let tex: vec2<f32> = uv * gfu.uInputSize.xy;
  
  let p: vec2<f32> = vec2<f32>(
      c * tex.x - s * tex.y,
      s * tex.x + c * tex.y
  ) * dotUniforms.uScale;

  return (sin(p.x) * sin(p.y)) * 4.0;
}`,a3=Object.defineProperty,l3=(n,e,t)=>e in n?a3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,u3=(n,e,t)=>(l3(n,e+"",t),t);const c3=class nm extends xe{constructor(...e){let t=e[0]??{};typeof t=="number"&&(ie("6.0.0","DotFilter constructor params are now options object. See params: { scale, angle, grayscale }"),t={scale:t},e[1]!==void 0&&(t.angle=e[1]),e[2]!==void 0&&(t.grayscale=e[2])),t={...nm.DEFAULT_OPTIONS,...t};const r={uScale:{value:t.scale,type:"f32"},uAngle:{value:t.angle,type:"f32"},uGrayScale:{value:t.grayscale?1:0,type:"f32"}},i=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:o3,entryPoint:"mainFragment"}}),s=_e.from({vertex:Pe,fragment:s3,name:"dot-filter"});super({gpuProgram:i,glProgram:s,resources:{dotUniforms:r}})}get scale(){return this.resources.dotUniforms.uniforms.uScale}set scale(e){this.resources.dotUniforms.uniforms.uScale=e}get angle(){return this.resources.dotUniforms.uniforms.uAngle}set angle(e){this.resources.dotUniforms.uniforms.uAngle=e}get grayscale(){return this.resources.dotUniforms.uniforms.uGrayScale===1}set grayscale(e){this.resources.dotUniforms.uniforms.uGrayScale=e?1:0}};u3(c3,"DEFAULT_OPTIONS",{scale:1,angle:5,grayscale:!0});var h3=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uAlpha;
uniform vec3 uColor;
uniform vec2 uOffset;

uniform vec4 uInputSize;

void main(void){
    vec4 sample = texture(uTexture, vTextureCoord - uOffset * uInputSize.zw);

    // Premultiply alpha
    sample.rgb = uColor.rgb * sample.a;

    // alpha user alpha
    sample *= uAlpha;

    finalColor = sample;
}`,f3=`struct DropShadowUniforms {
  uAlpha: f32,
  uColor: vec3<f32>,
  uOffset: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> dropShadowUniforms : DropShadowUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv - dropShadowUniforms.uOffset * gfu.uInputSize.zw);

  // Premultiply alpha
  color = vec4<f32>(vec3<f32>(dropShadowUniforms.uColor.rgb * color.a), color.a);
  // alpha user alpha
  color *= dropShadowUniforms.uAlpha;

  return color;
}`,d3=Object.defineProperty,p3=(n,e,t)=>e in n?d3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,sr=(n,e,t)=>(p3(n,typeof e!="symbol"?e+"":e,t),t);const rm=class im extends xe{constructor(e){e={...im.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:f3,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:h3,name:"drop-shadow-filter"});super({gpuProgram:t,glProgram:r,resources:{dropShadowUniforms:{uAlpha:{value:e.alpha,type:"f32"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uOffset:{value:e.offset,type:"vec2<f32>"}}},resolution:e.resolution}),sr(this,"uniforms"),sr(this,"shadowOnly",!1),sr(this,"_color"),sr(this,"_blurFilter"),sr(this,"_basePass"),this.uniforms=this.resources.dropShadowUniforms.uniforms,this._color=new me,this.color=e.color??0,this._blurFilter=new Lp({strength:e.kernels??e.blur,quality:e.kernels?void 0:e.quality}),this._basePass=new xe({gpuProgram:ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:`
                    @group(0) @binding(1) var uTexture: texture_2d<f32>; 
                    @group(0) @binding(2) var uSampler: sampler;
                    @fragment
                    fn mainFragment(
                        @builtin(position) position: vec4<f32>,
                        @location(0) uv : vec2<f32>
                    ) -> @location(0) vec4<f32> {
                        return textureSample(uTexture, uSampler, uv);
                    }
                    `,entryPoint:"mainFragment"}}),glProgram:_e.from({vertex:Pe,fragment:`
                in vec2 vTextureCoord;
                out vec4 finalColor;
                uniform sampler2D uTexture;

                void main(void){
                    finalColor = texture(uTexture, vTextureCoord);
                }
                `,name:"drop-shadow-filter"}),resources:{}}),Object.assign(this,e)}apply(e,t,r,i){const s=Me.getSameSizeTexture(t);e.applyFilter(this,t,s,!0),this._blurFilter.apply(e,s,r,i),this.shadowOnly||e.applyFilter(this._basePass,t,r,!1),Me.returnTexture(s)}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e,this._updatePadding()}get offsetX(){return this.offset.x}set offsetX(e){this.offset.x=e,this._updatePadding()}get offsetY(){return this.offset.y}set offsetY(e){this.offset.y=e,this._updatePadding()}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,r,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get blur(){return this._blurFilter.strength}set blur(e){this._blurFilter.strength=e,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e,this._updatePadding()}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){typeof e=="number"&&(e={x:e,y:e}),Array.isArray(e)&&(e={x:e[0],y:e[1]}),this._blurFilter.pixelSize=e}get pixelSizeX(){return this._blurFilter.pixelSizeX}set pixelSizeX(e){this._blurFilter.pixelSizeX=e}get pixelSizeY(){return this._blurFilter.pixelSizeY}set pixelSizeY(e){this._blurFilter.pixelSizeY=e}_updatePadding(){const e=Math.max(Math.abs(this.offsetX),Math.abs(this.offsetY));this.padding=e+this.blur*2+this.quality*4}};sr(rm,"DEFAULT_OPTIONS",{offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:void 0,blur:2,quality:3,pixelSize:{x:1,y:1},resolution:1});let m3=rm;var g3=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uDisplacementMap;
uniform float uSeed;
uniform vec2 uDimensions;
uniform float uAspect;
uniform float uFillMode;
uniform float uOffset;
uniform float uDirection;
uniform vec2 uRed;
uniform vec2 uGreen;
uniform vec2 uBlue;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * uInputSize.xy) / uDimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float sinDir = sin(uDirection);
    float cosDir = cos(uDirection);

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * uAspect;
    float ny = (-sinDir * cx + cosDir * cy) / uAspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture(uDisplacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (uOffset / uInputSize.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * uAspect);

    int fillMode = int(uFillMode);

    if (fillMode == CLAMP) {
        coord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    } else {
        if( coord.x > uInputClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= uInputClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = uInputClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < uInputClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += uInputClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -uInputClamp.z;
            }
        }

        if( coord.y > uInputClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= uInputClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = uInputClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < uInputClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += uInputClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -uInputClamp.w;
            }
        }
    }

    finalColor.r = texture(uTexture, coord + uRed * (1.0 - uSeed * 0.4) / uInputSize.xy).r;
    finalColor.g = texture(uTexture, coord + uGreen * (1.0 - uSeed * 0.3) / uInputSize.xy).g;
    finalColor.b = texture(uTexture, coord + uBlue * (1.0 - uSeed * 0.2) / uInputSize.xy).b;
    finalColor.a = texture(uTexture, coord).a;
}
`,_3=`struct GlitchUniforms {
  uSeed: f32,
  uDimensions: vec2<f32>,
  uAspect: f32,
  uFillMode: f32,
  uOffset: f32,
  uDirection: f32,
  uRed: vec2<f32>,
  uGreen: vec2<f32>,
  uBlue: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> glitchUniforms : GlitchUniforms;
@group(1) @binding(1) var uDisplacementMap: texture_2d<f32>; 
@group(1) @binding(2) var uDisplacementSampler: sampler; 

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uSeed: f32 = glitchUniforms.uSeed;
  let uDimensions: vec2<f32> = glitchUniforms.uDimensions;
  let uAspect: f32 = glitchUniforms.uAspect;
  let uOffset: f32 = glitchUniforms.uOffset;
  let uDirection: f32 = glitchUniforms.uDirection;
  let uRed: vec2<f32> = glitchUniforms.uRed;
  let uGreen: vec2<f32> = glitchUniforms.uGreen;
  let uBlue: vec2<f32> = glitchUniforms.uBlue;

  let uInputSize: vec4<f32> = gfu.uInputSize;
  let uInputClamp: vec4<f32> = gfu.uInputClamp;

  var discarded: bool = false;
  var coord: vec2<f32> = (uv * uInputSize.xy) / uDimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
      discarded = true;
    }

    let sinDir: f32 = sin(uDirection);
    let cosDir: f32 = cos(uDirection);

    let cx: f32 = coord.x - 0.5;
    let cy: f32 = (coord.y - 0.5) * uAspect;
    var ny: f32 = (-sinDir * cx + cosDir * cy) / uAspect + 0.5;

    ny = select(select(ny, -ny, ny < 0.0), 2.0 - ny, ny > 1.0);

    let dc: vec4<f32> = textureSample(uDisplacementMap, uDisplacementSampler, vec2<f32>(0.5, ny));

    let displacement: f32 = (dc.r - dc.g) * (uOffset / uInputSize.x);

    coord = uv + vec2<f32>(cosDir * displacement, sinDir * displacement * uAspect);

    let fillMode: i32 = i32(glitchUniforms.uFillMode);

    if (fillMode == CLAMP) {
      coord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    } else {
      if (coord.x > uInputClamp.z) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.x = coord.x - uInputClamp.z;
        } else if (fillMode == MIRROR) {
          coord.x = uInputClamp.z * 2.0 - coord.x;
        }
      } else if (coord.x < uInputClamp.x) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.x = coord.x + uInputClamp.z;
        } else if (fillMode == MIRROR) {
          coord.x = coord.x * -uInputClamp.z;
        }
      }

      if (coord.y > uInputClamp.w) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.y = coord.y - uInputClamp.w;
        } else if (fillMode == MIRROR) {
          coord.y = uInputClamp.w * 2.0 - coord.y;
        }
      } else if (coord.y < uInputClamp.y) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.y = coord.y + uInputClamp.w;
        } else if (fillMode == MIRROR) {
          coord.y = coord.y * -uInputClamp.w;
        }
      }
    }

    let seedR: f32 = 1.0 - uSeed * 0.4;
    let seedG: f32 = 1.0 - uSeed * 0.3;
    let seedB: f32 = 1.0 - uSeed * 0.2;

    let offsetR: vec2<f32> = vec2(uRed.x * seedR / uInputSize.x, uRed.y * seedR / uInputSize.y);
    let offsetG: vec2<f32> = vec2(uGreen.x * seedG / uInputSize.x, uGreen.y * seedG / uInputSize.y);
    let offsetB: vec2<f32> = vec2(uBlue.x * seedB / uInputSize.x, uBlue.y * seedB / uInputSize.y);

    let r = textureSample(uTexture, uSampler, coord + offsetR).r;
    let g = textureSample(uTexture, uSampler, coord + offsetG).g;
    let b = textureSample(uTexture, uSampler, coord + offsetB).b;
    let a = textureSample(uTexture, uSampler, coord).a;

    return select(vec4<f32>(r, g, b, a), vec4<f32>(0.0,0.0,0.0,0.0), discarded);
}

const TRANSPARENT: i32 = 0;
const ORIGINAL: i32 = 1;
const LOOP: i32 = 2;
const CLAMP: i32 = 3;
const MIRROR: i32 = 4;`,v3=Object.defineProperty,b3=(n,e,t)=>e in n?v3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Kt=(n,e,t)=>(b3(n,typeof e!="symbol"?e+"":e,t),t);const x3=class sm extends xe{constructor(e){e={...sm.defaults,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:_3,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:g3,name:"glitch-filter"}),i=document.createElement("canvas");i.width=4,i.height=e.sampleSize??512;const s=new se({source:new Nn({resource:i})});super({gpuProgram:t,glProgram:r,resources:{glitchUniforms:{uSeed:{value:e?.seed??0,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"},uAspect:{value:1,type:"f32"},uFillMode:{value:e?.fillMode??0,type:"f32"},uOffset:{value:e?.offset??100,type:"f32"},uDirection:{value:e?.direction??0,type:"f32"},uRed:{value:e.red,type:"vec2<f32>"},uGreen:{value:e.green,type:"vec2<f32>"},uBlue:{value:e.blue,type:"vec2<f32>"}},uDisplacementMap:s.source,uDisplacementSampler:s.source.style}}),Kt(this,"uniforms"),Kt(this,"average",!1),Kt(this,"minSize",8),Kt(this,"sampleSize",512),Kt(this,"_canvas"),Kt(this,"texture"),Kt(this,"_slices",0),Kt(this,"_sizes",new Float32Array(1)),Kt(this,"_offsets",new Float32Array(1)),this.uniforms=this.resources.glitchUniforms.uniforms,this._canvas=i,this.texture=s,Object.assign(this,e)}apply(e,t,r,i){const{width:s,height:o}=t.frame;this.uniforms.uDimensions[0]=s,this.uniforms.uDimensions[1]=o,this.uniforms.uAspect=o/s,e.applyFilter(this,t,r,i)}_randomizeSizes(){const e=this._sizes,t=this._slices-1,r=this.sampleSize,i=Math.min(this.minSize/r,.9/this._slices);if(this.average){const s=this._slices;let o=1;for(let a=0;a<t;a++){const l=o/(s-a),u=Math.max(l*(1-Math.random()*.6),i);e[a]=u,o-=u}e[t]=o}else{let s=1;const o=Math.sqrt(1/this._slices);for(let a=0;a<t;a++){const l=Math.max(o*s*Math.random(),i);e[a]=l,s-=l}e[t]=s}this.shuffle()}shuffle(){const e=this._sizes,t=this._slices-1;for(let r=t;r>0;r--){const i=Math.random()*r>>0,s=e[r];e[r]=e[i],e[i]=s}}_randomizeOffsets(){for(let e=0;e<this._slices;e++)this._offsets[e]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const e=this.sampleSize,t=this.texture,r=this._canvas.getContext("2d");r.clearRect(0,0,8,e);let i,s=0;for(let o=0;o<this._slices;o++){i=Math.floor(this._offsets[o]*256);const a=this._sizes[o]*e,l=i>0?i:0,u=i<0?-i:0;r.fillStyle=`rgba(${l}, ${u}, 0, 1)`,r.fillRect(0,s>>0,e,a+1>>0),s+=a}t.source.update()}set sizes(e){const t=Math.min(this._slices,e.length);for(let r=0;r<t;r++)this._sizes[r]=e[r]}get sizes(){return this._sizes}set offsets(e){const t=Math.min(this._slices,e.length);for(let r=0;r<t;r++)this._offsets[r]=e[r]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(e){this._slices!==e&&(this._slices=e,this._sizes=new Float32Array(e),this._offsets=new Float32Array(e),this.refresh())}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}get fillMode(){return this.uniforms.uFillMode}set fillMode(e){this.uniforms.uFillMode=e}get direction(){return this.uniforms.uDirection/gr}set direction(e){this.uniforms.uDirection=e*gr}get red(){return this.uniforms.uRed}set red(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uRed=e}get green(){return this.uniforms.uGreen}set green(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uGreen=e}get blue(){return this.uniforms.uBlue}set blue(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uBlue=e}destroy(){this.texture?.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};Kt(x3,"defaults",{slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:{x:0,y:0},green:{x:0,y:0},blue:{x:0,y:0},minSize:8,sampleSize:512});var y3=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uStrength;
uniform vec3 uColor;
uniform float uKnockout;
uniform float uAlpha;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

const float PI = 3.14159265358979323846264;

// Hard-assignment of DIST and ANGLE_STEP_SIZE instead of using uDistance and uQuality to allow them to be use on GLSL loop conditions
const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.);
const float ANGLE_STEP_NUM = ceil(PI * 2. / ANGLE_STEP_SIZE);
const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.) / 2.;

void main(void) {
    vec2 px = vec2(1.) / uInputSize.xy;

    float totalAlpha = 0.;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.; angle < PI * 2.; angle += ANGLE_STEP_SIZE) {
      direction = vec2(cos(angle), sin(angle)) * px;

      for (float curDistance = 0.; curDistance < DIST; curDistance++) {
          displaced = clamp(vTextureCoord + direction * (curDistance + 1.), uInputClamp.xy, uInputClamp.zw);
          curColor = texture(uTexture, displaced);
          totalAlpha += (DIST - curDistance) * curColor.a;
      }
    }
    
    curColor = texture(uTexture, vTextureCoord);

    vec4 glowColor = vec4(uColor, uAlpha);
    bool knockout = uKnockout > .5;
    float innerStrength = uStrength[0];
    float outerStrength = uStrength[1];

    float alphaRatio = totalAlpha / MAX_TOTAL_ALPHA;
    float innerGlowAlpha = (1. - alphaRatio) * innerStrength * curColor.a * uAlpha;
    float innerGlowStrength = min(1., innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);
    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a) * uAlpha;
    float outerGlowStrength = min(1. - innerColor.a, outerGlowAlpha);
    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;

    if (knockout) {
      float resultAlpha = outerGlowAlpha + innerGlowAlpha;
      finalColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      finalColor = innerColor + outerGlowColor;
    }
}
`,S3=`struct GlowUniforms {
  uDistance: f32,
  uStrength: vec2<f32>,
  uColor: vec3<f32>,
  uAlpha: f32,
  uQuality: f32,
  uKnockout: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> glowUniforms : GlowUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let quality = glowUniforms.uQuality;
  let distance = glowUniforms.uDistance;

  let dist: f32 = glowUniforms.uDistance;
  let angleStepSize: f32 = min(1. / quality / distance, PI * 2.0);
  let angleStepNum: f32 = ceil(PI * 2.0 / angleStepSize);

  let px: vec2<f32> = vec2<f32>(1.0 / gfu.uInputSize.xy);

  var totalAlpha: f32 = 0.0;

  var direction: vec2<f32>;
  var displaced: vec2<f32>;
  var curColor: vec4<f32>;

  for (var angle = 0.0; angle < PI * 2.0; angle += angleStepSize) {
    direction = vec2<f32>(cos(angle), sin(angle)) * px;
    for (var curDistance = 0.0; curDistance < dist; curDistance+=1) {
      displaced = vec2<f32>(clamp(uv + direction * (curDistance + 1.0), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
      curColor = textureSample(uTexture, uSampler, displaced);
      totalAlpha += (dist - curDistance) * curColor.a;
    }
  }
    
  curColor = textureSample(uTexture, uSampler, uv);

  let glowColorRGB = glowUniforms.uColor;
  let glowAlpha = glowUniforms.uAlpha;
  let glowColor = vec4<f32>(glowColorRGB, glowAlpha);
  let knockout: bool = glowUniforms.uKnockout > 0.5;
  let innerStrength = glowUniforms.uStrength[0];
  let outerStrength = glowUniforms.uStrength[1];

  let alphaRatio: f32 = (totalAlpha / (angleStepNum * dist * (dist + 1.0) / 2.0));
  let innerGlowAlpha: f32 = (1.0 - alphaRatio) * innerStrength * curColor.a * glowAlpha;
  let innerGlowStrength: f32 = min(1.0, innerGlowAlpha);
  
  let innerColor: vec4<f32> = mix(curColor, glowColor, innerGlowStrength);
  let outerGlowAlpha: f32 = alphaRatio * outerStrength * (1. - curColor.a) * glowAlpha;
  let outerGlowStrength: f32 = min(1.0 - innerColor.a, outerGlowAlpha);
  let outerGlowColor: vec4<f32> = outerGlowStrength * glowColor.rgba;
  
  if (knockout) {
    let resultAlpha: f32 = outerGlowAlpha + innerGlowAlpha;
    return vec4<f32>(glowColor.rgb * resultAlpha, resultAlpha);
  }
  else {
    return innerColor + outerGlowColor;
  }
}

const PI: f32 = 3.14159265358979323846264;`,w3=Object.defineProperty,T3=(n,e,t)=>e in n?w3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Sa=(n,e,t)=>(T3(n,typeof e!="symbol"?e+"":e,t),t);const C3=class om extends xe{constructor(e){e={...om.DEFAULT_OPTIONS,...e};const t=e.distance??10,r=e.quality??.1,i=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:S3,entryPoint:"mainFragment"}}),s=_e.from({vertex:Pe,fragment:y3.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/r/t).toFixed(7)}`).replace(/__DIST__/gi,`${t.toFixed(0)}.0`),name:"glow-filter"});super({gpuProgram:i,glProgram:s,resources:{glowUniforms:{uDistance:{value:t,type:"f32"},uStrength:{value:[e.innerStrength,e.outerStrength],type:"vec2<f32>"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:e.alpha,type:"f32"},uQuality:{value:r,type:"f32"},uKnockout:{value:e?.knockout??!1?1:0,type:"f32"}}},padding:t}),Sa(this,"uniforms"),Sa(this,"_color"),this.uniforms=this.resources.glowUniforms.uniforms,this._color=new me,this.color=e.color??16777215}get distance(){return this.uniforms.uDistance}set distance(e){this.uniforms.uDistance=this.padding=e}get innerStrength(){return this.uniforms.uStrength[0]}set innerStrength(e){this.uniforms.uStrength[0]=e}get outerStrength(){return this.uniforms.uStrength[1]}set outerStrength(e){this.uniforms.uStrength[1]=e}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,r,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get quality(){return this.uniforms.uQuality}set quality(e){this.uniforms.uQuality=e}get knockout(){return this.uniforms.uKnockout===1}set knockout(e){this.uniforms.uKnockout=e?1:0}};Sa(C3,"DEFAULT_OPTIONS",{distance:10,outerStrength:4,innerStrength:0,color:16777215,alpha:1,quality:.1,knockout:!1});var P3=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uDimensions;
uniform float uParallel;
uniform vec2 uLight;
uniform float uAspect;
uniform float uTime;
uniform vec3 uRay;

uniform vec4 uInputSize;

\${PERLIN}

void main(void) {
    vec2 uDimensions = uDimensions;
    bool uParallel = uParallel > 0.5;
    vec2 uLight = uLight;
    float uAspect = uAspect;

    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions;

    float d;

    if (uParallel) {
        float _cos = uLight.x;
        float _sin = uLight.y;
        d = (_cos * coord.x) + (_sin * coord.y * uAspect);
    } else {
        float dx = coord.x - uLight.x / uDimensions.x;
        float dy = (coord.y - uLight.y / uDimensions.y) * uAspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    float uTime = uTime;
    vec3 uRay = uRay;

    float gain = uRay[0];
    float lacunarity = uRay[1];
    float alpha = uRay[2];

    vec3 dir = vec3(d, d, 0.0);
    float noise = turb(dir + vec3(uTime, 0.0, 62.1 + uTime) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(vec3(noise), 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    finalColor = texture(uTexture, vTextureCoord) + mist;
}
`,A3=`struct GodrayUniforms {
  uLight: vec2<f32>,
  uParallel: f32,
  uAspect: f32,
  uTime: f32,
  uRay: vec3<f32>,
  uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> godrayUniforms : GodrayUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uDimensions: vec2<f32> = godrayUniforms.uDimensions;
  let uParallel: bool = godrayUniforms.uParallel > 0.5;
  let uLight: vec2<f32> = godrayUniforms.uLight;
  let uAspect: f32 = godrayUniforms.uAspect;

  let coord: vec2<f32> = uv * gfu.uInputSize.xy / uDimensions;

  var d: f32;

  if (uParallel) {
    let _cos: f32 = uLight.x;
    let _sin: f32 = uLight.y;
    d = (_cos * coord.x) + (_sin * coord.y * uAspect);
  } else {
    let dx: f32 = coord.x - uLight.x / uDimensions.x;
    let dy: f32 = (coord.y - uLight.y / uDimensions.y) * uAspect;
    let dis: f32 = sqrt(dx * dx + dy * dy) + 0.00001;
    d = dy / dis;
  }

  let uTime: f32 = godrayUniforms.uTime;
  let uRay: vec3<f32> = godrayUniforms.uRay;
  
  let gain = uRay[0];
  let lacunarity = uRay[1];
  let alpha = uRay[2];

  let dir: vec3<f32> = vec3<f32>(d, d, 0.0);
  var noise: f32 = turb(dir + vec3<f32>(uTime, 0.0, 62.1 + uTime) * 0.05, vec3<f32>(480.0, 320.0, 480.0), lacunarity, gain);
  noise = mix(noise, 0.0, 0.3);
  //fade vertically.
  var mist: vec4<f32> = vec4<f32>(vec3<f32>(noise), 1.0) * (1.0 - coord.y);
  mist.a = 1.0;
  // apply user alpha
  mist *= alpha;
  return textureSample(uTexture, uSampler, uv) + mist;
}

\${PERLIN}`,E3=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,M3=`// Taken from https://gist.github.com/munrocket/236ed5ba7e409b8bdf1ff6eca5dcdc39

fn moduloVec3(x: vec3<f32>, y: vec3<f32>) -> vec3<f32>
{
  return x - y * floor(x/y);
}
fn mod289Vec3(x: vec3<f32>) -> vec3<f32>
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
fn mod289Vec4(x: vec4<f32>) -> vec4<f32>
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
fn permute4(x: vec4<f32>) -> vec4<f32>
{
    return mod289Vec4(((x * 34.0) + 1.0) * x);
}
fn taylorInvSqrt(r: vec4<f32>) -> vec4<f32>
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
fn fade3(t: vec3<f32>) -> vec3<f32>
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
fn fade2(t: vec2<f32>) -> vec2<f32> { return t * t * t * (t * (t * 6. - 15.) + 10.); }

fn perlinNoise2(P: vec2<f32>) -> f32 {
  var Pi: vec4<f32> = floor(P.xyxy) + vec4<f32>(0., 0., 1., 1.);
  let Pf = fract(P.xyxy) - vec4<f32>(0., 0., 1., 1.);
  Pi = Pi % vec4<f32>(289.); // To avoid truncation effects in permutation
  let ix = Pi.xzxz;
  let iy = Pi.yyww;
  let fx = Pf.xzxz;
  let fy = Pf.yyww;
  let i = permute4(permute4(ix) + iy);
  var gx: vec4<f32> = 2. * fract(i * 0.0243902439) - 1.; // 1/41 = 0.024...
  let gy = abs(gx) - 0.5;
  let tx = floor(gx + 0.5);
  gx = gx - tx;
  var g00: vec2<f32> = vec2<f32>(gx.x, gy.x);
  var g10: vec2<f32> = vec2<f32>(gx.y, gy.y);
  var g01: vec2<f32> = vec2<f32>(gx.z, gy.z);
  var g11: vec2<f32> = vec2<f32>(gx.w, gy.w);
  let norm = 1.79284291400159 - 0.85373472095314 *
      vec4<f32>(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11));
  g00 = g00 * norm.x;
  g01 = g01 * norm.y;
  g10 = g10 * norm.z;
  g11 = g11 * norm.w;
  let n00 = dot(g00, vec2<f32>(fx.x, fy.x));
  let n10 = dot(g10, vec2<f32>(fx.y, fy.y));
  let n01 = dot(g01, vec2<f32>(fx.z, fy.z));
  let n11 = dot(g11, vec2<f32>(fx.w, fy.w));
  let fade_xy = fade2(Pf.xy);
  let n_x = mix(vec2<f32>(n00, n01), vec2<f32>(n10, n11), vec2<f32>(fade_xy.x));
  let n_xy = mix(n_x.x, n_x.y, fade_xy.y);
  return 2.3 * n_xy;
}

// Classic Perlin noise, periodic variant
fn perlinNoise3(P: vec3<f32>, rep: vec3<f32>) -> f32
{
    var Pi0: vec3<f32> = moduloVec3(floor(P), rep); // Integer part, modulo period
    var Pi1: vec3<f32> = moduloVec3(Pi0 + vec3<f32>(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289Vec3(Pi0);
    Pi1 = mod289Vec3(Pi1);
    let Pf0: vec3<f32> = fract(P); // Fractional part for interpolation
    let Pf1: vec3<f32> = Pf0 - vec3<f32>(1.0); // Fractional part - 1.0
    let ix: vec4<f32> = vec4<f32>(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    let iy: vec4<f32> = vec4<f32>(Pi0.yy, Pi1.yy);
    let iz0: vec4<f32> = Pi0.zzzz;
    let iz1: vec4<f32> = Pi1.zzzz;
    let ixy: vec4<f32> = permute4(permute4(ix) + iy);
    let ixy0: vec4<f32> = permute4(ixy + iz0);
    let ixy1: vec4<f32> = permute4(ixy + iz1);
    var gx0: vec4<f32> = ixy0 * (1.0 / 7.0);
    var gy0: vec4<f32> = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    let gz0: vec4<f32> = vec4<f32>(0.5) - abs(gx0) - abs(gy0);
    let sz0: vec4<f32> = step(gz0, vec4<f32>(0.0));
    gx0 -= sz0 * (step(vec4<f32>(0.0), gx0) - 0.5);
    gy0 -= sz0 * (step(vec4<f32>(0.0), gy0) - 0.5);
    var gx1: vec4<f32> = ixy1 * (1.0 / 7.0);
    var gy1: vec4<f32> = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    let gz1: vec4<f32> = vec4<f32>(0.5) - abs(gx1) - abs(gy1);
    let sz1: vec4<f32> = step(gz1, vec4<f32>(0.0));
    gx1 -= sz1 * (step(vec4<f32>(0.0), gx1) - 0.5);
    gy1 -= sz1 * (step(vec4<f32>(0.0), gy1) - 0.5);
    var g000: vec3<f32> = vec3<f32>(gx0.x, gy0.x, gz0.x);
    var g100: vec3<f32> = vec3<f32>(gx0.y, gy0.y, gz0.y);
    var g010: vec3<f32> = vec3<f32>(gx0.z, gy0.z, gz0.z);
    var g110: vec3<f32> = vec3<f32>(gx0.w, gy0.w, gz0.w);
    var g001: vec3<f32> = vec3<f32>(gx1.x, gy1.x, gz1.x);
    var g101: vec3<f32> = vec3<f32>(gx1.y, gy1.y, gz1.y);
    var g011: vec3<f32> = vec3<f32>(gx1.z, gy1.z, gz1.z);
    var g111: vec3<f32> = vec3<f32>(gx1.w, gy1.w, gz1.w);
    let norm0: vec4<f32> = taylorInvSqrt(vec4<f32>(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    let norm1: vec4<f32> = taylorInvSqrt(vec4<f32>(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    let n000: f32 = dot(g000, Pf0);
    let n100: f32 = dot(g100, vec3<f32>(Pf1.x, Pf0.yz));
    let n010: f32 = dot(g010, vec3<f32>(Pf0.x, Pf1.y, Pf0.z));
    let n110: f32 = dot(g110, vec3<f32>(Pf1.xy, Pf0.z));
    let n001: f32 = dot(g001, vec3<f32>(Pf0.xy, Pf1.z));
    let n101: f32 = dot(g101, vec3<f32>(Pf1.x, Pf0.y, Pf1.z));
    let n011: f32 = dot(g011, vec3<f32>(Pf0.x, Pf1.yz));
    let n111: f32 = dot(g111, Pf1);
    let fade_xyz: vec3<f32> = fade3(Pf0);
    let n_z: vec4<f32> = mix(vec4<f32>(n000, n100, n010, n110), vec4<f32>(n001, n101, n011, n111), fade_xyz.z);
    let n_yz: vec2<f32> = mix(n_z.xy, n_z.zw, fade_xyz.y);
    let n_xyz: f32 = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
fn turb(P: vec3<f32>, rep: vec3<f32>, lacunarity: f32, gain: f32) -> f32
{
    var sum: f32 = 0.0;
    var sc: f32 = 1.0;
    var totalgain: f32 = 1.0;
    for (var i = 0.0; i < 6.0; i += 1)
    {
        sum += totalgain * perlinNoise3(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}`,k3=Object.defineProperty,R3=(n,e,t)=>e in n?k3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,or=(n,e,t)=>(R3(n,typeof e!="symbol"?e+"":e,t),t);const B3=class am extends xe{constructor(e){e={...am.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:A3.replace("${PERLIN}",M3),entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:P3.replace("${PERLIN}",E3),name:"god-ray-filter"});super({gpuProgram:t,glProgram:r,resources:{godrayUniforms:{uLight:{value:new Float32Array(2),type:"vec2<f32>"},uParallel:{value:0,type:"f32"},uAspect:{value:0,type:"f32"},uTime:{value:e.time,type:"f32"},uRay:{value:new Float32Array(3),type:"vec3<f32>"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),or(this,"uniforms"),or(this,"time",0),or(this,"_angleLight",[0,0]),or(this,"_angle",0),or(this,"_center"),this.uniforms=this.resources.godrayUniforms.uniforms,Object.assign(this,e)}apply(e,t,r,i){const s=t.frame.width,o=t.frame.height;this.uniforms.uLight[0]=this.parallel?this._angleLight[0]:this._center.x,this.uniforms.uLight[1]=this.parallel?this._angleLight[1]:this._center.y,this.uniforms.uDimensions[0]=s,this.uniforms.uDimensions[1]=o,this.uniforms.uAspect=o/s,this.uniforms.uTime=this.time,e.applyFilter(this,t,r,i)}get angle(){return this._angle}set angle(e){this._angle=e;const t=e*gr;this._angleLight[0]=Math.cos(t),this._angleLight[1]=Math.sin(t)}get parallel(){return this.uniforms.uParallel>.5}set parallel(e){this.uniforms.uParallel=e?1:0}get center(){return this._center}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this._center=e}get centerX(){return this.center.x}set centerX(e){this.center.x=e}get centerY(){return this.center.y}set centerY(e){this.center.y=e}get gain(){return this.uniforms.uRay[0]}set gain(e){this.uniforms.uRay[0]=e}get lacunarity(){return this.uniforms.uRay[1]}set lacunarity(e){this.uniforms.uRay[1]=e}get alpha(){return this.uniforms.uRay[2]}set alpha(e){this.uniforms.uRay[2]=e}};or(B3,"DEFAULT_OPTIONS",{angle:30,gain:.5,lacunarity:2.5,parallel:!0,time:0,center:{x:0,y:0},alpha:1});var I3=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uHsl;
uniform float uAlpha;
uniform float uColorize;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

float getWeightedAverage(vec3 rgb) {
    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const vec3 k = vec3(0.57735, 0.57735, 0.57735);

vec3 hueShift(vec3 color, float angle) {
    float cosAngle = cos(angle);
    return vec3(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}

void main()
{
    vec4 color = texture(uTexture, vTextureCoord);
    vec3 resultRGB = color.rgb;

    float hue = uHsl[0];
    float saturation = uHsl[1];
    float lightness = uHsl[2];

    // colorize
    if (uColorize > 0.5) {
        resultRGB = vec3(getWeightedAverage(resultRGB), 0., 0.);
    }

    // hue
    resultRGB = hueShift(resultRGB, hue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    float average = (resultRGB.r + resultRGB.g + resultRGB.b) / 3.0;

    if (saturation > 0.) {
        resultRGB += (average - resultRGB) * (1. - 1. / (1.001 - saturation));
    } else {
        resultRGB -= (average - resultRGB) * saturation;
    }

    // lightness
    resultRGB = mix(resultRGB, vec3(ceil(lightness)) * color.a, abs(lightness));

    // alpha
    finalColor = mix(color, vec4(resultRGB, color.a), uAlpha);
}
`,F3=`struct HslUniforms {
  uHsl:vec3<f32>,
  uColorize:f32,
  uAlpha:f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> hslUniforms : HslUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
    let color: vec4<f32> = textureSample(uTexture, uSampler, uv);
    var resultRGB: vec3<f32> = color.rgb;

    let hue: f32 = hslUniforms.uHsl[0];
    let saturation: f32 = hslUniforms.uHsl[1];
    let lightness: f32 = hslUniforms.uHsl[2];

    // colorize
    if (hslUniforms.uColorize > 0.5) {
        resultRGB = vec3<f32>(dot(color.rgb, vec3<f32>(0.299, 0.587, 0.114)), 0., 0.);
    }

    // hue
    resultRGB = hueShift(resultRGB, hue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    let average: f32 = (resultRGB.r + resultRGB.g + resultRGB.b) / 3.0;

    if (saturation > 0.) {
        resultRGB += (average - resultRGB) * (1. - 1. / (1.001 - saturation));
    } else {
        resultRGB -= (average - resultRGB) * saturation;
    }

    // lightness
    resultRGB = mix(resultRGB, vec3<f32>(ceil(lightness)) * color.a, abs(lightness));

    // alpha
    return mix(color, vec4<f32>(resultRGB, color.a), hslUniforms.uAlpha);
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const k: vec3<f32> = vec3(0.57735, 0.57735, 0.57735);

fn hueShift(color: vec3<f32>, angle: f32) -> vec3<f32> 
{
    let cosAngle: f32 = cos(angle);
    return vec3<f32>(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}`,O3=Object.defineProperty,U3=(n,e,t)=>e in n?O3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,wa=(n,e,t)=>(U3(n,typeof e!="symbol"?e+"":e,t),t);const G3=class lm extends xe{constructor(e){e={...lm.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:F3,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:I3,name:"hsl-adjustment-filter"});super({gpuProgram:t,glProgram:r,resources:{hslUniforms:{uHsl:{value:new Float32Array(3),type:"vec3<f32>"},uColorize:{value:e.colorize?1:0,type:"f32"},uAlpha:{value:e.alpha,type:"f32"}}}}),wa(this,"uniforms"),wa(this,"_hue"),this.uniforms=this.resources.hslUniforms.uniforms,Object.assign(this,e)}get hue(){return this._hue}set hue(e){this._hue=e,this.uniforms.uHsl[0]=e*(Math.PI/180)}get saturation(){return this.uniforms.uHsl[1]}set saturation(e){this.uniforms.uHsl[1]=e}get lightness(){return this.uniforms.uHsl[2]}set lightness(e){this.uniforms.uHsl[2]=e}get colorize(){return this.uniforms.uColorize===1}set colorize(e){this.uniforms.uColorize=e?1:0}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}};wa(G3,"DEFAULT_OPTIONS",{hue:0,saturation:0,lightness:0,colorize:!1,alpha:1});var D3=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uVelocity;
uniform int uKernelSize;
uniform float uOffset;

uniform vec4 uInputSize;

const int MAX_KERNEL_SIZE = 2048;

// Notice:
// the perfect way:
//    int kernelSize = min(uKernelSize, MAX_KERNELSIZE);
// BUT in real use-case , uKernelSize < MAX_KERNELSIZE almost always.
// So use uKernelSize directly.

void main(void)
{
    vec4 color = texture(uTexture, vTextureCoord);

    if (uKernelSize == 0)
    {
        finalColor = color;
        return;
    }

    vec2 velocity = uVelocity / uInputSize.xy;
    float offset = -uOffset / length(uVelocity) - 0.5;
    int k = uKernelSize - 1;

    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {
        if (i == k) {
            break;
        }
        vec2 bias = velocity * (float(i) / float(k) + offset);
        color += texture(uTexture, vTextureCoord + bias);
    }
    finalColor = color / float(uKernelSize);
}
`,z3=`struct MotionBlurUniforms {
  uVelocity: vec2<f32>,
  uKernelSize: f32,
  uOffset: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> motionBlurUniforms : MotionBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uVelocity = motionBlurUniforms.uVelocity;
  let uKernelSize = motionBlurUniforms.uKernelSize;
  let uOffset = motionBlurUniforms.uOffset;

  let velocity: vec2<f32> = uVelocity / gfu.uInputSize.xy;
  let offset: f32 = -uOffset / length(uVelocity) - 0.5;
  let k: i32 = i32(min(uKernelSize - 1, MAX_KERNEL_SIZE - 1));

  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  for(var i: i32 = 0; i < k; i += 1) {
    let bias: vec2<f32> = velocity * (f32(i) / f32(k) + offset);
    color += textureSample(uTexture, uSampler, uv + bias);
  }
  
  return select(color / f32(uKernelSize), textureSample(uTexture, uSampler, uv), uKernelSize == 0);
}

const MAX_KERNEL_SIZE: f32 = 2048;`,L3=Object.defineProperty,N3=(n,e,t)=>e in n?L3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ta=(n,e,t)=>(N3(n,typeof e!="symbol"?e+"":e,t),t);const H3=class um extends xe{constructor(...e){let t=e[0]??{};if(Array.isArray(t)||"x"in t&&"y"in t||t instanceof ut){ie("6.0.0","MotionBlurFilter constructor params are now options object. See params: { velocity, kernelSize, offset }");const s="x"in t?t.x:t[0],o="y"in t?t.y:t[1];t={velocity:{x:s,y:o}},e[1]!==void 0&&(t.kernelSize=e[1]),e[2]!==void 0&&(t.offset=e[2])}t={...um.DEFAULT_OPTIONS,...t};const r=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:z3,entryPoint:"mainFragment"}}),i=_e.from({vertex:Pe,fragment:D3,name:"motion-blur-filter"});super({gpuProgram:r,glProgram:i,resources:{motionBlurUniforms:{uVelocity:{value:t.velocity,type:"vec2<f32>"},uKernelSize:{value:Math.trunc(t.kernelSize??5),type:"i32"},uOffset:{value:t.offset,type:"f32"}}}}),Ta(this,"uniforms"),Ta(this,"_kernelSize"),this.uniforms=this.resources.motionBlurUniforms.uniforms,Object.assign(this,t)}get velocity(){return this.uniforms.uVelocity}set velocity(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uVelocity=e,this._updateDirty()}get velocityX(){return this.velocity.x}set velocityX(e){this.velocity.x=e,this._updateDirty()}get velocityY(){return this.velocity.y}set velocityY(e){this.velocity.y=e,this._updateDirty()}get kernelSize(){return this._kernelSize}set kernelSize(e){this._kernelSize=e,this._updateDirty()}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e}_updateDirty(){this.padding=(Math.max(Math.abs(this.velocityX),Math.abs(this.velocityY))>>0)+1,this.uniforms.uKernelSize=this.velocityX!==0||this.velocityY!==0?this._kernelSize:0}};Ta(H3,"DEFAULT_OPTIONS",{velocity:{x:0,y:0},kernelSize:5,offset:0});var V3=`in vec2 vTextureCoord;
out vec4 finalColor;

const int MAX_COLORS = \${MAX_COLORS};

uniform sampler2D uTexture;
uniform vec3 uOriginalColors[MAX_COLORS];
uniform vec3 uTargetColors[MAX_COLORS];
uniform float uTolerance;

void main(void)
{
    finalColor = texture(uTexture, vTextureCoord);

    float alpha = finalColor.a;
    if (alpha < 0.0001)
    {
      return;
    }

    vec3 color = finalColor.rgb / alpha;

    for(int i = 0; i < MAX_COLORS; i++)
    {
      vec3 origColor = uOriginalColors[i];
      if (origColor.r < 0.0)
      {
        break;
      }
      vec3 colorDiff = origColor - color;
      if (length(colorDiff) < uTolerance)
      {
        vec3 targetColor = uTargetColors[i];
        finalColor = vec4((targetColor + colorDiff) * alpha, alpha);
        return;
      }
    }
}
`,W3=`struct MultiColorReplaceUniforms {
  uOriginalColors: array<vec3<f32>, MAX_COLORS>,
  uTargetColors: array<vec3<f32>, MAX_COLORS>,
  uTolerance:f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> multiColorReplaceUniforms : MultiColorReplaceUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uOriginalColors = multiColorReplaceUniforms.uOriginalColors;
  let uTargetColors = multiColorReplaceUniforms.uTargetColors;
  let uTolerance = multiColorReplaceUniforms.uTolerance;

  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  let alpha: f32 = color.a;

  if (alpha > 0.0001)
  {
    var modColor: vec3<f32> = vec3<f32>(color.rgb) / alpha;

    for(var i: i32 = 0; i < MAX_COLORS; i += 1)
    {
      let origColor: vec3<f32> = uOriginalColors[i];
      if (origColor.r < 0.0)
      {
        break;
      }
      let colorDiff: vec3<f32> = origColor - modColor;
      
      if (length(colorDiff) < uTolerance)
      {
        let targetColor: vec3<f32> = uTargetColors[i];
        color = vec4((targetColor + colorDiff) * alpha, alpha);
        return color;
      }
    }
  }

  return color;
}

const MAX_COLORS: i32 = \${MAX_COLORS};`,j3=Object.defineProperty,X3=(n,e,t)=>e in n?j3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ss=(n,e,t)=>(X3(n,typeof e!="symbol"?e+"":e,t),t);const q3=class cm extends xe{constructor(...e){let t=e[0]??{};Array.isArray(t)&&(ie("6.0.0","MultiColorReplaceFilter constructor params are now options object. See params: { replacements, tolerance, maxColors }"),t={replacements:t},e[1]&&(t.tolerance=e[1]),e[2]&&(t.maxColors=e[2])),t={...cm.DEFAULT_OPTIONS,...t};const r=t.maxColors??t.replacements.length,i=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:W3.replace(/\$\{MAX_COLORS\}/g,r.toFixed(0)),entryPoint:"mainFragment"}}),s=_e.from({vertex:Pe,fragment:V3.replace(/\$\{MAX_COLORS\}/g,r.toFixed(0)),name:"multi-color-replace-filter"});super({gpuProgram:i,glProgram:s,resources:{multiColorReplaceUniforms:{uOriginalColors:{value:new Float32Array(3*r),type:"vec3<f32>",size:r},uTargetColors:{value:new Float32Array(3*r),type:"vec3<f32>",size:r},uTolerance:{value:t.tolerance,type:"f32"}}}}),ss(this,"uniforms"),ss(this,"_replacements",[]),ss(this,"_maxColors"),this._maxColors=r,this.uniforms=this.resources.multiColorReplaceUniforms.uniforms,this.replacements=t.replacements}set replacements(e){const t=this.uniforms.uOriginalColors,r=this.uniforms.uTargetColors,i=e.length,s=new me;if(i>this._maxColors)throw new Error(`Length of replacements (${i}) exceeds the maximum colors length (${this._maxColors})`);t[i*3]=-1;let o,a,l;for(let u=0;u<i;u++){const c=e[u];s.setValue(c[0]),[o,a,l]=s.toArray(),t[u*3]=o,t[u*3+1]=a,t[u*3+2]=l,s.setValue(c[1]),[o,a,l]=s.toArray(),r[u*3]=o,r[u*3+1]=a,r[u*3+2]=l}this._replacements=e}get replacements(){return this._replacements}refresh(){this.replacements=this._replacements}get maxColors(){return this._maxColors}get tolerance(){return this.uniforms.uTolerance}set tolerance(e){this.uniforms.uTolerance=e}set epsilon(e){ie("6.0.0","MultiColorReplaceFilter.epsilon is deprecated, please use MultiColorReplaceFilter.tolerance instead"),this.tolerance=e}get epsilon(){return ie("6.0.0","MultiColorReplaceFilter.epsilon is deprecated, please use MultiColorReplaceFilter.tolerance instead"),this.tolerance}};ss(q3,"DEFAULT_OPTIONS",{replacements:[[16711680,255]],tolerance:.05,maxColors:void 0});var Y3=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uSepia;
uniform vec2 uNoise;
uniform vec3 uScratch;
uniform vec3 uVignetting;
uniform float uSeed;
uniform vec2 uDimensions;

uniform vec4 uInputSize;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    finalColor = texture(uTexture, vTextureCoord);
    vec3 color = finalColor.rgb;

    if (uSepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + uSepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions.xy;

    float vignette = uVignetting[0];
    float vignetteAlpha = uVignetting[1];
    float vignetteBlur = uVignetting[2];

    if (vignette > 0.0)
    {
        float outter = SQRT_2 - vignette * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= uDimensions.y / uDimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignetteBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignetteAlpha);
    }

    float scratch = uScratch[0];
    float scratchDensity = uScratch[1];
    float scratchWidth = uScratch[2];

    if (scratchDensity > uSeed && scratch != 0.0)
    {
        float phase = uSeed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(uSeed * dist, abs(s - uSeed * dist)));
        if (d < uSeed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / uDimensions.x * (0.75 + uSeed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    float noise = uNoise[0];
    float noiseSize = uNoise[1];

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * uInputSize.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + uSeed * 512.0, 1024.0 - uSeed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * uSeed) - 0.5;
        color += _noise * noise;
    }

    finalColor.rgb = color;
}`,K3=`struct OldFilmUniforms {
    uSepia: f32,
    uNoise: vec2<f32>,
    uScratch: vec3<f32>,
    uVignetting: vec3<f32>,
    uSeed: f32,
    uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> oldFilmUniforms : OldFilmUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  if (oldFilmUniforms.uSepia > 0.)
  {
    color = vec4<f32>(sepia(color.rgb), color.a);
  }

  let coord: vec2<f32> = uv * gfu.uInputSize.xy / oldFilmUniforms.uDimensions;

  if (oldFilmUniforms.uVignetting[0] > 0.)
  {
    color *= vec4<f32>(vec3<f32>(vignette(color.rgb, coord)), color.a);
  }

  let uScratch = oldFilmUniforms.uScratch; 

  if (uScratch[1] > oldFilmUniforms.uSeed && uScratch[0] != 0.)
  {
    color = vec4<f32>(scratch(color.rgb, coord), color.a);
  }

  let uNoise = oldFilmUniforms.uNoise;

  if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
  {
    color += vec4<f32>(vec3<f32>(noise(uv)), color.a);
  }

  return color;
}

const SQRT_2: f32 = 1.414213;
const SEPIA_RGB: vec3<f32> = vec3<f32>(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

fn rand(co: vec2<f32>) -> f32
{
  return fract(sin(dot(co, vec2<f32>(12.9898, 78.233))) * 43758.5453);
}

fn overlay(src: vec3<f32>, dst: vec3<f32>) -> vec3<f32>
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)

    return vec3<f32>(
      select((1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)), (2.0 * src.x * dst.x), (dst.x <= 0.5)), 
      select((1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)), (2.0 * src.y * dst.y), (dst.y <= 0.5)),
      select((1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)), (2.0 * src.z * dst.z), (dst.z <= 0.5))
    );
}

fn sepia(co: vec3<f32>) -> vec3<f32>
{
  let gray: f32 = (co.x + co.y + co.z) / 3.0;
  let grayscale: vec3<f32> = vec3<f32>(gray);
  let color = overlay(SEPIA_RGB, grayscale);
  return grayscale + oldFilmUniforms.uSepia * (color - grayscale);
}

fn vignette(co: vec3<f32>, coord: vec2<f32>) -> f32
{
  let uVignetting = oldFilmUniforms.uVignetting;
  let uDimensions = oldFilmUniforms.uDimensions;
  
  let outter: f32 = SQRT_2 - uVignetting[0] * SQRT_2;
  var dir: vec2<f32> = vec2<f32>(vec2<f32>(0.5) - coord);
  dir.y *= uDimensions.y / uDimensions.x;
  let darker: f32 = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignetting[2] * SQRT_2), 0.0, 1.0);
  return darker + (1.0 - darker) * (1.0 - uVignetting[1]);
}

fn scratch(co: vec3<f32>, coord: vec2<f32>) -> vec3<f32>
{
  var color = co;
  let uScratch = oldFilmUniforms.uScratch;
  let uSeed = oldFilmUniforms.uSeed;
  let uDimensions = oldFilmUniforms.uDimensions;

  let phase: f32 = uSeed * 256.0;
  let s: f32 = modulo(floor(phase), 2.0);
  let dist: f32 = 1.0 / uScratch[1];
  let d: f32 = distance(coord, vec2<f32>(uSeed * dist, abs(s - uSeed * dist)));

  if (d < uSeed * 0.6 + 0.4)
  {
    let period: f32 = uScratch[1] * 10.0;

    let xx: f32 = coord.x * period + phase;
    let aa: f32 = abs(modulo(xx, 0.5) * 4.0);
    let bb: f32 = modulo(floor(xx / 0.5), 2.0);
    let yy: f32 = (1.0 - bb) * aa + bb * (2.0 - aa);

    let kk: f32 = 2.0 * period;
    let dw: f32 = uScratch[2] / uDimensions.x * (0.75 + uSeed);
    let dh: f32 = dw * kk;

    var tine: f32 = (yy - (2.0 - dh));

    if (tine > 0.0) {
        let _sign: f32 = sign(uScratch[0]);

        tine = s * tine / period + uScratch[0] + 0.1;
        tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

        color *= tine;
    }
  }

  return color;
}

fn noise(coord: vec2<f32>) -> f32
{
  let uNoise = oldFilmUniforms.uNoise;
  let uSeed = oldFilmUniforms.uSeed;

  var pixelCoord: vec2<f32> = coord * gfu.uInputSize.xy;
  pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
  pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
  return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}`,Z3=Object.defineProperty,Q3=(n,e,t)=>e in n?Z3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ca=(n,e,t)=>(Q3(n,typeof e!="symbol"?e+"":e,t),t);const hm=class fm extends xe{constructor(e){e={...fm.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:K3,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:Y3,name:"old-film-filter"});super({gpuProgram:t,glProgram:r,resources:{oldFilmUniforms:{uSepia:{value:e.sepia,type:"f32"},uNoise:{value:new Float32Array(2),type:"vec2<f32>"},uScratch:{value:new Float32Array(3),type:"vec3<f32>"},uVignetting:{value:new Float32Array(3),type:"vec3<f32>"},uSeed:{value:e.seed,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),Ca(this,"uniforms"),Ca(this,"seed"),this.uniforms=this.resources.oldFilmUniforms.uniforms,Object.assign(this,e)}apply(e,t,r,i){this.uniforms.uDimensions[0]=t.frame.width,this.uniforms.uDimensions[1]=t.frame.height,this.uniforms.uSeed=this.seed,e.applyFilter(this,t,r,i)}get sepia(){return this.uniforms.uSepia}set sepia(e){this.uniforms.uSepia=e}get noise(){return this.uniforms.uNoise[0]}set noise(e){this.uniforms.uNoise[0]=e}get noiseSize(){return this.uniforms.uNoise[1]}set noiseSize(e){this.uniforms.uNoise[1]=e}get scratch(){return this.uniforms.uScratch[0]}set scratch(e){this.uniforms.uScratch[0]=e}get scratchDensity(){return this.uniforms.uScratch[1]}set scratchDensity(e){this.uniforms.uScratch[1]=e}get scratchWidth(){return this.uniforms.uScratch[2]}set scratchWidth(e){this.uniforms.uScratch[2]=e}get vignetting(){return this.uniforms.uVignetting[0]}set vignetting(e){this.uniforms.uVignetting[0]=e}get vignettingAlpha(){return this.uniforms.uVignetting[1]}set vignettingAlpha(e){this.uniforms.uVignetting[1]=e}get vignettingBlur(){return this.uniforms.uVignetting[2]}set vignettingBlur(e){this.uniforms.uVignetting[2]=e}};Ca(hm,"DEFAULT_OPTIONS",{sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,seed:0});let J3=hm;var $3=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uThickness;
uniform vec3 uColor;
uniform float uAlpha;
uniform float uKnockout;

uniform vec4 uInputClamp;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${ANGLE_STEP};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture(uTexture, clamp(displacedPos, uInputClamp.xy, uInputClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture(uTexture, vTextureCoord);
    vec4 contentColor = sourceColor * float(uKnockout < 0.5);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    finalColor = contentColor + outlineColor;
}
`,ew=`struct OutlineUniforms {
  uThickness:vec2<f32>,
  uColor:vec3<f32>,
  uAlpha:f32,
  uAngleStep:f32,
  uKnockout:f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> outlineUniforms : OutlineUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let sourceColor: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let contentColor: vec4<f32> = sourceColor * (1. - outlineUniforms.uKnockout);
  
  let outlineAlpha: f32 = outlineUniforms.uAlpha * outlineMaxAlphaAtPos(uv) * (1. - sourceColor.a);
  let outlineColor: vec4<f32> = vec4<f32>(vec3<f32>(outlineUniforms.uColor) * outlineAlpha, outlineAlpha);
  
  return contentColor + outlineColor;
}

fn outlineMaxAlphaAtPos(uv: vec2<f32>) -> f32 {
  let thickness = outlineUniforms.uThickness;

  if (thickness.x == 0. || thickness.y == 0.) {
    return 0.;
  }
  
  let angleStep = outlineUniforms.uAngleStep;

  var displacedColor: vec4<f32>;
  var displacedPos: vec2<f32>;

  var maxAlpha: f32 = 0.;
  var displaced: vec2<f32>;
  var curColor: vec4<f32>;

  for (var angle = 0.; angle <= DOUBLE_PI; angle += angleStep)
  {
    displaced.x = uv.x + thickness.x * cos(angle);
    displaced.y = uv.y + thickness.y * sin(angle);
    curColor = textureSample(uTexture, uSampler, clamp(displaced, gfu.uInputClamp.xy, gfu.uInputClamp.zw));
    maxAlpha = max(maxAlpha, curColor.a);
  }

  return maxAlpha;
}

const DOUBLE_PI: f32 = 3.14159265358979323846264 * 2.;`,tw=Object.defineProperty,nw=(n,e,t)=>e in n?tw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Gn=(n,e,t)=>(nw(n,typeof e!="symbol"?e+"":e,t),t);const Cl=class In extends xe{constructor(...e){let t=e[0]??{};typeof t=="number"&&(ie("6.0.0","OutlineFilter constructor params are now options object. See params: { thickness, color, quality, alpha, knockout }"),t={thickness:t},e[1]!==void 0&&(t.color=e[1]),e[2]!==void 0&&(t.quality=e[2]),e[3]!==void 0&&(t.alpha=e[3]),e[4]!==void 0&&(t.knockout=e[4])),t={...In.DEFAULT_OPTIONS,...t};const r=t.quality??.1,i=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:ew,entryPoint:"mainFragment"}}),s=_e.from({vertex:Pe,fragment:$3.replace(/\$\{ANGLE_STEP\}/,In.getAngleStep(r).toFixed(7)),name:"outline-filter"});super({gpuProgram:i,glProgram:s,resources:{outlineUniforms:{uThickness:{value:new Float32Array(2),type:"vec2<f32>"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:t.alpha,type:"f32"},uAngleStep:{value:0,type:"f32"},uKnockout:{value:t.knockout?1:0,type:"f32"}}}}),Gn(this,"uniforms"),Gn(this,"_thickness"),Gn(this,"_quality"),Gn(this,"_color"),this.uniforms=this.resources.outlineUniforms.uniforms,this.uniforms.uAngleStep=In.getAngleStep(r),this._color=new me,this.color=t.color??0,Object.assign(this,t)}apply(e,t,r,i){this.uniforms.uThickness[0]=this.thickness/t.source.width,this.uniforms.uThickness[1]=this.thickness/t.source.height,e.applyFilter(this,t,r,i)}static getAngleStep(e){return parseFloat((Math.PI*2/Math.max(e*In.MAX_SAMPLES,In.MIN_SAMPLES)).toFixed(7))}get thickness(){return this._thickness}set thickness(e){this._thickness=this.padding=e}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,r,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get quality(){return this._quality}set quality(e){this._quality=e,this.uniforms.uAngleStep=In.getAngleStep(e)}get knockout(){return this.uniforms.uKnockout===1}set knockout(e){this.uniforms.uKnockout=e?1:0}};Gn(Cl,"DEFAULT_OPTIONS",{thickness:1,color:0,alpha:1,quality:.1,knockout:!1});Gn(Cl,"MIN_SAMPLES",1);Gn(Cl,"MAX_SAMPLES",100);var rw=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uRadian;
uniform vec2 uCenter;
uniform float uRadius;
uniform int uKernelSize;

uniform vec4 uInputSize;

const int MAX_KERNEL_SIZE = 2048;

void main(void)
{
    vec4 color = texture(uTexture, vTextureCoord);

    if (uKernelSize == 0)
    {
        finalColor = color;
        return;
    }

    float aspect = uInputSize.y / uInputSize.x;
    vec2 center = uCenter.xy / uInputSize.xy;
    float gradient = uRadius / uInputSize.x * 0.3;
    float radius = uRadius / uInputSize.x - gradient * 0.5;
    int k = uKernelSize - 1;

    vec2 coord = vTextureCoord;
    vec2 dir = vec2(center - coord);
    float dist = length(vec2(dir.x, dir.y * aspect));

    float radianStep = uRadian;
    if (radius >= 0.0 && dist > radius) {
        float delta = dist - radius;
        float gap = gradient;
        float scale = 1.0 - abs(delta / gap);
        if (scale <= 0.0) {
            finalColor = color;
            return;
        }
        radianStep *= scale;
    }
    radianStep /= float(k);

    float s = sin(radianStep);
    float c = cos(radianStep);
    mat2 rotationMatrix = mat2(vec2(c, -s), vec2(s, c));

    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {
        if (i == k) {
            break;
        }

        coord -= center;
        coord.y *= aspect;
        coord = rotationMatrix * coord;
        coord.y /= aspect;
        coord += center;

        vec4 sample = texture(uTexture, coord);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample;
    }

    finalColor = color / float(uKernelSize);
}
`,iw=`struct RadialBlurUniforms {
  uRadian: f32,
  uCenter: vec2<f32>,
  uKernelSize: f32,
  uRadius: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> radialBlurUniforms : RadialBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uRadian = radialBlurUniforms.uRadian;
  let uCenter = radialBlurUniforms.uCenter;
  let uKernelSize = radialBlurUniforms.uKernelSize;
  let uRadius = radialBlurUniforms.uRadius;
  
  var returnColorOnly = false;

  if (uKernelSize == 0)
  {
    returnColorOnly = true;
  }

  let aspect: f32 = gfu.uInputSize.y / gfu.uInputSize.x;
  let center: vec2<f32> = uCenter.xy / gfu.uInputSize.xy;
  let gradient: f32 = uRadius / gfu.uInputSize.x * 0.3;
  let radius: f32 = uRadius / gfu.uInputSize.x - gradient * 0.5;
  let k: i32 = i32(uKernelSize - 1);

  var coord: vec2<f32> = uv;
  let dir: vec2<f32> = vec2<f32>(center - coord);
  let dist: f32 = length(vec2<f32>(dir.x, dir.y * aspect));

  var radianStep: f32 = uRadian;
  
  if (radius >= 0.0 && dist > radius)
  {
    let delta: f32 = dist - radius;
    let gap: f32 = gradient;
    let scale: f32 = 1.0 - abs(delta / gap);
    if (scale <= 0.0) {
      returnColorOnly = true;
    }
    radianStep *= scale;
  }

  radianStep /= f32(k);

  let s: f32 = sin(radianStep);
  let c: f32 = cos(radianStep);
  let rotationMatrix: mat2x2<f32> = mat2x2<f32>(vec2<f32>(c, -s), vec2<f32>(s, c));
  
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let baseColor = vec4<f32>(color);

  let minK: i32 = min(i32(uKernelSize) - 1, MAX_KERNEL_SIZE - 1);

  for(var i: i32 = 0; i < minK; i += 1) 
  {
    coord -= center;
    coord.y *= aspect;
    coord = rotationMatrix * coord;
    coord.y /= aspect;
    coord += center;
    let sample: vec4<f32> = textureSample(uTexture, uSampler, coord);
    // switch to pre-multiplied alpha to correctly blur transparent images
    // sample.rgb *= sample.a;
    color += sample;
  }

  return select(color / f32(uKernelSize), baseColor, returnColorOnly);
}

const MAX_KERNEL_SIZE: i32 = 2048;`,sw=Object.defineProperty,ow=(n,e,t)=>e in n?sw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,os=(n,e,t)=>(ow(n,typeof e!="symbol"?e+"":e,t),t);const aw=class dm extends xe{constructor(...e){let t=e[0]??{};if(typeof t=="number"){if(ie("6.0.0","RadialBlurFilter constructor params are now options object. See params: { angle, center, kernelSize, radius }"),t={angle:t},e[1]){const s="x"in e[1]?e[1].x:e[1][0],o="y"in e[1]?e[1].y:e[1][1];t.center={x:s,y:o}}e[2]&&(t.kernelSize=e[2]),e[3]&&(t.radius=e[3])}t={...dm.DEFAULT_OPTIONS,...t};const r=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:iw,entryPoint:"mainFragment"}}),i=_e.from({vertex:Pe,fragment:rw,name:"radial-blur-filter"});super({gpuProgram:r,glProgram:i,resources:{radialBlurUniforms:{uRadian:{value:0,type:"f32"},uCenter:{value:t.center,type:"vec2<f32>"},uKernelSize:{value:t.kernelSize,type:"i32"},uRadius:{value:t.radius,type:"f32"}}}}),os(this,"uniforms"),os(this,"_angle"),os(this,"_kernelSize"),this.uniforms=this.resources.radialBlurUniforms.uniforms,Object.assign(this,t)}_updateKernelSize(){this.uniforms.uKernelSize=this._angle!==0?this.kernelSize:0}get angle(){return this._angle}set angle(e){this._angle=e,this.uniforms.uRadian=e*Math.PI/180,this._updateKernelSize()}get center(){return this.uniforms.uCenter}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.center.x}set centerX(e){this.center.x=e}get centerY(){return this.center.y}set centerY(e){this.center.y=e}get kernelSize(){return this._kernelSize}set kernelSize(e){this._kernelSize=e,this._updateKernelSize()}get radius(){return this.uniforms.uRadius}set radius(e){this.uniforms.uRadius=e<0||e===1/0?-1:e}};os(aw,"DEFAULT_OPTIONS",{angle:0,center:{x:0,y:0},kernelSize:5,radius:-1});var lw=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uMirror;
uniform float uBoundary;
uniform vec2 uAmplitude;
uniform vec2 uWavelength;
uniform vec2 uAlpha;
uniform float uTime;
uniform vec2 uDimensions;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * uInputSize.xy;
    vec2 coord = pixelCoord / uDimensions;

    if (coord.y < uBoundary) {
        finalColor = texture(uTexture, vTextureCoord);
        return;
    }

    float k = (coord.y - uBoundary) / (1. - uBoundary + 0.0001);
    float areaY = uBoundary * uDimensions.y / uInputSize.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = uMirror > 0.5 ? v : vTextureCoord.y;

    float _amplitude = ((uAmplitude.y - uAmplitude.x) * k + uAmplitude.x ) / uInputSize.x;
    float _waveLength = ((uWavelength.y - uWavelength.x) * k + uWavelength.x) / uInputSize.y;
    float _alpha = (uAlpha.y - uAlpha.x) * k + uAlpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - uTime) * _amplitude;
    x = clamp(x, uInputClamp.x, uInputClamp.z);

    vec4 color = texture(uTexture, vec2(x, y));

    finalColor = color * _alpha;
}
`,uw=`struct ReflectionUniforms {
  uMirror: f32,
  uBoundary: f32,
  uAmplitude: vec2<f32>,
  uWavelength: vec2<f32>,
  uAlpha: vec2<f32>,
  uTime: f32,
  uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> reflectionUniforms : ReflectionUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uDimensions: vec2<f32> = reflectionUniforms.uDimensions;
  let uBoundary: f32 = reflectionUniforms.uBoundary;
  let uMirror: bool = reflectionUniforms.uMirror > 0.5;
  let uAmplitude: vec2<f32> = reflectionUniforms.uAmplitude;
  let uWavelength: vec2<f32> = reflectionUniforms.uWavelength;
  let uAlpha: vec2<f32> = reflectionUniforms.uAlpha;
  let uTime: f32 = reflectionUniforms.uTime;

  let pixelCoord: vec2<f32> = uv * gfu.uInputSize.xy;
  let coord: vec2<f32> = pixelCoord /uDimensions;
  var returnColorOnly: bool = false;

  if (coord.y < uBoundary) {
    returnColorOnly = true;
  }

  let k: f32 = (coord.y - uBoundary) / (1. - uBoundary + 0.0001);
  let areaY: f32 = uBoundary * uDimensions.y / gfu.uInputSize.y;
  let v: f32 = areaY + areaY - uv.y;
  let y: f32 = select(uv.y, v, uMirror);

  let amplitude: f32 = ((uAmplitude.y - uAmplitude.x) * k + uAmplitude.x ) / gfu.uInputSize.x;
  let waveLength: f32 = ((uWavelength.y - uWavelength.x) * k + uWavelength.x) / gfu.uInputSize.y;
  let alpha: f32 = select((uAlpha.y - uAlpha.x) * k + uAlpha.x, 1., returnColorOnly);

  var x: f32 = uv.x + cos(v * 6.28 / waveLength - uTime) * amplitude;
  x = clamp(x, gfu.uInputClamp.x, gfu.uInputClamp.z);
  
  return textureSample(uTexture, uSampler, select(vec2<f32>(x, y), uv, returnColorOnly)) * alpha;
}

fn rand(co: vec2<f32>) -> f32 
{
  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}`,cw=Object.defineProperty,hw=(n,e,t)=>e in n?cw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Pa=(n,e,t)=>(hw(n,typeof e!="symbol"?e+"":e,t),t);const fw=class pm extends xe{constructor(e){e={...pm.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:uw,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:lw,name:"reflection-filter"});super({gpuProgram:t,glProgram:r,resources:{reflectionUniforms:{uMirror:{value:e.mirror?1:0,type:"f32"},uBoundary:{value:e.boundary,type:"f32"},uAmplitude:{value:e.amplitude,type:"vec2<f32>"},uWavelength:{value:e.waveLength,type:"vec2<f32>"},uAlpha:{value:e.alpha,type:"vec2<f32>"},uTime:{value:e.time,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),Pa(this,"uniforms"),Pa(this,"time",0),this.uniforms=this.resources.reflectionUniforms.uniforms,Object.assign(this,e)}apply(e,t,r,i){this.uniforms.uDimensions[0]=t.frame.width,this.uniforms.uDimensions[1]=t.frame.height,this.uniforms.uTime=this.time,e.applyFilter(this,t,r,i)}get mirror(){return this.uniforms.uMirror>.5}set mirror(e){this.uniforms.uMirror=e?1:0}get boundary(){return this.uniforms.uBoundary}set boundary(e){this.uniforms.uBoundary=e}get amplitude(){return Array.from(this.uniforms.uAmplitude)}set amplitude(e){this.uniforms.uAmplitude[0]=e[0],this.uniforms.uAmplitude[1]=e[1]}get amplitudeStart(){return this.uniforms.uAmplitude[0]}set amplitudeStart(e){this.uniforms.uAmplitude[0]=e}get amplitudeEnd(){return this.uniforms.uAmplitude[1]}set amplitudeEnd(e){this.uniforms.uAmplitude[1]=e}get waveLength(){return Array.from(this.uniforms.uWavelength)}set waveLength(e){this.uniforms.uWavelength[0]=e[0],this.uniforms.uWavelength[1]=e[1]}get wavelengthStart(){return this.uniforms.uWavelength[0]}set wavelengthStart(e){this.uniforms.uWavelength[0]=e}get wavelengthEnd(){return this.uniforms.uWavelength[1]}set wavelengthEnd(e){this.uniforms.uWavelength[1]=e}get alpha(){return Array.from(this.uniforms.uAlpha)}set alpha(e){this.uniforms.uAlpha[0]=e[0],this.uniforms.uAlpha[1]=e[1]}get alphaStart(){return this.uniforms.uAlpha[0]}set alphaStart(e){this.uniforms.uAlpha[0]=e}get alphaEnd(){return this.uniforms.uAlpha[1]}set alphaEnd(e){this.uniforms.uAlpha[1]=e}};Pa(fw,"DEFAULT_OPTIONS",{mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0});var dw=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec4 uInputSize;
uniform vec2 uRed;
uniform vec2 uGreen;
uniform vec2 uBlue;

void main(void)
{
   float r = texture(uTexture, vTextureCoord + uRed/uInputSize.xy).r;
   float g = texture(uTexture, vTextureCoord + uGreen/uInputSize.xy).g;
   float b = texture(uTexture, vTextureCoord + uBlue/uInputSize.xy).b;
   float a = texture(uTexture, vTextureCoord).a;
   finalColor = vec4(r, g, b, a);
}
`,pw=`struct RgbSplitUniforms {
    uRed: vec2<f32>,
    uGreen: vec2<f32>,
    uBlue: vec3<f32>,
};

struct GlobalFilterUniforms {
    uInputSize:vec4<f32>,
    uInputPixel:vec4<f32>,
    uInputClamp:vec4<f32>,
    uOutputFrame:vec4<f32>,
    uGlobalFrame:vec4<f32>,
    uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> rgbSplitUniforms : RgbSplitUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    let r = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uRed.x / gfu.uInputSize.x, rgbSplitUniforms.uRed.y / gfu.uInputSize.y)).r;
    let g = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uGreen.x / gfu.uInputSize.x, rgbSplitUniforms.uGreen.y / gfu.uInputSize.y)).g;
    let b = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uBlue.x / gfu.uInputSize.x, rgbSplitUniforms.uBlue.y / gfu.uInputSize.y)).b;
    let a = textureSample(uTexture, uSampler, uv).a;
    return vec4<f32>(r, g, b, a);
}
`,mw=Object.defineProperty,gw=(n,e,t)=>e in n?mw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,mm=(n,e,t)=>(gw(n,typeof e!="symbol"?e+"":e,t),t);const _w=class gm extends xe{constructor(...e){let t=e[0]??{};(Array.isArray(t)||"x"in t&&"y"in t)&&(ie("6.0.0","RGBSplitFilter constructor params are now options object. See params: { red, green, blue }"),t={red:t},e[1]!==void 0&&(t.green=e[1]),e[2]!==void 0&&(t.blue=e[2])),t={...gm.DEFAULT_OPTIONS,...t};const r=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:pw,entryPoint:"mainFragment"}}),i=_e.from({vertex:Pe,fragment:dw,name:"rgb-split-filter"});super({gpuProgram:r,glProgram:i,resources:{rgbSplitUniforms:{uRed:{value:t.red,type:"vec2<f32>"},uGreen:{value:t.green,type:"vec2<f32>"},uBlue:{value:t.blue,type:"vec2<f32>"}}}}),mm(this,"uniforms"),this.uniforms=this.resources.rgbSplitUniforms.uniforms,Object.assign(this,t)}get red(){return this.uniforms.uRed}set red(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uRed=e}get redX(){return this.red.x}set redX(e){this.red.x=e}get redY(){return this.red.y}set redY(e){this.red.y=e}get green(){return this.uniforms.uGreen}set green(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uGreen=e}get greenX(){return this.green.x}set greenX(e){this.green.x=e}get greenY(){return this.green.y}set greenY(e){this.green.y=e}get blue(){return this.uniforms.uBlue}set blue(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uBlue=e}get blueX(){return this.blue.x}set blueX(e){this.blue.x=e}get blueY(){return this.blue.y}set blueY(e){this.blue.y=e}};mm(_w,"DEFAULT_OPTIONS",{red:{x:-10,y:0},green:{x:0,y:10},blue:{x:0,y:0}});var vw=`
precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uCenter;
uniform float uTime;
uniform float uSpeed;
uniform vec4 uWave;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

const float PI = 3.14159;

void main()
{
    float uAmplitude = uWave[0];
    float uWavelength = uWave[1];
    float uBrightness = uWave[2];
    float uRadius = uWave[3];

    float halfWavelength = uWavelength * 0.5 / uInputSize.x;
    float maxRadius = uRadius / uInputSize.x;
    float currentRadius = uTime * uSpeed / uInputSize.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            finalColor = texture(uTexture, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - uCenter / uInputSize.xy);
    dir.y *= uInputSize.y / uInputSize.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        finalColor = texture(uTexture, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );

    vec2 offset = diffUV * powDiff / uInputSize.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    vec4 color = texture(uTexture, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // finalColor = texture(uTexture, vTextureCoord + offset);

    color.rgb *= 1.0 + (uBrightness - 1.0) * p * fade;

    finalColor = color;
}
`,bw=`
struct ShockWaveUniforms {
    uTime: f32,
    uOffset: vec2<f32>,
    uSpeed: f32,
    uWave: vec4<f32>,
};

struct GlobalFilterUniforms {
    uInputSize:vec4<f32>,
    uInputPixel:vec4<f32>,
    uInputClamp:vec4<f32>,
    uOutputFrame:vec4<f32>,
    uGlobalFrame:vec4<f32>,
    uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> shockwaveUniforms : ShockWaveUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {

    let uTime = shockwaveUniforms.uTime;
    let uOffset = shockwaveUniforms.uOffset;
    let uSpeed = shockwaveUniforms.uSpeed;
    let uAmplitude = shockwaveUniforms.uWave[0];
    let uWavelength = shockwaveUniforms.uWave[1];
    let uBrightness = shockwaveUniforms.uWave[2];
    let uRadius = shockwaveUniforms.uWave[3];
    let halfWavelength: f32 = uWavelength * 0.5 / gfu.uInputSize.x;
    let maxRadius: f32 = uRadius / gfu.uInputSize.x;
    let currentRadius: f32 = uTime * uSpeed / gfu.uInputSize.x;
    var fade: f32 = 1.0;
    var returnColorOnly: bool = false;
    
    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            returnColorOnly = true;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }
    var dir: vec2<f32> = vec2<f32>(uv - uOffset / gfu.uInputSize.xy);
    dir.y *= gfu.uInputSize.y / gfu.uInputSize.x;

    let dist:f32 = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        returnColorOnly = true;
    }

    let diffUV: vec2<f32> = normalize(dir);
    let diff: f32 = (dist - currentRadius) / halfWavelength;
    let p: f32 = 1.0 - pow(abs(diff), 2.0);
    let powDiff: f32 = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );
    let offset: vec2<f32> = diffUV * powDiff / gfu.uInputSize.xy;
    // Do clamp :
    let coord: vec2<f32> = uv + offset;
    let clampedCoord: vec2<f32> = clamp(coord, gfu.uInputClamp.xy, gfu.uInputClamp.zw);

    var clampedColor: vec4<f32> = textureSample(uTexture, uSampler, clampedCoord);
    
    if (boolVec2(coord, clampedCoord)) 
    {
        clampedColor *= max(0.0, 1.0 - length(coord - clampedCoord));
    }
    // No clamp :
    var finalColor = clampedColor;

    return select(finalColor, textureSample(uTexture, uSampler, uv), returnColorOnly);
}

fn boolVec2(x: vec2<f32>, y: vec2<f32>) -> bool
{
    if (x.x == y.x && x.y == y.y)
    {
        return true;
    }
    
    return false;
}

const PI: f32 = 3.14159265358979323846264;
`,xw=Object.defineProperty,yw=(n,e,t)=>e in n?xw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Aa=(n,e,t)=>(yw(n,typeof e!="symbol"?e+"":e,t),t);const Sw=class _m extends xe{constructor(...e){let t=e[0]??{};(Array.isArray(t)||"x"in t&&"y"in t)&&(ie("6.0.0","ShockwaveFilter constructor params are now options object. See params: { center, speed, amplitude, wavelength, brightness, radius, time }"),t={center:t,...e[1]},e[2]!==void 0&&(t.time=e[2])),t={..._m.DEFAULT_OPTIONS,...t};const r=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:bw,entryPoint:"mainFragment"}}),i=_e.from({vertex:Pe,fragment:vw,name:"shockwave-filter"});super({gpuProgram:r,glProgram:i,resources:{shockwaveUniforms:{uTime:{value:t.time,type:"f32"},uCenter:{value:t.center,type:"vec2<f32>"},uSpeed:{value:t.speed,type:"f32"},uWave:{value:new Float32Array(4),type:"vec4<f32>"}}}}),Aa(this,"uniforms"),Aa(this,"time"),this.time=0,this.uniforms=this.resources.shockwaveUniforms.uniforms,Object.assign(this,t)}apply(e,t,r,i){this.uniforms.uTime=this.time,e.applyFilter(this,t,r,i)}get center(){return this.uniforms.uCenter}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.uniforms.uCenter.x}set centerX(e){this.uniforms.uCenter.x=e}get centerY(){return this.uniforms.uCenter.y}set centerY(e){this.uniforms.uCenter.y=e}get speed(){return this.uniforms.uSpeed}set speed(e){this.uniforms.uSpeed=e}get amplitude(){return this.uniforms.uWave[0]}set amplitude(e){this.uniforms.uWave[0]=e}get wavelength(){return this.uniforms.uWave[1]}set wavelength(e){this.uniforms.uWave[1]=e}get brightness(){return this.uniforms.uWave[2]}set brightness(e){this.uniforms.uWave[2]=e}get radius(){return this.uniforms.uWave[3]}set radius(e){this.uniforms.uWave[3]=e}};Aa(Sw,"DEFAULT_OPTIONS",{center:{x:0,y:0},speed:500,amplitude:30,wavelength:160,brightness:1,radius:-1});var ww=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uMapTexture;
uniform vec3 uColor;
uniform float uAlpha;
uniform vec2 uDimensions;

uniform vec4 uInputSize;

void main() {
    vec4 diffuseColor = texture(uTexture, vTextureCoord);
    vec2 lightCoord = (vTextureCoord * uInputSize.xy) / uDimensions;
    vec4 light = texture(uMapTexture, lightCoord);
    vec3 ambient = uColor.rgb * uAlpha;
    vec3 intensity = ambient + light.rgb;
    vec3 color = diffuseColor.rgb * intensity;
    finalColor = vec4(color, diffuseColor.a);
}
`,Tw=`struct SimpleLightmapUniforms {
  uColor: vec3<f32>,
  uAlpha: f32,
  uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> simpleLightmapUniforms : SimpleLightmapUniforms;
@group(1) @binding(1) var uMapTexture: texture_2d<f32>;
@group(1) @binding(2) var uMapSampler: sampler;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>,
) -> @location(0) vec4<f32> {
  let uColor = simpleLightmapUniforms.uColor;
  let uAlpha = simpleLightmapUniforms.uAlpha;
  let uDimensions = simpleLightmapUniforms.uDimensions;

  let diffuseColor: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let lightCoord: vec2<f32> = (uv * gfu.uInputSize.xy) / simpleLightmapUniforms.uDimensions;
  let light: vec4<f32> = textureSample(uMapTexture, uMapSampler, lightCoord);
  let ambient: vec3<f32> = uColor * uAlpha;
  let intensity: vec3<f32> = ambient + light.rgb;
  let finalColor: vec3<f32> = diffuseColor.rgb * intensity;
  return vec4<f32>(finalColor, diffuseColor.a);
}`,Cw=Object.defineProperty,Pw=(n,e,t)=>e in n?Cw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,as=(n,e,t)=>(Pw(n,typeof e!="symbol"?e+"":e,t),t);const Aw=class vm extends xe{constructor(...e){let t=e[0]??{};if(t instanceof se&&(ie("6.0.0","SimpleLightmapFilter constructor params are now options object. See params: { lightMap, color, alpha }"),t={lightMap:t},e[1]!==void 0&&(t.color=e[1]),e[2]!==void 0&&(t.alpha=e[2])),t={...vm.DEFAULT_OPTIONS,...t},!t.lightMap)throw Error("No light map texture source was provided to SimpleLightmapFilter");const r=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:Tw,entryPoint:"mainFragment"}}),i=_e.from({vertex:Pe,fragment:ww,name:"simple-lightmap-filter"});super({gpuProgram:r,glProgram:i,resources:{simpleLightmapUniforms:{uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:t.alpha,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}},uMapTexture:t.lightMap.source,uMapSampler:t.lightMap.source.style}}),as(this,"uniforms"),as(this,"_color"),as(this,"_lightMap"),this.uniforms=this.resources.simpleLightmapUniforms.uniforms,this._color=new me,this.color=t.color??0,Object.assign(this,t)}apply(e,t,r,i){this.uniforms.uDimensions[0]=t.frame.width,this.uniforms.uDimensions[1]=t.frame.height,e.applyFilter(this,t,r,i)}get lightMap(){return this._lightMap}set lightMap(e){this._lightMap=e,this.resources.uMapTexture=e.source,this.resources.uMapSampler=e.source.style}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,r,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}};as(Aw,"DEFAULT_OPTIONS",{lightMap:se.WHITE,color:0,alpha:1});var Ew=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uBlur;
uniform vec2 uStart;
uniform vec2 uEnd;
uniform vec2 uDelta;
uniform vec2 uDimensions;

float random(vec3 scale, float seed)
{
    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}

void main(void)
{
    vec4 color = vec4(0.0);
    float total = 0.0;

    float blur = uBlur[0];
    float gradientBlur = uBlur[1];

    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
    vec2 normal = normalize(vec2(uStart.y - uEnd.y, uEnd.x - uStart.x));
    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * uDimensions - uStart, normal)) / gradientBlur) * blur;

    for (float t = -30.0; t <= 30.0; t++)
    {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 sample = texture(uTexture, vTextureCoord + uDelta / uDimensions * percent * radius);
        sample.rgb *= sample.a;
        color += sample * weight;
        total += weight;
    }

    color /= total;
    color.rgb /= color.a + 0.00001;

    finalColor = color;
}
`,Mw=`struct TiltShiftUniforms {
  uBlur: vec2<f32>,
  uStart: vec2<f32>,
  uEnd: vec2<f32>,
  uDelta: vec2<f32>,
  uDimensions: vec2<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> tiltShiftUniforms : TiltShiftUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uBlur = tiltShiftUniforms.uBlur[0];
  let uBlurGradient = tiltShiftUniforms.uBlur[1];
  let uStart = tiltShiftUniforms.uStart;
  let uEnd = tiltShiftUniforms.uEnd;
  let uDelta = tiltShiftUniforms.uDelta;
  let uDimensions = tiltShiftUniforms.uDimensions;

  var color: vec4<f32> = vec4<f32>(0.0);
  var total: f32 = 0.0;

  let offset: f32 = random(position, vec3<f32>(12.9898, 78.233, 151.7182), 0.0);
  let normal: vec2<f32> = normalize(vec2<f32>(uStart.y - uEnd.y, uEnd.x - uStart.x));
  let radius: f32 = smoothstep(0.0, 1.0, abs(dot(uv * uDimensions - uStart, normal)) / uBlurGradient) * uBlur;

  for (var t: f32 = -30.0; t <= 30.0; t += 1.0)
  {
    var percent: f32 = (t + offset - 0.5) / 30.0;
    var weight: f32 = 1.0 - abs(percent);
    var sample: vec4<f32> = textureSample(uTexture, uSampler, uv + uDelta / uDimensions * percent * radius);
    sample = vec4<f32>(sample.xyz * sample.a, sample.a); // multiply sample.rgb with sample.a
    color += sample * weight;
    total += weight;
  }

  color /= total;
  color = vec4<f32>(color.xyz / (color.a + 0.00001), color.a); // divide color.rgb by color.a + 0.00001

  return color;
}


fn random(position: vec4<f32>, scale: vec3<f32>, seed: f32) -> f32
{
  return fract(sin(dot(position.xyz + seed, scale)) * 43758.5453 + seed);
}`,kw=Object.defineProperty,Rw=(n,e,t)=>e in n?kw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ea=(n,e,t)=>(Rw(n,typeof e!="symbol"?e+"":e,t),t);const bm=class xm extends xe{constructor(e){const{width:t,height:r}=Qd.defaultOptions;e={...xm.DEFAULT_OPTIONS,start:{x:0,y:r/2},end:{x:t,y:r/2},...e};const i=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:Mw,entryPoint:"mainFragment"}}),s=_e.from({vertex:Pe,fragment:Ew,name:"tilt-shift-axis-filter"});super({gpuProgram:i,glProgram:s,resources:{tiltShiftUniforms:{uBlur:{value:new Float32Array([e.blur,e.gradientBlur]),type:"vec2<f32>"},uStart:{value:e.start,type:"vec2<f32>"},uEnd:{value:e.end,type:"vec2<f32>"},uDelta:{value:new Float32Array([0,0]),type:"vec2<f32>"},uDimensions:{value:new Float32Array([t,r]),type:"vec2<f32>"}}}}),Ea(this,"uniforms"),Ea(this,"_tiltAxis"),this.uniforms=this.resources.tiltShiftUniforms.uniforms,this._tiltAxis=e.axis}updateDimensions(e){const{uDimensions:t}=this.uniforms;t[0]=e.frame.width,t[1]=e.frame.height}updateDelta(){if(this.uniforms.uDelta[0]=0,this.uniforms.uDelta[1]=0,this._tiltAxis===void 0)return;const e=this.uniforms.uEnd,t=this.uniforms.uStart,r=e.x-t.x,i=e.y-t.y,s=Math.sqrt(r*r+i*i),o=this._tiltAxis==="vertical";this.uniforms.uDelta[0]=o?-i/s:r/s,this.uniforms.uDelta[1]=o?r/s:i/s}};Ea(bm,"DEFAULT_OPTIONS",{blur:100,gradientBlur:600});let No=bm;var Bw=Object.defineProperty,Iw=(n,e,t)=>e in n?Bw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Fw=(n,e,t)=>(Iw(n,e+"",t),t);class Ow extends No{constructor(e){e={...No.DEFAULT_OPTIONS,...e},super({...e,axis:"horizontal"}),Fw(this,"_tiltShiftYFilter"),this._tiltShiftYFilter=new No({...e,axis:"vertical"}),this.updateDelta(),Object.assign(this,e)}apply(e,t,r,i){const s=Me.getSameSizeTexture(t);this.updateDimensions(t),this._tiltShiftYFilter.updateDimensions(t),e.applyFilter(this,t,s,!0),e.applyFilter(this._tiltShiftYFilter,s,r,i),Me.returnTexture(s)}updateDelta(){super.updateDelta(),this._tiltShiftYFilter.updateDelta()}get blur(){return this.uniforms.uBlur[0]}set blur(e){this.uniforms.uBlur[0]=this._tiltShiftYFilter.uniforms.uBlur[0]=e}get gradientBlur(){return this.uniforms.uBlur[1]}set gradientBlur(e){this.uniforms.uBlur[1]=this._tiltShiftYFilter.uniforms.uBlur[1]=e}get start(){return this.uniforms.uStart}set start(e){this.uniforms.uStart=this._tiltShiftYFilter.uniforms.uStart=e,this.updateDelta()}get startX(){return this.start.x}set startX(e){this.start.x=e,this.updateDelta()}get startY(){return this.start.y}set startY(e){this.start.y=e,this.updateDelta()}get end(){return this.uniforms.uEnd}set end(e){this.uniforms.uEnd=this._tiltShiftYFilter.uniforms.uEnd=e,this.updateDelta()}get endX(){return this.end.x}set endX(e){this.end.x=e,this.updateDelta()}get endY(){return this.end.y}set endY(e){this.end.y=e,this.updateDelta()}}var Uw=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uTwist;
uniform vec2 uOffset;
uniform vec4 uInputSize;

vec2 mapCoord( vec2 coord )
{
    coord *= uInputSize.xy;
    coord += uInputSize.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= uInputSize.zw;
    coord /= uInputSize.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= uOffset;

    float dist = length(coord);
    float uRadius = uTwist[0];
    float uAngle = uTwist[1];

    if (dist < uRadius)
    {
        float ratioDist = (uRadius - dist) / uRadius;
        float angleMod = ratioDist * ratioDist * uAngle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += uOffset;

    return coord;
}

void main(void)
{
    vec2 coord = mapCoord(vTextureCoord);
    coord = twist(coord);
    coord = unmapCoord(coord);
    finalColor = texture(uTexture, coord);
}
`,Gw=`struct TwistUniforms {
  uTwist:vec2<f32>,
  uOffset:vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> twistUniforms : TwistUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
  return textureSample(uTexture, uSampler, unmapCoord(twist(mapCoord(uv))));
}

fn mapCoord(coord: vec2<f32> ) -> vec2<f32>
{
  var mappedCoord: vec2<f32> = coord;
  mappedCoord *= gfu.uInputSize.xy;
  mappedCoord += gfu.uOutputFrame.xy;
  return mappedCoord;
}

fn unmapCoord(coord: vec2<f32> ) -> vec2<f32>
{
  var mappedCoord: vec2<f32> = coord;
  mappedCoord -= gfu.uOutputFrame.xy;
  mappedCoord /= gfu.uInputSize.xy;
  return mappedCoord;
}

fn twist(coord: vec2<f32>) -> vec2<f32>
{
  var twistedCoord: vec2<f32> = coord;
  let uRadius = twistUniforms.uTwist[0];
  let uAngle = twistUniforms.uTwist[1];
  let uOffset = twistUniforms.uOffset;

  twistedCoord -= uOffset;
  
  let dist = length(twistedCoord);

  if (dist < uRadius)
  {
    let ratioDist: f32 = (uRadius - dist) / uRadius;
    let angleMod: f32 = ratioDist * ratioDist * uAngle;
    let s: f32 = sin(angleMod);
    let c: f32 = cos(angleMod);
    twistedCoord = vec2<f32>(twistedCoord.x * c - twistedCoord.y * s, twistedCoord.x * s + twistedCoord.y * c);
  }

  twistedCoord += uOffset;
  return twistedCoord;
}
`,Dw=Object.defineProperty,zw=(n,e,t)=>e in n?Dw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ym=(n,e,t)=>(zw(n,typeof e!="symbol"?e+"":e,t),t);const Lw=class Sm extends xe{constructor(e){e={...Sm.DEFAULT_OPTIONS,...e};const t=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:Gw,entryPoint:"mainFragment"}}),r=_e.from({vertex:Pe,fragment:Uw,name:"twist-filter"});super({gpuProgram:t,glProgram:r,resources:{twistUniforms:{uTwist:{value:[e.radius??0,e.angle??0],type:"vec2<f32>"},uOffset:{value:e.offset,type:"vec2<f32>"}}},...e}),ym(this,"uniforms"),this.uniforms=this.resources.twistUniforms.uniforms}get radius(){return this.uniforms.uTwist[0]}set radius(e){this.uniforms.uTwist[0]=e}get angle(){return this.uniforms.uTwist[1]}set angle(e){this.uniforms.uTwist[1]=e}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e}get offsetX(){return this.offset.x}set offsetX(e){this.offset.x=e}get offsetY(){return this.offset.y}set offsetY(e){this.offset.y=e}};ym(Lw,"DEFAULT_OPTIONS",{padding:20,radius:200,angle:4,offset:{x:0,y:0}});var Nw=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uStrength;
uniform vec2 uCenter;
uniform vec2 uRadii;

uniform vec4 uInputSize;

const float MAX_KERNEL_SIZE = \${MAX_KERNEL_SIZE};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {
    float minGradient = uRadii[0] * 0.3;
    float innerRadius = (uRadii[0] + minGradient * 0.5) / uInputSize.x;

    float gradient = uRadii[1] * 0.3;
    float radius = (uRadii[1] - gradient * 0.5) / uInputSize.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / uInputSize.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * uInputSize.y / uInputSize.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / uInputSize.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture(uTexture, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture(uTexture, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,Hw=`struct ZoomBlurUniforms {
    uStrength:f32,
    uCenter:vec2<f32>,
    uRadii:vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> zoomBlurUniforms : ZoomBlurUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uStrength = zoomBlurUniforms.uStrength;
  let uCenter = zoomBlurUniforms.uCenter;
  let uRadii = zoomBlurUniforms.uRadii;

  let minGradient: f32 = uRadii[0] * 0.3;
  let innerRadius: f32 = (uRadii[0] + minGradient * 0.5) / gfu.uInputSize.x;

  let gradient: f32 = uRadii[1] * 0.3;
  let radius: f32 = (uRadii[1] - gradient * 0.5) / gfu.uInputSize.x;

  let MAX_KERNEL_SIZE: f32 = \${MAX_KERNEL_SIZE};

  var countLimit: f32 = MAX_KERNEL_SIZE;

  var dir: vec2<f32> = vec2<f32>(uCenter / gfu.uInputSize.xy - uv);
  let dist: f32 = length(vec2<f32>(dir.x, dir.y * gfu.uInputSize.y / gfu.uInputSize.x));

  var strength: f32 = uStrength;

  var delta: f32 = 0.0;
  var gap: f32;

  if (dist < innerRadius) {
      delta = innerRadius - dist;
      gap = minGradient;
  } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
      delta = dist - radius;
      gap = gradient;
  }

  var returnColorOnly: bool = false;

  if (delta > 0.0) {
    let normalCount: f32 = gap / gfu.uInputSize.x;
    delta = (normalCount - delta) / normalCount;
    countLimit *= delta;
    strength *= delta;
    
    if (countLimit < 1.0)
    {
      returnColorOnly = true;;
    }
  }

  // randomize the lookup values to hide the fixed number of samples
  let offset: f32 = rand(uv, 0.0);

  var total: f32 = 0.0;
  var color: vec4<f32> = vec4<f32>(0.);

  dir *= strength;

  for (var t = 0.0; t < MAX_KERNEL_SIZE; t += 1.0) {
    let percent: f32 = (t + offset) / MAX_KERNEL_SIZE;
    let weight: f32 = 4.0 * (percent - percent * percent);
    let p: vec2<f32> = uv + dir * percent;
    let sample: vec4<f32> = textureSample(uTexture, uSampler, p);
    
    if (t < countLimit)
    {
      color += sample * weight;
      total += weight;
    }
  }

  color /= total;

  return select(color, textureSample(uTexture, uSampler, uv), returnColorOnly);
}

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
fn rand(co: vec2<f32>, seed: f32) -> f32
{
  let a: f32 = 12.9898;
  let b: f32 = 78.233;
  let c: f32 = 43758.5453;
  let dt: f32 = dot(co + seed, vec2<f32>(a, b));
  let sn: f32 = modulo(dt, 3.14159);
  return fract(sin(sn) * c + seed);
}`,Vw=Object.defineProperty,Ww=(n,e,t)=>e in n?Vw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,wm=(n,e,t)=>(Ww(n,typeof e!="symbol"?e+"":e,t),t);const Tm=class Cm extends xe{constructor(e){e={...Cm.DEFAULT_OPTIONS,...e};const t=e.maxKernelSize??32,r=ge.from({vertex:{source:Ae,entryPoint:"mainVertex"},fragment:{source:Hw.replace("${MAX_KERNEL_SIZE}",t.toFixed(1)),entryPoint:"mainFragment"}}),i=_e.from({vertex:Pe,fragment:Nw.replace("${MAX_KERNEL_SIZE}",t.toFixed(1)),name:"zoom-blur-filter"});super({gpuProgram:r,glProgram:i,resources:{zoomBlurUniforms:{uStrength:{value:e.strength,type:"f32"},uCenter:{value:e.center,type:"vec2<f32>"},uRadii:{value:new Float32Array(2),type:"vec2<f32>"}}}}),wm(this,"uniforms"),this.uniforms=this.resources.zoomBlurUniforms.uniforms,Object.assign(this,e)}get strength(){return this.uniforms.uStrength}set strength(e){this.uniforms.uStrength=e}get center(){return this.uniforms.uCenter}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.uniforms.uCenter.x}set centerX(e){this.uniforms.uCenter.x=e}get centerY(){return this.uniforms.uCenter.y}set centerY(e){this.uniforms.uCenter.y=e}get innerRadius(){return this.uniforms.uRadii[0]}set innerRadius(e){this.uniforms.uRadii[0]=e}get radius(){return this.uniforms.uRadii[1]}set radius(e){this.uniforms.uRadii[1]=e<0||e===1/0?-1:e}};wm(Tm,"DEFAULT_OPTIONS",{strength:.1,center:{x:0,y:0},innerRadius:0,radius:-1,maxKernelSize:32});let jw=Tm;class Xw{constructor(e,t,r){this.updater=e,this.fail=t,this.success=r}cache=new Map;last_failed=void 0;async get(e){if(this.last_failed===e)return null;if(this.cache.has(e))return this.cache.get(e);try{const t=await this.updater(e);return this.success&&this.success(e),this.cache.set(e,t),t}catch{return this.last_failed=e,this.fail&&this.fail(e),null}}get size(){return this.cache.size}}class qw{app;textures;constructor(e,t){this.textures=new Xw(async r=>await Nr.load(r),e,t)}static async create(e){const t=new this(e.texture_fail,e.texture_success);return await t.init(e),t}async init(e){this.app=new af;const[t,r]=this.splitRGBA(e.background);await this.app.init({background:t,backgroundAlpha:r,width:e.width,height:e.height,antialias:!1}),await this.mount(e.state),e.mount_point.appendChild(this.app.canvas)}splitRGBA(e){return[e.slice(0,7),e.length>7?parseInt(e.slice(7,9),16)/255:1]}createRoundedRectMask(e,t,r){const i=new ai;return i.roundRect(0,0,e,t,r),i.fill(16777215),i}}class Yw extends qw{text_group=new Ge;title=new $u;description=new $u;background_group=new Ge;backrgound=new Jt;logo_group=new Ge;logo=new Jt;categories_group=new Ge;prev_category_round;async mount(e){this.prev_category_round=e.categories.round,this.backrgound=Jt.from(e.background.src),this.text_group.addChild(this.title),this.text_group.addChild(this.description),this.background_group.addChild(this.backrgound),this.logo_group.addChild(this.logo),this.app.stage.addChild(this.background_group),this.app.stage.addChild(this.logo_group),this.app.stage.addChild(this.categories_group),this.app.stage.addChild(this.text_group)}async update(e){this.updateBackground(e),this.updateLogo(e),this.updateCategories(e),this.updateText(e)}updateText(e){this.title.x=e.title.x,this.title.y=e.title.y,this.title.text=e.title.text;const[t,r]=this.splitRGBA(e.title.shadow.color);this.title.style={fontFamily:e.title.font.face,fontSize:e.title.font.size,fill:e.title.font.color,fontWeight:e.title.font.weight,lineHeight:e.title.font.line_height,dropShadow:{color:t,blur:e.title.shadow.value,distance:0,alpha:r}};const[i,s]=this.splitRGBA(e.description.shadow.color);this.description.text=e.description.text,this.description.x=e.description.x,this.description.style={fontFamily:e.description.font.face,fontSize:e.description.font.size,fill:e.description.font.color,fontWeight:e.description.font.weight,lineHeight:e.description.font.line_height,dropShadow:{color:i,blur:e.description.shadow.value,distance:0,alpha:s}},this.description.y=this.title.y+this.title.height+e.description.gap}async updateBackground(e){const t=await this.textures.get(e.background.src);t&&(this.backrgound.texture=t),this.backrgound.x=e.background.x,this.backrgound.y=e.background.y,this.backrgound.width=e.background.w,this.backrgound.height=e.background.h,e.background.flip_h?(this.backrgound.scale.x=-Math.abs(this.backrgound.scale.x),this.backrgound.x=this.backrgound.x+this.backrgound.width):this.backrgound.scale.x=Math.abs(this.backrgound.scale.x),e.background.flip_v?(this.backrgound.scale.y=-Math.abs(this.backrgound.scale.y),this.backrgound.y=this.backrgound.y+this.backrgound.height):this.backrgound.scale.y=Math.abs(this.backrgound.scale.y),this.background_group.filters=this.buildFilters(e)}async updateLogo(e){this.logo.x=e.logo.x,this.logo.y=e.logo.y,this.logo.width=e.logo.w,this.logo.height=e.logo.h;const t=await this.textures.get(e.logo.src);t&&(this.logo.texture=t),this.logo.filters=[new Ji({strength:e.logo.blur,quality:15})]}async updateCategories(e){if(this.prev_category_round!=e.categories.round){for(const i of this.categories_group.children){const s=this.createRoundedRectMask(e.categories.w,e.categories.h,e.categories.round);i.removeChildAt(1);const o=i.children[0];o.mask=s,i.addChild(s)}this.prev_category_round=e.categories.round;return}this.categories_group.x=e.categories.x,this.categories_group.y=e.categories.y;const[t,r]=this.splitRGBA(e.categories.shadow.color);for(const[i,s]of e.categories.src.entries()){const o=await this.textures.get(s);if(!o)continue;let a;if(i<this.categories_group.children.length){a=this.categories_group.getChildAt(i);const l=a.getChildAt(0);l.texture=o}else{a=new Ge;const l=this.createRoundedRectMask(e.categories.w,e.categories.h,e.categories.round),u=new Jt({width:e.categories.w,height:e.categories.h,texture:o,mask:l});a.addChild(u),a.addChild(l),this.categories_group.addChild(a)}a.x=i*(e.categories.w+e.categories.margin),a.y=0,a.width=e.categories.w,a.height=e.categories.h,a.filters=[new Ji({strength:e.categories.blur,quality:15}),new m3({offset:{x:0,y:0},color:parseInt(t.slice(1),16),alpha:r,blur:e.categories.shadow.value,quality:15})]}for(;this.categories_group.children.length>e.categories.src.length;)this.categories_group.removeChildAt(this.categories_group.children.length-1)}buildFilters(e){const t=[];if(e.filter.adjustment.enabled&&t.push(new D2({gamma:e.filter.adjustment.gamma,saturation:e.filter.adjustment.saturation,contrast:e.filter.adjustment.contrast,brightness:e.filter.adjustment.brightness})),e.filter.blur.enabled&&(this.backrgound.x-=e.filter.blur.value,this.backrgound.y-=e.filter.blur.value,this.backrgound.width+=2*e.filter.blur.value,this.backrgound.height+=2*e.filter.blur.value,t.push(new Ji({strength:e.filter.blur.value,quality:15}))),e.filter.tilt_shift.enabled&&t.push(new Ow({blur:e.filter.tilt_shift.blur,start:{x:e.filter.tilt_shift.start.x,y:e.filter.tilt_shift.start.y},end:{x:e.filter.tilt_shift.end.x,y:e.filter.tilt_shift.end.y}})),e.filter.vignetting.enabled&&t.push(new J3({sepia:0,noise:0,scratch:0,vignetting:e.filter.vignetting.value,vignettingAlpha:e.filter.vignetting.alpha,vignettingBlur:e.filter.vignetting.blur})),e.filter.zoom_blur.enabled&&t.push(new jw({strength:e.filter.zoom_blur.value,center:{x:e.filter.zoom_blur.center.x,y:e.filter.zoom_blur.center.y},innerRadius:e.filter.zoom_blur.radius})),e.filter.gradient.enabled){const r=this.splitRGBA(e.filter.gradient.start.color),i=this.splitRGBA(e.filter.gradient.mid.color),s=this.splitRGBA(e.filter.gradient.end.color),o=[{color:r[0],alpha:r[1],offset:e.filter.gradient.start.value},{color:i[0],alpha:i[1],offset:e.filter.gradient.mid.value},{color:s[0],alpha:s[1],offset:e.filter.gradient.end.value}];o[0].offset>0&&o.unshift({color:r[0],alpha:r[1],offset:0}),t.push(new bc({type:bc.LINEAR,stops:o}))}return t}}function Kw(n){let e,t,r;return{c(){e=ne("div"),T(e,"style",n[1]),T(e,"class","svelte-148xzb6")},m(i,s){O(i,e,s),n[9](e),t||(r=[X(e,"wheel",n[2]),X(e,"mousedown",n[3]),X(e,"mouseup",n[4]),X(e,"mousemove",n[5]),X(e,"dblclick",Ht(ct(n[6]))),X(e,"selectstart",Ht(ct(n[8])))],t=!0)},p(i,[s]){s&2&&T(e,"style",i[1])},i:ce,o:ce,d(i){i&&F(e),n[9](null),t=!1,He(r)}}}function Zw(n,e,t){let r,i;fr(n,K,m=>t(7,r=m)),fr(n,Zt,m=>t(12,i=m));let s,o,a="STANDBY",l="";$c(async()=>{const m=await Yw.create({mount_point:s,state:r,background:"#1a1a24",width:r.width,height:r.height,texture_fail:()=>{Ie(Zt,i.background_cl="invalid",i)},texture_success:()=>{i.background_cl==="invalid"&&Ie(Zt,i.background_cl="valid",i)}});o=s.querySelector("canvas"),K.subscribe(v=>{m.update(v)}),Ie(Zt,i.app=m,i)});function u(m){m.preventDefault();const v=-m.deltaY*1e-4,x=o.width*v,S=o.height*v;Ie(K,r.background.w+=Math.floor(x),r),Ie(K,r.background.h+=Math.floor(S),r),Ie(K,r.background.x-=Math.floor(x/2),r),Ie(K,r.background.y-=Math.floor(S/2),r)}function c(){a==="STANDBY"&&(a="DRAG")}function h(){a==="DRAG"&&(a="STANDBY")}function d(m){a==="DRAG"&&(Ie(K,r.background.x+=m.movementX,r),Ie(K,r.background.y+=m.movementY,r))}function f(){Ie(K,r.background.x=0,r),Ie(K,r.background.y=0,r),Ie(K,r.background.w=o.width,r),Ie(K,r.background.h=o.height,r)}function p(m){Be.call(this,n,m)}function g(m){q[m?"unshift":"push"](()=>{s=m,t(0,s)})}return n.$$.update=()=>{if(n.$$.dirty&128){const m=[];r.background.x>0&&m.push("-3px 0px 0px 0px var(--red)"),r.background.y>0&&m.push("0px -3px 0px 0px var(--red)"),r.background.x+r.background.w<r.width&&m.push("3px 0px 0px 0px var(--red)"),r.background.y+r.background.h<r.height&&m.push("0px 3px 0px 0px var(--red)"),m.length>0?t(1,l=`width: ${r.width}px; height: ${r.height}px; box-shadow: ${m.join(", ")};`):t(1,l=`width: ${r.width}px; height: ${r.height}px;`)}},[s,l,u,c,h,d,f,r,p,g]}class Qw extends ze{constructor(e){super(),De(this,e,Zw,Kw,Ue,{})}}function Jw(n){let e,t=`${n[0]} transparent ${n[0]}
  ${n[0]}`;return{c(){e=ne("div"),ve(e,"--duration",n[1]),T(e,"class","svelte-66wdl1"),ve(e,"border-color",t),ve(e,"width",n[2]),ve(e,"height",n[2])},m(r,i){O(r,e,i)},p(r,[i]){i&2&&ve(e,"--duration",r[1]);const s=i&2;(i&3&&t!==(t=`${r[0]} transparent ${r[0]}
  ${r[0]}`)||s)&&ve(e,"border-color",t),(i&6||s)&&ve(e,"width",r[2]),(i&6||s)&&ve(e,"height",r[2])},i:ce,o:ce,d(r){r&&F(e)}}}function $w(n,e,t){let{color:r="cornflowerblue"}=e,{duration:i="1.5s"}=e,{size:s="1em"}=e;return n.$$set=o=>{"color"in o&&t(0,r=o.color),"duration"in o&&t(1,i=o.duration),"size"in o&&t(2,s=o.size)},[r,i,s]}class eT extends ze{constructor(e){super(),De(this,e,$w,Jw,Ue,{color:0,duration:1,size:2})}}function tT(n){const e=n-1;return e*e*e+1}function nT(n,{from:e,to:t},r={}){const i=getComputedStyle(n),s=i.transform==="none"?"":i.transform,[o,a]=i.transformOrigin.split(" ").map(parseFloat),l=e.left+e.width*o/t.width-(t.left+o),u=e.top+e.height*a/t.height-(t.top+a),{delay:c=0,duration:h=f=>Math.sqrt(f)*120,easing:d=tT}=r;return{delay:c,duration:Nt(h)?h(Math.sqrt(l*l+u*u)):h,easing:d,css:(f,p)=>{const g=p*l,m=p*u,v=f+p*e.width/t.width,x=f+p*e.height/t.height;return`transform: ${s} translate(${g}px, ${m}px) scale(${v}, ${x});`}}}function xc(n){return Object.prototype.toString.call(n)==="[object Date]"}function Ma(n,e,t,r){if(typeof t=="number"||xc(t)){const i=r-t,s=(t-e)/(n.dt||1/60),o=n.opts.stiffness*i,a=n.opts.damping*s,l=(o-a)*n.inv_mass,u=(s+l)*n.dt;return Math.abs(u)<n.opts.precision&&Math.abs(i)<n.opts.precision?r:(n.settled=!1,xc(t)?new Date(t.getTime()+u):t+u)}else{if(Array.isArray(t))return t.map((i,s)=>Ma(n,e[s],t[s],r[s]));if(typeof t=="object"){const i={};for(const s in t)i[s]=Ma(n,e[s],t[s],r[s]);return i}else throw new Error(`Cannot spring ${typeof t} values`)}}function rT(n,e={}){const t=Ba(n),{stiffness:r=.15,damping:i=.8,precision:s=.01}=e;let o,a,l,u=n,c=n,h=1,d=0,f=!1;function p(m,v={}){c=m;const x=l={};return n==null||v.hard||g.stiffness>=1&&g.damping>=1?(f=!0,o=Wo(),u=m,t.set(n=c),Promise.resolve()):(v.soft&&(d=1/((v.soft===!0?.5:+v.soft)*60),h=0),a||(o=Wo(),f=!1,a=qc(S=>{if(f)return f=!1,a=null,!1;h=Math.min(h+d,1);const y={inv_mass:h,opts:g,settled:!0,dt:(S-o)*60/1e3},b=Ma(y,u,n,c);return o=S,u=n,t.set(n=b),y.settled&&(a=null),!y.settled})),new Promise(S=>{a.promise.then(()=>{x===l&&S()})}))}const g={set:p,update:(m,v)=>p(m(c,n),v),subscribe:t.subscribe,stiffness:r,damping:i,precision:s};return g}function iT(n){let e,t=`rotate(${n[0].angle}deg) scale(${n[0].scale}) translate(${n[0].dx}px,
  ${n[0].dy}px)`,r;const i=n[11].default,s=ft(i,n,n[10],null);return{c(){e=ne("span"),s&&s.c(),ve(e,"transform",t)},m(o,a){O(o,e,a),s&&s.m(e,null),r=!0},p(o,[a]){s&&s.p&&(!r||a&1024)&&pt(s,i,o,o[10],r?dt(i,o[10],a,null):mt(o[10]),null),a&1&&t!==(t=`rotate(${o[0].angle}deg) scale(${o[0].scale}) translate(${o[0].dx}px,
  ${o[0].dy}px)`)&&ve(e,"transform",t)},i(o){r||(k(s,o),r=!0)},o(o){R(s,o),r=!1},d(o){o&&F(e),s&&s.d(o)}}}function sT(n,e,t){let r,{$$slots:i={},$$scope:s}=e,{wiggle:o=!1}=e,{angle:a=0}=e,{scale:l=1}=e,{dx:u=0}=e,{dy:c=0}=e,{duration:h=200}=e,{stiffness:d=.05}=e,{damping:f=.1}=e,p={angle:0,scale:1,dx:0,dy:0},g=rT(p,{stiffness:d,damping:f});return fr(n,g,m=>t(0,r=m)),n.$$set=m=>{"wiggle"in m&&t(2,o=m.wiggle),"angle"in m&&t(3,a=m.angle),"scale"in m&&t(4,l=m.scale),"dx"in m&&t(5,u=m.dx),"dy"in m&&t(6,c=m.dy),"duration"in m&&t(7,h=m.duration),"stiffness"in m&&t(8,d=m.stiffness),"damping"in m&&t(9,f=m.damping),"$$scope"in m&&t(10,s=m.$$scope)},n.$$.update=()=>{n.$$.dirty&132&&o&&setTimeout(()=>t(2,o=!1),h),n.$$.dirty&124&&g.set(o?{scale:l,angle:a,dx:u,dy:c}:p)},[r,g,o,a,l,u,c,h,d,f,s,i]}class oT extends ze{constructor(e){super(),De(this,e,sT,iT,Ue,{wiggle:2,angle:3,scale:4,dx:5,dy:6,duration:7,stiffness:8,damping:9})}}function aT(n){let e,t,r=[n[0],{fill:"currentColor"},{viewBox:"0 0 16 16"}],i={};for(let s=0;s<r.length;s+=1)i=en(i,r[s]);return{c(){e=zn("svg"),t=zn("path"),T(t,"d","M3.646 9.146a.5.5 0 0 1 .708 0L8 12.793l3.646-3.647a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 0-.708zm0-2.292a.5.5 0 0 0 .708 0L8 3.207l3.646 3.647a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 0 0 0 .708z"),pr(e,i)},m(s,o){O(s,e,o),te(e,t)},p(s,[o]){pr(e,i=Ra(r,[o&1&&s[0],{fill:"currentColor"},{viewBox:"0 0 16 16"}]))},i:ce,o:ce,d(s){s&&F(e)}}}function lT(n,e,t){return n.$$set=r=>{t(0,e=en(en({},e),dr(r)))},e=dr(e),[e]}class uT extends ze{constructor(e){super(),De(this,e,lT,aT,Ue,{})}}function cT(n){let e,t,r=[n[0],{viewBox:"0 0 24 24"},{fill:"currentColor"}],i={};for(let s=0;s<r.length;s+=1)i=en(i,r[s]);return{c(){e=zn("svg"),t=zn("path"),T(t,"d","M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"),pr(e,i)},m(s,o){O(s,e,o),te(e,t)},p(s,[o]){pr(e,i=Ra(r,[o&1&&s[0],{viewBox:"0 0 24 24"},{fill:"currentColor"}]))},i:ce,o:ce,d(s){s&&F(e)}}}function hT(n,e,t){return n.$$set=r=>{t(0,e=en(en({},e),dr(r)))},e=dr(e),[e]}class Pm extends ze{constructor(e){super(),De(this,e,hT,cT,Ue,{})}}function fT(n){let e,t,r=[n[0],{viewBox:"0 0 24 24"},{fill:"currentColor"}],i={};for(let s=0;s<r.length;s+=1)i=en(i,r[s]);return{c(){e=zn("svg"),t=zn("path"),T(t,"d","M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2S2 6.477 2 12s4.477 10 10 10Zm-4.906-3.68L18.32 7.094A8 8 0 0 1 7.094 18.32ZM5.68 16.906A8 8 0 0 1 16.906 5.68L5.68 16.906Z"),pr(e,i)},m(s,o){O(s,e,o),te(e,t)},p(s,[o]){pr(e,i=Ra(r,[o&1&&s[0],{viewBox:"0 0 24 24"},{fill:"currentColor"}]))},i:ce,o:ce,d(s){s&&F(e)}}}function dT(n,e,t){return n.$$set=r=>{t(0,e=en(en({},e),dr(r)))},e=dr(e),[e]}class pT extends ze{constructor(e){super(),De(this,e,dT,fT,Ue,{})}}const it=n=>n instanceof Object?(n.label===void 0&&console.error(`MultiSelect option ${JSON.stringify(n)} is an object but has no label key`),n.label):`${n}`;function Ts(n,e=null){let t="";if(["selected","option",null].includes(e)||console.error(`MultiSelect: Invalid key=${e} for get_style`),typeof n=="object"&&n.style&&(typeof n.style=="string"&&(t=n.style),typeof n.style=="object")){if(e&&e in n.style)return n.style[e]??"";console.error(`Invalid style object for option=${JSON.stringify(n)}`)}return t.trim()&&!t.trim().endsWith(";")&&(t+=";"),t}const{Boolean:mT}=lg,gT=n=>({searchText:n[0]&16,msgType:n[0]&68660|n[1]&16,msg:n[0]&101428|n[1]&16}),yc=n=>({searchText:n[4],msgType:n[124],msg:n[125]});function Ho(n){const e=n.slice(),t={dupe:e[15],create:e[10],"no-match":e[35]}[e[124]];return e[125]=t,e}function Vo(n){const e=n.slice(),t=e[5].map(it).includes(e[4]);e[120]=t;const r=!e[16]&&e[120]&&"dupe";e[121]=r;const i=!!(e[11]&&e[10])&&"create";e[122]=i;const s=!!(e[2]?.length==0&&e[35])&&"no-match";e[123]=s;const o=e[121]||e[122]||e[123];return e[124]=o,e}function Sc(n,e,t){const r=n.slice();r[126]=e[t],r[133]=t;const i=r[126]instanceof Object?r[126]:{label:r[126]};r[127]=i.label,r[50]=i.disabled!==void 0?i.disabled:null,r[128]=i.title!==void 0?i.title:null,r[129]=i.selectedTitle!==void 0?i.selectedTitle:null,r[130]=i.disabledTitle!==void 0?i.disabledTitle:r[13];const s=r[0]===r[133];return r[131]=s,r}const _T=n=>({option:n[0]&1073741828}),wc=n=>({option:n[126],idx:n[133]}),vT=n=>({option:n[0]&1073741828}),Tc=n=>({option:n[126],idx:n[133]}),bT=n=>({}),Cc=n=>({}),xT=n=>({}),Pc=n=>({}),yT=n=>({}),Ac=n=>({}),ST=n=>({selected:n[0]&32,disabled:n[1]&524288,invalid:n[0]&128,id:n[0]&262144,placeholder:n[1]&256,open:n[0]&256,required:n[1]&4096}),Ec=n=>({selected:n[5],disabled:n[50],invalid:n[7],id:n[18],placeholder:n[39],open:n[8],required:n[43]});function Mc(n,e,t){const r=n.slice();return r[126]=e[t],r[133]=t,r}const wT=n=>({}),kc=n=>({}),TT=n=>({option:n[0]&32,idx:n[0]&32}),Rc=n=>({option:n[126],idx:n[133]}),CT=n=>({option:n[0]&32,idx:n[0]&32}),Bc=n=>({option:n[126],idx:n[133]}),PT=n=>({open:n[0]&256}),Ic=n=>({open:n[8]});function AT(n){let e,t;return e=new uT({props:{width:"15px",style:"min-width: 1em; padding: 0 1pt; cursor: pointer;"}}),{c(){H(e.$$.fragment)},m(r,i){z(e,r,i),t=!0},p:ce,i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){R(e.$$.fragment,r),t=!1},d(r){L(e,r)}}}function ET(n){let e=it(n[126])+"",t;return{c(){t=rt(e)},m(r,i){O(r,t,i)},p(r,i){i[0]&32&&e!==(e=it(r[126])+"")&&ht(t,e)},d(r){r&&F(t)}}}function MT(n){let e,t=it(n[126])+"",r;return{c(){e=new Qc(!1),r=Ot(),e.a=r},m(i,s){e.m(t,i,s),O(i,r,s)},p(i,s){s[0]&32&&t!==(t=it(i[126])+"")&&e.p(t)},d(i){i&&(F(r),e.d())}}}function kT(n){let e;function t(s,o){return s[37]?MT:ET}let r=t(n),i=r(n);return{c(){i.c(),e=Ot()},m(s,o){i.m(s,o),O(s,e,o)},p(s,o){r===(r=t(s))&&i?i.p(s,o):(i.d(1),i=r(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){s&&F(e),i.d(s)}}}function RT(n){let e;const t=n[77].default,r=ft(t,n,n[115],Rc),i=r||kT(n);return{c(){i&&i.c()},m(s,o){i&&i.m(s,o),e=!0},p(s,o){r?r.p&&(!e||o[0]&32|o[3]&4194304)&&pt(r,t,s,s[115],e?dt(t,s[115],o,TT):mt(s[115]),Rc):i&&i.p&&(!e||o[0]&32|o[1]&64)&&i.p(s,e?o:[-1,-1,-1,-1,-1])},i(s){e||(k(i,s),e=!0)},o(s){R(i,s),e=!1},d(s){i&&i.d(s)}}}function Fc(n){let e,t,r,i,s;const o=n[77]["remove-icon"],a=ft(o,n,n[115],kc),l=a||BT();function u(){return n[97](n[126])}function c(){return n[98](n[126])}return{c(){e=ne("button"),l&&l.c(),T(e,"type","button"),T(e,"title",t=n[41]+" "+it(n[126])),T(e,"class","remove svelte-1r2hsto")},m(h,d){O(h,e,d),l&&l.m(e,null),r=!0,i||(s=[X(e,"mouseup",Ht(u)),X(e,"keydown",function(){Nt(n[62](c))&&n[62](c).apply(this,arguments)})],i=!0)},p(h,d){n=h,a&&a.p&&(!r||d[3]&4194304)&&pt(a,o,n,n[115],r?dt(o,n[115],d,wT):mt(n[115]),kc),(!r||d[0]&32|d[1]&1024&&t!==(t=n[41]+" "+it(n[126])))&&T(e,"title",t)},i(h){r||(k(l,h),r=!0)},o(h){R(l,h),r=!1},d(h){h&&F(e),l&&l.d(h),i=!1,He(s)}}}function BT(n){let e,t;return e=new Pm({props:{width:"15px"}}),{c(){H(e.$$.fragment)},m(r,i){z(e,r,i),t=!0},p:ce,i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){R(e.$$.fragment,r),t=!1},d(r){L(e,r)}}}function Oc(n,e){let t,r,i,s,o,a,l=ce,u,c,h;const d=e[77].selected,f=ft(d,e,e[115],Bc),p=f||RT(e);let g=!e[50]&&(e[42]===null||e[5].length>e[42])&&Fc(e);function m(){return e[99](e[133])}return{key:n,first:null,c(){t=ne("li"),p&&p.c(),r=V(),g&&g.c(),T(t,"class",i=tn(e[26])+" svelte-1r2hsto"),T(t,"role","option"),T(t,"aria-selected","true"),T(t,"draggable",s=e[44]&&!e[50]&&e[5].length>1),T(t,"style",o=Ts(e[126],"selected")+" "+e[27]),Fe(t,"active",e[54]===e[133]),this.first=t},m(v,x){O(v,t,x),p&&p.m(t,null),te(t,r),g&&g.m(t,null),u=!0,c||(h=[X(t,"dragstart",function(){Nt(e[65](e[133]))&&e[65](e[133]).apply(this,arguments)}),X(t,"drop",ct(function(){Nt(e[64](e[133]))&&e[64](e[133]).apply(this,arguments)})),X(t,"dragenter",m),X(t,"dragover",ct(e[93]))],c=!0)},p(v,x){e=v,f?f.p&&(!u||x[0]&32|x[3]&4194304)&&pt(f,d,e,e[115],u?dt(d,e[115],x,CT):mt(e[115]),Bc):p&&p.p&&(!u||x[0]&32|x[1]&64|x[3]&4194304)&&p.p(e,u?x:[-1,-1,-1,-1,-1]),!e[50]&&(e[42]===null||e[5].length>e[42])?g?(g.p(e,x),x[0]&32|x[1]&526336&&k(g,1)):(g=Fc(e),g.c(),k(g,1),g.m(t,null)):g&&(Ye(),R(g,1,1,()=>{g=null}),Ke()),(!u||x[0]&67108864&&i!==(i=tn(e[26])+" svelte-1r2hsto"))&&T(t,"class",i),(!u||x[0]&32|x[1]&532480&&s!==(s=e[44]&&!e[50]&&e[5].length>1))&&T(t,"draggable",s),(!u||x[0]&134217760&&o!==(o=Ts(e[126],"selected")+" "+e[27]))&&T(t,"style",o),(!u||x[0]&67108896|x[1]&8388608)&&Fe(t,"active",e[54]===e[133])},r(){a=t.getBoundingClientRect()},f(){xg(t),l()},a(){l(),l=bg(t,a,nT,{duration:100})},i(v){u||(k(p,v),k(g),u=!0)},o(v){R(p,v),R(g),u=!1},d(v){v&&F(t),p&&p.d(v),g&&g.d(),c=!1,He(h)}}}function Uc(n){let e;const t=n[77].spinner,r=ft(t,n,n[115],Ac),i=r||IT();return{c(){i&&i.c()},m(s,o){i&&i.m(s,o),e=!0},p(s,o){r&&r.p&&(!e||o[3]&4194304)&&pt(r,t,s,s[115],e?dt(t,s[115],o,yT):mt(s[115]),Ac)},i(s){e||(k(i,s),e=!0)},o(s){R(i,s),e=!1},d(s){i&&i.d(s)}}}function IT(n){let e,t;return e=new eT({}),{c(){H(e.$$.fragment)},m(r,i){z(e,r,i),t=!0},i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){R(e.$$.fragment,r),t=!1},d(r){L(e,r)}}}function FT(n){let e,t,r,i=n[31]&&(n[31]>1||n[32])&&Gc(n),s=n[31]!==1&&n[5].length>1&&Dc(n);return{c(){i&&i.c(),e=V(),s&&s.c(),t=Ot()},m(o,a){i&&i.m(o,a),O(o,e,a),s&&s.m(o,a),O(o,t,a),r=!0},p(o,a){o[31]&&(o[31]>1||o[32])?i?(i.p(o,a),a[1]&3&&k(i,1)):(i=Gc(o),i.c(),k(i,1),i.m(e.parentNode,e)):i&&(Ye(),R(i,1,1,()=>{i=null}),Ke()),o[31]!==1&&o[5].length>1?s?(s.p(o,a),a[0]&32|a[1]&1&&k(s,1)):(s=Dc(o),s.c(),k(s,1),s.m(t.parentNode,t)):s&&(Ye(),R(s,1,1,()=>{s=null}),Ke())},i(o){r||(k(i),k(s),r=!0)},o(o){R(i),R(s),r=!1},d(o){o&&(F(e),F(t)),i&&i.d(o),s&&s.d(o)}}}function OT(n){let e;const t=n[77]["disabled-icon"],r=ft(t,n,n[115],Pc),i=r||DT();return{c(){i&&i.c()},m(s,o){i&&i.m(s,o),e=!0},p(s,o){r&&r.p&&(!e||o[3]&4194304)&&pt(r,t,s,s[115],e?dt(t,s[115],o,xT):mt(s[115]),Pc)},i(s){e||(k(i,s),e=!0)},o(s){R(i,s),e=!1},d(s){i&&i.d(s)}}}function Gc(n){let e,t,r;function i(o){n[102](o)}let s={angle:20,$$slots:{default:[UT]},$$scope:{ctx:n}};return n[51]!==void 0&&(s.wiggle=n[51]),e=new oT({props:s}),q.push(()=>$(e,"wiggle",i)),{c(){H(e.$$.fragment)},m(o,a){z(e,o,a),r=!0},p(o,a){const l={};a[0]&32|a[1]&7|a[3]&4194304&&(l.$$scope={dirty:a,ctx:o}),!t&&a[1]&1048576&&(t=!0,l.wiggle=o[51],ee(()=>t=!1)),e.$set(l)},i(o){r||(k(e.$$.fragment,o),r=!0)},o(o){R(e.$$.fragment,o),r=!1},d(o){L(e,o)}}}function UT(n){let e,t=n[32]?.(n[5].length,n[31])+"",r,i;return{c(){e=ne("span"),r=rt(t),T(e,"class",i="max-select-msg "+n[33]+" svelte-1r2hsto")},m(s,o){O(s,e,o),te(e,r)},p(s,o){o[0]&32|o[1]&3&&t!==(t=s[32]?.(s[5].length,s[31])+"")&&ht(r,t),o[1]&4&&i!==(i="max-select-msg "+s[33]+" svelte-1r2hsto")&&T(e,"class",i)},d(s){s&&F(e)}}}function Dc(n){let e,t,r,i;const s=n[77]["remove-icon"],o=ft(s,n,n[115],Cc),a=o||GT();return{c(){e=ne("button"),a&&a.c(),T(e,"type","button"),T(e,"class","remove remove-all svelte-1r2hsto"),T(e,"title",n[40])},m(l,u){O(l,e,u),a&&a.m(e,null),t=!0,r||(i=[X(e,"mouseup",Ht(n[61])),X(e,"keydown",n[62](n[61]))],r=!0)},p(l,u){o&&o.p&&(!t||u[3]&4194304)&&pt(o,s,l,l[115],t?dt(s,l[115],u,bT):mt(l[115]),Cc),(!t||u[1]&512)&&T(e,"title",l[40])},i(l){t||(k(a,l),t=!0)},o(l){R(a,l),t=!1},d(l){l&&F(e),a&&a.d(l),r=!1,He(i)}}}function GT(n){let e,t;return e=new Pm({props:{width:"15px"}}),{c(){H(e.$$.fragment)},m(r,i){z(e,r,i),t=!0},p:ce,i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){R(e.$$.fragment,r),t=!1},d(r){L(e,r)}}}function DT(n){let e,t;return e=new pT({props:{width:"14pt",style:"margin: 0 2pt;","data-name":"disabled-icon"}}),{c(){H(e.$$.fragment)},m(r,i){z(e,r,i),t=!0},p:ce,i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){R(e.$$.fragment,r),t=!1},d(r){L(e,r)}}}function zc(n){let e,t,r,i,s,o,a=cs(n[2].slice(0,Math.max(0,n[30]??0)||1/0)),l=[];for(let h=0;h<a.length;h+=1)l[h]=Lc(Sc(n,a,h));const u=h=>R(l[h],1,1,()=>{l[h]=null});let c=n[4]&&Nc(Vo(n));return{c(){e=ne("ul");for(let h=0;h<l.length;h+=1)l[h].c();t=V(),c&&c.c(),T(e,"class",r="options "+n[46]+" svelte-1r2hsto"),T(e,"role","listbox"),T(e,"aria-multiselectable",i=n[31]===null||n[31]>1),T(e,"aria-expanded",n[8]),T(e,"aria-disabled",s=n[50]?"true":null),T(e,"style",n[49]),Fe(e,"hidden",!n[8])},m(h,d){O(h,e,d);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);te(e,t),c&&c.m(e,null),n[113](e),o=!0},p(h,d){if(d[0]&1128267781|d[1]&100663360|d[3]&4194304){a=cs(h[2].slice(0,Math.max(0,h[30]??0)||1/0));let f;for(f=0;f<a.length;f+=1){const p=Sc(h,a,f);l[f]?(l[f].p(p,d),k(l[f],1)):(l[f]=Lc(p),l[f].c(),k(l[f],1),l[f].m(e,t))}for(Ye(),f=a.length;f<l.length;f+=1)u(f);Ke()}h[4]?c?(c.p(Vo(h),d),d[0]&16&&k(c,1)):(c=Nc(Vo(h)),c.c(),k(c,1),c.m(e,null)):c&&(Ye(),R(c,1,1,()=>{c=null}),Ke()),(!o||d[1]&32768&&r!==(r="options "+h[46]+" svelte-1r2hsto"))&&T(e,"class",r),(!o||d[1]&1&&i!==(i=h[31]===null||h[31]>1))&&T(e,"aria-multiselectable",i),(!o||d[0]&256)&&T(e,"aria-expanded",h[8]),(!o||d[1]&524288&&s!==(s=h[50]?"true":null))&&T(e,"aria-disabled",s),(!o||d[1]&262144)&&T(e,"style",h[49]),(!o||d[0]&256|d[1]&32768)&&Fe(e,"hidden",!h[8])},i(h){if(!o){for(let d=0;d<a.length;d+=1)k(l[d]);k(c),o=!0}},o(h){l=l.filter(mT);for(let d=0;d<l.length;d+=1)R(l[d]);R(c),o=!1},d(h){h&&F(e),hg(l,h),c&&c.d(),n[113](null)}}}function zT(n){let e=it(n[126])+"",t;return{c(){t=rt(e)},m(r,i){O(r,t,i)},p(r,i){i[0]&1073741828&&e!==(e=it(r[126])+"")&&ht(t,e)},d(r){r&&F(t)}}}function LT(n){let e,t=it(n[126])+"",r;return{c(){e=new Qc(!1),r=Ot(),e.a=r},m(i,s){e.m(t,i,s),O(i,r,s)},p(i,s){s[0]&1073741828&&t!==(t=it(i[126])+"")&&e.p(t)},d(i){i&&(F(r),e.d())}}}function NT(n){let e;function t(s,o){return s[37]?LT:zT}let r=t(n),i=r(n);return{c(){i.c(),e=Ot()},m(s,o){i.m(s,o),O(s,e,o)},p(s,o){r===(r=t(s))&&i?i.p(s,o):(i.d(1),i=r(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){s&&F(e),i.d(s)}}}function HT(n){let e;const t=n[77].default,r=ft(t,n,n[115],wc),i=r||NT(n);return{c(){i&&i.c()},m(s,o){i&&i.m(s,o),e=!0},p(s,o){r?r.p&&(!e||o[0]&1073741828|o[3]&4194304)&&pt(r,t,s,s[115],e?dt(t,s[115],o,_T):mt(s[115]),wc):i&&i.p&&(!e||o[0]&1073741828|o[1]&64)&&i.p(s,e?o:[-1,-1,-1,-1,-1])},i(s){e||(k(i,s),e=!0)},o(s){R(i,s),e=!1},d(s){i&&i.d(s)}}}function Lc(n){let e,t,r,i,s,o,a;const l=n[77].option,u=ft(l,n,n[115],Tc),c=u||HT(n);function h(...p){return n[103](n[50],n[126],...p)}function d(){return n[104](n[50],n[133])}function f(){return n[105](n[50],n[133])}return{c(){e=ne("li"),c&&c.c(),T(e,"title",t=n[50]?n[130]:n[56](n[127])&&n[129]||n[128]),T(e,"class",r=n[24]+" "+(n[131]?n[22]:"")+" svelte-1r2hsto"),T(e,"role","option"),T(e,"aria-selected","false"),T(e,"style",i=Ts(n[126],"option")+" "+n[25]),Fe(e,"selected",n[56](n[127])),Fe(e,"active",n[131]),Fe(e,"disabled",n[50])},m(p,g){O(p,e,g),c&&c.m(e,null),s=!0,o||(a=[X(e,"mousedown",Ht(n[79])),X(e,"mouseup",Ht(h)),X(e,"mouseover",d),X(e,"focus",f),X(e,"mouseout",n[106]),X(e,"blur",n[107])],o=!0)},p(p,g){n=p,u?u.p&&(!s||g[0]&1073741828|g[3]&4194304)&&pt(u,l,n,n[115],s?dt(l,n[115],g,vT):mt(n[115]),Tc):c&&c.p&&(!s||g[0]&1073741828|g[1]&64|g[3]&4194304)&&c.p(n,s?g:[-1,-1,-1,-1,-1]),(!s||g[0]&1073741828|g[1]&33554432&&t!==(t=n[50]?n[130]:n[56](n[127])&&n[129]||n[128]))&&T(e,"title",t),(!s||g[0]&20971521&&r!==(r=n[24]+" "+(n[131]?n[22]:"")+" svelte-1r2hsto"))&&T(e,"class",r),(!s||g[0]&1107296260&&i!==(i=Ts(n[126],"option")+" "+n[25]))&&T(e,"style",i),(!s||g[0]&1094713349|g[1]&33554432)&&Fe(e,"selected",n[56](n[127])),(!s||g[0]&20971521)&&Fe(e,"active",n[131]),(!s||g[0]&1094713349)&&Fe(e,"disabled",n[50])},i(p){s||(k(c,p),s=!0)},o(p){R(c,p),s=!1},d(p){p&&F(e),c&&c.d(p),o=!1,He(a)}}}function Nc(n){let e,t,r=n[124]&&Hc(Ho(n));return{c(){r&&r.c(),e=Ot()},m(i,s){r&&r.m(i,s),O(i,e,s),t=!0},p(i,s){i[124]?r?(r.p(Ho(i),s),s[0]&68660|s[1]&16&&k(r,1)):(r=Hc(Ho(i)),r.c(),k(r,1),r.m(e.parentNode,e)):r&&(Ye(),R(r,1,1,()=>{r=null}),Ke())},i(i){t||(k(r),t=!0)},o(i){R(r),t=!1},d(i){i&&F(e),r&&r.d(i)}}}function Hc(n){let e,t,r,i,s;const o=n[77]["user-msg"],a=ft(o,n,n[115],yc),l=a||VT(n);return{c(){e=ne("li"),l&&l.c(),T(e,"title",n[10]),T(e,"role","option"),T(e,"aria-selected","false"),T(e,"class",t="user-msg "+n[28]+" "+(n[52]?n[23]:"")+" svelte-1r2hsto"),Fe(e,"active",n[52]),ve(e,"cursor",{dupe:"not-allowed",create:"pointer","no-match":"default"}[n[124]])},m(u,c){O(u,e,c),l&&l.m(e,null),r=!0,i||(s=[X(e,"mousedown",Ht(n[78])),X(e,"mouseup",Ht(n[108])),X(e,"mouseover",n[109]),X(e,"focus",n[110]),X(e,"mouseout",n[111]),X(e,"blur",n[112])],i=!0)},p(u,c){a?a.p&&(!r||c[0]&101428|c[1]&16|c[3]&4194304)&&pt(a,o,u,u[115],r?dt(o,u[115],c,gT):mt(u[115]),yc):l&&l.p&&(!r||c[0]&101428|c[1]&16)&&l.p(u,r?c:[-1,-1,-1,-1,-1]),(!r||c[0]&1024)&&T(e,"title",u[10]),(!r||c[0]&276824064|c[1]&2097152&&t!==(t="user-msg "+u[28]+" "+(u[52]?u[23]:"")+" svelte-1r2hsto"))&&T(e,"class",t),(!r||c[0]&276824064|c[1]&2097152)&&Fe(e,"active",u[52]),c[0]&68660|c[1]&16&&ve(e,"cursor",{dupe:"not-allowed",create:"pointer","no-match":"default"}[u[124]])},i(u){r||(k(l,u),r=!0)},o(u){R(l,u),r=!1},d(u){u&&F(e),l&&l.d(u),i=!1,He(s)}}}function VT(n){let e=n[125]+"",t;return{c(){t=rt(e)},m(r,i){O(r,t,i)},p(r,i){i[0]&101428|i[1]&16&&e!==(e=r[125]+"")&&ht(t,e)},d(r){r&&F(t)}}}function WT(n){let e,t,r,i,s,o,a=[],l=new Map,u,c,h,d,f,p,g,m,v,x,S,y,b,B,A,U,E;Jr(n[94]);const _=n[77]["expand-icon"],I=ft(_,n,n[115],Ic),re=I||AT();let Y=cs(n[5]);const j=G=>G[16]?[G[17](G[126]),G[133]]:G[17](G[126]);for(let G=0;G<Y.length;G+=1){let Q=Mc(n,Y,G),he=j(Q);l.set(he,a[G]=Oc(he,Q))}const C=n[77]["after-input"],N=ft(C,n,n[115],Ec);let W=n[29]&&Uc(n);const le=[OT,FT],Z=[];function D(G,Q){return G[50]?0:G[5].length>0?1:-1}~(x=D(n))&&(S=Z[x]=le[x](n));let oe=(n[4]&&n[35]||n[3]?.length>0)&&zc(n);return{c(){e=ne("div"),t=ne("input"),i=V(),re&&re.c(),s=V(),o=ne("ul");for(let G=0;G<a.length;G+=1)a[G].c();u=V(),c=ne("input"),p=V(),N&&N.c(),m=V(),W&&W.c(),v=V(),S&&S.c(),y=V(),oe&&oe.c(),T(t,"name",n[34]),t.required=n[43],t.value=r=n[5].length>=Number(n[43])?JSON.stringify(n[5]):null,T(t,"tabindex","-1"),T(t,"aria-hidden","true"),T(t,"aria-label","ignore this, used only to prevent form submission if select is required but empty"),T(t,"class","form-control svelte-1r2hsto"),T(c,"class",h=tn(n[19])+" svelte-1r2hsto"),T(c,"style",n[20]),T(c,"id",n[18]),c.disabled=n[50],T(c,"autocomplete",n[12]),T(c,"inputmode",n[21]),T(c,"pattern",n[38]),T(c,"placeholder",d=n[5].length==0?n[39]:null),T(c,"aria-invalid",f=n[7]?"true":null),T(c,"ondrop","return false"),T(o,"class",g="selected "+n[47]+" svelte-1r2hsto"),T(o,"aria-label","selected options"),T(o,"style",n[48]),T(e,"class",b="multiselect "+n[36]+" svelte-1r2hsto"),T(e,"title",B=n[50]?n[14]:null),T(e,"data-id",n[18]),T(e,"role","searchbox"),T(e,"tabindex","-1"),T(e,"style",n[45]),Fe(e,"disabled",n[50]),Fe(e,"single",n[31]===1),Fe(e,"open",n[8]),Fe(e,"invalid",n[7])},m(G,Q){O(G,e,Q),te(e,t),n[95](t),te(e,i),re&&re.m(e,null),te(e,s),te(e,o);for(let he=0;he<a.length;he+=1)a[he]&&a[he].m(o,null);te(o,u),te(o,c),n[100](c),xn(c,n[4]),te(o,p),N&&N.m(o,null),te(e,m),W&&W.m(e,null),te(e,v),~x&&Z[x].m(e,null),te(e,y),oe&&oe.m(e,null),n[114](e),A=!0,U||(E=[X(window,"click",n[63]),X(window,"touchstart",n[63]),X(window,"resize",n[94]),X(t,"invalid",n[96]),X(c,"input",n[101]),X(c,"mouseup",Kc(Ht(n[59]))),X(c,"keydown",Ht(n[60])),X(c,"focus",n[80]),X(c,"focus",n[59]),X(c,"input",n[66]),X(c,"blur",n[81]),X(c,"change",n[82]),X(c,"click",n[83]),X(c,"keydown",n[84]),X(c,"keyup",n[85]),X(c,"mousedown",n[86]),X(c,"mouseenter",n[87]),X(c,"mouseleave",n[88]),X(c,"touchcancel",n[89]),X(c,"touchend",n[90]),X(c,"touchmove",n[91]),X(c,"touchstart",n[92]),X(e,"mouseup",Ht(n[59]))],U=!0)},p(G,Q){if((!A||Q[1]&8)&&T(t,"name",G[34]),(!A||Q[1]&4096)&&(t.required=G[43]),(!A||Q[0]&32|Q[1]&4096&&r!==(r=G[5].length>=Number(G[43])?JSON.stringify(G[5]):null)&&t.value!==r)&&(t.value=r),I&&I.p&&(!A||Q[0]&256|Q[3]&4194304)&&pt(I,_,G,G[115],A?dt(_,G[115],Q,PT):mt(G[115]),Ic),Q[0]&201523232|Q[1]&143141952|Q[2]&13|Q[3]&4194304){Y=cs(G[5]),Ye();for(let Le=0;Le<a.length;Le+=1)a[Le].r();a=Pg(a,Q,j,1,G,Y,l,o,Cg,Oc,u,Mc);for(let Le=0;Le<a.length;Le+=1)a[Le].a();Ke()}(!A||Q[0]&524288&&h!==(h=tn(G[19])+" svelte-1r2hsto"))&&T(c,"class",h),(!A||Q[0]&1048576)&&T(c,"style",G[20]),(!A||Q[0]&262144)&&T(c,"id",G[18]),(!A||Q[1]&524288)&&(c.disabled=G[50]),(!A||Q[0]&4096)&&T(c,"autocomplete",G[12]),(!A||Q[0]&2097152)&&T(c,"inputmode",G[21]),(!A||Q[1]&128)&&T(c,"pattern",G[38]),(!A||Q[0]&32|Q[1]&256&&d!==(d=G[5].length==0?G[39]:null))&&T(c,"placeholder",d),(!A||Q[0]&128&&f!==(f=G[7]?"true":null))&&T(c,"aria-invalid",f),Q[0]&16&&c.value!==G[4]&&xn(c,G[4]),N&&N.p&&(!A||Q[0]&262560|Q[1]&528640|Q[3]&4194304)&&pt(N,C,G,G[115],A?dt(C,G[115],Q,ST):mt(G[115]),Ec),(!A||Q[1]&65536&&g!==(g="selected "+G[47]+" svelte-1r2hsto"))&&T(o,"class",g),(!A||Q[1]&131072)&&T(o,"style",G[48]),G[29]?W?(W.p(G,Q),Q[0]&536870912&&k(W,1)):(W=Uc(G),W.c(),k(W,1),W.m(e,v)):W&&(Ye(),R(W,1,1,()=>{W=null}),Ke());let he=x;x=D(G),x===he?~x&&Z[x].p(G,Q):(S&&(Ye(),R(Z[he],1,1,()=>{Z[he]=null}),Ke()),~x?(S=Z[x],S?S.p(G,Q):(S=Z[x]=le[x](G),S.c()),k(S,1),S.m(e,y)):S=null),G[4]&&G[35]||G[3]?.length>0?oe?(oe.p(G,Q),Q[0]&24|Q[1]&16&&k(oe,1)):(oe=zc(G),oe.c(),k(oe,1),oe.m(e,null)):oe&&(Ye(),R(oe,1,1,()=>{oe=null}),Ke()),(!A||Q[1]&32&&b!==(b="multiselect "+G[36]+" svelte-1r2hsto"))&&T(e,"class",b),(!A||Q[0]&16384|Q[1]&524288&&B!==(B=G[50]?G[14]:null))&&T(e,"title",B),(!A||Q[0]&262144)&&T(e,"data-id",G[18]),(!A||Q[1]&16384)&&T(e,"style",G[45]),(!A||Q[1]&524320)&&Fe(e,"disabled",G[50]),(!A||Q[1]&33)&&Fe(e,"single",G[31]===1),(!A||Q[0]&256|Q[1]&32)&&Fe(e,"open",G[8]),(!A||Q[0]&128|Q[1]&32)&&Fe(e,"invalid",G[7])},i(G){if(!A){k(re,G);for(let Q=0;Q<Y.length;Q+=1)k(a[Q]);k(N,G),k(W),k(S),k(oe),A=!0}},o(G){R(re,G);for(let Q=0;Q<a.length;Q+=1)R(a[Q]);R(N,G),R(W),R(S),R(oe),A=!1},d(G){G&&F(e),n[95](null),re&&re.d(G);for(let Q=0;Q<a.length;Q+=1)a[Q].d();n[100](null),N&&N.d(G),W&&W.d(),~x&&Z[x].d(),oe&&oe.d(),n[114](null),U=!1,He(E)}}}function jT(n,e,t){let r,{$$slots:i={},$$scope:s}=e,{activeIndex:o=null}=e,{activeOption:a=null}=e,{createOptionMsg:l="Create this option..."}=e,{allowUserOptions:u=!1}=e,{allowEmpty:c=!1}=e,{autocomplete:h="off"}=e,{autoScroll:d=!0}=e,{breakpoint:f=800}=e,{defaultDisabledTitle:p="This option is disabled"}=e,{disabled:g=!1}=e,{disabledInputTitle:m="This input is disabled"}=e,{duplicateOptionMsg:v="This option is already selected"}=e,{duplicates:x=!1}=e,{key:S=w=>`${it(w)}`.toLowerCase()}=e,{filterFunc:y=(w,ye)=>ye?`${it(w)}`.toLowerCase().includes(ye.toLowerCase()):!0}=e,{closeDropdownOnSelect:b="desktop"}=e,{form_input:B=null}=e,{highlightMatches:A=!0}=e,{id:U=null}=e,{input:E=null}=e,{inputClass:_=""}=e,{inputStyle:I=null}=e,{inputmode:re=null}=e,{invalid:Y=!1}=e,{liActiveOptionClass:j=""}=e,{liActiveUserMsgClass:C=""}=e,{liOptionClass:N=""}=e,{liOptionStyle:W=null}=e,{liSelectedClass:le=""}=e,{liSelectedStyle:Z=null}=e,{liUserMsgClass:D=""}=e,{loading:oe=!1}=e,{matchingOptions:G=[]}=e,{maxOptions:Q=void 0}=e,{maxSelect:he=null}=e,{maxSelectMsg:Le=(w,ye)=>ye>1?`${w}/${ye}`:""}=e,{maxSelectMsgClass:ot=""}=e,{name:Et=null}=e,{noMatchingOptionsMsg:st="No matching options"}=e,{open:_t=!1}=e,{options:Ze}=e,{outerDiv:xt=null}=e,{outerDivClass:Ut=""}=e,{parseLabelsAsHtml:Mt=!1}=e,{pattern:Xt=null}=e,{placeholder:J=null}=e,{removeAllTitle:Ne="Remove all"}=e,{removeBtnTitle:at="Remove"}=e,{minSelect:kt=null}=e,{required:yt=!1}=e,{resetFilterOnAdd:mn=!0}=e,{searchText:Ve=""}=e,{selected:be=Ze?.filter(w=>w instanceof Object&&w?.preselected).slice(0,he??void 0)??[]}=e,{sortSelected:nn=!1}=e,{selectedOptionsDraggable:Ar=!nn}=e,{style:pi=null}=e,{ulOptionsClass:mi=""}=e,{ulSelectedClass:gi=""}=e,{ulSelectedStyle:_i=null}=e,{ulOptionsStyle:vi=null}=e,{value:Wn=null}=e;const Fs=w=>{t(67,Wn=he===1?w[0]??null:w)},Os=w=>{he===1?t(5,be=w?[w]:[]):t(5,be=w??[])};let jn=!1;Ze?.length>0||(u||oe||g||c?Ze=[]:console.error("MultiSelect received no options")),he!==null&&he<1&&console.error(`MultiSelect's maxSelect must be null or positive integer, got ${he}`),Array.isArray(be)||console.error(`MultiSelect's selected prop should always be an array, got ${be}`),he&&typeof yt=="number"&&yt>he&&console.error(`MultiSelect maxSelect=${he} < required=${yt}, makes it impossible for users to submit a valid form`),Mt&&u&&console.warn("Don't combine parseLabelsAsHtml and allowUserOptions. It's susceptible to XSS attacks!"),nn&&Ar&&console.warn("MultiSelect's sortSelected and selectedOptionsDraggable should not be combined as any user re-orderings of selected options will be undone by sortSelected on component re-renders."),u&&!l&&l!==null&&console.error(`MultiSelect has allowUserOptions=${u} but createOptionMsg=${l} is falsy. This prevents the "Add option" <span> from showing up, resulting in a confusing user experience.`),Q&&(typeof Q!="number"||Q<0||Q%1!=0)&&console.error(`MultiSelect's maxOptions must be undefined or a positive integer, got ${Q}`);const Gt=li();let rn=!1,Er;if(o!==null&&!G[o])throw`Run time error, activeIndex=${o} is out of bounds, matchingOptions.length=${G.length}`;function Tn(w,ye){he&&he>1&&be.length>=he&&t(51,jn=!0),!isNaN(Number(w))&&typeof be.map(it)[0]=="number"&&(w=Number(w));const qe=be.map(S).includes(S(w));if((he===null||he===1||be.length<he)&&(x||!qe)){if(!Ze.includes(w)&&[!0,"append"].includes(u)&&Ve.length>0&&(typeof Ze[0]=="object"?w={label:Ve}:(["number","undefined"].includes(typeof Ze[0])&&!isNaN(Number(Ve))?w=Number(Ve):w=Ve,Gt("create",{option:w})),u==="append"&&t(3,Ze=[...Ze,w])),mn&&t(4,Ve=""),["",void 0,null].includes(w)){console.error(`MultiSelect: encountered falsy option ${w}`);return}he===1?t(5,be=[w]):(t(5,be=[...be,w]),nn===!0?t(5,be=be.sort((Vs,Pn)=>{const[Rr,Ci]=[it(Vs),it(Pn)];return`${Rr}`.localeCompare(`${Ci}`)})):typeof nn=="function"&&t(5,be=be.sort(nn)));const lt=be.length===he,Xn=b===!0||b==="desktop"&&Er<f;lt||Xn?Mr(ye):Xn||E?.focus(),Gt("add",{option:w}),Gt("change",{option:w,type:"add"}),t(7,Y=!1),B?.setCustomValidity("")}}function Cn(w){if(be.length===0)return;const ye=be.findIndex(lt=>S(lt)===S(w));let[qe]=be.splice(ye,1);if(qe===void 0&&u&&(qe=typeof Ze[0]?{label:w}:w),qe===void 0)return console.error(`Multiselect can't remove selected option ${JSON.stringify(w)}, not found in selected list`);t(5,be=[...be]),t(7,Y=!1),B?.setCustomValidity(""),Gt("remove",{option:qe}),Gt("change",{option:qe,type:"remove"})}function bi(w){g||(t(8,_t=!0),w instanceof FocusEvent||E?.focus(),Gt("open",{event:w}))}function Mr(w){t(8,_t=!1),E?.blur(),t(0,o=null),Gt("close",{event:w})}async function Us(w){if(w.key==="Escape"||w.key==="Tab")Mr(w),t(4,Ve="");else if(w.key==="Enter")w.preventDefault(),a?(be.includes(a)?Cn(a):Tn(a,w),t(4,Ve="")):u&&Ve.length>0?Tn(Ve,w):bi(w);else if(["ArrowDown","ArrowUp"].includes(w.key)){if(o===null&&G.length>0){t(0,o=0);return}else if(u&&!G.length&&Ve.length>0){t(52,rn=!rn);return}else if(o===null)return;w.preventDefault();const ye=w.key==="ArrowUp"?-1:1;if(t(0,o=(o+ye)%G.length),o<0&&t(0,o=G.length-1),d){await nh();const qe=document.querySelector("ul.options > li.active");qe&&qe.scrollIntoViewIfNeeded?.()}}else w.key==="Backspace"&&be.length>0&&!Ve?Cn(be.at(-1)):G.length>0&&t(0,o=0)}function Gs(){Gt("removeAll",{options:be}),Gt("change",{options:be,type:"removeAll"}),t(5,be=[]),t(4,Ve="")}const Ds=w=>ye=>{["Enter","Space"].includes(ye.code)&&(ye.preventDefault(),w())};function zs(w){xt&&!xt.contains(w.target)&&Mr(w)}let kr=null;const Ls=w=>ye=>{if(!ye.dataTransfer)return;ye.dataTransfer.dropEffect="move";const qe=parseInt(ye.dataTransfer.getData("text/plain")),lt=[...be];qe<w?(lt.splice(w+1,0,lt[qe]),lt.splice(qe,1)):(lt.splice(w,0,lt[qe]),lt.splice(qe+1,1)),t(5,be=lt),t(54,kr=null)},Ns=w=>ye=>{ye.dataTransfer&&(ye.dataTransfer.effectAllowed="move",ye.dataTransfer.dropEffect="move",ye.dataTransfer.setData("text/plain",`${w}`))};let P;function xi(w){if(!A||typeof CSS>"u"||!CSS.highlights)return;CSS.highlights.clear();const ye=w?.target?.value.trim().toLowerCase();if(!ye)return;const qe=document.createTreeWalker(P,NodeFilter.SHOW_TEXT,{acceptNode:Pn=>Pn?.textContent===st?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}),lt=[];let Xn=qe.nextNode();for(;Xn;)lt.push(Xn),Xn=qe.nextNode();const Vs=lt.map(Pn=>{const Rr=Pn.textContent?.toLowerCase(),Ci=[];let Ws=0;for(;Rr&&Ws<Rr.length;){const qn=Rr.indexOf(ye,Ws);if(qn===-1)break;Ci.push(qn),Ws=qn+ye.length}return Ci.map(qn=>{const js=new Range;return js.setStart(Pn,qn),js.setEnd(Pn,qn+ye.length),js})});CSS.highlights.set("sms-search-matches",new Highlight(...Vs.flat()))}function yi(w){Be.call(this,n,w)}function Si(w){Be.call(this,n,w)}function Hs(w){Be.call(this,n,w)}function wi(w){Be.call(this,n,w)}function Ti(w){Be.call(this,n,w)}function Am(w){Be.call(this,n,w)}function Em(w){Be.call(this,n,w)}function Mm(w){Be.call(this,n,w)}function km(w){Be.call(this,n,w)}function Rm(w){Be.call(this,n,w)}function Bm(w){Be.call(this,n,w)}function Im(w){Be.call(this,n,w)}function Fm(w){Be.call(this,n,w)}function Om(w){Be.call(this,n,w)}function Um(w){Be.call(this,n,w)}function Gm(w){Be.call(this,n,w)}function Dm(){t(53,Er=window.innerWidth)}function zm(w){q[w?"unshift":"push"](()=>{B=w,t(1,B)})}const Lm=()=>{t(7,Y=!0);let w;he&&he>1&&Number(yt)>1?w=`Please select between ${yt} and ${he} options`:Number(yt)>1?w=`Please select at least ${yt} options`:w="Please select an option",B?.setCustomValidity(w)},Nm=w=>Cn(w),Hm=w=>Cn(w),Vm=w=>t(54,kr=w);function Wm(w){q[w?"unshift":"push"](()=>{E=w,t(6,E)})}function jm(){Ve=this.value,t(4,Ve)}function Xm(w){jn=w,t(51,jn)}const qm=(w,ye,qe)=>{w||Tn(ye,qe)},Ym=(w,ye)=>{w||t(0,o=ye)},Km=(w,ye)=>{w||t(0,o=ye)},Zm=()=>t(0,o=null),Qm=()=>t(0,o=null),Jm=w=>{u&&Tn(Ve,w)},$m=()=>t(52,rn=!0),eg=()=>t(52,rn=!0),tg=()=>t(52,rn=!1),ng=()=>t(52,rn=!1);function rg(w){q[w?"unshift":"push"](()=>{P=w,t(55,P)})}function ig(w){q[w?"unshift":"push"](()=>{xt=w,t(9,xt)})}return n.$$set=w=>{"activeIndex"in w&&t(0,o=w.activeIndex),"activeOption"in w&&t(68,a=w.activeOption),"createOptionMsg"in w&&t(10,l=w.createOptionMsg),"allowUserOptions"in w&&t(11,u=w.allowUserOptions),"allowEmpty"in w&&t(69,c=w.allowEmpty),"autocomplete"in w&&t(12,h=w.autocomplete),"autoScroll"in w&&t(70,d=w.autoScroll),"breakpoint"in w&&t(71,f=w.breakpoint),"defaultDisabledTitle"in w&&t(13,p=w.defaultDisabledTitle),"disabled"in w&&t(50,g=w.disabled),"disabledInputTitle"in w&&t(14,m=w.disabledInputTitle),"duplicateOptionMsg"in w&&t(15,v=w.duplicateOptionMsg),"duplicates"in w&&t(16,x=w.duplicates),"key"in w&&t(17,S=w.key),"filterFunc"in w&&t(72,y=w.filterFunc),"closeDropdownOnSelect"in w&&t(73,b=w.closeDropdownOnSelect),"form_input"in w&&t(1,B=w.form_input),"highlightMatches"in w&&t(74,A=w.highlightMatches),"id"in w&&t(18,U=w.id),"input"in w&&t(6,E=w.input),"inputClass"in w&&t(19,_=w.inputClass),"inputStyle"in w&&t(20,I=w.inputStyle),"inputmode"in w&&t(21,re=w.inputmode),"invalid"in w&&t(7,Y=w.invalid),"liActiveOptionClass"in w&&t(22,j=w.liActiveOptionClass),"liActiveUserMsgClass"in w&&t(23,C=w.liActiveUserMsgClass),"liOptionClass"in w&&t(24,N=w.liOptionClass),"liOptionStyle"in w&&t(25,W=w.liOptionStyle),"liSelectedClass"in w&&t(26,le=w.liSelectedClass),"liSelectedStyle"in w&&t(27,Z=w.liSelectedStyle),"liUserMsgClass"in w&&t(28,D=w.liUserMsgClass),"loading"in w&&t(29,oe=w.loading),"matchingOptions"in w&&t(2,G=w.matchingOptions),"maxOptions"in w&&t(30,Q=w.maxOptions),"maxSelect"in w&&t(31,he=w.maxSelect),"maxSelectMsg"in w&&t(32,Le=w.maxSelectMsg),"maxSelectMsgClass"in w&&t(33,ot=w.maxSelectMsgClass),"name"in w&&t(34,Et=w.name),"noMatchingOptionsMsg"in w&&t(35,st=w.noMatchingOptionsMsg),"open"in w&&t(8,_t=w.open),"options"in w&&t(3,Ze=w.options),"outerDiv"in w&&t(9,xt=w.outerDiv),"outerDivClass"in w&&t(36,Ut=w.outerDivClass),"parseLabelsAsHtml"in w&&t(37,Mt=w.parseLabelsAsHtml),"pattern"in w&&t(38,Xt=w.pattern),"placeholder"in w&&t(39,J=w.placeholder),"removeAllTitle"in w&&t(40,Ne=w.removeAllTitle),"removeBtnTitle"in w&&t(41,at=w.removeBtnTitle),"minSelect"in w&&t(42,kt=w.minSelect),"required"in w&&t(43,yt=w.required),"resetFilterOnAdd"in w&&t(75,mn=w.resetFilterOnAdd),"searchText"in w&&t(4,Ve=w.searchText),"selected"in w&&t(5,be=w.selected),"sortSelected"in w&&t(76,nn=w.sortSelected),"selectedOptionsDraggable"in w&&t(44,Ar=w.selectedOptionsDraggable),"style"in w&&t(45,pi=w.style),"ulOptionsClass"in w&&t(46,mi=w.ulOptionsClass),"ulSelectedClass"in w&&t(47,gi=w.ulSelectedClass),"ulSelectedStyle"in w&&t(48,_i=w.ulSelectedStyle),"ulOptionsStyle"in w&&t(49,vi=w.ulOptionsStyle),"value"in w&&t(67,Wn=w.value),"$$scope"in w&&t(115,s=w.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&32&&Fs(be),n.$$.dirty[2]&32&&Os(Wn),n.$$.dirty[0]&196664|n.$$.dirty[2]&1024&&t(2,G=Ze.filter(w=>y(w,Ve)&&(!be.map(S).includes(S(w))||x))),n.$$.dirty[0]&5&&t(68,a=G[o??-1]??null),n.$$.dirty[0]&32&&t(56,r=w=>be.map(it).includes(w)),n.$$.dirty[0]&2|n.$$.dirty[1]&4096&&B?.setCustomValidity("")},[o,B,G,Ze,Ve,be,E,Y,_t,xt,l,u,h,p,m,v,x,S,U,_,I,re,j,C,N,W,le,Z,D,oe,Q,he,Le,ot,Et,st,Ut,Mt,Xt,J,Ne,at,kt,yt,Ar,pi,mi,gi,_i,vi,g,jn,rn,Er,kr,P,r,Tn,Cn,bi,Us,Gs,Ds,zs,Ls,Ns,xi,Wn,a,c,d,f,y,b,A,mn,nn,i,yi,Si,Hs,wi,Ti,Am,Em,Mm,km,Rm,Bm,Im,Fm,Om,Um,Gm,Dm,zm,Lm,Nm,Hm,Vm,Wm,jm,Xm,qm,Ym,Km,Zm,Qm,Jm,$m,eg,tg,ng,rg,ig,s]}class XT extends ze{constructor(e){super(),De(this,e,jT,WT,Ue,{activeIndex:0,activeOption:68,createOptionMsg:10,allowUserOptions:11,allowEmpty:69,autocomplete:12,autoScroll:70,breakpoint:71,defaultDisabledTitle:13,disabled:50,disabledInputTitle:14,duplicateOptionMsg:15,duplicates:16,key:17,filterFunc:72,closeDropdownOnSelect:73,form_input:1,highlightMatches:74,id:18,input:6,inputClass:19,inputStyle:20,inputmode:21,invalid:7,liActiveOptionClass:22,liActiveUserMsgClass:23,liOptionClass:24,liOptionStyle:25,liSelectedClass:26,liSelectedStyle:27,liUserMsgClass:28,loading:29,matchingOptions:2,maxOptions:30,maxSelect:31,maxSelectMsg:32,maxSelectMsgClass:33,name:34,noMatchingOptionsMsg:35,open:8,options:3,outerDiv:9,outerDivClass:36,parseLabelsAsHtml:37,pattern:38,placeholder:39,removeAllTitle:40,removeBtnTitle:41,minSelect:42,required:43,resetFilterOnAdd:75,searchText:4,selected:5,sortSelected:76,selectedOptionsDraggable:44,style:45,ulOptionsClass:46,ulSelectedClass:47,ulSelectedStyle:48,ulOptionsStyle:49,value:67},null,[-1,-1,-1,-1,-1])}}function qT(n=!0){const e=this,t=new IntersectionObserver(function([r]){const i=r.intersectionRatio;if(i<1){const s=i<=0&&n?"center":"nearest";e.scrollIntoView({block:s,inline:s})}this.disconnect()});return t.observe(e),t}typeof Element<"u"&&!Element.prototype?.scrollIntoViewIfNeeded&&typeof IntersectionObserver<"u"&&(Element.prototype.scrollIntoViewIfNeeded=qT);const YT="https://gql.twitch.tv/gql",KT="kimne78kx3ncx6brgo4mv6wki5h1ko";async function ZT(n,e="285x380"){return(await QT(n.map(s=>$T.SearchResultsPage_SearchResults(s)))).map(s=>eC.SearchResultsPage_SearchResults(s)).map((s,o)=>{if(!s||s.length===0)return[{name:"Nothing found",cover:"https://static-cdn.jtvnw.net/ttv-static/404_boxart.jpg",tags:[]}];const a=s.findIndex(l=>l.name.toLowerCase()===n[o].toLowerCase());if(a){const l=s.splice(a,1)[0];s.unshift(l)}return s.forEach(l=>{l&&(l.cover=l?.cover?l.cover.replace("90x120",e):"https://static-cdn.jtvnw.net/ttv-static/404_boxart.jpg")}),s})}async function QT(n){return await(await fetch(YT,{headers:{"Client-Id":KT},method:"POST",body:JSON.stringify(n)})).json()}const JT=(n,e=1)=>({extensions:{persistedQuery:{version:e,sha256Hash:n}}}),$T={SearchResultsPage_SearchResults:n=>({operationName:"SearchResultsPage_SearchResults",variables:{query:n,options:null,requestID:crypto.randomUUID()},...JT("6ea6e6f66006485e41dbe3ebd69d5674c5b22896ce7b595d7fce6411a3790138")})},eC={SearchResultsPage_SearchResults:n=>{const e=n.data.searchFor?.games?.edges;return e?e?.map(r=>({name:r.item.name,cover:r.item.boxArtURL,tags:r.item.tags.map(i=>i.tagName)})):[]}};function tC(n){let e,t,r,i,s,o,a;function l(f){n[9](f)}function u(f){n[10](f)}function c(f){n[11](f)}function h(f){n[12](f)}let d={closeDropdownOnSelect:!0,allowUserOptions:!0,createOptionMsg:null,placeholder:"",filterFunc:rC,loading:n[3]};return n[4]!==void 0&&(d.form_input=n[4]),n[1]!==void 0&&(d.selected=n[1]),n[0]!==void 0&&(d.searchText=n[0]),n[2]!==void 0&&(d.options=n[2]),e=new XT({props:d}),q.push(()=>$(e,"form_input",l)),q.push(()=>$(e,"selected",u)),q.push(()=>$(e,"searchText",c)),q.push(()=>$(e,"options",h)),e.$on("add",n[5]),e.$on("remove",n[6]),e.$on("removeAll",n[7]),{c(){t=ne("div"),H(e.$$.fragment),ve(t,"display","contents"),ve(t,"--sms-bg","var(--bg-light)"),ve(t,"--sms-options-bg","var(--bg-light-extra)"),ve(t,"--sms-border","2px solid var(--bg-light)"),ve(t,"--sms-focus-border","2px solid var(--violet)"),ve(t,"--sms-placeholder-color","var(--text-2)"),ve(t,"--sms-placeholder-opacity","0.5"),ve(t,"--sms-remove-btn-hover-color","var(--violet)"),ve(t,"--sms-min-height","33px")},m(f,p){O(f,t,p),z(e,t,null),a=!0},p(f,[p]){const g={};p&8&&(g.loading=f[3]),!r&&p&16&&(r=!0,g.form_input=f[4],ee(()=>r=!1)),!i&&p&2&&(i=!0,g.selected=f[1],ee(()=>i=!1)),!s&&p&1&&(s=!0,g.searchText=f[0],ee(()=>s=!1)),!o&&p&4&&(o=!0,g.options=f[2],ee(()=>o=!1)),e.$set(g)},i(f){a||(k(e.$$.fragment,f),a=!0)},o(f){R(e.$$.fragment,f),a=!1},d(f){f&&e&&F(t),L(e,f)}}}const nC=500,rC=()=>!0;function iC(n,e,t){let r;fr(n,K,A=>t(17,r=A));let{tabindex:i=void 0}=e,s=["Just Chatting"],o=[],a="",l=!1,u=null,c=[],h=[{name:"Just Chatting",cover:hh,tags:["Just Chatting"]}],d="",f=null;async function p(A){const U=c.find(E=>E.name===A.detail.option.trim());U&&(h.push(U),t(2,o=[]),Ie(K,r.categories.src=await Promise.all(h.map(E=>E.cover)),r))}async function g(A){const U=h.findIndex(E=>E.name===A.detail.option);U>-1&&(h.splice(U,1),Ie(K,r.categories.src=await Promise.all(h.map(E=>E.cover)),r))}function m(){h=[],Ie(K,r.categories.src=[],r)}async function v(){if(a===d||a==="")return;t(3,l=!0),d=a;const A=await ZT([a]);c=A[0],t(2,o=A[0].map(U=>U.name)),t(3,l=!1)}async function x(){!a||a.length<3||(f&&clearTimeout(f),f=setTimeout(async()=>await v(),nC))}$c(()=>{u&&t(4,u.tabIndex=i,u)});function S(A){u=A,t(4,u)}function y(A){s=A,t(1,s)}function b(A){a=A,t(0,a)}function B(A){o=A,t(2,o)}return n.$$set=A=>{"tabindex"in A&&t(8,i=A.tabindex)},n.$$.update=()=>{n.$$.dirty&1&&a&&x()},[a,s,o,l,u,p,g,m,i,S,y,b,B]}class sC extends ze{constructor(e){super(),De(this,e,iC,tC,Ue,{tabindex:8})}}function oC(n){let e,t,r,i,s,o,a,l,u,c;return{c(){e=ne("div"),t=ne("div"),r=rt(n[1]),i=V(),s=ne("div"),o=ne("input"),a=V(),l=ne("label"),T(t,"class","label svelte-1dl1v59"),T(o,"id",n[3]),T(o,"type","checkbox"),T(o,"class","svelte-1dl1v59"),T(l,"for",n[3]),T(l,"class","svelte-1dl1v59"),T(s,"class","switch svelte-1dl1v59"),T(e,"class","container svelte-1dl1v59"),T(e,"style",n[2])},m(h,d){O(h,e,d),te(e,t),te(t,r),te(e,i),te(e,s),te(s,o),o.checked=n[0],te(s,a),te(s,l),u||(c=X(o,"change",n[4]),u=!0)},p(h,[d]){d&2&&ht(r,h[1]),d&1&&(o.checked=h[0]),d&4&&T(e,"style",h[2])},i:ce,o:ce,d(h){h&&F(e),u=!1,c()}}}let aC=0;function lC(n,e,t){let{label:r=""}=e,{checked:i=!1}=e,{style:s=void 0}=e,o="input_toggle_"+aC++;function a(){i=this.checked,t(0,i)}return n.$$set=l=>{"label"in l&&t(1,r=l.label),"checked"in l&&t(0,i=l.checked),"style"in l&&t(2,s=l.style)},[i,r,s,o,a]}class Sn extends ze{constructor(e){super(),De(this,e,lC,oC,Ue,{label:1,checked:0,style:2})}}function uC(n){let e,t,r,i;function s(l){n[8](l)}function o(l){n[9](l)}let a={placeholder:"   "};return n[1].background!==void 0&&(a.value=n[1].background),n[1].background_cl!==void 0&&(a.cl=n[1].background_cl),e=new mr({props:a}),q.push(()=>$(e,"value",s)),q.push(()=>$(e,"cl",o)),e.$on("change",n[4]),{c(){H(e.$$.fragment)},m(l,u){z(e,l,u),i=!0},p(l,u){const c={};!t&&u[0]&2&&(t=!0,c.value=l[1].background,ee(()=>t=!1)),!r&&u[0]&2&&(r=!0,c.cl=l[1].background_cl,ee(()=>r=!1)),e.$set(c)},i(l){i||(k(e.$$.fragment,l),i=!0)},o(l){R(e.$$.fragment,l),i=!1},d(l){L(e,l)}}}function cC(n){let e,t,r,i,s,o,a,l,u,c,h,d,f,p,g,m,v,x;function S(C){n[10](C)}let y={label:"x"};n[0].background.x!==void 0&&(y.value=n[0].background.x),e=new fe({props:y}),q.push(()=>$(e,"value",S));function b(C){n[11](C)}let B={label:"y"};n[0].background.y!==void 0&&(B.value=n[0].background.y),i=new fe({props:B}),q.push(()=>$(i,"value",b));function A(C){n[12](C)}let U={label:"w"};n[0].background.w!==void 0&&(U.value=n[0].background.w),a=new fe({props:U}),q.push(()=>$(a,"value",A));function E(C){n[13](C)}let _={label:"h"};n[0].background.h!==void 0&&(_.value=n[0].background.h),c=new fe({props:_}),q.push(()=>$(c,"value",E));function I(C){n[14](C)}let re={label:"flip h"};n[0].background.flip_h!==void 0&&(re.checked=n[0].background.flip_h),f=new Sn({props:re}),q.push(()=>$(f,"checked",I));function Y(C){n[15](C)}let j={label:"flip v"};return n[0].background.flip_v!==void 0&&(j.checked=n[0].background.flip_v),m=new Sn({props:j}),q.push(()=>$(m,"checked",Y)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment),d=V(),H(f.$$.fragment),g=V(),H(m.$$.fragment)},m(C,N){z(e,C,N),O(C,r,N),z(i,C,N),O(C,o,N),z(a,C,N),O(C,u,N),z(c,C,N),O(C,d,N),z(f,C,N),O(C,g,N),z(m,C,N),x=!0},p(C,N){const W={};!t&&N[0]&1&&(t=!0,W.value=C[0].background.x,ee(()=>t=!1)),e.$set(W);const le={};!s&&N[0]&1&&(s=!0,le.value=C[0].background.y,ee(()=>s=!1)),i.$set(le);const Z={};!l&&N[0]&1&&(l=!0,Z.value=C[0].background.w,ee(()=>l=!1)),a.$set(Z);const D={};!h&&N[0]&1&&(h=!0,D.value=C[0].background.h,ee(()=>h=!1)),c.$set(D);const oe={};!p&&N[0]&1&&(p=!0,oe.checked=C[0].background.flip_h,ee(()=>p=!1)),f.$set(oe);const G={};!v&&N[0]&1&&(v=!0,G.checked=C[0].background.flip_v,ee(()=>v=!1)),m.$set(G)},i(C){x||(k(e.$$.fragment,C),k(i.$$.fragment,C),k(a.$$.fragment,C),k(c.$$.fragment,C),k(f.$$.fragment,C),k(m.$$.fragment,C),x=!0)},o(C){R(e.$$.fragment,C),R(i.$$.fragment,C),R(a.$$.fragment,C),R(c.$$.fragment,C),R(f.$$.fragment,C),R(m.$$.fragment,C),x=!1},d(C){C&&(F(r),F(o),F(u),F(d),F(g)),L(e,C),L(i,C),L(a,C),L(c,C),L(f,C),L(m,C)}}}function hC(n){let e,t,r,i;return e=new Qe({props:{$$slots:{default:[uC]},$$scope:{ctx:n}}}),r=new Qe({props:{$$slots:{default:[cC]},$$scope:{ctx:n}}}),{c(){H(e.$$.fragment),t=V(),H(r.$$.fragment)},m(s,o){z(e,s,o),O(s,t,o),z(r,s,o),i=!0},p(s,o){const a={};o[0]&2|o[2]&524288&&(a.$$scope={dirty:o,ctx:s}),e.$set(a);const l={};o[0]&1|o[2]&524288&&(l.$$scope={dirty:o,ctx:s}),r.$set(l)},i(s){i||(k(e.$$.fragment,s),k(r.$$.fragment,s),i=!0)},o(s){R(e.$$.fragment,s),R(r.$$.fragment,s),i=!1},d(s){s&&F(t),L(e,s),L(r,s)}}}function fC(n){let e,t,r;function i(o){n[16](o)}let s={placeholder:"   "};return n[1].logo!==void 0&&(s.value=n[1].logo),e=new mr({props:s}),q.push(()=>$(e,"value",i)),e.$on("change",n[5]),{c(){H(e.$$.fragment)},m(o,a){z(e,o,a),r=!0},p(o,a){const l={};!t&&a[0]&2&&(t=!0,l.value=o[1].logo,ee(()=>t=!1)),e.$set(l)},i(o){r||(k(e.$$.fragment,o),r=!0)},o(o){R(e.$$.fragment,o),r=!1},d(o){L(e,o)}}}function dC(n){let e,t,r,i,s,o,a,l,u,c,h,d,f,p,g;function m(_){n[17](_)}let v={label:"x"};n[0].logo.x!==void 0&&(v.value=n[0].logo.x),e=new fe({props:v}),q.push(()=>$(e,"value",m));function x(_){n[18](_)}let S={label:"y"};n[0].logo.y!==void 0&&(S.value=n[0].logo.y),i=new fe({props:S}),q.push(()=>$(i,"value",x));function y(_){n[19](_)}let b={label:"w"};n[0].logo.w!==void 0&&(b.value=n[0].logo.w),a=new fe({props:b}),q.push(()=>$(a,"value",y));function B(_){n[20](_)}let A={label:"h"};n[0].logo.h!==void 0&&(A.value=n[0].logo.h),c=new fe({props:A}),q.push(()=>$(c,"value",B));function U(_){n[21](_)}let E={label:"blur",step:.1,min:0};return n[0].logo.blur!==void 0&&(E.value=n[0].logo.blur),f=new fe({props:E}),q.push(()=>$(f,"value",U)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment),d=V(),H(f.$$.fragment)},m(_,I){z(e,_,I),O(_,r,I),z(i,_,I),O(_,o,I),z(a,_,I),O(_,u,I),z(c,_,I),O(_,d,I),z(f,_,I),g=!0},p(_,I){const re={};!t&&I[0]&1&&(t=!0,re.value=_[0].logo.x,ee(()=>t=!1)),e.$set(re);const Y={};!s&&I[0]&1&&(s=!0,Y.value=_[0].logo.y,ee(()=>s=!1)),i.$set(Y);const j={};!l&&I[0]&1&&(l=!0,j.value=_[0].logo.w,ee(()=>l=!1)),a.$set(j);const C={};!h&&I[0]&1&&(h=!0,C.value=_[0].logo.h,ee(()=>h=!1)),c.$set(C);const N={};!p&&I[0]&1&&(p=!0,N.value=_[0].logo.blur,ee(()=>p=!1)),f.$set(N)},i(_){g||(k(e.$$.fragment,_),k(i.$$.fragment,_),k(a.$$.fragment,_),k(c.$$.fragment,_),k(f.$$.fragment,_),g=!0)},o(_){R(e.$$.fragment,_),R(i.$$.fragment,_),R(a.$$.fragment,_),R(c.$$.fragment,_),R(f.$$.fragment,_),g=!1},d(_){_&&(F(r),F(o),F(u),F(d)),L(e,_),L(i,_),L(a,_),L(c,_),L(f,_)}}}function pC(n){let e,t,r,i;return e=new Qe({props:{$$slots:{default:[fC]},$$scope:{ctx:n}}}),r=new Qe({props:{$$slots:{default:[dC]},$$scope:{ctx:n}}}),{c(){H(e.$$.fragment),t=V(),H(r.$$.fragment)},m(s,o){z(e,s,o),O(s,t,o),z(r,s,o),i=!0},p(s,o){const a={};o[0]&2|o[2]&524288&&(a.$$scope={dirty:o,ctx:s}),e.$set(a);const l={};o[0]&1|o[2]&524288&&(l.$$scope={dirty:o,ctx:s}),r.$set(l)},i(s){i||(k(e.$$.fragment,s),k(r.$$.fragment,s),i=!0)},o(s){R(e.$$.fragment,s),R(r.$$.fragment,s),i=!1},d(s){s&&F(t),L(e,s),L(r,s)}}}function mC(n){let e,t,r,i,s,o,a,l,u,c;function h(g){n[22](g)}let d={style:Pr,label:"blur"};n[0].filter.blur.enabled!==void 0&&(d.checked=n[0].filter.blur.enabled),e=new Sn({props:d}),q.push(()=>$(e,"checked",h));function f(g){n[23](g)}let p={label:"value",step:.1,min:0};return n[0].filter.blur.value!==void 0&&(p.value=n[0].filter.blur.value),i=new fe({props:p}),q.push(()=>$(i,"value",f)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),a=ne("button"),a.textContent="",T(a,"class","reset_filters svelte-1r8uhpl"),T(a,"title"," ")},m(g,m){z(e,g,m),O(g,r,m),z(i,g,m),O(g,o,m),O(g,a,m),l=!0,u||(c=X(a,"click",n[6]),u=!0)},p(g,m){const v={};!t&&m[0]&1&&(t=!0,v.checked=g[0].filter.blur.enabled,ee(()=>t=!1)),e.$set(v);const x={};!s&&m[0]&1&&(s=!0,x.value=g[0].filter.blur.value,ee(()=>s=!1)),i.$set(x)},i(g){l||(k(e.$$.fragment,g),k(i.$$.fragment,g),l=!0)},o(g){R(e.$$.fragment,g),R(i.$$.fragment,g),l=!1},d(g){g&&(F(r),F(o),F(a)),L(e,g),L(i,g),u=!1,c()}}}function gC(n){let e,t,r,i,s,o,a,l,u,c,h,d,f,p,g,m,v,x,S,y,b;function B(D){n[24](D)}let A={style:Pr,label:"gradient"};n[0].filter.gradient.enabled!==void 0&&(A.checked=n[0].filter.gradient.enabled),e=new Sn({props:A}),q.push(()=>$(e,"checked",B));function U(D){n[25](D)}let E={label:"start",step:.01,min:0,max:1};n[0].filter.gradient.start.value!==void 0&&(E.value=n[0].filter.gradient.start.value),i=new fe({props:E}),q.push(()=>$(i,"value",U));function _(D){n[26](D)}let I={};n[0].filter.gradient.start.color!==void 0&&(I.hex=n[0].filter.gradient.start.color),a=new bn({props:I}),q.push(()=>$(a,"hex",_));function re(D){n[27](D)}let Y={label:"mid",step:.01,min:0,max:1};n[0].filter.gradient.mid.value!==void 0&&(Y.value=n[0].filter.gradient.mid.value),c=new fe({props:Y}),q.push(()=>$(c,"value",re));function j(D){n[28](D)}let C={};n[0].filter.gradient.mid.color!==void 0&&(C.hex=n[0].filter.gradient.mid.color),f=new bn({props:C}),q.push(()=>$(f,"hex",j));function N(D){n[29](D)}let W={label:"end",step:.01,min:0,max:1};n[0].filter.gradient.end.value!==void 0&&(W.value=n[0].filter.gradient.end.value),m=new fe({props:W}),q.push(()=>$(m,"value",N));function le(D){n[30](D)}let Z={};return n[0].filter.gradient.end.color!==void 0&&(Z.hex=n[0].filter.gradient.end.color),S=new bn({props:Z}),q.push(()=>$(S,"hex",le)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment),d=V(),H(f.$$.fragment),g=V(),H(m.$$.fragment),x=V(),H(S.$$.fragment)},m(D,oe){z(e,D,oe),O(D,r,oe),z(i,D,oe),O(D,o,oe),z(a,D,oe),O(D,u,oe),z(c,D,oe),O(D,d,oe),z(f,D,oe),O(D,g,oe),z(m,D,oe),O(D,x,oe),z(S,D,oe),b=!0},p(D,oe){const G={};!t&&oe[0]&1&&(t=!0,G.checked=D[0].filter.gradient.enabled,ee(()=>t=!1)),e.$set(G);const Q={};!s&&oe[0]&1&&(s=!0,Q.value=D[0].filter.gradient.start.value,ee(()=>s=!1)),i.$set(Q);const he={};!l&&oe[0]&1&&(l=!0,he.hex=D[0].filter.gradient.start.color,ee(()=>l=!1)),a.$set(he);const Le={};!h&&oe[0]&1&&(h=!0,Le.value=D[0].filter.gradient.mid.value,ee(()=>h=!1)),c.$set(Le);const ot={};!p&&oe[0]&1&&(p=!0,ot.hex=D[0].filter.gradient.mid.color,ee(()=>p=!1)),f.$set(ot);const Et={};!v&&oe[0]&1&&(v=!0,Et.value=D[0].filter.gradient.end.value,ee(()=>v=!1)),m.$set(Et);const st={};!y&&oe[0]&1&&(y=!0,st.hex=D[0].filter.gradient.end.color,ee(()=>y=!1)),S.$set(st)},i(D){b||(k(e.$$.fragment,D),k(i.$$.fragment,D),k(a.$$.fragment,D),k(c.$$.fragment,D),k(f.$$.fragment,D),k(m.$$.fragment,D),k(S.$$.fragment,D),b=!0)},o(D){R(e.$$.fragment,D),R(i.$$.fragment,D),R(a.$$.fragment,D),R(c.$$.fragment,D),R(f.$$.fragment,D),R(m.$$.fragment,D),R(S.$$.fragment,D),b=!1},d(D){D&&(F(r),F(o),F(u),F(d),F(g),F(x)),L(e,D),L(i,D),L(a,D),L(c,D),L(f,D),L(m,D),L(S,D)}}}function _C(n){let e,t,r,i,s,o,a,l,u,c,h,d,f,p,g,m,v,x;function S(C){n[31](C)}let y={style:Pr,label:"tilt-shift"};n[0].filter.tilt_shift.enabled!==void 0&&(y.checked=n[0].filter.tilt_shift.enabled),e=new Sn({props:y}),q.push(()=>$(e,"checked",S));function b(C){n[32](C)}let B={label:"x1"};n[0].filter.tilt_shift.start.x!==void 0&&(B.value=n[0].filter.tilt_shift.start.x),i=new fe({props:B}),q.push(()=>$(i,"value",b));function A(C){n[33](C)}let U={label:"y1"};n[0].filter.tilt_shift.start.y!==void 0&&(U.value=n[0].filter.tilt_shift.start.y),a=new fe({props:U}),q.push(()=>$(a,"value",A));function E(C){n[34](C)}let _={label:"x2"};n[0].filter.tilt_shift.end.x!==void 0&&(_.value=n[0].filter.tilt_shift.end.x),c=new fe({props:_}),q.push(()=>$(c,"value",E));function I(C){n[35](C)}let re={label:"y2"};n[0].filter.tilt_shift.end.y!==void 0&&(re.value=n[0].filter.tilt_shift.end.y),f=new fe({props:re}),q.push(()=>$(f,"value",I));function Y(C){n[36](C)}let j={label:"blur",step:.1,min:0};return n[0].filter.tilt_shift.blur!==void 0&&(j.value=n[0].filter.tilt_shift.blur),m=new fe({props:j}),q.push(()=>$(m,"value",Y)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment),d=V(),H(f.$$.fragment),g=V(),H(m.$$.fragment)},m(C,N){z(e,C,N),O(C,r,N),z(i,C,N),O(C,o,N),z(a,C,N),O(C,u,N),z(c,C,N),O(C,d,N),z(f,C,N),O(C,g,N),z(m,C,N),x=!0},p(C,N){const W={};!t&&N[0]&1&&(t=!0,W.checked=C[0].filter.tilt_shift.enabled,ee(()=>t=!1)),e.$set(W);const le={};!s&&N[0]&1&&(s=!0,le.value=C[0].filter.tilt_shift.start.x,ee(()=>s=!1)),i.$set(le);const Z={};!l&&N[0]&1&&(l=!0,Z.value=C[0].filter.tilt_shift.start.y,ee(()=>l=!1)),a.$set(Z);const D={};!h&&N[0]&1&&(h=!0,D.value=C[0].filter.tilt_shift.end.x,ee(()=>h=!1)),c.$set(D);const oe={};!p&&N[0]&1&&(p=!0,oe.value=C[0].filter.tilt_shift.end.y,ee(()=>p=!1)),f.$set(oe);const G={};!v&&N[0]&1&&(v=!0,G.value=C[0].filter.tilt_shift.blur,ee(()=>v=!1)),m.$set(G)},i(C){x||(k(e.$$.fragment,C),k(i.$$.fragment,C),k(a.$$.fragment,C),k(c.$$.fragment,C),k(f.$$.fragment,C),k(m.$$.fragment,C),x=!0)},o(C){R(e.$$.fragment,C),R(i.$$.fragment,C),R(a.$$.fragment,C),R(c.$$.fragment,C),R(f.$$.fragment,C),R(m.$$.fragment,C),x=!1},d(C){C&&(F(r),F(o),F(u),F(d),F(g)),L(e,C),L(i,C),L(a,C),L(c,C),L(f,C),L(m,C)}}}function vC(n){let e,t,r,i,s,o,a,l,u,c,h,d,f,p,g;function m(_){n[37](_)}let v={style:Pr,label:"zoomblur"};n[0].filter.zoom_blur.enabled!==void 0&&(v.checked=n[0].filter.zoom_blur.enabled),e=new Sn({props:v}),q.push(()=>$(e,"checked",m));function x(_){n[38](_)}let S={label:"x"};n[0].filter.zoom_blur.center.x!==void 0&&(S.value=n[0].filter.zoom_blur.center.x),i=new fe({props:S}),q.push(()=>$(i,"value",x));function y(_){n[39](_)}let b={label:"y"};n[0].filter.zoom_blur.center.y!==void 0&&(b.value=n[0].filter.zoom_blur.center.y),a=new fe({props:b}),q.push(()=>$(a,"value",y));function B(_){n[40](_)}let A={label:"r",min:0};n[0].filter.zoom_blur.radius!==void 0&&(A.value=n[0].filter.zoom_blur.radius),c=new fe({props:A}),q.push(()=>$(c,"value",B));function U(_){n[41](_)}let E={label:"blur",step:.01,min:0};return n[0].filter.zoom_blur.value!==void 0&&(E.value=n[0].filter.zoom_blur.value),f=new fe({props:E}),q.push(()=>$(f,"value",U)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment),d=V(),H(f.$$.fragment)},m(_,I){z(e,_,I),O(_,r,I),z(i,_,I),O(_,o,I),z(a,_,I),O(_,u,I),z(c,_,I),O(_,d,I),z(f,_,I),g=!0},p(_,I){const re={};!t&&I[0]&1&&(t=!0,re.checked=_[0].filter.zoom_blur.enabled,ee(()=>t=!1)),e.$set(re);const Y={};!s&&I[0]&1&&(s=!0,Y.value=_[0].filter.zoom_blur.center.x,ee(()=>s=!1)),i.$set(Y);const j={};!l&&I[0]&1&&(l=!0,j.value=_[0].filter.zoom_blur.center.y,ee(()=>l=!1)),a.$set(j);const C={};!h&&I[0]&1&&(h=!0,C.value=_[0].filter.zoom_blur.radius,ee(()=>h=!1)),c.$set(C);const N={};!p&&I[0]&1&&(p=!0,N.value=_[0].filter.zoom_blur.value,ee(()=>p=!1)),f.$set(N)},i(_){g||(k(e.$$.fragment,_),k(i.$$.fragment,_),k(a.$$.fragment,_),k(c.$$.fragment,_),k(f.$$.fragment,_),g=!0)},o(_){R(e.$$.fragment,_),R(i.$$.fragment,_),R(a.$$.fragment,_),R(c.$$.fragment,_),R(f.$$.fragment,_),g=!1},d(_){_&&(F(r),F(o),F(u),F(d)),L(e,_),L(i,_),L(a,_),L(c,_),L(f,_)}}}function bC(n){let e,t,r,i,s,o,a,l,u,c,h,d;function f(b){n[42](b)}let p={style:Pr,label:"vignette"};n[0].filter.vignetting.enabled!==void 0&&(p.checked=n[0].filter.vignetting.enabled),e=new Sn({props:p}),q.push(()=>$(e,"checked",f));function g(b){n[43](b)}let m={label:"value",step:.01,min:0};n[0].filter.vignetting.value!==void 0&&(m.value=n[0].filter.vignetting.value),i=new fe({props:m}),q.push(()=>$(i,"value",g));function v(b){n[44](b)}let x={label:"alpha",step:.01,min:0,max:1};n[0].filter.vignetting.alpha!==void 0&&(x.value=n[0].filter.vignetting.alpha),a=new fe({props:x}),q.push(()=>$(a,"value",v));function S(b){n[45](b)}let y={label:"blur",step:.01,min:0};return n[0].filter.vignetting.blur!==void 0&&(y.value=n[0].filter.vignetting.blur),c=new fe({props:y}),q.push(()=>$(c,"value",S)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment)},m(b,B){z(e,b,B),O(b,r,B),z(i,b,B),O(b,o,B),z(a,b,B),O(b,u,B),z(c,b,B),d=!0},p(b,B){const A={};!t&&B[0]&1&&(t=!0,A.checked=b[0].filter.vignetting.enabled,ee(()=>t=!1)),e.$set(A);const U={};!s&&B[0]&1&&(s=!0,U.value=b[0].filter.vignetting.value,ee(()=>s=!1)),i.$set(U);const E={};!l&&B[0]&1&&(l=!0,E.value=b[0].filter.vignetting.alpha,ee(()=>l=!1)),a.$set(E);const _={};!h&&B[0]&1&&(h=!0,_.value=b[0].filter.vignetting.blur,ee(()=>h=!1)),c.$set(_)},i(b){d||(k(e.$$.fragment,b),k(i.$$.fragment,b),k(a.$$.fragment,b),k(c.$$.fragment,b),d=!0)},o(b){R(e.$$.fragment,b),R(i.$$.fragment,b),R(a.$$.fragment,b),R(c.$$.fragment,b),d=!1},d(b){b&&(F(r),F(o),F(u)),L(e,b),L(i,b),L(a,b),L(c,b)}}}function xC(n){let e,t,r,i,s,o,a,l,u,c,h,d,f,p,g;function m(_){n[46](_)}let v={style:Pr,label:"adjust"};n[0].filter.adjustment.enabled!==void 0&&(v.checked=n[0].filter.adjustment.enabled),e=new Sn({props:v}),q.push(()=>$(e,"checked",m));function x(_){n[47](_)}let S={label:"gam",step:.01,min:0};n[0].filter.adjustment.gamma!==void 0&&(S.value=n[0].filter.adjustment.gamma),i=new fe({props:S}),q.push(()=>$(i,"value",x));function y(_){n[48](_)}let b={label:"con",step:.01,min:0};n[0].filter.adjustment.contrast!==void 0&&(b.value=n[0].filter.adjustment.contrast),a=new fe({props:b}),q.push(()=>$(a,"value",y));function B(_){n[49](_)}let A={label:"bri",step:.01,min:0};n[0].filter.adjustment.brightness!==void 0&&(A.value=n[0].filter.adjustment.brightness),c=new fe({props:A}),q.push(()=>$(c,"value",B));function U(_){n[50](_)}let E={label:"sat",step:.01,min:0};return n[0].filter.adjustment.saturation!==void 0&&(E.value=n[0].filter.adjustment.saturation),f=new fe({props:E}),q.push(()=>$(f,"value",U)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment),d=V(),H(f.$$.fragment)},m(_,I){z(e,_,I),O(_,r,I),z(i,_,I),O(_,o,I),z(a,_,I),O(_,u,I),z(c,_,I),O(_,d,I),z(f,_,I),g=!0},p(_,I){const re={};!t&&I[0]&1&&(t=!0,re.checked=_[0].filter.adjustment.enabled,ee(()=>t=!1)),e.$set(re);const Y={};!s&&I[0]&1&&(s=!0,Y.value=_[0].filter.adjustment.gamma,ee(()=>s=!1)),i.$set(Y);const j={};!l&&I[0]&1&&(l=!0,j.value=_[0].filter.adjustment.contrast,ee(()=>l=!1)),a.$set(j);const C={};!h&&I[0]&1&&(h=!0,C.value=_[0].filter.adjustment.brightness,ee(()=>h=!1)),c.$set(C);const N={};!p&&I[0]&1&&(p=!0,N.value=_[0].filter.adjustment.saturation,ee(()=>p=!1)),f.$set(N)},i(_){g||(k(e.$$.fragment,_),k(i.$$.fragment,_),k(a.$$.fragment,_),k(c.$$.fragment,_),k(f.$$.fragment,_),g=!0)},o(_){R(e.$$.fragment,_),R(i.$$.fragment,_),R(a.$$.fragment,_),R(c.$$.fragment,_),R(f.$$.fragment,_),g=!1},d(_){_&&(F(r),F(o),F(u),F(d)),L(e,_),L(i,_),L(a,_),L(c,_),L(f,_)}}}function yC(n){let e,t,r,i,s,o,a,l,u,c,h,d;return e=new Qe({props:{$$slots:{default:[mC]},$$scope:{ctx:n}}}),r=new Qe({props:{$$slots:{default:[gC]},$$scope:{ctx:n}}}),s=new Qe({props:{$$slots:{default:[_C]},$$scope:{ctx:n}}}),a=new Qe({props:{$$slots:{default:[vC]},$$scope:{ctx:n}}}),u=new Qe({props:{$$slots:{default:[bC]},$$scope:{ctx:n}}}),h=new Qe({props:{$$slots:{default:[xC]},$$scope:{ctx:n}}}),{c(){H(e.$$.fragment),t=V(),H(r.$$.fragment),i=V(),H(s.$$.fragment),o=V(),H(a.$$.fragment),l=V(),H(u.$$.fragment),c=V(),H(h.$$.fragment)},m(f,p){z(e,f,p),O(f,t,p),z(r,f,p),O(f,i,p),z(s,f,p),O(f,o,p),z(a,f,p),O(f,l,p),z(u,f,p),O(f,c,p),z(h,f,p),d=!0},p(f,p){const g={};p[0]&1|p[2]&524288&&(g.$$scope={dirty:p,ctx:f}),e.$set(g);const m={};p[0]&1|p[2]&524288&&(m.$$scope={dirty:p,ctx:f}),r.$set(m);const v={};p[0]&1|p[2]&524288&&(v.$$scope={dirty:p,ctx:f}),s.$set(v);const x={};p[0]&1|p[2]&524288&&(x.$$scope={dirty:p,ctx:f}),a.$set(x);const S={};p[0]&1|p[2]&524288&&(S.$$scope={dirty:p,ctx:f}),u.$set(S);const y={};p[0]&1|p[2]&524288&&(y.$$scope={dirty:p,ctx:f}),h.$set(y)},i(f){d||(k(e.$$.fragment,f),k(r.$$.fragment,f),k(s.$$.fragment,f),k(a.$$.fragment,f),k(u.$$.fragment,f),k(h.$$.fragment,f),d=!0)},o(f){R(e.$$.fragment,f),R(r.$$.fragment,f),R(s.$$.fragment,f),R(a.$$.fragment,f),R(u.$$.fragment,f),R(h.$$.fragment,f),d=!1},d(f){f&&(F(t),F(i),F(o),F(l),F(c)),L(e,f),L(r,f),L(s,f),L(a,f),L(u,f),L(h,f)}}}function SC(n){let e,t;return e=new sC({props:{tabindex:3}}),{c(){H(e.$$.fragment)},m(r,i){z(e,r,i),t=!0},p:ce,i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){R(e.$$.fragment,r),t=!1},d(r){L(e,r)}}}function wC(n){let e,t,r,i,s,o,a,l,u,c,h,d,f,p,g;function m(_){n[51](_)}let v={label:"x"};n[0].categories.x!==void 0&&(v.value=n[0].categories.x),e=new fe({props:v}),q.push(()=>$(e,"value",m));function x(_){n[52](_)}let S={label:"y"};n[0].categories.y!==void 0&&(S.value=n[0].categories.y),i=new fe({props:S}),q.push(()=>$(i,"value",x));function y(_){n[53](_)}let b={label:"w"};n[0].categories.w!==void 0&&(b.value=n[0].categories.w),a=new fe({props:b}),q.push(()=>$(a,"value",y));function B(_){n[54](_)}let A={label:"h"};n[0].categories.h!==void 0&&(A.value=n[0].categories.h),c=new fe({props:A}),q.push(()=>$(c,"value",B));function U(_){n[55](_)}let E={label:"blur",step:.1,min:0};return n[0].categories.blur!==void 0&&(E.value=n[0].categories.blur),f=new fe({props:E}),q.push(()=>$(f,"value",U)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment),d=V(),H(f.$$.fragment)},m(_,I){z(e,_,I),O(_,r,I),z(i,_,I),O(_,o,I),z(a,_,I),O(_,u,I),z(c,_,I),O(_,d,I),z(f,_,I),g=!0},p(_,I){const re={};!t&&I[0]&1&&(t=!0,re.value=_[0].categories.x,ee(()=>t=!1)),e.$set(re);const Y={};!s&&I[0]&1&&(s=!0,Y.value=_[0].categories.y,ee(()=>s=!1)),i.$set(Y);const j={};!l&&I[0]&1&&(l=!0,j.value=_[0].categories.w,ee(()=>l=!1)),a.$set(j);const C={};!h&&I[0]&1&&(h=!0,C.value=_[0].categories.h,ee(()=>h=!1)),c.$set(C);const N={};!p&&I[0]&1&&(p=!0,N.value=_[0].categories.blur,ee(()=>p=!1)),f.$set(N)},i(_){g||(k(e.$$.fragment,_),k(i.$$.fragment,_),k(a.$$.fragment,_),k(c.$$.fragment,_),k(f.$$.fragment,_),g=!0)},o(_){R(e.$$.fragment,_),R(i.$$.fragment,_),R(a.$$.fragment,_),R(c.$$.fragment,_),R(f.$$.fragment,_),g=!1},d(_){_&&(F(r),F(o),F(u),F(d)),L(e,_),L(i,_),L(a,_),L(c,_),L(f,_)}}}function TC(n){let e,t,r,i,s,o,a,l,u,c,h,d;function f(b){n[56](b)}let p={label:"margin",min:0};n[0].categories.margin!==void 0&&(p.value=n[0].categories.margin),e=new fe({props:p}),q.push(()=>$(e,"value",f));function g(b){n[57](b)}let m={label:"round",min:0};n[0].categories.round!==void 0&&(m.value=n[0].categories.round),i=new fe({props:m}),q.push(()=>$(i,"value",g));function v(b){n[58](b)}let x={label:"shadow",min:0};n[0].categories.shadow.value!==void 0&&(x.value=n[0].categories.shadow.value),a=new fe({props:x}),q.push(()=>$(a,"value",v));function S(b){n[59](b)}let y={};return n[0].categories.shadow.color!==void 0&&(y.hex=n[0].categories.shadow.color),c=new bn({props:y}),q.push(()=>$(c,"hex",S)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment)},m(b,B){z(e,b,B),O(b,r,B),z(i,b,B),O(b,o,B),z(a,b,B),O(b,u,B),z(c,b,B),d=!0},p(b,B){const A={};!t&&B[0]&1&&(t=!0,A.value=b[0].categories.margin,ee(()=>t=!1)),e.$set(A);const U={};!s&&B[0]&1&&(s=!0,U.value=b[0].categories.round,ee(()=>s=!1)),i.$set(U);const E={};!l&&B[0]&1&&(l=!0,E.value=b[0].categories.shadow.value,ee(()=>l=!1)),a.$set(E);const _={};!h&&B[0]&1&&(h=!0,_.hex=b[0].categories.shadow.color,ee(()=>h=!1)),c.$set(_)},i(b){d||(k(e.$$.fragment,b),k(i.$$.fragment,b),k(a.$$.fragment,b),k(c.$$.fragment,b),d=!0)},o(b){R(e.$$.fragment,b),R(i.$$.fragment,b),R(a.$$.fragment,b),R(c.$$.fragment,b),d=!1},d(b){b&&(F(r),F(o),F(u)),L(e,b),L(i,b),L(a,b),L(c,b)}}}function CC(n){let e,t,r,i,s,o;return e=new Qe({props:{style:"display: block",$$slots:{default:[SC]},$$scope:{ctx:n}}}),r=new Qe({props:{$$slots:{default:[wC]},$$scope:{ctx:n}}}),s=new Qe({props:{$$slots:{default:[TC]},$$scope:{ctx:n}}}),{c(){H(e.$$.fragment),t=V(),H(r.$$.fragment),i=V(),H(s.$$.fragment)},m(a,l){z(e,a,l),O(a,t,l),z(r,a,l),O(a,i,l),z(s,a,l),o=!0},p(a,l){const u={};l[2]&524288&&(u.$$scope={dirty:l,ctx:a}),e.$set(u);const c={};l[0]&1|l[2]&524288&&(c.$$scope={dirty:l,ctx:a}),r.$set(c);const h={};l[0]&1|l[2]&524288&&(h.$$scope={dirty:l,ctx:a}),s.$set(h)},i(a){o||(k(e.$$.fragment,a),k(r.$$.fragment,a),k(s.$$.fragment,a),o=!0)},o(a){R(e.$$.fragment,a),R(r.$$.fragment,a),R(s.$$.fragment,a),o=!1},d(a){a&&(F(t),F(i)),L(e,a),L(r,a),L(s,a)}}}function PC(n){let e,t,r;function i(o){n[60](o)}let s={placeholder:"",tabindex:1};return n[0].title.text!==void 0&&(s.value=n[0].title.text),e=new lh({props:s}),q.push(()=>$(e,"value",i)),{c(){H(e.$$.fragment)},m(o,a){z(e,o,a),r=!0},p(o,a){const l={};!t&&a[0]&1&&(t=!0,l.value=o[0].title.text,ee(()=>t=!1)),e.$set(l)},i(o){r||(k(e.$$.fragment,o),r=!0)},o(o){R(e.$$.fragment,o),r=!1},d(o){L(e,o)}}}function AC(n){let e,t,r,i,s,o,a,l,u,c,h,d;function f(b){n[61](b)}let p={label:"x"};n[0].title.x!==void 0&&(p.value=n[0].title.x),e=new fe({props:p}),q.push(()=>$(e,"value",f));function g(b){n[62](b)}let m={label:"y"};n[0].title.y!==void 0&&(m.value=n[0].title.y),i=new fe({props:m}),q.push(()=>$(i,"value",g));function v(b){n[63](b)}let x={label:"shadow",min:0};n[0].title.shadow.value!==void 0&&(x.value=n[0].title.shadow.value),a=new fe({props:x}),q.push(()=>$(a,"value",v));function S(b){n[64](b)}let y={};return n[0].title.shadow.color!==void 0&&(y.hex=n[0].title.shadow.color),c=new bn({props:y}),q.push(()=>$(c,"hex",S)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment)},m(b,B){z(e,b,B),O(b,r,B),z(i,b,B),O(b,o,B),z(a,b,B),O(b,u,B),z(c,b,B),d=!0},p(b,B){const A={};!t&&B[0]&1&&(t=!0,A.value=b[0].title.x,ee(()=>t=!1)),e.$set(A);const U={};!s&&B[0]&1&&(s=!0,U.value=b[0].title.y,ee(()=>s=!1)),i.$set(U);const E={};!l&&B[0]&1&&(l=!0,E.value=b[0].title.shadow.value,ee(()=>l=!1)),a.$set(E);const _={};!h&&B[0]&1&&(h=!0,_.hex=b[0].title.shadow.color,ee(()=>h=!1)),c.$set(_)},i(b){d||(k(e.$$.fragment,b),k(i.$$.fragment,b),k(a.$$.fragment,b),k(c.$$.fragment,b),d=!0)},o(b){R(e.$$.fragment,b),R(i.$$.fragment,b),R(a.$$.fragment,b),R(c.$$.fragment,b),d=!1},d(b){b&&(F(r),F(o),F(u)),L(e,b),L(i,b),L(a,b),L(c,b)}}}function EC(n){let e,t,r,i,s,o,a,l,u,c,h,d,f,p,g;function m(_){n[65](_)}let v={placeholder:"Arial",label:"font",width:100};n[0].title.font.face!==void 0&&(v.value=n[0].title.font.face),e=new mr({props:v}),q.push(()=>$(e,"value",m));function x(_){n[66](_)}let S={placeholder:"60",label:"size",min:0};n[0].title.font.size!==void 0&&(S.value=n[0].title.font.size),i=new fe({props:S}),q.push(()=>$(i,"value",x));function y(_){n[67](_)}let b={placeholder:"60",label:"lh",min:0};n[0].title.font.line_height!==void 0&&(b.value=n[0].title.font.line_height),a=new fe({props:b}),q.push(()=>$(a,"value",y));function B(_){n[68](_)}let A={placeholder:"bold",label:"weight",width:40};n[0].title.font.weight!==void 0&&(A.value=n[0].title.font.weight),c=new mr({props:A}),q.push(()=>$(c,"value",B));function U(_){n[69](_)}let E={label:"color"};return n[0].title.font.color!==void 0&&(E.hex=n[0].title.font.color),f=new bn({props:E}),q.push(()=>$(f,"hex",U)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment),d=V(),H(f.$$.fragment)},m(_,I){z(e,_,I),O(_,r,I),z(i,_,I),O(_,o,I),z(a,_,I),O(_,u,I),z(c,_,I),O(_,d,I),z(f,_,I),g=!0},p(_,I){const re={};!t&&I[0]&1&&(t=!0,re.value=_[0].title.font.face,ee(()=>t=!1)),e.$set(re);const Y={};!s&&I[0]&1&&(s=!0,Y.value=_[0].title.font.size,ee(()=>s=!1)),i.$set(Y);const j={};!l&&I[0]&1&&(l=!0,j.value=_[0].title.font.line_height,ee(()=>l=!1)),a.$set(j);const C={};!h&&I[0]&1&&(h=!0,C.value=_[0].title.font.weight,ee(()=>h=!1)),c.$set(C);const N={};!p&&I[0]&1&&(p=!0,N.hex=_[0].title.font.color,ee(()=>p=!1)),f.$set(N)},i(_){g||(k(e.$$.fragment,_),k(i.$$.fragment,_),k(a.$$.fragment,_),k(c.$$.fragment,_),k(f.$$.fragment,_),g=!0)},o(_){R(e.$$.fragment,_),R(i.$$.fragment,_),R(a.$$.fragment,_),R(c.$$.fragment,_),R(f.$$.fragment,_),g=!1},d(_){_&&(F(r),F(o),F(u),F(d)),L(e,_),L(i,_),L(a,_),L(c,_),L(f,_)}}}function MC(n){let e,t,r,i,s,o;return e=new Qe({props:{$$slots:{default:[PC]},$$scope:{ctx:n}}}),r=new Qe({props:{$$slots:{default:[AC]},$$scope:{ctx:n}}}),s=new Qe({props:{$$slots:{default:[EC]},$$scope:{ctx:n}}}),{c(){H(e.$$.fragment),t=V(),H(r.$$.fragment),i=V(),H(s.$$.fragment)},m(a,l){z(e,a,l),O(a,t,l),z(r,a,l),O(a,i,l),z(s,a,l),o=!0},p(a,l){const u={};l[0]&1|l[2]&524288&&(u.$$scope={dirty:l,ctx:a}),e.$set(u);const c={};l[0]&1|l[2]&524288&&(c.$$scope={dirty:l,ctx:a}),r.$set(c);const h={};l[0]&1|l[2]&524288&&(h.$$scope={dirty:l,ctx:a}),s.$set(h)},i(a){o||(k(e.$$.fragment,a),k(r.$$.fragment,a),k(s.$$.fragment,a),o=!0)},o(a){R(e.$$.fragment,a),R(r.$$.fragment,a),R(s.$$.fragment,a),o=!1},d(a){a&&(F(t),F(i)),L(e,a),L(r,a),L(s,a)}}}function kC(n){let e,t,r;function i(o){n[70](o)}let s={placeholder:"",tabindex:2};return n[0].description.text!==void 0&&(s.value=n[0].description.text),e=new lh({props:s}),q.push(()=>$(e,"value",i)),{c(){H(e.$$.fragment)},m(o,a){z(e,o,a),r=!0},p(o,a){const l={};!t&&a[0]&1&&(t=!0,l.value=o[0].description.text,ee(()=>t=!1)),e.$set(l)},i(o){r||(k(e.$$.fragment,o),r=!0)},o(o){R(e.$$.fragment,o),r=!1},d(o){L(e,o)}}}function RC(n){let e,t,r,i,s,o,a,l,u,c,h,d;function f(b){n[71](b)}let p={label:"x"};n[0].description.x!==void 0&&(p.value=n[0].description.x),e=new fe({props:p}),q.push(()=>$(e,"value",f));function g(b){n[72](b)}let m={label:"gap"};n[0].description.gap!==void 0&&(m.value=n[0].description.gap),i=new fe({props:m}),q.push(()=>$(i,"value",g));function v(b){n[73](b)}let x={label:"shadow",min:0};n[0].description.shadow.value!==void 0&&(x.value=n[0].description.shadow.value),a=new fe({props:x}),q.push(()=>$(a,"value",v));function S(b){n[74](b)}let y={};return n[0].description.shadow.color!==void 0&&(y.hex=n[0].description.shadow.color),c=new bn({props:y}),q.push(()=>$(c,"hex",S)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment)},m(b,B){z(e,b,B),O(b,r,B),z(i,b,B),O(b,o,B),z(a,b,B),O(b,u,B),z(c,b,B),d=!0},p(b,B){const A={};!t&&B[0]&1&&(t=!0,A.value=b[0].description.x,ee(()=>t=!1)),e.$set(A);const U={};!s&&B[0]&1&&(s=!0,U.value=b[0].description.gap,ee(()=>s=!1)),i.$set(U);const E={};!l&&B[0]&1&&(l=!0,E.value=b[0].description.shadow.value,ee(()=>l=!1)),a.$set(E);const _={};!h&&B[0]&1&&(h=!0,_.hex=b[0].description.shadow.color,ee(()=>h=!1)),c.$set(_)},i(b){d||(k(e.$$.fragment,b),k(i.$$.fragment,b),k(a.$$.fragment,b),k(c.$$.fragment,b),d=!0)},o(b){R(e.$$.fragment,b),R(i.$$.fragment,b),R(a.$$.fragment,b),R(c.$$.fragment,b),d=!1},d(b){b&&(F(r),F(o),F(u)),L(e,b),L(i,b),L(a,b),L(c,b)}}}function BC(n){let e,t,r,i,s,o,a,l,u,c,h,d,f,p,g;function m(_){n[75](_)}let v={placeholder:"Arial",label:"font",width:100};n[0].description.font.face!==void 0&&(v.value=n[0].description.font.face),e=new mr({props:v}),q.push(()=>$(e,"value",m));function x(_){n[76](_)}let S={placeholder:"60",label:"size",min:0};n[0].description.font.size!==void 0&&(S.value=n[0].description.font.size),i=new fe({props:S}),q.push(()=>$(i,"value",x));function y(_){n[77](_)}let b={placeholder:"60",label:"lh",min:0};n[0].description.font.line_height!==void 0&&(b.value=n[0].description.font.line_height),a=new fe({props:b}),q.push(()=>$(a,"value",y));function B(_){n[78](_)}let A={placeholder:"bold",label:"weight",width:40};n[0].description.font.weight!==void 0&&(A.value=n[0].description.font.weight),c=new mr({props:A}),q.push(()=>$(c,"value",B));function U(_){n[79](_)}let E={label:"color"};return n[0].description.font.color!==void 0&&(E.hex=n[0].description.font.color),f=new bn({props:E}),q.push(()=>$(f,"hex",U)),{c(){H(e.$$.fragment),r=V(),H(i.$$.fragment),o=V(),H(a.$$.fragment),u=V(),H(c.$$.fragment),d=V(),H(f.$$.fragment)},m(_,I){z(e,_,I),O(_,r,I),z(i,_,I),O(_,o,I),z(a,_,I),O(_,u,I),z(c,_,I),O(_,d,I),z(f,_,I),g=!0},p(_,I){const re={};!t&&I[0]&1&&(t=!0,re.value=_[0].description.font.face,ee(()=>t=!1)),e.$set(re);const Y={};!s&&I[0]&1&&(s=!0,Y.value=_[0].description.font.size,ee(()=>s=!1)),i.$set(Y);const j={};!l&&I[0]&1&&(l=!0,j.value=_[0].description.font.line_height,ee(()=>l=!1)),a.$set(j);const C={};!h&&I[0]&1&&(h=!0,C.value=_[0].description.font.weight,ee(()=>h=!1)),c.$set(C);const N={};!p&&I[0]&1&&(p=!0,N.hex=_[0].description.font.color,ee(()=>p=!1)),f.$set(N)},i(_){g||(k(e.$$.fragment,_),k(i.$$.fragment,_),k(a.$$.fragment,_),k(c.$$.fragment,_),k(f.$$.fragment,_),g=!0)},o(_){R(e.$$.fragment,_),R(i.$$.fragment,_),R(a.$$.fragment,_),R(c.$$.fragment,_),R(f.$$.fragment,_),g=!1},d(_){_&&(F(r),F(o),F(u),F(d)),L(e,_),L(i,_),L(a,_),L(c,_),L(f,_)}}}function IC(n){let e,t,r,i,s,o;return e=new Qe({props:{$$slots:{default:[kC]},$$scope:{ctx:n}}}),r=new Qe({props:{$$slots:{default:[RC]},$$scope:{ctx:n}}}),s=new Qe({props:{$$slots:{default:[BC]},$$scope:{ctx:n}}}),{c(){H(e.$$.fragment),t=V(),H(r.$$.fragment),i=V(),H(s.$$.fragment)},m(a,l){z(e,a,l),O(a,t,l),z(r,a,l),O(a,i,l),z(s,a,l),o=!0},p(a,l){const u={};l[0]&1|l[2]&524288&&(u.$$scope={dirty:l,ctx:a}),e.$set(u);const c={};l[0]&1|l[2]&524288&&(c.$$scope={dirty:l,ctx:a}),r.$set(c);const h={};l[0]&1|l[2]&524288&&(h.$$scope={dirty:l,ctx:a}),s.$set(h)},i(a){o||(k(e.$$.fragment,a),k(r.$$.fragment,a),k(s.$$.fragment,a),o=!0)},o(a){R(e.$$.fragment,a),R(r.$$.fragment,a),R(s.$$.fragment,a),o=!1},d(a){a&&(F(t),F(i)),L(e,a),L(r,a),L(s,a)}}}function FC(n){let e,t,r,i,s,o,a,l,u,c,h,d,f,p,g,m,v,x,S;return r=new Qw({}),o=new Zn({props:{title:"",collapse:!0,$$slots:{default:[hC]},$$scope:{ctx:n}}}),l=new Zn({props:{title:"",collapse:!0,$$slots:{default:[pC]},$$scope:{ctx:n}}}),c=new Zn({props:{title:"",$$slots:{default:[yC]},$$scope:{ctx:n}}}),d=new Zn({props:{title:"",$$slots:{default:[CC]},$$scope:{ctx:n}}}),p=new Zn({props:{title:"",$$slots:{default:[MC]},$$scope:{ctx:n}}}),m=new Zn({props:{title:"",$$slots:{default:[IC]},$$scope:{ctx:n}}}),{c(){e=ne("div"),t=ne("main"),H(r.$$.fragment),i=V(),s=ne("aside"),H(o.$$.fragment),a=V(),H(l.$$.fragment),u=V(),H(c.$$.fragment),h=V(),H(d.$$.fragment),f=V(),H(p.$$.fragment),g=V(),H(m.$$.fragment),T(t,"class","svelte-1r8uhpl"),T(s,"class","svelte-1r8uhpl"),T(e,"class","container svelte-1r8uhpl")},m(y,b){O(y,e,b),te(e,t),z(r,t,null),te(e,i),te(e,s),z(o,s,null),te(s,a),z(l,s,null),te(s,u),z(c,s,null),te(s,h),z(d,s,null),te(s,f),z(p,s,null),te(s,g),z(m,s,null),v=!0,x||(S=[X(window,"paste",n[2]),X(window,"dragover",ct(n[7])),X(window,"drop",ct(n[3]))],x=!0)},p(y,b){const B={};b[0]&3|b[2]&524288&&(B.$$scope={dirty:b,ctx:y}),o.$set(B);const A={};b[0]&3|b[2]&524288&&(A.$$scope={dirty:b,ctx:y}),l.$set(A);const U={};b[0]&1|b[2]&524288&&(U.$$scope={dirty:b,ctx:y}),c.$set(U);const E={};b[0]&1|b[2]&524288&&(E.$$scope={dirty:b,ctx:y}),d.$set(E);const _={};b[0]&1|b[2]&524288&&(_.$$scope={dirty:b,ctx:y}),p.$set(_);const I={};b[0]&1|b[2]&524288&&(I.$$scope={dirty:b,ctx:y}),m.$set(I)},i(y){v||(k(r.$$.fragment,y),k(o.$$.fragment,y),k(l.$$.fragment,y),k(c.$$.fragment,y),k(d.$$.fragment,y),k(p.$$.fragment,y),k(m.$$.fragment,y),v=!0)},o(y){R(r.$$.fragment,y),R(o.$$.fragment,y),R(l.$$.fragment,y),R(c.$$.fragment,y),R(d.$$.fragment,y),R(p.$$.fragment,y),R(m.$$.fragment,y),v=!1},d(y){y&&F(e),L(r),L(o),L(l),L(c),L(d),L(p),L(m),x=!1,He(S)}}}const Pr="flex: 0 0 100px; justify-content: right;";function OC(n,e,t){let r,i;fr(n,K,P=>t(0,r=P)),fr(n,Zt,P=>t(1,i=P));function s(P){P?.target?.nodeName==="BUTTON"&&c(P.clipboardData?.items)&&P.preventDefault()}function o(P){c(P.dataTransfer?.items)}function a(P){Ie(Zt,i.background_cl="",i),Ie(K,r.background.src=P.target?.value,r)}function l(P){Ie(K,r.logo.src=P.target?.value,r)}function u(){Ie(K,r.filter=structuredClone(fh.filter),r)}function c(P){if(!P)return!1;for(const xi of Object.values(P)){if(xi.kind!=="file")continue;const yi=xi.getAsFile(),Si=new FileReader;Si.onload=async Hs=>{const wi=Hs.target?.result,Ti=wi.split(",")[0];if(Ti.includes("data:image"))return Ie(Zt,i.background=Ti,i),Ie(K,r.background.x=0,r),Ie(K,r.background.y=0,r),Ie(K,r.background.w=r.width,r),Ie(K,r.background.h=r.height,r),Ie(K,r.background.src=wi,r),!0},yi&&Si.readAsDataURL(yi)}return!1}function h(P){Be.call(this,n,P)}function d(P){n.$$.not_equal(i.background,P)&&(i.background=P,Zt.set(i))}function f(P){n.$$.not_equal(i.background_cl,P)&&(i.background_cl=P,Zt.set(i))}function p(P){n.$$.not_equal(r.background.x,P)&&(r.background.x=P,K.set(r))}function g(P){n.$$.not_equal(r.background.y,P)&&(r.background.y=P,K.set(r))}function m(P){n.$$.not_equal(r.background.w,P)&&(r.background.w=P,K.set(r))}function v(P){n.$$.not_equal(r.background.h,P)&&(r.background.h=P,K.set(r))}function x(P){n.$$.not_equal(r.background.flip_h,P)&&(r.background.flip_h=P,K.set(r))}function S(P){n.$$.not_equal(r.background.flip_v,P)&&(r.background.flip_v=P,K.set(r))}function y(P){n.$$.not_equal(i.logo,P)&&(i.logo=P,Zt.set(i))}function b(P){n.$$.not_equal(r.logo.x,P)&&(r.logo.x=P,K.set(r))}function B(P){n.$$.not_equal(r.logo.y,P)&&(r.logo.y=P,K.set(r))}function A(P){n.$$.not_equal(r.logo.w,P)&&(r.logo.w=P,K.set(r))}function U(P){n.$$.not_equal(r.logo.h,P)&&(r.logo.h=P,K.set(r))}function E(P){n.$$.not_equal(r.logo.blur,P)&&(r.logo.blur=P,K.set(r))}function _(P){n.$$.not_equal(r.filter.blur.enabled,P)&&(r.filter.blur.enabled=P,K.set(r))}function I(P){n.$$.not_equal(r.filter.blur.value,P)&&(r.filter.blur.value=P,K.set(r))}function re(P){n.$$.not_equal(r.filter.gradient.enabled,P)&&(r.filter.gradient.enabled=P,K.set(r))}function Y(P){n.$$.not_equal(r.filter.gradient.start.value,P)&&(r.filter.gradient.start.value=P,K.set(r))}function j(P){n.$$.not_equal(r.filter.gradient.start.color,P)&&(r.filter.gradient.start.color=P,K.set(r))}function C(P){n.$$.not_equal(r.filter.gradient.mid.value,P)&&(r.filter.gradient.mid.value=P,K.set(r))}function N(P){n.$$.not_equal(r.filter.gradient.mid.color,P)&&(r.filter.gradient.mid.color=P,K.set(r))}function W(P){n.$$.not_equal(r.filter.gradient.end.value,P)&&(r.filter.gradient.end.value=P,K.set(r))}function le(P){n.$$.not_equal(r.filter.gradient.end.color,P)&&(r.filter.gradient.end.color=P,K.set(r))}function Z(P){n.$$.not_equal(r.filter.tilt_shift.enabled,P)&&(r.filter.tilt_shift.enabled=P,K.set(r))}function D(P){n.$$.not_equal(r.filter.tilt_shift.start.x,P)&&(r.filter.tilt_shift.start.x=P,K.set(r))}function oe(P){n.$$.not_equal(r.filter.tilt_shift.start.y,P)&&(r.filter.tilt_shift.start.y=P,K.set(r))}function G(P){n.$$.not_equal(r.filter.tilt_shift.end.x,P)&&(r.filter.tilt_shift.end.x=P,K.set(r))}function Q(P){n.$$.not_equal(r.filter.tilt_shift.end.y,P)&&(r.filter.tilt_shift.end.y=P,K.set(r))}function he(P){n.$$.not_equal(r.filter.tilt_shift.blur,P)&&(r.filter.tilt_shift.blur=P,K.set(r))}function Le(P){n.$$.not_equal(r.filter.zoom_blur.enabled,P)&&(r.filter.zoom_blur.enabled=P,K.set(r))}function ot(P){n.$$.not_equal(r.filter.zoom_blur.center.x,P)&&(r.filter.zoom_blur.center.x=P,K.set(r))}function Et(P){n.$$.not_equal(r.filter.zoom_blur.center.y,P)&&(r.filter.zoom_blur.center.y=P,K.set(r))}function st(P){n.$$.not_equal(r.filter.zoom_blur.radius,P)&&(r.filter.zoom_blur.radius=P,K.set(r))}function _t(P){n.$$.not_equal(r.filter.zoom_blur.value,P)&&(r.filter.zoom_blur.value=P,K.set(r))}function Ze(P){n.$$.not_equal(r.filter.vignetting.enabled,P)&&(r.filter.vignetting.enabled=P,K.set(r))}function xt(P){n.$$.not_equal(r.filter.vignetting.value,P)&&(r.filter.vignetting.value=P,K.set(r))}function Ut(P){n.$$.not_equal(r.filter.vignetting.alpha,P)&&(r.filter.vignetting.alpha=P,K.set(r))}function Mt(P){n.$$.not_equal(r.filter.vignetting.blur,P)&&(r.filter.vignetting.blur=P,K.set(r))}function Xt(P){n.$$.not_equal(r.filter.adjustment.enabled,P)&&(r.filter.adjustment.enabled=P,K.set(r))}function J(P){n.$$.not_equal(r.filter.adjustment.gamma,P)&&(r.filter.adjustment.gamma=P,K.set(r))}function Ne(P){n.$$.not_equal(r.filter.adjustment.contrast,P)&&(r.filter.adjustment.contrast=P,K.set(r))}function at(P){n.$$.not_equal(r.filter.adjustment.brightness,P)&&(r.filter.adjustment.brightness=P,K.set(r))}function kt(P){n.$$.not_equal(r.filter.adjustment.saturation,P)&&(r.filter.adjustment.saturation=P,K.set(r))}function yt(P){n.$$.not_equal(r.categories.x,P)&&(r.categories.x=P,K.set(r))}function mn(P){n.$$.not_equal(r.categories.y,P)&&(r.categories.y=P,K.set(r))}function Ve(P){n.$$.not_equal(r.categories.w,P)&&(r.categories.w=P,K.set(r))}function be(P){n.$$.not_equal(r.categories.h,P)&&(r.categories.h=P,K.set(r))}function nn(P){n.$$.not_equal(r.categories.blur,P)&&(r.categories.blur=P,K.set(r))}function Ar(P){n.$$.not_equal(r.categories.margin,P)&&(r.categories.margin=P,K.set(r))}function pi(P){n.$$.not_equal(r.categories.round,P)&&(r.categories.round=P,K.set(r))}function mi(P){n.$$.not_equal(r.categories.shadow.value,P)&&(r.categories.shadow.value=P,K.set(r))}function gi(P){n.$$.not_equal(r.categories.shadow.color,P)&&(r.categories.shadow.color=P,K.set(r))}function _i(P){n.$$.not_equal(r.title.text,P)&&(r.title.text=P,K.set(r))}function vi(P){n.$$.not_equal(r.title.x,P)&&(r.title.x=P,K.set(r))}function Wn(P){n.$$.not_equal(r.title.y,P)&&(r.title.y=P,K.set(r))}function Fs(P){n.$$.not_equal(r.title.shadow.value,P)&&(r.title.shadow.value=P,K.set(r))}function Os(P){n.$$.not_equal(r.title.shadow.color,P)&&(r.title.shadow.color=P,K.set(r))}function jn(P){n.$$.not_equal(r.title.font.face,P)&&(r.title.font.face=P,K.set(r))}function Gt(P){n.$$.not_equal(r.title.font.size,P)&&(r.title.font.size=P,K.set(r))}function rn(P){n.$$.not_equal(r.title.font.line_height,P)&&(r.title.font.line_height=P,K.set(r))}function Er(P){n.$$.not_equal(r.title.font.weight,P)&&(r.title.font.weight=P,K.set(r))}function Tn(P){n.$$.not_equal(r.title.font.color,P)&&(r.title.font.color=P,K.set(r))}function Cn(P){n.$$.not_equal(r.description.text,P)&&(r.description.text=P,K.set(r))}function bi(P){n.$$.not_equal(r.description.x,P)&&(r.description.x=P,K.set(r))}function Mr(P){n.$$.not_equal(r.description.gap,P)&&(r.description.gap=P,K.set(r))}function Us(P){n.$$.not_equal(r.description.shadow.value,P)&&(r.description.shadow.value=P,K.set(r))}function Gs(P){n.$$.not_equal(r.description.shadow.color,P)&&(r.description.shadow.color=P,K.set(r))}function Ds(P){n.$$.not_equal(r.description.font.face,P)&&(r.description.font.face=P,K.set(r))}function zs(P){n.$$.not_equal(r.description.font.size,P)&&(r.description.font.size=P,K.set(r))}function kr(P){n.$$.not_equal(r.description.font.line_height,P)&&(r.description.font.line_height=P,K.set(r))}function Ls(P){n.$$.not_equal(r.description.font.weight,P)&&(r.description.font.weight=P,K.set(r))}function Ns(P){n.$$.not_equal(r.description.font.color,P)&&(r.description.font.color=P,K.set(r))}return[r,i,s,o,a,l,u,h,d,f,p,g,m,v,x,S,y,b,B,A,U,E,_,I,re,Y,j,C,N,W,le,Z,D,oe,G,Q,he,Le,ot,Et,st,_t,Ze,xt,Ut,Mt,Xt,J,Ne,at,kt,yt,mn,Ve,be,nn,Ar,pi,mi,gi,_i,vi,Wn,Fs,Os,jn,Gt,rn,Er,Tn,Cn,bi,Mr,Us,Gs,Ds,zs,kr,Ls,Ns]}class UC extends ze{constructor(e){super(),De(this,e,OC,FC,Ue,{},null,[-1,-1,-1])}}function GC(n){let e,t,r,i;return r=new UC({}),{c(){e=ne("div"),e.textContent=`build ${n[0]}`,t=V(),H(r.$$.fragment),T(e,"id","build"),T(e,"class","svelte-1lsgswv")},m(s,o){O(s,e,o),O(s,t,o),z(r,s,o),i=!0},p:ce,i(s){i||(k(r.$$.fragment,s),i=!0)},o(s){R(r.$$.fragment,s),i=!1},d(s){s&&(F(e),F(t)),L(r,s)}}}function DC(n){return["2024-09-29T11:59:52.292Z"]}class zC extends ze{constructor(e){super(),De(this,e,DC,GC,Ue,{})}}new zC({target:document.getElementById("app")});pe.add(Hh);Ge.mixin(z0);pe.add(lf);pe.add(uf);pe.add(Gf);Ge.mixin(nx);pe.add(Sp);pe.add($a);pe.add(Cp);pe.add(Fp);pe.add(Ip);pe.add(kp);pe.add(Tl);pe.add(Rp);pe.add(Mp);pe.add(Ep);pe.add(jf);pe.add(Vf);const LC=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),NC=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));
</script>
    <style rel="stylesheet" crossorigin>:root{--bg-light: #20202c;--bg-dark: #14151e;--bg-dark-extra: #101018;--bg-medium: #1a1a24;--bg-light-extra: #282a39;--text: #fff;--text-2: rgba(255, 255, 255, .5);--border-light: #292b3b;--violet: #9047fe;--violet-dark: #4933c2;--violet-light: #ae81ff;--red-dark: #ad1010;--red: #f85212;--green: #6dd919;--green-dark: #105a18;--blue: #559eff;--blue-light: #2392cc;--blue-light-extra: #42bdf9;--yellow: #fc0;--yellow-dark: #e6db74;--grey-dark: #75715e;--pink: #f92672;--green-light: #a9f513ee;--orange: #fd971f;--grey: #cfcfc2;--none: #0000;--font-size-base: 16px;--f1: "Inter";--f2: "Inter";font-family:var(--f1),var(--f2),sans-serif}body{margin:0;padding:0;height:100%}*{scrollbar-width:thin;scrollbar-color:var(--bg-light-extra) var(--bg-light)}*::-webkit-scrollbar{height:12px;width:12px}*::-webkit-scrollbar-track{background:var(--bg-light)}*::-webkit-scrollbar-thumb{background-color:var(--bg-light-extra);border-radius:5px;border:3px solid var(--bg-light)}textarea,input[type=text],input[type=url],input[type=number]{border:none;color:var(--text);font-family:var(--f2);font-size:1rem;padding:5px 10px;background-color:transparent;border-bottom:2px solid var(--bg-light)}input[type=number]{width:50px;padding-left:0;padding-right:0;text-align:center}textarea,input[type=text],input[type=url]{width:100%;text-align:left}textarea{background-color:var(--bg-light)}textarea:focus{outline:2px solid var(--violet)}input[type=text]:focus,input[type=url]:focus,input[type=number]:focus{outline:none;border-color:var(--violet);background:"transparent"!important}input:-webkit-autofill,input:-webkit-autofill:focus{transition:background-color 0s 600000s,color 0s 600000s!important}textarea:hover:not(:focus){outline:2px solid var(--bg-light-extra)}input[type=text]:hover:not(:focus),input[type=url]:hover:not(:focus),input[type=number]:hover:not(:focus){outline:none;border-color:var(--bg-light-extra)}input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=text].invalid{border-color:var(--red)}input[type=text].valid{border-color:var(--green-light)}input[type=checkbox]{-webkit-appearance:none;appearance:none;width:14px;height:14px;border:none;border-radius:4px;background-color:var(--bg-light);cursor:pointer;position:relative;margin:0;padding:0}input[type=checkbox]:checked{background-color:var(--violet)}input[type=checkbox]:checked:after{content:"";font-size:12px;color:var(--text);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}canvas{background-color:var(--bg-medium)}.slider.svelte-w4j1dz.svelte-w4j1dz{---track-width:var(--track-width, unset);---track-height:var(--track-height, 6px);---track-background:var(--track-background, #949494);---track-border:var(--track-border, none);---thumb-size:var(--thumb-size, 16px);---thumb-background:var(--thumb-background, #2d2d2d);---thumb-border:var(--thumb-border, none);---position:var(--position, 0px);---margin-inline-thumb-bigger:max(var(---thumb-size) - var(---track-height), 0px);---margin-inline-thumb-smaller:max(var(---track-height) - var(---thumb-size), 0px);position:relative;margin:auto;user-select:none;-webkit-user-select:none;background-color:transparent}.slider.svelte-w4j1dz.svelte-w4j1dz:before{background-color:transparent}[aria-orientation=horizontal].svelte-w4j1dz.svelte-w4j1dz{width:var(---track-width);max-width:calc(100% - 2 * var(---margin-inline-thumb-bigger));height:calc(max(var(---track-height),var(---thumb-size)) + 4px);height:max(var(---track-height),var(---thumb-size));margin-inline:var(---margin-inline-thumb-bigger);margin-block:var(--margin-block, 8px)}[aria-orientation=vertical].svelte-w4j1dz.svelte-w4j1dz{width:calc(max(var(---track-height),var(---thumb-size)) + 4px);width:max(var(---track-height),var(---thumb-size));height:var(---track-width);max-height:calc(100% - 2 * var(---margin-inline-thumb-bigger));margin-block:var(---margin-inline-thumb-bigger);margin-inline:var(--margin-block, 8px)}.track.svelte-w4j1dz.svelte-w4j1dz{position:absolute;pointer-events:none;background:var(---track-background);border:var(---track-border);border-radius:calc(var(---track-height) / 2);box-sizing:border-box}[aria-orientation=horizontal].svelte-w4j1dz .track.svelte-w4j1dz{height:var(---track-height);top:50%;transform:translateY(-50%);left:0;right:0}[aria-orientation=vertical].svelte-w4j1dz .track.svelte-w4j1dz{width:var(---track-height);left:50%;transform:translate(-50%);top:0;bottom:0}.thumb.svelte-w4j1dz.svelte-w4j1dz{pointer-events:none;position:absolute;height:var(---thumb-size);width:var(---thumb-size);border-radius:calc(var(---thumb-size) / 2);background:var(---thumb-background);border:var(---thumb-border);box-sizing:border-box;transform:translate(-50%,-50%);--margin-left:( 2 * var(---track-height) - var(---thumb-size) - var(---margin-inline-thumb-smaller) ) / 2;--left:calc(var(---position) * (100% - 2 * var(--margin-left)) + var(--margin-left))}[aria-orientation=horizontal].svelte-w4j1dz:not(.reverse) .thumb.svelte-w4j1dz{top:50%;left:var(--left)}[aria-orientation=vertical].svelte-w4j1dz:not(.reverse) .thumb.svelte-w4j1dz{left:50%;bottom:calc(var(--left) - var(---thumb-size))}[aria-orientation=horizontal].reverse.svelte-w4j1dz .thumb.svelte-w4j1dz{top:50%;right:calc(var(--left) - var(---thumb-size))}[aria-orientation=vertical].reverse.svelte-w4j1dz .thumb.svelte-w4j1dz{left:50%;top:calc(var(--left))}.slider.svelte-w4j1dz.svelte-w4j1dz:focus-visible{outline:none}.slider.svelte-w4j1dz:focus-visible .track.svelte-w4j1dz{outline:2px solid var(--focus-color, red);outline-offset:2px}.picker.svelte-1x9tz9y{position:relative;display:inline-block;width:var(--picker-width, 200px);height:var(--picker-height, 200px);background:linear-gradient(#fff0,#000),linear-gradient(.25turn,#fff,#0000),var(--picker-color-bg);border-radius:var(--picker-radius, 8px);outline:none;user-select:none}.s.svelte-1x9tz9y,.v.svelte-1x9tz9y{position:absolute;--track-background:none;--track-border:none;--thumb-background:none;--thumb-border:none;--thumb-size:2px;--margin-block:0;--track-height:var(--picker-indicator-size, 10px);user-select:none;-webkit-user-select:none}.s.svelte-1x9tz9y{top:calc(var(--pos-y) * (var(--picker-height, 200px) - var(--picker-indicator-size, 10px) - 4px) / 100 + 2px);left:2px;--track-width:calc(var(--picker-width, 200px) - 4px)}.v.svelte-1x9tz9y{top:2px;left:calc(var(--pos-x) * (var(--picker-width, 200px) - var(--picker-indicator-size, 10px) - 4px) / 100 + 2px);--track-width:calc(var(--picker-height, 200px) - 4px)}div.svelte-i5mg2p{position:absolute;left:calc(var(--pos-x) * (var(--picker-width, 200px) - var(--picker-indicator-size, 10px) - 4px) / 100 + 2px);top:calc(var(--pos-y) * (var(--picker-height, 200px) - var(--picker-indicator-size, 10px) - 4px) / 100 + 2px);width:var(--picker-indicator-size, 10px);height:var(--picker-indicator-size, 10px);background-color:#fff;box-shadow:0 0 4px #000;border-radius:50%;pointer-events:none;z-index:1;transition:box-shadow .2s}.is-dark.svelte-i5mg2p{box-shadow:0 0 4px #fff}.text-input.svelte-qtukzs.svelte-qtukzs{margin:var(--text-input-margin, 5px 0 0)}.input-container.svelte-qtukzs.svelte-qtukzs{display:flex;flex:1;gap:10px}input.svelte-qtukzs.svelte-qtukzs,button.svelte-qtukzs.svelte-qtukzs,.button-like.svelte-qtukzs.svelte-qtukzs{flex:1;border:none;background-color:var(--cp-input-color, #eee);color:var(--cp-text-color, var(--cp-border-color));padding:0;border-radius:5px;height:30px;line-height:30px;text-align:center}input.svelte-qtukzs.svelte-qtukzs{width:5px;font-family:inherit}button.svelte-qtukzs.svelte-qtukzs,.button-like.svelte-qtukzs.svelte-qtukzs{position:relative;flex:1;margin:8px 0 0;height:30px;width:100%;transition:background-color .2s;cursor:pointer;font-family:inherit}.button-like.svelte-qtukzs.svelte-qtukzs{cursor:default}.appear.svelte-qtukzs.svelte-qtukzs,.disappear.svelte-qtukzs.svelte-qtukzs{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:100%;transition:all .5s}button.svelte-qtukzs:hover .disappear.svelte-qtukzs,.appear.svelte-qtukzs.svelte-qtukzs{opacity:0}.disappear.svelte-qtukzs.svelte-qtukzs,button.svelte-qtukzs:hover .appear.svelte-qtukzs{opacity:1}button.svelte-qtukzs.svelte-qtukzs:hover{background-color:var(--cp-button-hover-color, #ccc)}input.svelte-qtukzs.svelte-qtukzs:focus,button.svelte-qtukzs.svelte-qtukzs:focus{outline:none}input.svelte-qtukzs.svelte-qtukzs:focus-visible,button.svelte-qtukzs.svelte-qtukzs:focus-visible{outline:2px solid var(--focus-color, red);outline-offset:2px}label.svelte-lemcb1.svelte-lemcb1{display:inline-flex;align-items:center;gap:8px;cursor:pointer;border-radius:3px;margin:4px;height:var(--input-size, 25px);user-select:none}.container.svelte-lemcb1.svelte-lemcb1{position:relative;display:block;display:flex;align-items:center;justify-content:center;width:var(--input-size, 25px)}input.svelte-lemcb1.svelte-lemcb1{margin:0;padding:0;border:none;width:1px;height:1px;flex-shrink:0;opacity:0}.alpha.svelte-lemcb1.svelte-lemcb1{clip-path:circle(50%);background:var(--alpha-grid-bg)}.alpha.svelte-lemcb1.svelte-lemcb1,.color.svelte-lemcb1.svelte-lemcb1{position:absolute;width:var(--input-size, 25px);height:var(--input-size, 25px);border-radius:50%;user-select:none}input.svelte-lemcb1:focus-visible~.color.svelte-lemcb1{outline:2px solid var(--focus-color, red);outline-offset:2px}div.svelte-h9ar9{padding:8px;background-color:var(--cp-bg-color, white);margin:0 10px 10px;border:1px solid var(--cp-border-color, black);border-radius:12px;display:none;width:max-content}.is-open.svelte-h9ar9{display:inline-block}[role=dialog].svelte-h9ar9{position:absolute;top:calc(var(--input-size, 25px) + 12px);left:0;z-index:var(--picker-z-index, 2)}label.svelte-oskb5b.svelte-oskb5b{display:flex;justify-content:center;margin-bottom:4px;grid-area:nullable;user-select:none}input.svelte-oskb5b.svelte-oskb5b{margin:0}input.svelte-oskb5b.svelte-oskb5b:focus-visible{outline:none}input.svelte-oskb5b:focus-visible+span.svelte-oskb5b{width:14px;height:14px;border-radius:2px;outline:2px solid var(--focus-color, red);outline-offset:2px}div.svelte-oskb5b.svelte-oskb5b{width:32px;aspect-ratio:2;position:relative}div.svelte-oskb5b .svelte-oskb5b{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}span.svelte-tsvobk.svelte-tsvobk{position:relative;color:var(--cp-text-color, var(--cp-border-color));--alpha-grid-bg:linear-gradient(45deg, #eee 25%, #0000 25%, #0000 75%, #eee 75%) 0 0 / 10px 10px, linear-gradient(45deg, #eee 25%, #0000 25%, #0000 75%, #eee 75%) 5px 5px / 10px 10px}.h.svelte-tsvobk.svelte-tsvobk,.a.svelte-tsvobk.svelte-tsvobk{display:inline-flex;justify-content:center;--track-height:var(--slider-width, 10px);--track-width:var(--picker-height, 200px);--track-border:none;--thumb-size:calc(var(--slider-width, 10px) - 3px);--thumb-background:white;--thumb-border:1px solid black;--margin-block:0;--gradient-direction:.5turn}.horizontal.svelte-tsvobk .h.svelte-tsvobk,.horizontal.svelte-tsvobk .a.svelte-tsvobk{--track-width:calc(var(--picker-width, 200px) - 12px);--gradient-direction:.25turn;margin:4px 6px}.horizontal.svelte-tsvobk .h.svelte-tsvobk{margin-top:8px}.vertical.svelte-tsvobk .h.svelte-tsvobk,.vertical.svelte-tsvobk .a.svelte-tsvobk{margin-left:3px}.h.svelte-tsvobk.svelte-tsvobk{grid-area:hue;--gradient-hue:#ff1500fb, #ffff00 17.2%, #ffff00 18.2%, #00ff00 33.3%, #00ffff 49.5%, #00ffff 51.5%, #0000ff 67.7%, #ff00ff 83.3%, #ff0000;--track-background:linear-gradient(var(--gradient-direction), var(--gradient-hue))}.a.svelte-tsvobk.svelte-tsvobk{grid-area:alpha;margin-top:2px;--track-background:linear-gradient(var(--gradient-direction), rgba(0, 0, 0, 0), var(--alphaless-color)), var(--alpha-grid-bg)}span.svelte-tsvobk .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}div.svelte-1le3y9a{background-color:var(--cp-bg-color, white);margin:0 10px 15px;border:1px solid var(--cp-border-color, black);border-radius:8px;display:none;--text-input-margin:5px 5px 6px;--picker-radius:8px 8px 0 0;--picker-width:260px}.is-open.svelte-1le3y9a{display:flex;flex-direction:column}[role=dialog].svelte-1le3y9a{position:absolute;top:calc(var(--input-size, 25px) + 12px);left:0;z-index:var(--picker-z-index, 2)}div.svelte-1le3y9a:not([role=dialog]){display:inline-flex;flex-direction:column}div.svelte-1qo09sh{padding:6px;background-color:var(--cp-bg-color, white);margin:0 10px 10px;border:1px solid var(--cp-border-color, black);border-radius:12px;display:none;width:max-content}.is-open.svelte-1qo09sh{display:block}@media (min-width: 768px){.is-open.svelte-1qo09sh{display:grid;gap:5px;grid-template:"nullable . . ." "picker hue alpha a11y" "input input input a11y";grid-template-rows:auto var(--picker-height, 200px) auto}}div.svelte-1qo09sh .picker{grid-area:picker}div.svelte-1qo09sh .text-input{grid-area:input}div.svelte-1qo09sh .a11y-notice{grid-area:a11y;margin:0 4px 0 6px}[role=dialog].svelte-1qo09sh{position:absolute;top:calc(var(--input-size, 25px) + 12px);left:0;z-index:var(--picker-z-index, 2)}.a11y-notice.svelte-12hg05j{display:grid;grid-template-columns:auto 1fr;grid-template-rows:auto repeat(var(--item-count),1fr) auto;justify-items:stretch;align-items:center;gap:0 12px;width:max-content}.title.svelte-12hg05j{margin:12px 0 0;grid-column:1 / 3;background:none;border:none;padding:0 8px;line-height:24px}@media (min-width: 768px){.title.svelte-12hg05j{margin:0}}.guidelines.svelte-12hg05j{grid-column:1 / 3;margin-top:10px;font-size:12px}.svelte-12hg05j:focus-visible,.guidelines.svelte-12hg05j :focus-visible{border-radius:2px;outline:2px solid var(--focus-color, red);outline-offset:2px}.lorem.svelte-1qfifh1{flex:1;text-align:center;padding:4px 8px;margin-top:10px;border-radius:4px;border:1px solid black;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.large.svelte-1qfifh1{font-size:22px;padding:2px 8px}.grade.svelte-1qfifh1{border-radius:50px;padding:0 8px 2px;background-color:#ff6100;font-weight:700}.grade-ok.svelte-1qfifh1{background-color:green;color:#fff}p.svelte-1qfifh1{margin:0}:root{--cp-bg-color:var(--bg-light-extra);--cp-border-color:var(--bg-light);--cp-text-color:var(--text-2);--cp-input-color:var(--bg-dark);--cp-button-hover-color:var(--bg-light-extra);--focus-color:var(--violet);--picker-z-index:10000}span.svelte-cj1vhf{font-size:smaller;color:var(--text-2);padding:0;margin:0;display:inline-block}.hide.svelte-cj1vhf{display:none}label.svelte-18hsjvr{font-size:smaller;color:var(--text-2)}.row.svelte-9ejy6{display:flex;flex-direction:row;align-items:center;gap:.6rem}section.svelte-1bhgzai{margin-bottom:1rem;padding:.7rem;background-color:var(--bg-medium);border-radius:4px}button.svelte-1bhgzai{font-size:1.3rem;margin:auto;color:var(--text-2);font-weight:300;display:inline-block;background:none;border:none;cursor:pointer;padding:0}.content.svelte-1bhgzai{margin-top:.3rem;display:flex;flex-direction:column;gap:.1rem}.collapse.svelte-1bhgzai{display:none}.collapser.svelte-1bhgzai{background:none;border:none;cursor:pointer;font-size:.8rem;color:var(--text-2);font-weight:300;padding:0;transform:translateY(-2px);transition:all .3s ease}.collapser.collapse.svelte-1bhgzai{display:inline-block;transform:rotate(-90deg) translateY(-2px)}div.svelte-148xzb6{background-color:var(--bg-medium)}div.svelte-66wdl1{display:inline-block;vertical-align:middle;margin:0 3pt;border-width:.2em;border-style:solid;border-radius:50%;animation:var(--duration) infinite svelte-66wdl1-rotate}@keyframes svelte-66wdl1-rotate{to{transform:rotate(360deg)}}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect){position:relative;align-items:center;display:flex;cursor:text;box-sizing:border-box;border:var(--sms-border, 1pt solid lightgray);border-radius:var(--sms-border-radius, 3pt);background:var(--sms-bg);width:var(--sms-width);max-width:var(--sms-max-width);padding:var(--sms-padding, 0 3pt);color:var(--sms-text-color);font-size:var(--sms-font-size, inherit);min-height:var(--sms-min-height, 22pt);margin:var(--sms-margin)}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect.open){z-index:var(--sms-open-z-index, 4)}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect:focus-within){border:var(--sms-focus-border, 1pt solid var(--sms-active-color, cornflowerblue))}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect.disabled){background:var(--sms-disabled-bg, lightgray);cursor:not-allowed}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.selected){display:flex;flex:1;padding:0;margin:0;flex-wrap:wrap}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.selected>li){align-items:center;border-radius:3pt;display:flex;margin:2pt;line-height:normal;transition:.3s;white-space:nowrap;background:var(--sms-selected-bg, rgba(0, 0, 0, .15));padding:var(--sms-selected-li-padding, 1pt 5pt);color:var(--sms-selected-text-color, var(--sms-text-color))}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.selected>li[draggable=true]){cursor:grab}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.selected>li.active){background:var(--sms-li-active-bg, var(--sms-active-color, rgba(0, 0, 0, .15)))}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect button){border-radius:50%;display:flex;transition:.2s;color:inherit;background:transparent;border:none;cursor:pointer;outline:none;padding:0;margin:0 0 0 3pt}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect button.remove-all){margin:0 3pt}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(ul.selected>li button:hover,button.remove-all:hover,button:focus){color:var(--sms-remove-btn-hover-color, lightskyblue);background:var(--sms-remove-btn-hover-bg, rgba(0, 0, 0, .2))}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect input){margin:auto 0;padding:0}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.selected>input){border:none;outline:none;background:none;flex:1;min-width:2em;color:var(--sms-text-color);font-size:inherit;cursor:inherit;border-radius:0}div.multiselect.svelte-1r2hsto>ul.selected.svelte-1r2hsto>input.svelte-1r2hsto::placeholder{padding-left:5pt;color:var(--sms-placeholder-color);opacity:var(--sms-placeholder-opacity)}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>input.form-control){width:2em;position:absolute;background:transparent;border:none;outline:none;z-index:-1;opacity:0;pointer-events:none}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.options){list-style:none;top:100%;left:0;width:100%;position:absolute;overflow:auto;transition:all .2s;box-sizing:border-box;background:var(--sms-options-bg, white);max-height:var(--sms-options-max-height, 50vh);overscroll-behavior:var(--sms-options-overscroll, none);box-shadow:var(--sms-options-shadow, 0 0 14pt -8pt black);border:var(--sms-options-border);border-width:var(--sms-options-border-width);border-radius:var(--sms-options-border-radius, 1ex);padding:var(--sms-options-padding);margin:var(--sms-options-margin, inherit)}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.options.hidden){visibility:hidden;opacity:0;transform:translateY(50px)}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.options>li){padding:3pt 2ex;cursor:pointer;scroll-margin:var(--sms-options-scroll-margin, 100px)}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.options .user-msg){display:block;padding:3pt 2ex}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.options>li.selected){background:var(--sms-li-selected-bg);color:var(--sms-li-selected-color)}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.options>li.active){background:var(--sms-li-active-bg, var(--sms-active-color, rgba(0, 0, 0, .15)))}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(div.multiselect>ul.options>li.disabled){cursor:not-allowed;background:var(--sms-li-disabled-bg, #f5f5f6);color:var(--sms-li-disabled-text, #b8b8b8)}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto:where(span.max-select-msg){padding:0 3pt}.svelte-1r2hsto.svelte-1r2hsto.svelte-1r2hsto::highlight(sms-search-matches){color:#66cdaa}.svelte-fo0sp7:where(dialog){position:fixed;top:30%;border:none;padding:0;background-color:transparent;display:flex;color:#fff;z-index:10;font-size:2.4ex}dialog.svelte-fo0sp7 div.multiselect{--sms-bg:var(--sms-options-bg);--sms-width:min(20em, 90vw);--sms-max-width:none;--sms-placeholder-color:lightgray;--sms-options-margin:1px 0;--sms-options-border-radius:0 0 1ex 1ex}.container.svelte-1dl1v59.svelte-1dl1v59.svelte-1dl1v59{display:flex;align-items:center;justify-content:center;gap:.5rem}.switch.svelte-1dl1v59.svelte-1dl1v59.svelte-1dl1v59{display:inline-block}.switch.svelte-1dl1v59 input.svelte-1dl1v59.svelte-1dl1v59{display:none}.switch.svelte-1dl1v59 label.svelte-1dl1v59.svelte-1dl1v59{display:block;width:30px;height:14px;padding:2px;border-radius:15px;cursor:pointer;transition:.3s;background:var(--bg-light-extra)}.switch.svelte-1dl1v59 label.svelte-1dl1v59.svelte-1dl1v59:after{content:"";display:inherit;width:14px;height:14px;border-radius:12px;background:var(--bg-dark);transition:.3s}.switch.svelte-1dl1v59 input.svelte-1dl1v59:checked~label.svelte-1dl1v59:after{translate:15px 0;background:var(--bg-dark)}.switch.svelte-1dl1v59 input.svelte-1dl1v59:checked~label.svelte-1dl1v59{background:var(--violet)}.switch.svelte-1dl1v59 input.svelte-1dl1v59:disabled~label.svelte-1dl1v59{opacity:.5;cursor:not-allowed}.label.svelte-1dl1v59.svelte-1dl1v59.svelte-1dl1v59{font-size:smaller;color:var(--text-2)}body{color:var(--text)}.container.svelte-1r8uhpl{display:flex;height:100vh}aside.svelte-1r8uhpl{width:600px;background-color:var(--bg-dark);overflow-y:auto;overflow-x:hidden;padding:1rem}main.svelte-1r8uhpl{flex:1;padding:1rem;background-color:var(--bg-dark-extra);display:flex;align-items:center;justify-content:center;text-align:center}button.reset_filters.svelte-1r8uhpl{background:var(--bg-light-extra);border:2px solid var(--bg-light);border-radius:5px;color:var(--text-2);margin-left:auto;cursor:pointer}button.reset_filters.svelte-1r8uhpl:hover{border:2px solid var(--violet)}#build.svelte-1lsgswv{position:fixed;top:20;left:20;color:var(--text-2);font-size:.8rem;z-index:10000}
</style>
  </head>
  <body>
    <div id="app"></div>
  </body>
</html>
