<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WLG Cover</title>
    <link class="preload_font" href="https://shevernitskiy.github.io/store/fonts/US101/import.css" rel="stylesheet" />
    <link class="preload_font" href="https://shevernitskiy.github.io/store/fonts/Gilroy/import.css" rel="stylesheet" />
    <link class="preload_font" href="https://shevernitskiy.github.io/store/fonts/Geist/import.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="icon"
      type="image/png"
      href="data:image/png;base64,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"
    />
    <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const Tp=!1;var Zs=Array.isArray,hc=Array.from,Eb=Object.defineProperty,Dn=Object.getOwnPropertyDescriptor,Cp=Object.getOwnPropertyDescriptors,Mb=Object.prototype,Rb=Array.prototype,ia=Object.getPrototypeOf;function vs(r){return typeof r=="function"}const Pt=()=>{};function kb(r){return r()}function sa(r){for(var e=0;e<r.length;e++)r[e]()}const Xr=2,Pp=4,qi=8,fc=16,fn=32,Va=64,Yn=128,oa=256,wt=512,nn=1024,Yi=2048,sn=4096,Qs=8192,Ap=16384,Ki=32768,Fb=65536,Ib=1<<18,Ep=1<<19,wi=Symbol("$state"),Bb=Symbol("");function Mp(r){return r===this.v}function Rp(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function pc(r){return!Rp(r,this.v)}function Ob(r){throw new Error("effect_in_teardown")}function Ub(){throw new Error("effect_in_unowned_derived")}function Db(r){throw new Error("effect_orphan")}function Gb(){throw new Error("effect_update_depth_exceeded")}function zb(r){throw new Error("props_invalid_value")}function Lb(){throw new Error("state_descriptors_fixed")}function Nb(){throw new Error("state_prototype_fixed")}function Hb(){throw new Error("state_unsafe_local_read")}function Vb(){throw new Error("state_unsafe_mutation")}function Ct(r){return{f:0,v:r,reactions:null,equals:Mp,version:0}}function Ii(r){return kp(Ct(r))}function Wa(r){const e=Ct(r);return e.equals=pc,Ne!==null&&Ne.l!==null&&(Ne.l.s??=[]).push(e),e}function He(r){return kp(Wa(r))}function kp(r){return Ye!==null&&Ye.f&Xr&&(Mr===null?a_([r]):Mr.push(r)),r}function ii(r,e){return ne(r,y(()=>k(r))),e}function ne(r,e){return Ye!==null&&ca()&&Ye.f&Xr&&(Mr===null||!Mr.includes(r))&&Vb(),r.equals(e)||(r.v=e,r.version=Kp(),Fp(r,nn),ca()&&Ie!==null&&Ie.f&wt&&!(Ie.f&fn)&&(gt!==null&&gt.includes(r)?(xr(Ie,nn),qa(Ie)):rn===null?l_([r]):rn.push(r))),e}function Fp(r,e){var t=r.reactions;if(t!==null)for(var n=ca(),i=t.length,s=0;s<i;s++){var o=t[s],a=o.f;a&nn||!n&&o===Ie||(xr(o,e),a&(wt|Yn)&&(a&Xr?Fp(o,Yi):qa(o)))}}const mc=1,gc=2,Ip=4,Wb=8,jb=16,Xb=1,qb=2,Bp=4,Yb=8,Kb=16,$b=4,Zb=1,Qb=2,Ft=Symbol(),Op="http://www.w3.org/2000/svg";let Up=!1;function qe(r,e=null,t){if(typeof r!="object"||r===null||wi in r)return r;const n=ia(r);if(n!==Mb&&n!==Rb)return r;var i=new Map,s=Zs(r),o=Ct(0);s&&i.set("length",Ct(r.length));var a;return new Proxy(r,{defineProperty(l,u,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Lb();var d=i.get(u);return d===void 0?(d=Ct(c.value),i.set(u,d)):ne(d,qe(c.value,a)),!0},deleteProperty(l,u){var c=i.get(u);return c===void 0?u in l&&i.set(u,Ct(Ft)):(ne(c,Ft),jd(o)),!0},get(l,u,c){if(u===wi)return r;var d=i.get(u),h=u in l;if(d===void 0&&(!h||Dn(l,u)?.writable)&&(d=Ct(qe(h?l[u]:Ft,a)),i.set(u,d)),d!==void 0){var f=k(d);return f===Ft?void 0:f}return Reflect.get(l,u,c)},getOwnPropertyDescriptor(l,u){var c=Reflect.getOwnPropertyDescriptor(l,u);if(c&&"value"in c){var d=i.get(u);d&&(c.value=k(d))}else if(c===void 0){var h=i.get(u),f=h?.v;if(h!==void 0&&f!==Ft)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return c},has(l,u){if(u===wi)return!0;var c=i.get(u),d=c!==void 0&&c.v!==Ft||Reflect.has(l,u);if(c!==void 0||Ie!==null&&(!d||Dn(l,u)?.writable)){c===void 0&&(c=Ct(d?qe(l[u],a):Ft),i.set(u,c));var h=k(c);if(h===Ft)return!1}return d},set(l,u,c,d){var h=i.get(u),f=u in l;if(s&&u==="length")for(var p=c;p<h.v;p+=1){var m=i.get(p+"");m!==void 0?ne(m,Ft):p in l&&(m=Ct(Ft),i.set(p+"",m))}h===void 0?(!f||Dn(l,u)?.writable)&&(h=Ct(void 0),ne(h,qe(c,a)),i.set(u,h)):(f=h.v!==Ft,ne(h,qe(c,a)));var g=Reflect.getOwnPropertyDescriptor(l,u);if(g?.set&&g.set.call(d,c),!f){if(s&&typeof u=="string"){var v=i.get("length"),x=Number(u);Number.isInteger(x)&&x>=v.v&&ne(v,x+1)}jd(o)}return!0},ownKeys(l){k(o);var u=Reflect.ownKeys(l).filter(h=>{var f=i.get(h);return f===void 0||f.v!==Ft});for(var[c,d]of i)d.v!==Ft&&!(c in l)&&u.push(c);return u},setPrototypeOf(){Nb()}})}function jd(r,e=1){ne(r,r.v+e)}var zt,Dp,Gp;function Jb(){if(zt===void 0){zt=window;var r=Element.prototype,e=Node.prototype;Dp=Dn(e,"firstChild").get,Gp=Dn(e,"nextSibling").get,r.__click=void 0,r.__className="",r.__attributes=null,r.__e=void 0,Text.prototype.__t=void 0}}function Js(r=""){return document.createTextNode(r)}function Bi(r){return Dp.call(r)}function ja(r){return Gp.call(r)}function ie(r){return Bi(r)}function K(r,e){{var t=Bi(r);return t instanceof Comment&&t.data===""?ja(t):t}}function I(r,e=1,t=!1){let n=r;for(;e--;)n=ja(n);return n}function e_(r){r.textContent=""}function zp(r){Ie===null&&Ye===null&&Db(),Ye!==null&&Ye.f&Yn&&Ub(),bc&&Ob()}function t_(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function $i(r,e,t,n=!0){var i=(r&Va)!==0,s=Ie,o={ctx:Ne,deps:null,nodes_start:null,nodes_end:null,f:r|nn,first:null,fn:e,last:null,next:null,parent:i?null:s,prev:null,teardown:null,transitions:null,version:0};if(t){var a=Ti;try{Xd(!0),to(o),o.f|=Ap}catch(c){throw pn(o),c}finally{Xd(a)}}else e!==null&&qa(o);var l=t&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&Ep)===0;if(!l&&!i&&n&&(s!==null&&t_(o,s),Ye!==null&&Ye.f&Xr)){var u=Ye;(u.children??=[]).push(o)}return o}function vc(r){const e=$i(qi,null,!1);return xr(e,wt),e.teardown=r,e}function kr(r){zp();var e=Ie!==null&&(Ie.f&qi)!==0&&Ne!==null&&!Ne.m;if(e){var t=Ne;(t.e??=[]).push({fn:r,effect:Ie,reaction:Ye})}else{var n=Ln(r);return n}}function r_(r){return zp(),$n(r)}function n_(r){const e=$i(Va,r,!0);return()=>{pn(e)}}function Ln(r){return $i(Pp,r,!1)}function it(r,e){var t=Ne,n={effect:null,ran:!1};t.l.r1.push(n),n.effect=$n(()=>{r(),!n.ran&&(n.ran=!0,ne(t.l.r2,!0),y(e))})}function Kn(){var r=Ne;$n(()=>{if(k(r.l.r2)){for(var e of r.l.r1){var t=e.effect;t.f&wt&&xr(t,Yi),Qi(t)&&to(t),e.ran=!1}r.l.r2.v=!1}})}function $n(r){return $i(qi,r,!0)}function le(r){return $n(r)}function eo(r,e=0){return $i(qi|fc|e,r,!0)}function on(r,e=!0){return $i(qi|fn,r,!0,e)}function Lp(r){var e=r.teardown;if(e!==null){const t=bc,n=Ye;qd(!0),la(null);try{e.call(null)}finally{qd(t),la(n)}}}function pn(r,e=!0){var t=!1;if((e||r.f&Ib)&&r.nodes_start!==null){for(var n=r.nodes_start,i=r.nodes_end;n!==null;){var s=n===i?null:ja(n);n.remove(),n=s}t=!0}Zp(r,e&&!t),Ds(r,0),xr(r,Qs);var o=r.transitions;if(o!==null)for(const l of o)l.stop();Lp(r);var a=r.parent;a!==null&&a.first!==null&&Np(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.parent=r.fn=r.nodes_start=r.nodes_end=null}function Np(r){var e=r.parent,t=r.prev,n=r.next;t!==null&&(t.next=n),n!==null&&(n.prev=t),e!==null&&(e.first===r&&(e.first=n),e.last===r&&(e.last=t))}function Bs(r,e){var t=[];xc(r,t,!0),Hp(t,()=>{pn(r),e&&e()})}function Hp(r,e){var t=r.length;if(t>0){var n=()=>--t||e();for(var i of r)i.out(n)}else e()}function xc(r,e,t){if(!(r.f&sn)){if(r.f^=sn,r.transitions!==null)for(const o of r.transitions)(o.is_global||t)&&e.push(o);for(var n=r.first;n!==null;){var i=n.next,s=(n.f&Ki)!==0||(n.f&fn)!==0;xc(n,e,s?t:!1),n=i}}}function Os(r){Vp(r,!0)}function Vp(r,e){if(r.f&sn){r.f^=sn,Qi(r)&&to(r);for(var t=r.first;t!==null;){var n=t.next,i=(t.f&Ki)!==0||(t.f&fn)!==0;Vp(t,i?e:!1),t=n}if(r.transitions!==null)for(const s of r.transitions)(s.is_global||e)&&s.in()}}let aa=!1,pu=[];function Wp(){aa=!1;const r=pu.slice();pu=[],sa(r)}function Zi(r){aa||(aa=!0,queueMicrotask(Wp)),pu.push(r)}function i_(){aa&&Wp()}function pt(r){let e=Xr|nn;Ie===null?e|=Yn:Ie.f|=Ep;const t={children:null,deps:null,equals:Mp,f:e,fn:r,reactions:null,v:null,version:0,parent:Ie};if(Ye!==null&&Ye.f&Xr){var n=Ye;(n.children??=[]).push(t)}return t}function ut(r){const e=pt(r);return e.equals=pc,e}function jp(r){var e=r.children;if(e!==null){r.children=null;for(var t=0;t<e.length;t+=1){var n=e[t];n.f&Xr?s_(n):pn(n)}}}function Xp(r){var e,t=Ie;ua(r.parent);try{jp(r),e=$p(r)}finally{ua(t)}var n=(xi||r.f&Yn)&&r.deps!==null?Yi:wt;xr(r,n),r.equals(e)||(r.v=e,r.version=Kp())}function s_(r){jp(r),Ds(r,0),xr(r,Qs),r.children=r.deps=r.reactions=r.fn=null}function Xa(r){throw new Error("lifecycle_outside_component")}const qp=0,o_=1;let Vo=qp,Us=!1,Ti=!1,bc=!1;function Xd(r){Ti=r}function qd(r){bc=r}let In=[],Ci=0;let Ye=null;function la(r){Ye=r}let Ie=null;function ua(r){Ie=r}let Mr=null;function a_(r){Mr=r}let gt=null,Bt=0,rn=null;function l_(r){rn=r}let Yp=0,xi=!1,Ne=null;function Kp(){return++Yp}function ca(){return Ne!==null&&Ne.l===null}function Qi(r){var e=r.f;if(e&nn)return!0;if(e&Yi){var t=r.deps,n=(e&Yn)!==0;if(t!==null){var i;if(e&oa){for(i=0;i<t.length;i++)(t[i].reactions??=[]).push(r);r.f^=oa}for(i=0;i<t.length;i++){var s=t[i];if(Qi(s)&&Xp(s),n&&Ie!==null&&!xi&&!s?.reactions?.includes(r)&&(s.reactions??=[]).push(r),s.version>r.version)return!0}}n||xr(r,wt)}return!1}function u_(r,e,t){throw r}function $p(r){var e=gt,t=Bt,n=rn,i=Ye,s=xi,o=Mr;gt=null,Bt=0,rn=null,Ye=r.f&(fn|Va)?null:r,xi=!Ti&&(r.f&Yn)!==0,Mr=null;try{var a=(0,r.fn)(),l=r.deps;if(gt!==null){var u;if(Ds(r,Bt),l!==null&&Bt>0)for(l.length=Bt+gt.length,u=0;u<gt.length;u++)l[Bt+u]=gt[u];else r.deps=l=gt;if(!xi)for(u=Bt;u<l.length;u++)(l[u].reactions??=[]).push(r)}else l!==null&&Bt<l.length&&(Ds(r,Bt),l.length=Bt);return a}finally{gt=e,Bt=t,rn=n,Ye=i,xi=s,Mr=o}}function c_(r,e){let t=e.reactions;if(t!==null){var n=t.indexOf(r);if(n!==-1){var i=t.length-1;i===0?t=e.reactions=null:(t[n]=t[i],t.pop())}}t===null&&e.f&Xr&&(gt===null||!gt.includes(e))&&(xr(e,Yi),e.f&(Yn|oa)||(e.f^=oa),Ds(e,0))}function Ds(r,e){var t=r.deps;if(t!==null)for(var n=e;n<t.length;n++)c_(r,t[n])}function Zp(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){var n=t.next;pn(t,e),t=n}}function to(r){var e=r.f;if(!(e&Qs)){xr(r,wt);var t=Ie,n=Ne;Ie=r,Ne=r.ctx;try{e&fc||Zp(r),Lp(r);var i=$p(r);r.teardown=typeof i=="function"?i:null,r.version=Yp}catch(s){u_(s)}finally{Ie=t,Ne=n}}}function Qp(){Ci>1e3&&(Ci=0,Gb()),Ci++}function Jp(r){var e=r.length;if(e!==0){Qp();var t=Ti;Ti=!0;try{for(var n=0;n<e;n++){var i=r[n];i.f&wt||(i.f^=wt);var s=[];em(i,s),d_(s)}}finally{Ti=t}}}function d_(r){var e=r.length;if(e!==0)for(var t=0;t<e;t++){var n=r[t];!(n.f&(Qs|sn))&&Qi(n)&&(to(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?Np(n):n.fn=null))}}function h_(){if(Us=!1,Ci>1001)return;const r=In;In=[],Jp(r),Us||(Ci=0)}function qa(r){Vo===qp&&(Us||(Us=!0,queueMicrotask(h_)));for(var e=r;e.parent!==null;){e=e.parent;var t=e.f;if(t&(Va|fn)){if(!(t&wt))return;e.f^=wt}}In.push(e)}function em(r,e){var t=r.first,n=[];e:for(;t!==null;){var i=t.f,s=(i&fn)!==0,o=s&&(i&wt)!==0;if(!o&&!(i&sn))if(i&qi){s?t.f^=wt:Qi(t)&&to(t);var a=t.first;if(a!==null){t=a;continue}}else i&Pp&&n.push(t);var l=t.next;if(l===null){let d=t.parent;for(;d!==null;){if(r===d)break e;var u=d.next;if(u!==null){t=u;continue e}d=d.parent}}t=l}for(var c=0;c<n.length;c++)a=n[c],e.push(a),em(a,e)}function tm(r){var e=Vo,t=In;try{Qp();const i=[];Vo=o_,In=i,Us=!1,Jp(t);var n=r?.();return i_(),(In.length>0||i.length>0)&&tm(),Ci=0,n}finally{Vo=e,In=t}}async function zr(){await Promise.resolve(),tm()}function k(r){var e=r.f;if(e&Qs)return r.v;if(Ye!==null){Mr!==null&&Mr.includes(r)&&Hb();var t=Ye.deps;gt===null&&t!==null&&t[Bt]===r?Bt++:gt===null?gt=[r]:gt.push(r),rn!==null&&Ie!==null&&Ie.f&wt&&!(Ie.f&fn)&&rn.includes(r)&&(xr(Ie,nn),qa(Ie))}if(e&Xr){var n=r;Qi(n)&&Xp(n)}return r.v}function y(r){const e=Ye;try{return Ye=null,r()}finally{Ye=e}}const f_=~(nn|Yi|wt);function xr(r,e){r.f=r.f&f_|e}function p_(r,e){return m_().set(r,e),e}function m_(r){return Ne===null&&Xa(),Ne.c??=new Map(g_(Ne)||void 0)}function g_(r){let e=r.p;for(;e!==null;){const t=e.c;if(t!==null)return t;e=e.p}return null}function Yd(r,e=1){var t=+k(r);return ne(r,t+e),t}function ye(r,e=!1,t){Ne={p:Ne,c:null,e:null,m:!1,s:r,x:null,l:null},e||(Ne.l={s:null,u:null,r1:[],r2:Ct(!1)})}function Se(r){const e=Ne;if(e!==null){const o=e.e;if(o!==null){var t=Ie,n=Ye;e.e=null;try{for(var i=0;i<o.length;i++){var s=o[i];ua(s.effect),la(s.reaction),Ln(s.fn)}}finally{ua(t),la(n)}}Ne=e.p,e.m=!0}return{}}function rt(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(wi in r)mu(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&wi in t&&mu(t)}}}function mu(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let n in r)try{mu(r[n],e)}catch{}const t=ia(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const n=Cp(t);for(let i in n){const s=n[i].get;if(s)try{s.call(r)}catch{}}}}}const rm=new Set,gu=new Set;function vu(r,e,t,n){function i(s){if(n.capture||xs.call(e,s),!s.cancelBubble)return t.call(this,s)}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?Zi(()=>{e.addEventListener(r,i,n)}):e.addEventListener(r,i,n),i}function ge(r,e,t,n,i){var s={capture:n,passive:i},o=vu(r,e,t,s);(e===document.body||e===window||e===document)&&vc(()=>{e.removeEventListener(r,o,s)})}function Zn(r){for(var e=0;e<r.length;e++)rm.add(r[e]);for(var t of gu)t(r)}function xs(r){var e=this,t=e.ownerDocument,n=r.type,i=r.composedPath?.()||[],s=i[0]||r.target,o=0,a=r.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){r.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(o=l)}if(s=i[o]||r.target,s!==e){Eb(r,"currentTarget",{configurable:!0,get(){return s||t}});try{for(var c,d=[];s!==null;){var h=s.assignedSlot||s.parentNode||s.host||null;try{var f=s["__"+n];if(f!==void 0&&!s.disabled)if(Zs(f)){var[p,...m]=f;p.apply(s,[r,...m])}else f.call(s,r)}catch(g){c?d.push(g):c=g}if(r.cancelBubble||h===e||h===null)break;s=h}if(c){for(let g of d)queueMicrotask(()=>{throw g});throw c}}finally{r.__root=e,delete r.currentTarget}}}function nm(r){var e=document.createElement("template");return e.innerHTML=r,e.content}function Oi(r,e){var t=Ie;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function Y(r,e){var t=(e&Zb)!==0,n=(e&Qb)!==0,i,s=!r.startsWith("<!>");return()=>{i===void 0&&(i=nm(s?r:"<!>"+r),t||(i=Bi(i)));var o=n?document.importNode(i,!0):i.cloneNode(!0);if(t){var a=Bi(o),l=o.lastChild;Oi(a,l)}else Oi(o,o);return o}}function v_(r,e,t="svg"){var n=!r.startsWith("<!>"),i=`<${t}>${n?r:"<!>"+r}</${t}>`,s;return()=>{if(!s){var o=nm(i),a=Bi(o);s=Bi(a)}var l=s.cloneNode(!0);return Oi(l,l),l}}function Ar(r=""){{var e=Js(r+"");return Oi(e,e),e}}function Pe(){var r=document.createDocumentFragment(),e=document.createComment(""),t=Js();return r.append(e,t),Oi(e,t),r}function N(r,e){r!==null&&r.before(e)}function x_(r){return r.endsWith("capture")&&r!=="gotpointercapture"&&r!=="lostpointercapture"}const b_=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function __(r){return b_.includes(r)}const y_={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"};function S_(r){return r=r.toLowerCase(),y_[r]??r}const w_=["touchstart","touchmove"];function T_(r){return w_.includes(r)}let da=!0;function Kd(r){da=r}function bt(r,e){e!==(r.__t??=r.nodeValue)&&(r.__t=e,r.nodeValue=e==null?"":e+"")}function C_(r,e){return P_(r,e)}const si=new Map;function P_(r,{target:e,anchor:t,props:n={},events:i,context:s,intro:o=!0}){Jb();var a=new Set,l=d=>{for(var h=0;h<d.length;h++){var f=d[h];if(!a.has(f)){a.add(f);var p=T_(f);e.addEventListener(f,xs,{passive:p});var m=si.get(f);m===void 0?(document.addEventListener(f,xs,{passive:p}),si.set(f,1)):si.set(f,m+1)}}};l(hc(rm)),gu.add(l);var u=void 0,c=n_(()=>{var d=t??e.appendChild(Js());return on(()=>{if(s){ye({});var h=Ne;h.c=s}i&&(n.$$events=i),da=o,u=r(d,n)||{},da=!0,s&&Se()}),()=>{for(var h of a){e.removeEventListener(h,xs);var f=si.get(h);--f===0?(document.removeEventListener(h,xs),si.delete(h)):si.set(h,f)}gu.delete(l),$d.delete(u),d!==t&&d.parentNode?.removeChild(d)}});return $d.set(u,c),u}let $d=new WeakMap;function Fe(r,e,t,n=null,i=!1){var s=r,o=null,a=null,l=null,u=i?Ki:0;eo(()=>{l!==(l=!!e())&&(l?(o?Os(o):o=on(()=>t(s)),a&&Bs(a,()=>{a=null})):(a?Os(a):n&&(a=on(()=>n(s))),o&&Bs(o,()=>{o=null})))},u)}let Pi=null;function Zd(r){Pi=r}function Ui(r,e){return e}function A_(r,e,t,n){for(var i=[],s=e.length,o=0;o<s;o++)xc(e[o].e,i,!0);var a=s>0&&i.length===0&&t!==null;if(a){var l=t.parentNode;e_(l),l.append(t),n.clear(),Zr(r,e[0].prev,e[s-1].next)}Hp(i,()=>{for(var u=0;u<s;u++){var c=e[u];a||(n.delete(c.k),Zr(r,c.prev,c.next)),pn(c.e,!a)}})}function Di(r,e,t,n,i,s=null){var o=r,a={flags:e,items:new Map,first:null},l=(e&Ip)!==0;if(l){var u=r;o=u.appendChild(Js())}var c=null;eo(()=>{var d=t(),h=Zs(d)?d:d==null?[]:hc(d),f=h.length;E_(h,a,o,i,e,n),s!==null&&(f===0?c?Os(c):c=on(()=>s(o)):c!==null&&Bs(c,()=>{c=null}))})}function E_(r,e,t,n,i,s){var o=(i&Wb)!==0,a=(i&(mc|gc))!==0,l=r.length,u=e.items,c=e.first,d=c,h,f=null,p,m=[],g=[],v,x,b,_;if(o)for(_=0;_<l;_+=1)v=r[_],x=s(v,_),b=u.get(x),b!==void 0&&(b.a?.measure(),(p??=new Set).add(b));for(_=0;_<l;_+=1){if(v=r[_],x=s(v,_),b=u.get(x),b===void 0){var w=d?d.e.nodes_start:t;f=R_(w,e,f,f===null?e.first:f.next,v,x,_,n,i),u.set(x,f),m=[],g=[],d=f.next;continue}if(a&&M_(b,v,_,i),b.e.f&sn&&(Os(b.e),o&&(b.a?.unfix(),(p??=new Set).delete(b))),b!==d){if(h!==void 0&&h.has(b)){if(m.length<g.length){var C=g[0],P;f=C.prev;var S=m[0],A=m[m.length-1];for(P=0;P<m.length;P+=1)Qd(m[P],C,t);for(P=0;P<g.length;P+=1)h.delete(g[P]);Zr(e,S.prev,A.next),Zr(e,f,S),Zr(e,A,C),d=C,f=A,_-=1,m=[],g=[]}else h.delete(b),Qd(b,d,t),Zr(e,b.prev,b.next),Zr(e,b,f===null?e.first:f.next),Zr(e,f,b),f=b;continue}for(m=[],g=[];d!==null&&d.k!==x;)d.e.f&sn||(h??=new Set).add(d),g.push(d),d=d.next;if(d===null)continue;b=d}m.push(b),f=b,d=b.next}if(d!==null||h!==void 0){for(var E=h===void 0?[]:hc(h);d!==null;)E.push(d),d=d.next;var U=E.length;if(U>0){var L=i&Ip&&l===0?t:null;if(o){for(_=0;_<U;_+=1)E[_].a?.measure();for(_=0;_<U;_+=1)E[_].a?.fix()}A_(e,E,L,u)}}o&&Zi(()=>{if(p!==void 0)for(b of p)b.a?.apply()}),Ie.first=e.first&&e.first.e,Ie.last=f&&f.e}function M_(r,e,t,n){n&mc&&ne(r.v,e),n&gc?ne(r.i,t):r.i=t}function R_(r,e,t,n,i,s,o,a,l){var u=Pi;try{var c=(l&mc)!==0,d=(l&jb)===0,h=c?d?Wa(i):Ct(i):i,f=l&gc?Ct(o):o,p={i:f,v:h,k:s,a:null,e:null,prev:t,next:n};return Pi=p,p.e=on(()=>a(r,h,f),Up),p.e.prev=t&&t.e,p.e.next=n&&n.e,t===null?e.first=p:(t.next=p,t.e.next=p.e),n!==null&&(n.prev=p,n.e.prev=p.e),p}finally{Pi=u}}function Qd(r,e,t){for(var n=r.next?r.next.e.nodes_start:t,i=e?e.e.nodes_start:t,s=r.e.nodes_start;s!==n;){var o=ja(s);i.before(s),s=o}}function Zr(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function tr(r,e,t,n){e===void 0||e(r,t)}function Gi(r,e,...t){var n=r,i=Pt,s;eo(()=>{i!==(i=e())&&(s&&(pn(s),s=null),s=on(()=>i(n,...t)))},Ki)}function Ot(r,e,t){var n=r,i,s;eo(()=>{i!==(i=e())&&(s&&(Bs(s),s=null),i&&(s=on(()=>t(n,i))))})}function k_(r,e,t,n,i,s){var o,a,l=null,u=r,c,d=Pi;eo(()=>{const h=e()||null;var f=Op;if(h!==o){var p=Pi;Zd(d),c&&(h===null?Bs(c,()=>{c=null,a=null}):h===a?Os(c):(pn(c),Kd(!1))),h&&h!==a&&(c=on(()=>{if(l=document.createElementNS(f,h),Oi(l,l),n){var m=l.appendChild(Js());n(l,m)}Ie.nodes_end=l,u.before(l)})),o=h,o&&(a=o),Kd(!0),Zd(p)}},Ki)}function xt(r,e,t){Ln(()=>{var n=y(()=>e(r,t?.())||{});if(n?.destroy)return()=>n.destroy()})}function F_(r,e){if(e){const t=document.body;r.autofocus=!0,Zi(()=>{document.activeElement===t&&r.focus()})}}let Jd=!1;function I_(){Jd||(Jd=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{if(!r.defaultPrevented)for(const e of r.target.elements)e.__on_r?.()})},{capture:!0}))}function dr(r,e){var t=r.__attributes??={};t.value!==(t.value=e)&&(r.value=e)}function ve(r,e,t,n){var i=r.__attributes??={};i[e]!==(i[e]=t)&&(e==="loading"&&(r[Bb]=t),t==null?r.removeAttribute(e):typeof t!="string"&&im(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function at(r,e,t,n,i=!1,s=!1,o=!1){var a=e||{},l=r.tagName==="OPTION";for(var u in e)u in t||(t[u]=null);n!==void 0&&(t.class=t.class?t.class+" "+n:n);var c=im(r),d=r.__attributes??={},h=[];for(const v in t){let x=t[v];if(l&&v==="value"&&x==null){r.value=r.__value="",a[v]=x;continue}var f=a[v];if(x!==f){a[v]=x;var p=v[0]+v[1];if(p!=="$$")if(p==="on"){const b={},_="$$"+v;let w=v.slice(2);var m=__(w);if(x_(w)&&(w=w.slice(0,-7),b.capture=!0),!m&&f){if(x!=null)continue;r.removeEventListener(w,a[_],b),a[_]=null}if(x!=null)if(m)r[`__${w}`]=x,Zn([w]);else{let C=function(P){a[v].call(this,P)};e?a[_]=vu(w,r,C,b):h.push([v,x,()=>a[_]=vu(w,r,C,b)])}}else if(v==="style"&&x!=null)r.style.cssText=x+"";else if(v==="autofocus")F_(r,!!x);else if(v==="__value"||v==="value"&&x!=null)r.value=r[v]=r.__value=x;else{var g=v;i||(g=S_(g)),x==null&&!s?(d[v]=null,r.removeAttribute(v)):c.includes(g)&&(s||typeof x!="string")?r[g]=x:typeof x!="function"&&ve(r,g,x)}}}return e||Zi(()=>{if(r.isConnected)for(const[v,x,b]of h)a[v]===x&&b()}),a}var eh=new Map;function im(r){var e=eh.get(r.nodeName);if(e)return e;eh.set(r.nodeName,e=[]);for(var t,n=ia(r);n.constructor.name!=="Element";){t=Cp(n);for(var i in t)t[i].set&&e.push(i);n=ia(n)}return e}function sm(r,e){var t=r.__className,n=B_(e);(t!==n||Up)&&(e==null?r.removeAttribute("class"):r.className=n,r.__className=n)}function B_(r){return r??""}function Ya(r,e,t){if(t){if(r.classList.contains(e))return;r.classList.add(e)}else{if(!r.classList.contains(e))return;r.classList.remove(e)}}function Lr(r,e,t,n,i){var s=r.__attributes??={},o=r.style,a="style-"+e;s[a]===t&&!i||(s[a]=t,t==null?o.removeProperty(e):o.setProperty(e,t,""))}const O_=requestAnimationFrame,U_=()=>performance.now(),en={tick:r=>O_(r),now:()=>U_(),tasks:new Set};function om(r){en.tasks.forEach(e=>{e.c(r)||(en.tasks.delete(e),e.f())}),en.tasks.size!==0&&en.tick(om)}function D_(r){let e;return en.tasks.size===0&&en.tick(om),{promise:new Promise(t=>{en.tasks.add(e={c:r,f:t})}),abort(){en.tasks.delete(e)}}}function po(r,e){r.dispatchEvent(new CustomEvent(e))}function G_(r){const e=r.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function th(r){const e={},t=r.split(";");for(const n of t){const[i,s]=n.split(":");if(!i||s===void 0)break;const o=G_(i.trim());e[o]=s.trim()}return e}const z_=r=>r;function Gs(r,e,t,n){var i=(r&$b)!==0,s="both",o,a=e.inert,l,u;function c(){return o??=t()(e,n?.()??{},{direction:s})}var d={is_global:i,in(){e.inert=a,po(e,"introstart"),l=xu(e,c(),u,1,()=>{po(e,"introend"),l?.abort(),l=o=void 0})},out(m){e.inert=!0,po(e,"outrostart"),u=xu(e,c(),l,0,()=>{po(e,"outroend"),m?.()})},stop:()=>{l?.abort(),u?.abort()}},h=Ie;if((h.transitions??=[]).push(d),da){var f=i;if(!f){for(var p=h.parent;p&&p.f&Ki;)for(;(p=p.parent)&&!(p.f&fc););f=!p||(p.f&Ap)!==0}f&&Ln(()=>{y(()=>d.in())})}}function xu(r,e,t,n,i){var s=n===1;if(vs(e)){var o,a=!1;return Zi(()=>{if(!a){var g=e({direction:s?"in":"out"});o=xu(r,g,t,n,i)}}),{abort:()=>{a=!0,o?.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(t?.deactivate(),!e?.duration)return i(),{abort:Pt,deactivate:Pt,reset:Pt,t:()=>n};const{delay:l=0,css:u,tick:c,easing:d=z_}=e;var h=[];if(s&&t===void 0&&(c&&c(0,1),u)){var f=th(u(0,1));h.push(f,f)}var p=()=>1-n,m=r.animate(h,{duration:l});return m.onfinish=()=>{var g=t?.t()??1-n;t?.abort();var v=n-g,x=e.duration*Math.abs(v),b=[];if(x>0){if(u)for(var _=Math.ceil(x/16.666666666666668),w=0;w<=_;w+=1){var C=g+v*d(w/_),P=u(C,1-C);b.push(th(P))}p=()=>{var S=m.currentTime;return g+v*d(S/x)},c&&D_(()=>{if(m.playState!=="running")return!1;var S=p();return c(S,1-S),!0})}m=r.animate(b,{duration:x,fill:"forwards"}),m.onfinish=()=>{p=()=>n,c?.(n,1-n),i()}},{abort:()=>{m&&(m.cancel(),m.effect=null)},deactivate:()=>{i=Pt},reset:()=>{n===0&&c?.(1,0)},t:()=>p()}}function L_(r,e,t,n=!0){n&&t();for(var i of e)r.addEventListener(i,t);vc(()=>{for(var s of e)r.removeEventListener(s,t)})}function am(r,e,t,n=t){r.addEventListener(e,t);const i=r.__on_r;i?r.__on_r=()=>{i(),n()}:r.__on_r=n,I_()}function Ka(r,e,t=e){var n=ca();am(r,"input",()=>{var i=rh(r)?nh(r.value):r.value;t(i),n&&i!==(i=e())&&(r.value=i??"")}),$n(()=>{var i=e();rh(r)&&i===nh(r.value)||r.type==="date"&&!i&&!r.value||(r.value=i??"")})}function lm(r,e,t=e){am(r,"change",()=>{var n=r.checked;t(n)}),e()==null&&t(!1),$n(()=>{var n=e();r.checked=!!n})}function rh(r){var e=r.type;return e==="number"||e==="range"}function nh(r){return r===""?null:+r}function ih(r,e){return r===e||r?.[wi]===e}function Qn(r={},e,t,n){return Ln(()=>{var i,s;return $n(()=>{i=s,s=[],y(()=>{r!==t(...s)&&(e(r,...s),i&&ih(t(...i),r)&&e(null,...i))})}),()=>{Zi(()=>{s&&ih(t(...s),r)&&e(null,...s)})}}),r}function sh(r,e){L_(window,["resize"],()=>e(window[r]))}function N_(r){return function(...e){var t=e[0];t.target===this&&r?.apply(this,e)}}function pr(r){return function(...e){var t=e[0];return t.preventDefault(),r?.apply(this,e)}}function kt(){const r=Ne,e=r.l.u;e&&(e.b.length&&r_(()=>{oh(r),sa(e.b)}),kr(()=>{const t=y(()=>e.m.map(kb));return()=>{for(const n of t)typeof n=="function"&&n()}}),e.a.length&&kr(()=>{oh(r),sa(e.a)}))}function oh(r){if(r.l.s)for(const e of r.l.s)k(e);rt(r.s)}function bu(r,e){var t=r.$$events?.[e.type],n=Zs(t)?t.slice():t==null?[]:[t];for(var i of n)i.call(this,e)}function rr(r){var e=r.$$slots?.default;return e===!0?r.children:e}const H_={get(r,e){if(!r.exclude.includes(e))return r.props[e]},set(r,e){return!1},getOwnPropertyDescriptor(r,e){if(!r.exclude.includes(e)&&e in r.props)return{enumerable:!0,configurable:!0,value:r.props[e]}},has(r,e){return r.exclude.includes(e)?!1:e in r.props},ownKeys(r){return Reflect.ownKeys(r.props).filter(e=>!r.exclude.includes(e))}};function um(r,e,t){return new Proxy({props:r,exclude:e},H_)}const V_={get(r,e){if(!r.exclude.includes(e))return k(r.version),e in r.special?r.special[e]():r.props[e]},set(r,e,t){return e in r.special||(r.special[e]=X({get[e](){return r.props[e]}},e,Bp)),r.special[e](t),Yd(r.version),!0},getOwnPropertyDescriptor(r,e){if(!r.exclude.includes(e)&&e in r.props)return{enumerable:!0,configurable:!0,value:r.props[e]}},deleteProperty(r,e){return r.exclude.includes(e)||(r.exclude.push(e),Yd(r.version)),!0},has(r,e){return r.exclude.includes(e)?!1:e in r.props},ownKeys(r){return Reflect.ownKeys(r.props).filter(e=>!r.exclude.includes(e))}};function nr(r,e){return new Proxy({props:r,exclude:e,special:{},version:Ct(0)},V_)}const W_={get(r,e){let t=r.props.length;for(;t--;){let n=r.props[t];if(vs(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n)return n[e]}},getOwnPropertyDescriptor(r,e){let t=r.props.length;for(;t--;){let n=r.props[t];if(vs(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n){const i=Dn(n,e);return i&&!i.configurable&&(i.configurable=!0),i}}},has(r,e){for(let t of r.props)if(vs(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(r){const e=[];for(let t of r.props){vs(t)&&(t=t());for(const n in t)e.includes(n)||e.push(n)}return e}};function Kr(...r){return new Proxy({props:r},W_)}function X(r,e,t,n){var i=(t&Xb)!==0,s=(t&qb)!==0,o=(t&Yb)!==0,a=(t&Kb)!==0,l=r[e],u=Dn(r,e)?.set,c=n,d=!0,h=!1,f=()=>(h=!0,d&&(d=!1,a?c=y(n):c=n),c);l===void 0&&n!==void 0&&(u&&s&&zb(),l=f(),u&&u(l));var p;if(s)p=()=>{var _=r[e];return _===void 0?f():(d=!0,h=!1,_)};else{var m=(i?pt:ut)(()=>r[e]);m.f|=Fb,p=()=>{var _=k(m);return _!==void 0&&(c=void 0),_===void 0?c:_}}if(!(t&Bp))return p;if(u){var g=r.$$legacy;return function(_,w){return arguments.length>0?((!s||!w||g)&&u(w?p():_),_):p()}}var v=!1,x=Wa(l),b=pt(()=>{var _=p(),w=k(x);return v?(v=!1,w):x.v=_});return i||(b.equals=pc),function(_,w){var C=k(b);if(arguments.length>0){const P=w?k(b):s&&o?qe(_):_;return b.equals(P)||(v=!0,ne(x,P),h&&c!==void 0&&(c=P),k(b)),_}return C}}function _c(r,e,t){if(r==null)return e(void 0),t&&t(void 0),Pt;const n=r.subscribe(e,t);return n.unsubscribe?()=>n.unsubscribe():n}function oe(r,e,t){const n=t[e]??={store:null,source:Wa(void 0),unsubscribe:Pt};if(n.store!==r)if(n.unsubscribe(),n.store=r??null,r==null)n.source.v=void 0,n.unsubscribe=Pt;else{var i=!0;n.unsubscribe=_c(r,s=>{i?n.source.v=s:ne(n.source,s)}),i=!1}return k(n.source)}function Gr(r,e){return r.set(e),e}function $e(){const r={};return vc(()=>{for(var e in r)r[e].unsubscribe()}),r}function D(r,e,t){return r.set(t),e}function j_(r){Ne===null&&Xa(),Ne.l!==null?Y_(Ne).m.push(r):kr(()=>{const e=y(r);if(typeof e=="function")return e})}function X_(r){Ne===null&&Xa(),j_(()=>()=>y(r))}function q_(r,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(r,{detail:e,bubbles:t,cancelable:n})}function ro(){const r=Ne;return r===null&&Xa(),(e,t,n)=>{const i=r.s.$$events?.[e];if(i){const s=Zs(i)?i.slice():[i],o=q_(e,t,n);for(const a of s)a.call(r.x,o);return!o.defaultPrevented}return!0}}function Y_(r){var e=r.l;return e.u??={a:[],b:[],m:[]}}const K_="5";typeof window<"u"&&(window.__svelte||={v:new Set}).v.add(K_);var ah=Object.prototype.hasOwnProperty;function lh(r,e,t){for(t of r.keys())if(hr(t,e))return t}function hr(r,e){var t,n,i;if(r===e)return!0;if(r&&e&&(t=r.constructor)===e.constructor){if(t===Date)return r.getTime()===e.getTime();if(t===RegExp)return r.toString()===e.toString();if(t===Array){if((n=r.length)===e.length)for(;n--&&hr(r[n],e[n]););return n===-1}if(t===Set){if(r.size!==e.size)return!1;for(n of r)if(i=n,i&&typeof i=="object"&&(i=lh(e,i),!i)||!e.has(i))return!1;return!0}if(t===Map){if(r.size!==e.size)return!1;for(n of r)if(i=n[0],i&&typeof i=="object"&&(i=lh(e,i),!i)||!hr(n[1],e.get(i)))return!1;return!0}if(t===ArrayBuffer)r=new Uint8Array(r),e=new Uint8Array(e);else if(t===DataView){if((n=r.byteLength)===e.byteLength)for(;n--&&r.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(r)){if((n=r.byteLength)===e.byteLength)for(;n--&&r[n]===e[n];);return n===-1}if(!t||typeof r=="object"){n=0;for(t in r)if(ah.call(r,t)&&++n&&!ah.call(e,t)||!(t in e)||!hr(r[t],e[t]))return!1;return Object.keys(e).length===n}}return r!==r&&e!==e}function $_(r,e,t,n=!0){const i=e-t;return i<=0?n?r[r.length-1]:r[0]:r[i]}function Z_(r,e,t,n=!0){const i=e+t;return i>r.length-1?n?r[0]:r[r.length-1]:r[i]}function Q_(r,e,t=!0){return e===r.length-1?t?r[0]:r[e]:r[e+1]}function J_(r,e,t=!0){return e<=0?t?r[r.length-1]:r[0]:r[e-1]}function hl(r){return r[r.length-1]}function ey(r,e){return r.map((t,n)=>r[(e+n)%r.length])}function ty(r,e,t=hr){const n=e.findIndex(i=>t(i,r));return n!==-1?e.splice(n,1):e.push(r),e}function qr(r){return Object.keys(r).reduce((e,t)=>r[t]===void 0?e:e+`${t}:${r[t]};`,"")}function vt(r){return r?!0:void 0}qr({position:"absolute",opacity:0,"pointer-events":"none",margin:0,transform:"translateX(-100%)"});function ry(r){if(r!==null)return""}const oi=[];function Gt(r,e){return{subscribe:xe(r,e).subscribe}}function xe(r,e=Pt){let t=null;const n=new Set;function i(a){if(Rp(r,a)&&(r=a,t)){const l=!oi.length;for(const u of n)u[1](),oi.push(u,r);if(l){for(let u=0;u<oi.length;u+=2)oi[u][0](oi[u+1]);oi.length=0}}}function s(a){i(a(r))}function o(a,l=Pt){const u=[a,l];return n.add(u),n.size===1&&(t=e(i,s)||Pt),a(r),()=>{n.delete(u),n.size===0&&t&&(t(),t=null)}}return{set:i,update:s,subscribe:o}}function mt(r,e,t){const n=!Array.isArray(r),i=n?[r]:r;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return Gt(t,(o,a)=>{let l=!1;const u=[];let c=0,d=Pt;const h=()=>{if(c)return;d();const p=e(n?u[0]:u,o,a);s?o(p):d=typeof p=="function"?p:Pt},f=i.map((p,m)=>_c(p,g=>{u[m]=g,c&=~(1<<m),l&&h()},()=>{c|=1<<m}));return l=!0,h(),function(){sa(f),d(),l=!1}})}function Wo(r){return{subscribe:r.subscribe.bind(r)}}function $a(r){let e;return _c(r,t=>e=t)(),e}function Jn(r,...e){const t={};for(const n of Object.keys(r))e.includes(n)||(t[n]=r[n]);return t}function ny(r,e,t){return Object.fromEntries(Object.entries(r).filter(([n,i])=>!hr(i,e)))}function bs(r){const e={};for(const t in r){const n=r[t];n!==void 0&&(e[t]=n)}return e}function uh(r){function e(t){return t(r),()=>{}}return{subscribe:e}}function Kt(r){if(!an)return null;const e=document.querySelector(`[data-melt-id="${r}"]`);return Ve(e)?e:null}const mo=r=>new Proxy(r,{get(e,t,n){return Reflect.get(e,t,n)},ownKeys(e){return Reflect.ownKeys(e).filter(t=>t!=="action")}}),ch=r=>typeof r=="function";Je("empty");function Je(r,e){const{stores:t,action:n,returned:i}=e??{},s=(()=>{if(t&&i)return mt(t,a=>{const l=i(a);if(ch(l)){const u=(...c)=>mo(bs({...l(...c),[`data-melt-${r}`]:"",action:n??ze}));return u.action=n??ze,u}return mo(bs({...l,[`data-melt-${r}`]:"",action:n??ze}))});{const l=i?.();if(ch(l)){const u=(...c)=>mo(bs({...l(...c),[`data-melt-${r}`]:"",action:n??ze}));return u.action=n??ze,uh(u)}return uh(mo(bs({...l,[`data-melt-${r}`]:"",action:n??ze})))}})(),o=n??(()=>{});return o.subscribe=s.subscribe,o}function Ji(r){const e=s=>s?`${r}-${s}`:r,t=s=>`data-melt-${r}${s?`-${s}`:""}`,n=s=>`[data-melt-${r}${s?`-${s}`:""}]`;return{name:e,attribute:t,selector:n,getEl:s=>document.querySelector(n(s))}}const an=typeof document<"u",iy=r=>typeof r=="function";function sy(r){return r instanceof Document}function es(r){return r instanceof Element}function Ve(r){return r instanceof HTMLElement}function cm(r){return r instanceof HTMLInputElement}function oy(r){return r instanceof HTMLLabelElement}function dh(r){return r instanceof HTMLButtonElement}function hh(r){const e=r.getAttribute("aria-disabled"),t=r.getAttribute("disabled"),n=r.hasAttribute("data-disabled");return!!(e==="true"||t!==null||n)}function fh(r){return r.pointerType==="touch"}function yc(r){return r!==null&&typeof r=="object"}function Sc(r){return yc(r)&&"subscribe"in r}function ft(...r){return(...e)=>{for(const t of r)typeof t=="function"&&t(...e)}}function ze(){}function Nn(r,e,t,n){const i=Array.isArray(e)?e:[e];return i.forEach(s=>r.addEventListener(s,t,n)),()=>{i.forEach(s=>r.removeEventListener(s,t,n))}}function Ue(r,e,t,n){const i=Array.isArray(e)?e:[e];if(typeof t=="function"){const s=ly(o=>t(o));return i.forEach(o=>r.addEventListener(o,s,n)),()=>{i.forEach(o=>r.removeEventListener(o,s,n))}}return()=>void 0}function ay(r){const e=r.currentTarget;if(!Ve(e))return null;const t=new CustomEvent(`m-${r.type}`,{detail:{originalEvent:r},cancelable:!0});return e.dispatchEvent(t),t}function ly(r){return e=>{if(!ay(e)?.defaultPrevented)return r(e)}}function uy(r){r.setAttribute("data-highlighted","")}function cy(r){r.removeAttribute("data-highlighted")}const dy=r=>{try{X_(r)}catch{return r}};function fl(r){return Array.from(r.querySelectorAll('[role="option"]:not([data-disabled])')).filter(e=>Ve(e))}function hy(r){return window.getComputedStyle(r).getPropertyValue("direction")}function Et(r){return{...r,get:()=>$a(r)}}Et.writable=function(r){const e=xe(r);let t=r;return{subscribe:e.subscribe,set(n){e.set(n),t=n},update(n){const i=n(t);e.set(i),t=i},get(){return t}}};Et.derived=function(r,e){const t=new Map,n=()=>{const s=Array.isArray(r)?r.map(o=>o.get()):r.get();return e(s)};return{get:n,subscribe:s=>{const o=[];return(Array.isArray(r)?r:[r]).forEach(l=>{o.push(l.subscribe(()=>{s(n())}))}),s(n()),t.set(s,o),()=>{const l=t.get(s);if(l)for(const u of l)u();t.delete(s)}}}};const zi=(r,e)=>{const t=Et(r),n=(s,o)=>{t.update(a=>{const l=s(a);let u=l;return e&&(u=e({curr:a,next:l})),o?.(u),u})};return{...t,update:n,set:s=>{n(()=>s)}}};function fy(r){return new Promise(e=>setTimeout(e,r))}let py="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",my=(r=21)=>{let e="",t=r;for(;t--;)e+=py[Math.random()*64|0];return e};function bi(){return my(10)}function wc(r){return r.reduce((e,t)=>(e[t]=bi(),e),{})}const ee={ALT:"Alt",ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",BACKSPACE:"Backspace",CAPS_LOCK:"CapsLock",CONTROL:"Control",DELETE:"Delete",END:"End",ENTER:"Enter",ESCAPE:"Escape",F1:"F1",F10:"F10",F11:"F11",F12:"F12",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",HOME:"Home",META:"Meta",PAGE_DOWN:"PageDown",PAGE_UP:"PageUp",SHIFT:"Shift",SPACE:" ",TAB:"Tab",CTRL:"Control",ASTERISK:"*",A:"a",P:"p"},gy=[ee.ARROW_DOWN,ee.PAGE_UP,ee.HOME],vy=[ee.ARROW_UP,ee.PAGE_DOWN,ee.END],xy=[...gy,...vy];function jo(r,e=500){let t;const n=(...i)=>{clearTimeout(t),t=setTimeout(()=>r(...i),e)};return n.destroy=()=>clearTimeout(t),n}const dm=()=>typeof window<"u";function by(){return navigator.userAgentData?.platform??navigator.platform}const hm=r=>dm()&&r.test(by().toLowerCase()),_y=()=>dm()&&!!navigator.maxTouchPoints,yy=()=>hm(/^mac/)&&!_y(),Sy=()=>hm(/mac|iphone|ipad|ipod/i),wy=()=>Sy()&&!yy();function Ty(r){const e=r.slice();return e.sort(Py),Cy(e)}function Cy(r){if(r.length<=1)return r.slice();const e=[];for(let n=0;n<r.length;n++){const i=r[n];for(;e.length>=2;){const s=e[e.length-1],o=e[e.length-2];if((s.x-o.x)*(i.y-o.y)>=(s.y-o.y)*(i.x-o.x))e.pop();else break}e.push(i)}e.pop();const t=[];for(let n=r.length-1;n>=0;n--){const i=r[n];for(;t.length>=2;){const s=t[t.length-1],o=t[t.length-2];if((s.x-o.x)*(i.y-o.y)>=(s.y-o.y)*(i.x-o.x))t.pop();else break}t.push(i)}return t.pop(),e.length==1&&t.length==1&&e[0].x==t[0].x&&e[0].y==t[0].y?e:e.concat(t)}function Py(r,e){return r.x<e.x?-1:r.x>e.x?1:r.y<e.y?-1:r.y>e.y?1:0}function Ay(r){const e=r.getBoundingClientRect();return[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.right,y:e.bottom},{x:e.left,y:e.bottom}]}function Ey(r){const e=r.flatMap(t=>Ay(t));return Ty(e)}function My(r,e){let t=!1;for(let n=0,i=e.length-1;n<e.length;i=n++){const s=e[n].x,o=e[n].y,a=e[i].x,l=e[i].y;o>r.y!=l>r.y&&r.x<(a-s)*(r.y-o)/(l-o)+s&&(t=!t)}return t}const pl="data-melt-scroll-lock";function ph(r,e){if(!r)return;const t=r.style.cssText;return Object.assign(r.style,e),()=>{r.style.cssText=t}}function Ry(r,e,t){if(!r)return;const n=r.style.getPropertyValue(e);return r.style.setProperty(e,t),()=>{n?r.style.setProperty(e,n):r.style.removeProperty(e)}}function ky(r){const e=r.getBoundingClientRect().left;return Math.round(e)+r.scrollLeft?"paddingLeft":"paddingRight"}function Fy(r){const e=document,t=e.defaultView??window,{documentElement:n,body:i}=e;if(i.hasAttribute(pl))return ze;i.setAttribute(pl,"");const o=t.innerWidth-n.clientWidth,a=()=>Ry(n,"--scrollbar-width",`${o}px`),l=ky(n),u=t.getComputedStyle(i)[l],c=()=>ph(i,{overflow:"hidden",[l]:`calc(${u} + ${o}px)`}),d=()=>{const{scrollX:f,scrollY:p,visualViewport:m}=t,g=m?.offsetLeft??0,v=m?.offsetTop??0,x=ph(i,{position:"fixed",overflow:"hidden",top:`${-(p-Math.floor(v))}px`,left:`${-(f-Math.floor(g))}px`,right:"0",[l]:`calc(${u} + ${o}px)`});return()=>{x?.(),t.scrollTo(f,p)}},h=[a(),wy()?d():c()];return()=>{h.forEach(f=>f?.()),i.removeAttribute(pl)}}function Iy(r){const{open:e,forceVisible:t,activeTrigger:n}=r;return mt([e,t,n],([i,s,o])=>(i||s)&&o!==null)}function Zt(r,e,t={}){const{skipFirstRun:n}=t;let i=!0,s;const o=mt(r,l=>{s?.(),i&&n?i=!1:s=e(l)}).subscribe(ze),a=()=>{o(),s?.()};return dy(a),a}function Hn(r){const e={};return Object.keys(r).forEach(t=>{const n=t,i=r[n];e[n]=Et(xe(i))}),e}function Cn(r){an&&fy(1).then(()=>{const e=document.activeElement;!Ve(e)||e===r||(e.tabIndex=-1,r&&(r.tabIndex=0,r.focus()))})}const By=new Set(["Shift","Control","Alt","Meta","CapsLock","NumLock"]),Oy={onMatch:Cn,getCurrentItem:()=>document.activeElement};function Uy(r={}){const e={...Oy,...r},t=Et(xe([])),n=jo(()=>{t.update(()=>[])});return{typed:t,resetTyped:n,handleTypeaheadSearch:(s,o)=>{if(By.has(s))return;const a=e.getCurrentItem(),l=$a(t);if(!Array.isArray(l))return;l.push(s.toLowerCase()),t.set(l);const u=o.filter(g=>!(g.getAttribute("disabled")==="true"||g.getAttribute("aria-disabled")==="true"||g.hasAttribute("data-disabled"))),d=l.length>1&&l.every(g=>g===l[0])?l[0]:l.join(""),h=Ve(a)?u.indexOf(a):-1;let f=ey(u,Math.max(h,0));d.length===1&&(f=f.filter(g=>g!==a));const m=f.find(g=>g?.innerText&&g.innerText.toLowerCase().startsWith(d.toLowerCase()));Ve(m)&&m!==a&&e.onMatch(m),n()}}}function Dy(r){let e=r.parentElement;for(;Ve(e)&&!e.hasAttribute("data-portal");)e=e.parentElement;return e||"body"}function fm(r,e){return e!==void 0?e:Dy(r)==="body"?document.body:null}function Tc(r,e){return r===e||r.contains(e)}function pm(r){return r?.ownerDocument??document}function Gy(r){return e=>{const t=e.target,n=Kt(r);if(!n||!es(t))return!1;const i=n.id;return!!(oy(t)&&i===t.htmlFor||t.closest(`label[for="${i}"]`))}}function zy(r,e){return e?My({x:r.clientX,y:r.clientY},e):!1}function Ly(r){const e={};return Object.keys(r).forEach(t=>{const n=t,i=r[n];Sc(i)?e[n]=Et(i):e[n]=Et(Gt(i))}),e}const Ny={prefix:"",disabled:Gt(!1),required:Gt(!1),name:Gt(void 0),type:Gt(void 0),checked:void 0};function Hy(r){const e={...Ny,...bs(r)},{name:t}=Ji(e.prefix),{value:n,name:i,disabled:s,required:o,type:a,checked:l}=Ly(Jn(e,"prefix")),u=i,c=Et.derived([l,a],([h,f])=>{if(f==="checkbox")return h==="indeterminate"?!1:h});return Je(t("hidden-input"),{stores:[n,u,s,o,a,c],returned:([h,f,p,m,g,v])=>({name:f,value:h?.toString(),"aria-hidden":"true",hidden:!0,disabled:p,required:m,tabIndex:-1,type:g,checked:v,style:qr({position:"absolute",opacity:0,"pointer-events":"none",margin:0,transform:"translateX(-100%)"})}),action:h=>({destroy:ft(n.subscribe(p=>{a.get()!=="checkbox"&&(h.value=p,h.dispatchEvent(new Event("change",{bubbles:!0})))}),c.subscribe(()=>{a.get()==="checkbox"&&h.dispatchEvent(new Event("change",{bubbles:!0}))}))})})}const Vy={defaultOpen:!1,disabled:!1,forceVisible:!1},{name:ml}=Ji("collapsible");function Wy(r){const e={...Vy,...r},t=Hn(Jn(e,"open","defaultOpen","onOpenChange")),{disabled:n,forceVisible:i}=t,s=e.open??xe(e.defaultOpen),o=zi(s,e?.onOpenChange),a=Je(ml(),{stores:[o,n],returned:([d,h])=>({"data-state":d?"open":"closed","data-disabled":vt(h)})}),l=Je(ml("trigger"),{stores:[o,n],returned:([d,h])=>({"data-state":d?"open":"closed","data-disabled":vt(h),disabled:vt(h)}),action:d=>({destroy:Ue(d,"click",()=>{d.dataset.disabled===void 0&&o.update(p=>!p)})})}),u=mt([o,i],([d,h])=>d||h),c=Je(ml("content"),{stores:[u,o,n],returned:([d,h,f])=>({"data-state":h?"open":"closed","data-disabled":vt(f),hidden:d?void 0:!0,style:d?void 0:qr({display:"none"})})});return{elements:{root:a,trigger:l,content:c},states:{open:o},options:t}}const Xo=new Map,mm=(r,e={})=>{let t=ze;function n(i={}){t();const s={behaviorType:"close",...i},o=Sc(s.behaviorType)?s.behaviorType:Et(Gt(s.behaviorType));Xo.set(r,o),t=ft(Nn(document,"keydown",l=>{if(l.key!==ee.ESCAPE||!jy(r))return;const u=l.target;Ve(u)&&(l.preventDefault(),!Xy(l,s.ignore)&&qy(o.get())&&s.handler?.(l))},{passive:!1}),Zt(o,l=>{l==="close"||l==="defer-otherwise-close"&&[...Xo.keys()][0]===r?r.dataset.escapee="":delete r.dataset.escapee}),o.destroy||ze)}return n(e),{update:n,destroy(){Xo.delete(r),delete r.dataset.escapee,t()}}},jy=r=>{const e=[...Xo],t=e.findLast(([i,s])=>{const o=s.get();return o==="close"||o==="ignore"});if(t)return t[0]===r;const[n]=e[0];return n===r},Xy=(r,e)=>e?!!(iy(e)&&e(r)||Array.isArray(e)&&e.some(t=>r.target===t)):!1,qy=r=>r==="close"||r==="defer-otherwise-close",ln=Math.min,Ut=Math.max,ha=Math.round,go=Math.floor,un=r=>({x:r,y:r}),Yy={left:"right",right:"left",bottom:"top",top:"bottom"},Ky={start:"end",end:"start"};function _u(r,e,t){return Ut(r,ln(e,t))}function ts(r,e){return typeof r=="function"?r(e):r}function cn(r){return r.split("-")[0]}function rs(r){return r.split("-")[1]}function gm(r){return r==="x"?"y":"x"}function Cc(r){return r==="y"?"height":"width"}function Vn(r){return["top","bottom"].includes(cn(r))?"y":"x"}function Pc(r){return gm(Vn(r))}function $y(r,e,t){t===void 0&&(t=!1);const n=rs(r),i=Pc(r),s=Cc(i);let o=i==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=fa(o)),[o,fa(o)]}function Zy(r){const e=fa(r);return[yu(r),e,yu(e)]}function yu(r){return r.replace(/start|end/g,e=>Ky[e])}function Qy(r,e,t){const n=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(r){case"top":case"bottom":return t?e?i:n:e?n:i;case"left":case"right":return e?s:o;default:return[]}}function Jy(r,e,t,n){const i=rs(r);let s=Qy(cn(r),t==="start",n);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(yu)))),s}function fa(r){return r.replace(/left|right|bottom|top/g,e=>Yy[e])}function e2(r){return{top:0,right:0,bottom:0,left:0,...r}}function vm(r){return typeof r!="number"?e2(r):{top:r,right:r,bottom:r,left:r}}function pa(r){const{x:e,y:t,width:n,height:i}=r;return{width:n,height:i,top:t,left:e,right:e+n,bottom:t+i,x:e,y:t}}function mh(r,e,t){let{reference:n,floating:i}=r;const s=Vn(e),o=Pc(e),a=Cc(o),l=cn(e),u=s==="y",c=n.x+n.width/2-i.width/2,d=n.y+n.height/2-i.height/2,h=n[a]/2-i[a]/2;let f;switch(l){case"top":f={x:c,y:n.y-i.height};break;case"bottom":f={x:c,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:d};break;case"left":f={x:n.x-i.width,y:d};break;default:f={x:n.x,y:n.y}}switch(rs(e)){case"start":f[o]-=h*(t&&u?-1:1);break;case"end":f[o]+=h*(t&&u?-1:1);break}return f}const t2=async(r,e,t)=>{const{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:o}=t,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:r,floating:e,strategy:i}),{x:c,y:d}=mh(u,n,l),h=n,f={},p=0;for(let m=0;m<a.length;m++){const{name:g,fn:v}=a[m],{x,y:b,data:_,reset:w}=await v({x:c,y:d,initialPlacement:n,placement:h,strategy:i,middlewareData:f,rects:u,platform:o,elements:{reference:r,floating:e}});c=x??c,d=b??d,f={...f,[g]:{...f[g],..._}},w&&p<=50&&(p++,typeof w=="object"&&(w.placement&&(h=w.placement),w.rects&&(u=w.rects===!0?await o.getElementRects({reference:r,floating:e,strategy:i}):w.rects),{x:c,y:d}=mh(u,h,l)),m=-1)}return{x:c,y:d,placement:h,strategy:i,middlewareData:f}};async function Ac(r,e){var t;e===void 0&&(e={});const{x:n,y:i,platform:s,rects:o,elements:a,strategy:l}=r,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=ts(e,r),p=vm(f),g=a[h?d==="floating"?"reference":"floating":d],v=pa(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(g)))==null||t?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:u,rootBoundary:c,strategy:l})),x=d==="floating"?{x:n,y:i,width:o.floating.width,height:o.floating.height}:o.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),_=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},w=pa(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:x,offsetParent:b,strategy:l}):x);return{top:(v.top-w.top+p.top)/_.y,bottom:(w.bottom-v.bottom+p.bottom)/_.y,left:(v.left-w.left+p.left)/_.x,right:(w.right-v.right+p.right)/_.x}}const r2=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:i,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:u,padding:c=0}=ts(r,e)||{};if(u==null)return{};const d=vm(c),h={x:t,y:n},f=Pc(i),p=Cc(f),m=await o.getDimensions(u),g=f==="y",v=g?"top":"left",x=g?"bottom":"right",b=g?"clientHeight":"clientWidth",_=s.reference[p]+s.reference[f]-h[f]-s.floating[p],w=h[f]-s.reference[f],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let P=C?C[b]:0;(!P||!await(o.isElement==null?void 0:o.isElement(C)))&&(P=a.floating[b]||s.floating[p]);const S=_/2-w/2,A=P/2-m[p]/2-1,E=ln(d[v],A),U=ln(d[x],A),L=E,R=P-m[p]-U,T=P/2-m[p]/2+S,B=_u(L,T,R),z=!l.arrow&&rs(i)!=null&&T!==B&&s.reference[p]/2-(T<L?E:U)-m[p]/2<0,G=z?T<L?T-L:T-R:0;return{[f]:h[f]+G,data:{[f]:B,centerOffset:T-B-G,...z&&{alignmentOffset:G}},reset:z}}}),n2=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=ts(r,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const v=cn(i),x=Vn(a),b=cn(a)===a,_=await(l.isRTL==null?void 0:l.isRTL(u.floating)),w=h||(b||!m?[fa(a)]:Zy(a)),C=p!=="none";!h&&C&&w.push(...Jy(a,m,p,_));const P=[a,...w],S=await Ac(e,g),A=[];let E=((n=s.flip)==null?void 0:n.overflows)||[];if(c&&A.push(S[v]),d){const T=$y(i,o,_);A.push(S[T[0]],S[T[1]])}if(E=[...E,{placement:i,overflows:A}],!A.every(T=>T<=0)){var U,L;const T=(((U=s.flip)==null?void 0:U.index)||0)+1,B=P[T];if(B)return{data:{index:T,overflows:E},reset:{placement:B}};let z=(L=E.filter(G=>G.overflows[0]<=0).sort((G,j)=>G.overflows[1]-j.overflows[1])[0])==null?void 0:L.placement;if(!z)switch(f){case"bestFit":{var R;const G=(R=E.filter(j=>{if(C){const M=Vn(j.placement);return M===x||M==="y"}return!0}).map(j=>[j.placement,j.overflows.filter(M=>M>0).reduce((M,H)=>M+H,0)]).sort((j,M)=>j[1]-M[1])[0])==null?void 0:R[0];G&&(z=G);break}case"initialPlacement":z=a;break}if(i!==z)return{reset:{placement:z}}}return{}}}};async function i2(r,e){const{placement:t,platform:n,elements:i}=r,s=await(n.isRTL==null?void 0:n.isRTL(i.floating)),o=cn(t),a=rs(t),l=Vn(t)==="y",u=["left","top"].includes(o)?-1:1,c=s&&l?-1:1,d=ts(e,r);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*c,y:h*u}:{x:h*u,y:f*c}}const s2=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:i,y:s,placement:o,middlewareData:a}=e,l=await i2(e,r);return o===((t=a.offset)==null?void 0:t.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:o}}}}},o2=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:v,y:x}=g;return{x:v,y:x}}},...l}=ts(r,e),u={x:t,y:n},c=await Ac(e,l),d=Vn(cn(i)),h=gm(d);let f=u[h],p=u[d];if(s){const g=h==="y"?"top":"left",v=h==="y"?"bottom":"right",x=f+c[g],b=f-c[v];f=_u(x,f,b)}if(o){const g=d==="y"?"top":"left",v=d==="y"?"bottom":"right",x=p+c[g],b=p-c[v];p=_u(x,p,b)}const m=a.fn({...e,[h]:f,[d]:p});return{...m,data:{x:m.x-t,y:m.y-n,enabled:{[h]:s,[d]:o}}}}}},a2=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:i,rects:s,platform:o,elements:a}=e,{apply:l=()=>{},...u}=ts(r,e),c=await Ac(e,u),d=cn(i),h=rs(i),f=Vn(i)==="y",{width:p,height:m}=s.floating;let g,v;d==="top"||d==="bottom"?(g=d,v=h===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(v=d,g=h==="end"?"top":"bottom");const x=m-c.top-c.bottom,b=p-c.left-c.right,_=ln(m-c[g],x),w=ln(p-c[v],b),C=!e.middlewareData.shift;let P=_,S=w;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(S=b),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(P=x),C&&!h){const E=Ut(c.left,0),U=Ut(c.right,0),L=Ut(c.top,0),R=Ut(c.bottom,0);f?S=p-2*(E!==0||U!==0?E+U:Ut(c.left,c.right)):P=m-2*(L!==0||R!==0?L+R:Ut(c.top,c.bottom))}await l({...e,availableWidth:S,availableHeight:P});const A=await o.getDimensions(a.floating);return p!==A.width||m!==A.height?{reset:{rects:!0}}:{}}}};function Za(){return typeof window<"u"}function ns(r){return xm(r)?(r.nodeName||"").toLowerCase():"#document"}function Lt(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Ir(r){var e;return(e=(xm(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function xm(r){return Za()?r instanceof Node||r instanceof Lt(r).Node:!1}function mr(r){return Za()?r instanceof Element||r instanceof Lt(r).Element:!1}function Fr(r){return Za()?r instanceof HTMLElement||r instanceof Lt(r).HTMLElement:!1}function gh(r){return!Za()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof Lt(r).ShadowRoot}function no(r){const{overflow:e,overflowX:t,overflowY:n,display:i}=gr(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!["inline","contents"].includes(i)}function l2(r){return["table","td","th"].includes(ns(r))}function Qa(r){return[":popover-open",":modal"].some(e=>{try{return r.matches(e)}catch{return!1}})}function Ec(r){const e=Mc(),t=mr(r)?gr(r):r;return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(t.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(t.contain||"").includes(n))}function u2(r){let e=dn(r);for(;Fr(e)&&!Li(e);){if(Ec(e))return e;if(Qa(e))return null;e=dn(e)}return null}function Mc(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Li(r){return["html","body","#document"].includes(ns(r))}function gr(r){return Lt(r).getComputedStyle(r)}function Ja(r){return mr(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function dn(r){if(ns(r)==="html")return r;const e=r.assignedSlot||r.parentNode||gh(r)&&r.host||Ir(r);return gh(e)?e.host:e}function bm(r){const e=dn(r);return Li(e)?r.ownerDocument?r.ownerDocument.body:r.body:Fr(e)&&no(e)?e:bm(e)}function zs(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=bm(r),s=i===((n=r.ownerDocument)==null?void 0:n.body),o=Lt(i);if(s){const a=Su(o);return e.concat(o,o.visualViewport||[],no(i)?i:[],a&&t?zs(a):[])}return e.concat(i,zs(i,[],t))}function Su(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function _m(r){const e=gr(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=Fr(r),s=i?r.offsetWidth:t,o=i?r.offsetHeight:n,a=ha(t)!==s||ha(n)!==o;return a&&(t=s,n=o),{width:t,height:n,$:a}}function Rc(r){return mr(r)?r:r.contextElement}function Ai(r){const e=Rc(r);if(!Fr(e))return un(1);const t=e.getBoundingClientRect(),{width:n,height:i,$:s}=_m(e);let o=(s?ha(t.width):t.width)/n,a=(s?ha(t.height):t.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const c2=un(0);function ym(r){const e=Lt(r);return!Mc()||!e.visualViewport?c2:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function d2(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==Lt(r)?!1:e}function Wn(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=r.getBoundingClientRect(),s=Rc(r);let o=un(1);e&&(n?mr(n)&&(o=Ai(n)):o=Ai(r));const a=d2(s,t,n)?ym(s):un(0);let l=(i.left+a.x)/o.x,u=(i.top+a.y)/o.y,c=i.width/o.x,d=i.height/o.y;if(s){const h=Lt(s),f=n&&mr(n)?Lt(n):n;let p=h,m=Su(p);for(;m&&n&&f!==p;){const g=Ai(m),v=m.getBoundingClientRect(),x=gr(m),b=v.left+(m.clientLeft+parseFloat(x.paddingLeft))*g.x,_=v.top+(m.clientTop+parseFloat(x.paddingTop))*g.y;l*=g.x,u*=g.y,c*=g.x,d*=g.y,l+=b,u+=_,p=Lt(m),m=Su(p)}}return pa({width:c,height:d,x:l,y:u})}function h2(r){let{elements:e,rect:t,offsetParent:n,strategy:i}=r;const s=i==="fixed",o=Ir(n),a=e?Qa(e.floating):!1;if(n===o||a&&s)return t;let l={scrollLeft:0,scrollTop:0},u=un(1);const c=un(0),d=Fr(n);if((d||!d&&!s)&&((ns(n)!=="body"||no(o))&&(l=Ja(n)),Fr(n))){const h=Wn(n);u=Ai(n),c.x=h.x+n.clientLeft,c.y=h.y+n.clientTop}return{width:t.width*u.x,height:t.height*u.y,x:t.x*u.x-l.scrollLeft*u.x+c.x,y:t.y*u.y-l.scrollTop*u.y+c.y}}function f2(r){return Array.from(r.getClientRects())}function wu(r,e){const t=Ja(r).scrollLeft;return e?e.left+t:Wn(Ir(r)).left+t}function p2(r){const e=Ir(r),t=Ja(r),n=r.ownerDocument.body,i=Ut(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=Ut(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-t.scrollLeft+wu(r);const a=-t.scrollTop;return gr(n).direction==="rtl"&&(o+=Ut(e.clientWidth,n.clientWidth)-i),{width:i,height:s,x:o,y:a}}function m2(r,e){const t=Lt(r),n=Ir(r),i=t.visualViewport;let s=n.clientWidth,o=n.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;const u=Mc();(!u||u&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a,y:l}}function g2(r,e){const t=Wn(r,!0,e==="fixed"),n=t.top+r.clientTop,i=t.left+r.clientLeft,s=Fr(r)?Ai(r):un(1),o=r.clientWidth*s.x,a=r.clientHeight*s.y,l=i*s.x,u=n*s.y;return{width:o,height:a,x:l,y:u}}function vh(r,e,t){let n;if(e==="viewport")n=m2(r,t);else if(e==="document")n=p2(Ir(r));else if(mr(e))n=g2(e,t);else{const i=ym(r);n={...e,x:e.x-i.x,y:e.y-i.y}}return pa(n)}function Sm(r,e){const t=dn(r);return t===e||!mr(t)||Li(t)?!1:gr(t).position==="fixed"||Sm(t,e)}function v2(r,e){const t=e.get(r);if(t)return t;let n=zs(r,[],!1).filter(a=>mr(a)&&ns(a)!=="body"),i=null;const s=gr(r).position==="fixed";let o=s?dn(r):r;for(;mr(o)&&!Li(o);){const a=gr(o),l=Ec(o);!l&&a.position==="fixed"&&(i=null),(s?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||no(o)&&!l&&Sm(r,o))?n=n.filter(c=>c!==o):i=a,o=dn(o)}return e.set(r,n),n}function x2(r){let{element:e,boundary:t,rootBoundary:n,strategy:i}=r;const o=[...t==="clippingAncestors"?Qa(e)?[]:v2(e,this._c):[].concat(t),n],a=o[0],l=o.reduce((u,c)=>{const d=vh(e,c,i);return u.top=Ut(d.top,u.top),u.right=ln(d.right,u.right),u.bottom=ln(d.bottom,u.bottom),u.left=Ut(d.left,u.left),u},vh(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function b2(r){const{width:e,height:t}=_m(r);return{width:e,height:t}}function _2(r,e,t){const n=Fr(e),i=Ir(e),s=t==="fixed",o=Wn(r,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=un(0);if(n||!n&&!s)if((ns(e)!=="body"||no(i))&&(a=Ja(e)),n){const f=Wn(e,!0,s,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else i&&(l.x=wu(i));let u=0,c=0;if(i&&!n&&!s){const f=i.getBoundingClientRect();c=f.top+a.scrollTop,u=f.left+a.scrollLeft-wu(i,f)}const d=o.left+a.scrollLeft-l.x-u,h=o.top+a.scrollTop-l.y-c;return{x:d,y:h,width:o.width,height:o.height}}function gl(r){return gr(r).position==="static"}function xh(r,e){if(!Fr(r)||gr(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Ir(r)===t&&(t=t.ownerDocument.body),t}function wm(r,e){const t=Lt(r);if(Qa(r))return t;if(!Fr(r)){let i=dn(r);for(;i&&!Li(i);){if(mr(i)&&!gl(i))return i;i=dn(i)}return t}let n=xh(r,e);for(;n&&l2(n)&&gl(n);)n=xh(n,e);return n&&Li(n)&&gl(n)&&!Ec(n)?t:n||u2(r)||t}const y2=async function(r){const e=this.getOffsetParent||wm,t=this.getDimensions,n=await t(r.floating);return{reference:_2(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function S2(r){return gr(r).direction==="rtl"}const w2={convertOffsetParentRelativeRectToViewportRelativeRect:h2,getDocumentElement:Ir,getClippingRect:x2,getOffsetParent:wm,getElementRects:y2,getClientRects:f2,getDimensions:b2,getScale:Ai,isElement:mr,isRTL:S2};function T2(r,e){let t=null,n;const i=Ir(r);function s(){var a;clearTimeout(n),(a=t)==null||a.disconnect(),t=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const{left:u,top:c,width:d,height:h}=r.getBoundingClientRect();if(a||e(),!d||!h)return;const f=go(c),p=go(i.clientWidth-(u+d)),m=go(i.clientHeight-(c+h)),g=go(u),x={rootMargin:-f+"px "+-p+"px "+-m+"px "+-g+"px",threshold:Ut(0,ln(1,l))||1};let b=!0;function _(w){const C=w[0].intersectionRatio;if(C!==l){if(!b)return o();C?o(!1,C):n=setTimeout(()=>{o(!1,1e-7)},1e3)}b=!1}try{t=new IntersectionObserver(_,{...x,root:i.ownerDocument})}catch{t=new IntersectionObserver(_,x)}t.observe(r)}return o(!0),s}function C2(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,u=Rc(r),c=i||s?[...u?zs(u):[],...zs(e)]:[];c.forEach(v=>{i&&v.addEventListener("scroll",t,{passive:!0}),s&&v.addEventListener("resize",t)});const d=u&&a?T2(u,t):null;let h=-1,f=null;o&&(f=new ResizeObserver(v=>{let[x]=v;x&&x.target===u&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(e)})),t()}),u&&!l&&f.observe(u),f.observe(e));let p,m=l?Wn(r):null;l&&g();function g(){const v=Wn(r);m&&(v.x!==m.x||v.y!==m.y||v.width!==m.width||v.height!==m.height)&&t(),m=v,p=requestAnimationFrame(g)}return t(),()=>{var v;c.forEach(x=>{i&&x.removeEventListener("scroll",t),s&&x.removeEventListener("resize",t)}),d?.(),(v=f)==null||v.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const P2=s2,A2=o2,E2=n2,M2=a2,R2=r2,k2=(r,e,t)=>{const n=new Map,i={platform:w2,...t},s={...i.platform,_c:n};return t2(r,e,{...i,platform:s})},F2={strategy:"absolute",placement:"top",gutter:5,flip:!0,sameWidth:!1,overflowPadding:8},I2={bottom:"rotate(45deg)",left:"rotate(135deg)",top:"rotate(225deg)",right:"rotate(315deg)"};function Tm(r,e,t={}){if(!e||!r||t===null)return{destroy:ze};const n={...F2,...t},i=e.querySelector("[data-arrow=true]"),s=[];n.flip&&s.push(E2({boundary:n.boundary,padding:n.overflowPadding,...yc(n.flip)&&n.flip}));const o=Ve(i)?i.offsetHeight/2:0;if(n.gutter||n.offset){const l=n.gutter?{mainAxis:n.gutter}:n.offset;l?.mainAxis!=null&&(l.mainAxis+=o),s.push(P2(l))}s.push(A2({boundary:n.boundary,crossAxis:n.overlap,padding:n.overflowPadding})),i&&s.push(R2({element:i,padding:8})),s.push(M2({padding:n.overflowPadding,apply({rects:l,availableHeight:u,availableWidth:c}){n.sameWidth&&Object.assign(e.style,{width:`${Math.round(l.reference.width)}px`,minWidth:"unset"}),n.fitViewport&&Object.assign(e.style,{maxWidth:`${c}px`,maxHeight:`${u}px`})}}));function a(){if(!r||!e||Ve(r)&&!r.ownerDocument.documentElement.contains(r))return;const{placement:l,strategy:u}=n;k2(r,e,{placement:l,middleware:s,strategy:u}).then(c=>{const d=Math.round(c.x),h=Math.round(c.y),[f,p]=B2(c.placement);if(e.setAttribute("data-side",f),e.setAttribute("data-align",p),Object.assign(e.style,{position:n.strategy,top:`${h}px`,left:`${d}px`}),Ve(i)&&c.middlewareData.arrow){const{x:m,y:g}=c.middlewareData.arrow,v=c.placement.split("-")[0];i.setAttribute("data-side",v),Object.assign(i.style,{position:"absolute",left:m!=null?`${m}px`:"",top:g!=null?`${g}px`:"",[v]:`calc(100% - ${o}px)`,transform:I2[v],backgroundColor:"inherit",zIndex:"inherit"})}return c})}return Object.assign(e.style,{position:n.strategy}),{destroy:C2(r,e,a)}}function B2(r){const[e,t="center"]=r.split("-");return[e,t]}/*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var Cm=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],ma=Cm.join(","),Pm=typeof Element>"u",jn=Pm?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,ga=!Pm&&Element.prototype.getRootNode?function(r){var e;return r==null||(e=r.getRootNode)===null||e===void 0?void 0:e.call(r)}:function(r){return r?.ownerDocument},va=function r(e,t){var n;t===void 0&&(t=!0);var i=e==null||(n=e.getAttribute)===null||n===void 0?void 0:n.call(e,"inert"),s=i===""||i==="true",o=s||t&&e&&r(e.parentNode);return o},O2=function(e){var t,n=e==null||(t=e.getAttribute)===null||t===void 0?void 0:t.call(e,"contenteditable");return n===""||n==="true"},Am=function(e,t,n){if(va(e))return[];var i=Array.prototype.slice.apply(e.querySelectorAll(ma));return t&&jn.call(e,ma)&&i.unshift(e),i=i.filter(n),i},Em=function r(e,t,n){for(var i=[],s=Array.from(e);s.length;){var o=s.shift();if(!va(o,!1))if(o.tagName==="SLOT"){var a=o.assignedElements(),l=a.length?a:o.children,u=r(l,!0,n);n.flatten?i.push.apply(i,u):i.push({scopeParent:o,candidates:u})}else{var c=jn.call(o,ma);c&&n.filter(o)&&(t||!e.includes(o))&&i.push(o);var d=o.shadowRoot||typeof n.getShadowRoot=="function"&&n.getShadowRoot(o),h=!va(d,!1)&&(!n.shadowRootFilter||n.shadowRootFilter(o));if(d&&h){var f=r(d===!0?o.children:d.children,!0,n);n.flatten?i.push.apply(i,f):i.push({scopeParent:o,candidates:f})}else s.unshift.apply(s,o.children)}}return i},Mm=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},Fn=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||O2(e))&&!Mm(e)?0:e.tabIndex},U2=function(e,t){var n=Fn(e);return n<0&&t&&!Mm(e)?0:n},D2=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},Rm=function(e){return e.tagName==="INPUT"},G2=function(e){return Rm(e)&&e.type==="hidden"},z2=function(e){var t=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(n){return n.tagName==="SUMMARY"});return t},L2=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]},N2=function(e){if(!e.name)return!0;var t=e.form||ga(e),n=function(a){return t.querySelectorAll('input[type="radio"][name="'+a+'"]')},i;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")i=n(window.CSS.escape(e.name));else try{i=n(e.name)}catch(o){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",o.message),!1}var s=L2(i,e.form);return!s||s===e},H2=function(e){return Rm(e)&&e.type==="radio"},V2=function(e){return H2(e)&&!N2(e)},W2=function(e){var t,n=e&&ga(e),i=(t=n)===null||t===void 0?void 0:t.host,s=!1;if(n&&n!==e){var o,a,l;for(s=!!((o=i)!==null&&o!==void 0&&(a=o.ownerDocument)!==null&&a!==void 0&&a.contains(i)||e!=null&&(l=e.ownerDocument)!==null&&l!==void 0&&l.contains(e));!s&&i;){var u,c,d;n=ga(i),i=(u=n)===null||u===void 0?void 0:u.host,s=!!((c=i)!==null&&c!==void 0&&(d=c.ownerDocument)!==null&&d!==void 0&&d.contains(i))}}return s},bh=function(e){var t=e.getBoundingClientRect(),n=t.width,i=t.height;return n===0&&i===0},j2=function(e,t){var n=t.displayCheck,i=t.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var s=jn.call(e,"details>summary:first-of-type"),o=s?e.parentElement:e;if(jn.call(o,"details:not([open]) *"))return!0;if(!n||n==="full"||n==="legacy-full"){if(typeof i=="function"){for(var a=e;e;){var l=e.parentElement,u=ga(e);if(l&&!l.shadowRoot&&i(l)===!0)return bh(e);e.assignedSlot?e=e.assignedSlot:!l&&u!==e.ownerDocument?e=u.host:e=l}e=a}if(W2(e))return!e.getClientRects().length;if(n!=="legacy-full")return!0}else if(n==="non-zero-area")return bh(e);return!1},X2=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if(t.tagName==="FIELDSET"&&t.disabled){for(var n=0;n<t.children.length;n++){var i=t.children.item(n);if(i.tagName==="LEGEND")return jn.call(t,"fieldset[disabled] *")?!0:!i.contains(e)}return!0}t=t.parentElement}return!1},xa=function(e,t){return!(t.disabled||va(t)||G2(t)||j2(t,e)||z2(t)||X2(t))},Tu=function(e,t){return!(V2(t)||Fn(t)<0||!xa(e,t))},q2=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},Y2=function r(e){var t=[],n=[];return e.forEach(function(i,s){var o=!!i.scopeParent,a=o?i.scopeParent:i,l=U2(a,o),u=o?r(i.candidates):a;l===0?o?t.push.apply(t,u):t.push(a):n.push({documentOrder:s,tabIndex:l,item:i,isScope:o,content:u})}),n.sort(D2).reduce(function(i,s){return s.isScope?i.push.apply(i,s.content):i.push(s.content),i},[]).concat(t)},K2=function(e,t){t=t||{};var n;return t.getShadowRoot?n=Em([e],t.includeContainer,{filter:Tu.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:q2}):n=Am(e,t.includeContainer,Tu.bind(null,t)),Y2(n)},$2=function(e,t){t=t||{};var n;return t.getShadowRoot?n=Em([e],t.includeContainer,{filter:xa.bind(null,t),flatten:!0,getShadowRoot:t.getShadowRoot}):n=Am(e,t.includeContainer,xa.bind(null,t)),n},ai=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return jn.call(e,ma)===!1?!1:Tu(t,e)},Z2=Cm.concat("iframe").join(","),vl=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return jn.call(e,Z2)===!1?!1:xa(t,e)};/*!
* focus-trap 7.6.0
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function Q2(r,e,t){return(e=e1(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _h(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function yh(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?_h(Object(t),!0).forEach(function(n){Q2(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):_h(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function J2(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function e1(r){var e=J2(r,"string");return typeof e=="symbol"?e:e+""}var Sh={activateTrap:function(e,t){if(e.length>0){var n=e[e.length-1];n!==t&&n.pause()}var i=e.indexOf(t);i===-1||e.splice(i,1),e.push(t)},deactivateTrap:function(e,t){var n=e.indexOf(t);n!==-1&&e.splice(n,1),e.length>0&&e[e.length-1].unpause()}},t1=function(e){return e.tagName&&e.tagName.toLowerCase()==="input"&&typeof e.select=="function"},r1=function(e){return e?.key==="Escape"||e?.key==="Esc"||e?.keyCode===27},Ts=function(e){return e?.key==="Tab"||e?.keyCode===9},n1=function(e){return Ts(e)&&!e.shiftKey},i1=function(e){return Ts(e)&&e.shiftKey},wh=function(e){return setTimeout(e,0)},Th=function(e,t){var n=-1;return e.every(function(i,s){return t(i)?(n=s,!1):!0}),n},us=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return typeof e=="function"?e.apply(void 0,n):e},vo=function(e){return e.target.shadowRoot&&typeof e.composedPath=="function"?e.composedPath()[0]:e.target},s1=[],o1=function(e,t){var n=t?.document||document,i=t?.trapStack||s1,s=yh({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:n1,isKeyBackward:i1},t),o={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},a,l=function(R,T,B){return R&&R[T]!==void 0?R[T]:s[B||T]},u=function(R,T){var B=typeof T?.composedPath=="function"?T.composedPath():void 0;return o.containerGroups.findIndex(function(z){var G=z.container,j=z.tabbableNodes;return G.contains(R)||B?.includes(G)||j.find(function(M){return M===R})})},c=function(R){var T=s[R];if(typeof T=="function"){for(var B=arguments.length,z=new Array(B>1?B-1:0),G=1;G<B;G++)z[G-1]=arguments[G];T=T.apply(void 0,z)}if(T===!0&&(T=void 0),!T){if(T===void 0||T===!1)return T;throw new Error("`".concat(R,"` was specified but was not a node, or did not return a node"))}var j=T;if(typeof T=="string"&&(j=n.querySelector(T),!j))throw new Error("`".concat(R,"` as selector refers to no known node"));return j},d=function(){var R=c("initialFocus");if(R===!1)return!1;if(R===void 0||!vl(R,s.tabbableOptions))if(u(n.activeElement)>=0)R=n.activeElement;else{var T=o.tabbableGroups[0],B=T&&T.firstTabbableNode;R=B||c("fallbackFocus")}if(!R)throw new Error("Your focus-trap needs to have at least one focusable element");return R},h=function(){if(o.containerGroups=o.containers.map(function(R){var T=K2(R,s.tabbableOptions),B=$2(R,s.tabbableOptions),z=T.length>0?T[0]:void 0,G=T.length>0?T[T.length-1]:void 0,j=B.find(function(W){return ai(W)}),M=B.slice().reverse().find(function(W){return ai(W)}),H=!!T.find(function(W){return Fn(W)>0});return{container:R,tabbableNodes:T,focusableNodes:B,posTabIndexesFound:H,firstTabbableNode:z,lastTabbableNode:G,firstDomTabbableNode:j,lastDomTabbableNode:M,nextTabbableNode:function(O){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,$=T.indexOf(O);return $<0?V?B.slice(B.indexOf(O)+1).find(function(Q){return ai(Q)}):B.slice(0,B.indexOf(O)).reverse().find(function(Q){return ai(Q)}):T[$+(V?1:-1)]}}}),o.tabbableGroups=o.containerGroups.filter(function(R){return R.tabbableNodes.length>0}),o.tabbableGroups.length<=0&&!c("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(o.containerGroups.find(function(R){return R.posTabIndexesFound})&&o.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},f=function(R){var T=R.activeElement;if(T)return T.shadowRoot&&T.shadowRoot.activeElement!==null?f(T.shadowRoot):T},p=function(R){if(R!==!1&&R!==f(document)){if(!R||!R.focus){p(d());return}R.focus({preventScroll:!!s.preventScroll}),o.mostRecentlyFocusedNode=R,t1(R)&&R.select()}},m=function(R){var T=c("setReturnFocus",R);return T||(T===!1?!1:R)},g=function(R){var T=R.target,B=R.event,z=R.isBackward,G=z===void 0?!1:z;T=T||vo(B),h();var j=null;if(o.tabbableGroups.length>0){var M=u(T,B),H=M>=0?o.containerGroups[M]:void 0;if(M<0)G?j=o.tabbableGroups[o.tabbableGroups.length-1].lastTabbableNode:j=o.tabbableGroups[0].firstTabbableNode;else if(G){var W=Th(o.tabbableGroups,function(De){var st=De.firstTabbableNode;return T===st});if(W<0&&(H.container===T||vl(T,s.tabbableOptions)&&!ai(T,s.tabbableOptions)&&!H.nextTabbableNode(T,!1))&&(W=M),W>=0){var O=W===0?o.tabbableGroups.length-1:W-1,V=o.tabbableGroups[O];j=Fn(T)>=0?V.lastTabbableNode:V.lastDomTabbableNode}else Ts(B)||(j=H.nextTabbableNode(T,!1))}else{var $=Th(o.tabbableGroups,function(De){var st=De.lastTabbableNode;return T===st});if($<0&&(H.container===T||vl(T,s.tabbableOptions)&&!ai(T,s.tabbableOptions)&&!H.nextTabbableNode(T))&&($=M),$>=0){var Q=$===o.tabbableGroups.length-1?0:$+1,ue=o.tabbableGroups[Q];j=Fn(T)>=0?ue.firstTabbableNode:ue.firstDomTabbableNode}else Ts(B)||(j=H.nextTabbableNode(T))}}else j=c("fallbackFocus");return j},v=function(R){var T=vo(R);if(!(u(T,R)>=0)){if(us(s.clickOutsideDeactivates,R)){a.deactivate({returnFocus:s.returnFocusOnDeactivate});return}us(s.allowOutsideClick,R)||R.preventDefault()}},x=function(R){var T=vo(R),B=u(T,R)>=0;if(B||T instanceof Document)B&&(o.mostRecentlyFocusedNode=T);else{R.stopImmediatePropagation();var z,G=!0;if(o.mostRecentlyFocusedNode)if(Fn(o.mostRecentlyFocusedNode)>0){var j=u(o.mostRecentlyFocusedNode),M=o.containerGroups[j].tabbableNodes;if(M.length>0){var H=M.findIndex(function(W){return W===o.mostRecentlyFocusedNode});H>=0&&(s.isKeyForward(o.recentNavEvent)?H+1<M.length&&(z=M[H+1],G=!1):H-1>=0&&(z=M[H-1],G=!1))}}else o.containerGroups.some(function(W){return W.tabbableNodes.some(function(O){return Fn(O)>0})})||(G=!1);else G=!1;G&&(z=g({target:o.mostRecentlyFocusedNode,isBackward:s.isKeyBackward(o.recentNavEvent)})),p(z||o.mostRecentlyFocusedNode||d())}o.recentNavEvent=void 0},b=function(R){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;o.recentNavEvent=R;var B=g({event:R,isBackward:T});B&&(Ts(R)&&R.preventDefault(),p(B))},_=function(R){(s.isKeyForward(R)||s.isKeyBackward(R))&&b(R,s.isKeyBackward(R))},w=function(R){r1(R)&&us(s.escapeDeactivates,R)!==!1&&(R.preventDefault(),a.deactivate())},C=function(R){var T=vo(R);u(T,R)>=0||us(s.clickOutsideDeactivates,R)||us(s.allowOutsideClick,R)||(R.preventDefault(),R.stopImmediatePropagation())},P=function(){if(o.active)return Sh.activateTrap(i,a),o.delayInitialFocusTimer=s.delayInitialFocus?wh(function(){p(d())}):p(d()),n.addEventListener("focusin",x,!0),n.addEventListener("mousedown",v,{capture:!0,passive:!1}),n.addEventListener("touchstart",v,{capture:!0,passive:!1}),n.addEventListener("click",C,{capture:!0,passive:!1}),n.addEventListener("keydown",_,{capture:!0,passive:!1}),n.addEventListener("keydown",w),a},S=function(){if(o.active)return n.removeEventListener("focusin",x,!0),n.removeEventListener("mousedown",v,!0),n.removeEventListener("touchstart",v,!0),n.removeEventListener("click",C,!0),n.removeEventListener("keydown",_,!0),n.removeEventListener("keydown",w),a},A=function(R){var T=R.some(function(B){var z=Array.from(B.removedNodes);return z.some(function(G){return G===o.mostRecentlyFocusedNode})});T&&p(d())},E=typeof window<"u"&&"MutationObserver"in window?new MutationObserver(A):void 0,U=function(){E&&(E.disconnect(),o.active&&!o.paused&&o.containers.map(function(R){E.observe(R,{subtree:!0,childList:!0})}))};return a={get active(){return o.active},get paused(){return o.paused},activate:function(R){if(o.active)return this;var T=l(R,"onActivate"),B=l(R,"onPostActivate"),z=l(R,"checkCanFocusTrap");z||h(),o.active=!0,o.paused=!1,o.nodeFocusedBeforeActivation=n.activeElement,T?.();var G=function(){z&&h(),P(),U(),B?.()};return z?(z(o.containers.concat()).then(G,G),this):(G(),this)},deactivate:function(R){if(!o.active)return this;var T=yh({onDeactivate:s.onDeactivate,onPostDeactivate:s.onPostDeactivate,checkCanReturnFocus:s.checkCanReturnFocus},R);clearTimeout(o.delayInitialFocusTimer),o.delayInitialFocusTimer=void 0,S(),o.active=!1,o.paused=!1,U(),Sh.deactivateTrap(i,a);var B=l(T,"onDeactivate"),z=l(T,"onPostDeactivate"),G=l(T,"checkCanReturnFocus"),j=l(T,"returnFocus","returnFocusOnDeactivate");B?.();var M=function(){wh(function(){j&&p(m(o.nodeFocusedBeforeActivation)),z?.()})};return j&&G?(G(m(o.nodeFocusedBeforeActivation)).then(M,M),this):(M(),this)},pause:function(R){if(o.paused||!o.active)return this;var T=l(R,"onPause"),B=l(R,"onPostPause");return o.paused=!0,T?.(),S(),U(),B?.(),this},unpause:function(R){if(!o.paused||!o.active)return this;var T=l(R,"onUnpause"),B=l(R,"onPostUnpause");return o.paused=!1,T?.(),h(),P(),U(),B?.(),this},updateContainerElements:function(R){var T=[].concat(R).filter(Boolean);return o.containers=T.map(function(B){return typeof B=="string"?n.querySelector(B):B}),o.active&&h(),U(),this}},a.updateContainerElements(e),a};const a1=(r,e={})=>{let t=ze;const n=i=>{t();const s=o1(r,{returnFocusOnDeactivate:!1,allowOutsideClick:!0,escapeDeactivates:!1,clickOutsideDeactivates:!1,...i});t=s.deactivate,s.activate()};return n(e),{destroy:t,update:n}},l1=(r,e)=>{let t=ze;function n(i){t();const{onClose:s,shouldCloseOnInteractOutside:o,closeOnInteractOutside:a}=i;function l(){s?.()}function u(d){const h=d.target;es(h)&&d.stopImmediatePropagation()}function c(d){o?.(d)&&(d.stopImmediatePropagation(),l())}t=kc(r,{onInteractOutsideStart:u,onInteractOutside:a?c:void 0,enabled:a}).destroy}return n(e),{update:n,destroy(){t()}}},Cu=new Set,u1=(r,e={})=>{Cu.add(r);let t=ze,n=ze;const i=pm(r);let s=!1;const o=l=>{t(),a();const u={enabled:!0,...l},c=Sc(u.enabled)?u.enabled:Et(Gt(u.enabled));t=ft(Nn(i,"pointerdown",h=>{const f=h.target;!d1(r)||!Ve(f)||!c.get()||(s=Tc(r,f),s&&(n=c1(r)))},!0),Nn(i,"pointerup",a,!0))},a=()=>{n(),n=ze,s=!1};return o(e),{destroy(){Cu.delete(r),t(),a()},update:o}},c1=r=>{const e=document.body,t=Ch(e),n=Ch(r);return xo(e,"none"),xo(r,"text"),()=>{xo(e,t),xo(r,n)}},Ch=r=>r.style.userSelect||r.style.webkitUserSelect,xo=(r,e)=>{r.style.userSelect=e,r.style.webkitUserSelect=e},d1=r=>[...Cu].at(-1)===r,h1={floating:{},focusTrap:{},modal:{},escapeKeydown:{},portal:"body",preventTextSelectionOverflow:{}},f1=(r,e)=>{r.dataset.escapee="";const{anchorElement:t,open:n,options:i}=e;if(!t||!n||!i)return{destroy:ze};const s={...h1,...i},o=[];s.portal!==null&&o.push(km(r,s.portal).destroy),o.push(Tm(t,r,s.floating).destroy),s.focusTrap!==null&&o.push(a1(r,{fallbackFocus:r,...s.focusTrap}).destroy),s.modal!==null&&o.push(l1(r,{onClose:()=>{Ve(t)&&(n.set(!1),t.focus())},shouldCloseOnInteractOutside:l=>!(l.defaultPrevented||Ve(t)&&t.contains(l.target)),...s.modal}).destroy),s.escapeKeydown!==null&&o.push(mm(r,{handler:()=>{n.set(!1)},...s.escapeKeydown}).destroy),s.preventTextSelectionOverflow!==null&&o.push(u1(r).destroy);const a=ft(...o);return{destroy(){a()}}},km=(r,e="body")=>{let t;if(!Ve(e)&&typeof e!="string")return{destroy:ze};async function n(s="body"){if(e=s,typeof e=="string"){if(t=document.querySelector(e),t===null&&(await zr(),t=document.querySelector(e)),t===null)throw new Error(`No element found matching css selector: "${e}"`)}else if(e instanceof HTMLElement)t=e;else throw new TypeError(`Unknown portal target type: ${e===null?"null":typeof e}. Allowed types: string (CSS selector) or HTMLElement.`);r.dataset.portal="",t.appendChild(r),r.hidden=!1}function i(){r.remove()}return n(e),{update:n,destroy:i}},Pu=new Set,kc=(r,e={})=>{let t=ze,n=ze,i=ze,s=ze;Pu.add(r);const o=pm(r);let a=!1,l=!1;const u={pointerdown:!1,pointerup:!1,mousedown:!1,mouseup:!1,touchstart:!1,touchend:!1,click:!1},c=()=>{for(const v in u)u[v]=!1},d=()=>{for(const v of Object.values(u))if(v)return!0;return!1},h=(v,x)=>Nn(o,v,b=>{u[v]=!0,x?.(b)},!0),f=(v,x)=>Nn(o,v,b=>{u[v]=!1,x?.(b)});function p(v){t(),n(),i(),s(),c();const{onInteractOutside:x,onInteractOutsideStart:b,enabled:_}={enabled:!0,...v};if(!_)return;let w=!1;const C=jo(E=>{if(!w||d())return;x&&Ph(E,r)&&b?.(E);const U=E.target;es(U)&&Tc(r,U)&&(l=!0),a=!0},10);n=C.destroy;const P=jo(E=>{w&&!d()&&m(E)&&x?.(E),g()},10);i=P.destroy;const S=jo(c,20);s=S.destroy;const A=()=>{w=p1(r)};t=ft(h("pointerdown",A),h("mousedown",A),h("touchstart",A),h("pointerup",S),h("mouseup",S),h("touchend",S),h("click",S),f("pointerdown",C),f("mousedown",C),f("touchstart",C),f("pointerup",P),f("mouseup",P),f("touchend",P),f("click",P))}function m(v){return!!(a&&!l&&Ph(v,r))}function g(){a=!1,l=!1}return p(e),{update:p,destroy(){t(),n(),i(),s(),Pu.delete(r)}}};function Ph(r,e){if("button"in r&&r.button>0)return!1;const t=r.target;if(!es(t))return!1;const n=t.ownerDocument;return!n||!n.documentElement.contains(t)?!1:e&&!Tc(e,t)}function p1(r){return Array.from(Pu).at(-1)===r}function m1(){return{elements:{root:Je("label",{action:e=>({destroy:Ue(e,"mousedown",n=>{!n.defaultPrevented&&n.detail>1&&n.preventDefault()})})})}}}const g1=[ee.ARROW_LEFT,ee.ESCAPE,ee.ARROW_RIGHT,ee.SHIFT,ee.CAPS_LOCK,ee.CONTROL,ee.ALT,ee.META,ee.ENTER,ee.F1,ee.F2,ee.F3,ee.F4,ee.F5,ee.F6,ee.F7,ee.F8,ee.F9,ee.F10,ee.F11,ee.F12],v1={positioning:{placement:"bottom",sameWidth:!0},scrollAlignment:"nearest",loop:!0,defaultOpen:!1,closeOnOutsideClick:!0,preventScroll:!0,escapeBehavior:"close",forceVisible:!1,portal:"body",builder:"listbox",disabled:!1,required:!1,name:void 0,typeahead:!0,highlightOnHover:!0,onOutsideClick:void 0,preventTextSelectionOverflow:!0},x1=["trigger","menu","label"];function b1(r){const e={...v1,...r},t=Et(xe(null)),n=Et(xe(null)),i=e.selected??xe(e.defaultSelected),s=zi(i,e?.onSelectedChange),o=mt(n,q=>q?B(q):void 0),a=e.open??xe(e.defaultOpen),l=zi(a,e?.onOpenChange),u=Hn({...Jn(e,"open","defaultOpen","builder","ids"),multiple:e.multiple??!1}),{scrollAlignment:c,loop:d,closeOnOutsideClick:h,escapeBehavior:f,preventScroll:p,portal:m,forceVisible:g,positioning:v,multiple:x,arrowSize:b,disabled:_,required:w,typeahead:C,name:P,highlightOnHover:S,onOutsideClick:A,preventTextSelectionOverflow:E}=u,{name:U,selector:L}=Ji(e.builder),R=Hn({...wc(x1),...e.ids}),{handleTypeaheadSearch:T}=Uy({onMatch:q=>{n.set(q),q.scrollIntoView({block:c.get()})},getCurrentItem(){return n.get()}});function B(q){const re=q.getAttribute("data-value"),we=q.getAttribute("data-label"),ce=q.hasAttribute("data-disabled");return{value:re&&JSON.parse(re),label:we??q.textContent??void 0,disabled:!!ce}}const z=q=>{s.update(re=>{if(x.get()){const ce=Array.isArray(re)?[...re]:[];return ty(q,ce,(ot,je)=>hr(ot.value,je.value))}return q})};function G(q){const re=B(q);z(re)}async function j(){l.set(!0),await zr();const q=document.getElementById(R.menu.get());if(!Ve(q))return;const re=q.querySelector("[aria-selected=true]");Ve(re)&&n.set(re)}function M(){l.set(!1),n.set(null)}const H=Iy({open:l,forceVisible:g,activeTrigger:t}),W=mt([s],([q])=>re=>Array.isArray(q)?q.some(we=>hr(we.value,re)):yc(re)?hr(q?.value,ny(re,void 0)):hr(q?.value,re)),O=mt([o],([q])=>re=>hr(q?.value,re)),V=Je(U("trigger"),{stores:[l,n,_,R.menu,R.trigger,R.label],returned:([q,re,we,ce,ot,je])=>({"aria-activedescendant":re?.id,"aria-autocomplete":"list","aria-controls":ce,"aria-expanded":q,"aria-labelledby":je,"data-state":q?"open":"closed",id:ot,role:"combobox",disabled:vt(we),type:e.builder==="select"?"button":void 0}),action:q=>{t.set(q);const re=cm(q),we=ft(Ue(q,"click",()=>{q.focus(),l.get()?M():j()}),Ue(q,"keydown",ce=>{if(!l.get()){if(g1.includes(ce.key)||ce.key===ee.TAB||ce.key===ee.BACKSPACE&&re&&q.value===""||ce.key===ee.SPACE&&dh(q))return;j(),zr().then(()=>{if(s.get())return;const or=document.getElementById(R.menu.get());if(!Ve(or))return;const Ze=Array.from(or.querySelectorAll(`${L("item")}:not([data-disabled]):not([data-hidden])`)).filter(_r=>Ve(_r));Ze.length&&(ce.key===ee.ARROW_DOWN?(n.set(Ze[0]),Ze[0].scrollIntoView({block:c.get()})):ce.key===ee.ARROW_UP&&(n.set(hl(Ze)),hl(Ze).scrollIntoView({block:c.get()})))})}if(ce.key===ee.TAB){M();return}if(ce.key===ee.ENTER&&!ce.isComposing||ce.key===ee.SPACE&&dh(q)){ce.preventDefault();const je=n.get();je&&G(je),x.get()||M()}if(ce.key===ee.ARROW_UP&&ce.altKey&&M(),xy.includes(ce.key)){ce.preventDefault();const je=document.getElementById(R.menu.get());if(!Ve(je))return;const or=fl(je);if(!or.length)return;const Ze=or.filter(fo=>!hh(fo)&&fo.dataset.hidden===void 0),_r=n.get(),qt=_r?Ze.indexOf(_r):-1,yr=d.get(),cl=c.get();let ar;switch(ce.key){case ee.ARROW_DOWN:ar=Q_(Ze,qt,yr);break;case ee.ARROW_UP:ar=J_(Ze,qt,yr);break;case ee.PAGE_DOWN:ar=Z_(Ze,qt,10,yr);break;case ee.PAGE_UP:ar=$_(Ze,qt,10,yr);break;case ee.HOME:ar=Ze[0];break;case ee.END:ar=hl(Ze);break;default:return}n.set(ar),ar?.scrollIntoView({block:cl})}else if(C.get()){const je=document.getElementById(R.menu.get());if(!Ve(je))return;T(ce.key,fl(je))}}));return{destroy(){t.set(null),we()}}}}),$=Je(U("menu"),{stores:[H,R.menu],returned:([q,re])=>({hidden:q?void 0:!0,id:re,role:"listbox",style:q?void 0:qr({display:"none"})}),action:q=>{let re=ze;const we=ft(Zt([H,m,h,v,t],([ce,ot,je,or,Ze])=>{re(),!(!ce||!Ze)&&zr().then(()=>{re();const _r=Gy(R.trigger.get());re=f1(q,{anchorElement:Ze,open:l,options:{floating:or,focusTrap:null,modal:{closeOnInteractOutside:je,onClose:M,shouldCloseOnInteractOutside:qt=>{if(A.get()?.(qt),qt.defaultPrevented)return!1;const yr=qt.target;return!(!es(yr)||yr===Ze||Ze.contains(yr)||_r(qt))}},escapeKeydown:{handler:M,behaviorType:f},portal:fm(q,ot),preventTextSelectionOverflow:{enabled:E}}}).destroy})}));return{destroy:()=>{we(),re()}}}}),{elements:{root:Q}}=m1(),{action:ue}=$a(Q),De=Je(U("label"),{stores:[R.label,R.trigger],returned:([q,re])=>({id:q,for:re}),action:ue}),st=Je(U("option"),{stores:[W],returned:([q])=>re=>{const we=q(re.value);return{"data-value":JSON.stringify(re.value),"data-label":re.label,"data-disabled":vt(re.disabled),"aria-disabled":re.disabled?!0:void 0,"aria-selected":we,"data-selected":we?"":void 0,id:bi(),role:"option"}},action:q=>({destroy:ft(Ue(q,"click",we=>{if(hh(q)){we.preventDefault();return}G(q),x.get()||M()}),Zt(S,we=>we?ft(Ue(q,"mouseover",()=>{n.set(q)}),Ue(q,"mouseleave",()=>{n.set(null)})):void 0))})}),Xt=Je(U("group"),{returned:()=>q=>({role:"group","aria-labelledby":q})}),xn=Je(U("group-label"),{returned:()=>q=>({id:q})}),ri=Hy({value:mt([s],([q])=>{const re=Array.isArray(q)?q.map(we=>we.value):q?.value;return typeof re=="string"?re:JSON.stringify(re)}),name:Wo(P),required:w,prefix:e.builder}),Ce=Je(U("arrow"),{stores:b,returned:q=>({"data-arrow":!0,style:qr({position:"absolute",width:`var(--arrow-size, ${q}px)`,height:`var(--arrow-size, ${q}px)`})})});return Zt([n],([q])=>{if(!an)return;const re=document.getElementById(R.menu.get());Ve(re)&&fl(re).forEach(we=>{we===q?uy(we):cy(we)})}),Zt([l,p],([q,re])=>{if(!(!an||!q||!re))return Fy()}),{ids:R,elements:{trigger:V,group:Xt,option:st,menu:$,groupLabel:xn,label:De,hiddenInput:ri,arrow:Ce},states:{open:l,selected:s,highlighted:o,highlightedItem:n},helpers:{isSelected:W,isHighlighted:O,closeMenu:M},options:u}}const _1={isDateDisabled:void 0,isDateUnavailable:void 0,value:void 0,preventDeselect:!1,numberOfMonths:1,pagedNavigation:!1,weekStartsOn:0,fixedWeeks:!1,calendarLabel:"Event Date",locale:"en",minValue:void 0,maxValue:void 0,disabled:!1,readonly:!1,weekdayFormat:"narrow"};({...Jn(_1,"isDateDisabled","isDateUnavailable","value","locale","disabled","readonly","minValue","maxValue","weekdayFormat")});function y1(r){const e=b1({...r,builder:"select"}),t=mt(e.states.selected,n=>Array.isArray(n)?n.map(i=>i.label).join(", "):n?.label??"");return{...e,elements:{...e.elements},states:{...e.states,selectedLabel:t}}}function Sr(r,e="default"){const t=Kt(r);cm(t)&&(t.focus(),e==="start"?t.setSelectionRange(0,0):e==="end"&&t.setSelectionRange(t.value.length,t.value.length))}function wr(r,e){if(!r){e.set(null);return}e.set({id:r.getAttribute("data-tag-id")??"",value:r.getAttribute("data-tag-value")??""})}function Ah(r){const e=document.querySelector(r);if(!Ve(e))return;e.focus();const t=document.createRange();t.selectNodeContents(e);const n=window.getSelection();n&&(n.removeAllRanges(),n.addRange(t))}const S1={placeholder:"",disabled:!1,editable:!0,defaultTags:[],unique:!1,trim:!0,blur:"nothing",addOnPaste:!1,maxTags:void 0,allowed:[],denied:[],add:void 0,remove:void 0,update:void 0},{name:cs,attribute:w1,selector:li}=Ji("tags-input");function T1(r){const e={...S1,...r},t=wc(["root","input"]),n=Hn(Jn(e,"tags")),{placeholder:i,disabled:s,editable:o,unique:a,trim:l,blur:u,addOnPaste:c,allowed:d,denied:h,add:f,remove:p,update:m,maxTags:g}=n,v=xe(""),x=xe(!1),b=xe(""),_=e.tags??xe(e.defaultTags&&e.defaultTags.length>0?typeof e.defaultTags[0]=="string"?e.defaultTags.map(M=>({id:bi(),value:M})):e.defaultTags:[]),w=zi(_,e?.onTagsChange),C=Et.writable(e.selected??null),P=Et.writable(null),S=M=>{const H=w.get(),W=P.get(),O=d.get(),V=h.get(),$=g.get();return l.get()&&(M=M.trim()),!(a.get()&&W?.value!==M&&H.findIndex(ue=>ue.value===M)>=0||O&&O.length>0&&!O.includes(M)||V&&V.length>0&&V.includes(M)||$&&$>0&&H.length>=$)},A=async M=>{const H=f.get();let W={id:"",value:M};if(H)try{const O=await H(M);typeof O=="string"?W.value=O:W=O,W.id||(W.id=bi())}catch{return!1}else W.id=bi();return l.get()&&(W.value=W.value.trim()),S(W.value)?(w.update(O=>(O.push(W),O)),!0):!1};async function E(M,H=!1){const W=m.get(),O=M.id;let V=M;if(W)try{V=await W(V),V.id||(V.id=bi())}catch{return!1}return l.get()&&(V.value=V.value.trim()),S(V.value)?(w.update($=>$.map(Q=>Q.id===O?V:Q)),H&&C.set(V),!0):!1}async function U(M){const H=p.get();if(H)try{if(!await H(M))return!1}catch{return!1}const O=w.get().findIndex(V=>V.id===M.id);return w.update(V=>(V.splice(O,1),V)),!0}const L=mt([o,P],([M,H])=>W=>M&&H?.id===W.id),R=Je(cs(""),{stores:[s],returned:([M])=>({"data-melt-id":t.root,"data-disabled":vt(M),disabled:vt(M)}),action:M=>({destroy:ft(Ue(M,"mousedown",W=>{const O=W.target;Ve(O)&&O.hasAttribute(w1())&&(W.preventDefault(),Sr(t.input))}))})}),T=Je(cs("input"),{stores:[s,i],returned:([M,H])=>({"data-melt-id":t.input,"data-disabled":vt(M),disabled:vt(M),placeholder:H}),action:M=>{const H=O=>{const V=Kt(t.root);let $=[],Q=-1,ue=-1,De=-1;return V&&($=Array.from(V.querySelectorAll(li("tag"))),Q=$.findIndex(st=>st.getAttribute("data-tag-id")===O),ue=Q-1,De=Q+1),{tagsEl:$,selectedIndex:Q,prevIndex:ue,nextIndex:De}};return{destroy:ft(Ue(M,"focus",()=>{const O=Kt(t.root);O&&O.setAttribute("data-focus",""),M.setAttribute("data-focus","")}),Ue(M,"blur",async()=>{const O=Kt(t.root);O&&O.removeAttribute("data-focus"),M.removeAttribute("data-focus"),C.set(null);const V=M.value;if(!V)return;const $=u.get();$==="clear"?M.value="":$==="add"&&(S(V)&&await A(V)?(M.value="",v.set("")):x.set(!0))}),Ue(M,"paste",async O=>{const V=O.clipboardData?.getData("text");if(!V||!c.get())return;O.preventDefault();const $=V.split(",");e:for(let Q=0;Q<$.length;Q++){const ue=$[Q];if(S(ue)&&await A(ue))continue e;M.value=$.slice(Q).join(","),x.set(!0);return}}),Ue(M,"keydown",async O=>{const V=C.get();if(V){if(O.key.length===1)C.set(null);else if(O.key===ee.ARROW_LEFT){O.preventDefault();const{tagsEl:$,prevIndex:Q}=H(V.id);Q>=0&&wr($[Q],C)}else if(O.key===ee.ARROW_RIGHT){O.preventDefault();const{tagsEl:$,nextIndex:Q}=H(V.id);Q===-1||Q>=$.length?(C.set(null),Sr(t.input,"start")):wr($[Q],C)}else if(O.key===ee.HOME){O.preventDefault();const{tagsEl:$}=H(V.id);$.length>0&&wr($[0],C)}else if(O.key===ee.END)O.preventDefault(),C.set(null),Sr(t.input);else if(O.key===ee.DELETE){O.preventDefault();const $=V,{tagsEl:Q,nextIndex:ue}=H(V.id);ue===-1||ue>=Q.length?(C.set(null),Sr(t.input)):wr(Q[ue],C),await U($)||C.set($)}else if(O.key===ee.BACKSPACE){O.preventDefault();const $=V,{tagsEl:Q,nextIndex:ue,prevIndex:De}=H(V.id);De>=0?wr(Q[De],C):ue===-1||ue>=Q.length?(C.set(null),Sr(t.input,"start")):wr(Q[ue],C),await U($)||C.set($)}else if(O.key===ee.ENTER){O.preventDefault();const $=document.querySelector(li("edit")+`[data-tag-id="${V.id}"]`);if(!$)return;P.set({id:V.id,value:V.value}),$.textContent=V.value,await zr(),Ah(li("edit")+`[data-tag-id="${V.id}"]`)}}else if(O.key===ee.ENTER){O.preventDefault();const $=M.value;if(!$)return;S($)&&await A($)?(M.value="",v.set("")):x.set(!0)}else if(M.selectionStart===0&&M.selectionEnd===0&&(O.key===ee.ARROW_LEFT||O.key===ee.BACKSPACE)){O.preventDefault();const{tagsEl:$}=H(""),Q=$.at(-1);if(!Q)return;wr(Q,C)}}),Ue(M,"input",()=>{v.set(M.value)}))}}}),B=Je(cs("tag"),{stores:[C,P,s,o],returned:([M,H,W,O])=>V=>{const $=W||V.disabled,Q=O&&V.editable!==!1,ue=$?void 0:M?.id===V?.id,De=Q?H?.id===V?.id:void 0;return{"aria-hidden":De,"aria-selected":ue,"data-tag-id":V.id,"data-tag-value":V.value,"data-selected":ue?"":void 0,"data-editable":Q?"":void 0,"data-editing":De?"":void 0,"data-disabled":vt($),disabled:vt($),hidden:De,tabindex:-1,style:De?qr({position:"absolute",opacity:0,"pointer-events":"none",margin:0}):void 0}},action:M=>{const H=()=>({id:M.getAttribute("data-tag-id")??""});return{destroy:ft(Ue(M,"mousedown",O=>{const V=P.get();V&&V.id!==H().id||(Sr(t.input),O.preventDefault(),wr(M,C),P.set(null))}),Ue(M,"click",O=>{const V=P.get();V&&V.id===H().id||(Sr(t.input),O.preventDefault(),wr(M,C),P.set(null))}),Ue(M,"dblclick",async()=>{if(!an||!M.hasAttribute("data-editable"))return;const O=document.querySelector(li("edit")+`[data-tag-id="${H().id}"]`);if(!O)return;const V=M.getAttribute("data-tag-value")??"";P.set({id:M.getAttribute("data-tag-id")??"",value:V}),O.textContent=V,await zr(),Ah(li("edit")+`[data-tag-id="${H().id}"]`)}))}}}),z=Je(cs("delete-trigger"),{stores:[C,P,s,o],returned:([M,H,W,O])=>V=>{const $=W||V.disabled,Q=O&&V.editable!==!1,ue=$?void 0:M?.id===V?.id,De=Q?H?.id===V?.id:void 0;return{"aria-selected":ue,"data-tag-id":V.id,"data-tag-value":V.value,"data-selected":ue?"":void 0,"data-editing":De?"":void 0,"data-disabled":vt($),disabled:vt($),tabindex:-1}},action:M=>{function H(){if(M.hasAttribute("data-disabled"))return;const O=M.getAttribute("data-tag-value")??"",V=M.getAttribute("data-tag-id")??"";U({id:V,value:O}),Sr(t.input)}return{destroy:ft(Ue(M,"click",O=>{O.stopPropagation(),H()}),Ue(M,"keydown",O=>{O.key!==ee.ENTER&&O.key!==ee.SPACE||(O.preventDefault(),H())}))}}}),G=Je(cs("edit"),{stores:L,returned:M=>H=>{const W=M(H);return{"aria-hidden":!W,"data-tag-id":H.id,"data-tag-value":H.value,hidden:W?void 0:!0,contenteditable:W,tabindex:-1,style:W?void 0:qr({position:"absolute",opacity:0,"pointer-events":"none",margin:0})}},action:M=>{const H=()=>{const $=M.getAttribute("data-tag-id")??"",Q=M.getAttribute("data-tag-value")??"";return{id:$,value:Q}};let W=ze,O=ze;const V=Zt(L,$=>{W(),O(),$(H())&&(W=kc(M).destroy,O=ft(Ue(M,"blur",()=>{P.set(null),M.textContent=H().value,Kt(t.root)?.removeAttribute("data-invalid-edit"),M.removeAttribute("data-invalid-edit")}),Ue(M,"keydown",async Q=>{if(Q.key===ee.ENTER){Q.preventDefault();const ue=M.textContent;if(!ue)return;const De={id:H().id,value:ue};S(ue)&&await E(De,!0)?(M.textContent=De.value,b.set(""),Sr(t.input)):(Kt(t.root)?.setAttribute("data-invalid-edit",""),M.setAttribute("data-invalid-edit",""))}else Q.key===ee.ESCAPE&&(Q.preventDefault(),Q.stopImmediatePropagation(),M.textContent=H().value,b.set(""),wr(M,C),Sr(t.input))}),Ue(M,"input",()=>{b.set(M.textContent||"")})))});return{destroy(){W(),O(),V()}}}}),j=mt(C,M=>H=>M?.id===H.id);return Zt(v,()=>{x.set(!1)}),Zt(x,M=>{M?(Kt(t.root)?.setAttribute("data-invalid",""),Kt(t.input)?.setAttribute("data-invalid","")):(Kt(t.root)?.removeAttribute("data-invalid"),Kt(t.input)?.removeAttribute("data-invalid"))}),Zt(b,()=>{if(!an)return;Kt(t.root)?.removeAttribute("data-invalid-edit"),Array.from(document.querySelectorAll(li("edit")+"[data-invalid-edit]")).forEach(H=>{H.removeAttribute("data-invalid-edit")})}),{ids:t,elements:{root:R,input:T,deleteTrigger:z,edit:G,tag:B},states:{tags:w,inputValue:Wo(v),inputInvalid:Wo(x),selected:Wo(C)},helpers:{isSelected:j,isEditing:L,isInputValid:S,addTag:A,updateTag:E,removeTag:U},options:n}}const C1={type:"single",orientation:"horizontal",loop:!0,rovingFocus:!0,disabled:!1,defaultValue:""},{name:Eh,selector:bo}=Ji("toggle-group"),P1=r=>{const e={...C1,...r},t=Hn(Jn(e,"value")),{type:n,orientation:i,loop:s,rovingFocus:o,disabled:a}=t,l=e.defaultValue?e.defaultValue:e.type==="single"?void 0:[],u=e.value??xe(l),c=zi(u,e?.onValueChange),d=Je(Eh(),{stores:i,returned:p=>({role:"group","data-orientation":p})}),h=Je(Eh("item"),{stores:[c,a,i,n],returned:([p,m,g,v])=>x=>{const b=typeof x=="string"?x:x.value,_=typeof x=="string"?!1:!!x.disabled,w=m||_,C=Array.isArray(p)?p.includes(b):p===b,P=v==="single",S=v==="multiple"||v===void 0;return{disabled:vt(w),pressed:C,"data-orientation":g,"data-disabled":vt(w),"data-state":C?"on":"off","data-value":b,"aria-pressed":S?C:void 0,"aria-checked":P?C:void 0,type:"button",role:P?"radio":void 0,tabindex:C?0:-1}},action:p=>{let m=ze;const g=p.closest(bo());if(!Ve(g))return{};const v=Array.from(g.querySelectorAll(bo("item"))),x=c.get();!(Array.isArray(x)?x.length>0:!!x)&&v[0]===p&&(p.tabIndex=0);function _(){const C=p.dataset.value,P=p.dataset.disabled==="true";return{value:C,disabled:P}}function w(){const{value:C,disabled:P}=_();C===void 0||P||c.update(S=>Array.isArray(S)?S.includes(C)?S.filter(A=>A!==C):[...S,C]:S===C?void 0:C)}return m=ft(Ue(p,"click",()=>{w()}),Ue(p,"keydown",C=>{if(C.key===ee.SPACE||C.key===ee.ENTER){C.preventDefault(),w();return}if(!o.get())return;const P=C.currentTarget;if(!Ve(P))return;const S=P.closest(bo());if(!Ve(S))return;const A=Array.from(S.querySelectorAll(bo("item")+":not([data-disabled])")).filter(z=>Ve(z)),E=A.indexOf(P),U=hy(P),L=i.get(),R={horizontal:U==="rtl"?ee.ARROW_LEFT:ee.ARROW_RIGHT,vertical:ee.ARROW_DOWN}[L??"horizontal"],T={horizontal:U==="rtl"?ee.ARROW_RIGHT:ee.ARROW_LEFT,vertical:ee.ARROW_UP}[L??"horizontal"],B=s.get();if(C.key===R){C.preventDefault();const z=E+1;z>=A.length&&B?Cn(A[0]):Cn(A[z])}else if(C.key===T){C.preventDefault();const z=E-1;z<0&&B?Cn(A[A.length-1]):Cn(A[z])}else C.key===ee.HOME?(C.preventDefault(),Cn(A[0])):C.key===ee.END&&(C.preventDefault(),Cn(A[A.length-1]))})),{destroy:m}}}),f=mt(c,p=>m=>Array.isArray(p)?p.includes(m):p===m);return{elements:{root:d,item:h},states:{value:c},helpers:{isPressed:f},options:t}},A1={positioning:{placement:"bottom"},arrowSize:8,defaultOpen:!1,closeOnPointerDown:!0,openDelay:1e3,closeDelay:0,forceVisible:!1,portal:"body",escapeBehavior:"close",disableHoverableContent:!1,group:void 0},{name:xl}=Ji("tooltip"),_o=new Map,E1=["trigger","content"];function M1(r){const e={...A1,...r},t=Hn(Jn(e,"open","ids")),{positioning:n,arrowSize:i,closeOnPointerDown:s,openDelay:o,closeDelay:a,forceVisible:l,portal:u,escapeBehavior:c,disableHoverableContent:d,group:h}=t,f=e.open??xe(e.defaultOpen),p=zi(f,e?.onOpenChange),m=xe(null),g=Hn({...wc(E1),...e.ids});let v=!1,x=!1,b=!1;const _=T=>an?document.getElementById(g[T].get()):null;let w=null,C=null;function P(T){C&&(window.clearTimeout(C),C=null),w||(w=window.setTimeout(()=>{p.set(!0),m.update(B=>B??T),w=null},o.get()))}function S(T){if(w&&(window.clearTimeout(w),w=null),T&&R){m.set("pointer");return}C||(C=window.setTimeout(()=>{p.set(!1),m.set(null),T&&(v=!1),C=null},a.get()))}const A=mt([p,l],([T,B])=>T||B),E=Je(xl("trigger"),{stores:[g.content,g.trigger,p],returned:([T,B,z])=>({"aria-describedby":T,id:B,"data-state":z?"open":"closed"}),action:T=>{const B=ft(Ue(T,"pointerdown",()=>{s.get()&&(p.set(!1),v=!0,w&&(window.clearTimeout(w),w=null))}),Ue(T,"pointerenter",z=>{x=!0,!fh(z)&&P("pointer")}),Ue(T,"pointerleave",z=>{x=!1,!fh(z)&&w&&(window.clearTimeout(w),w=null)}),Ue(T,"focus",()=>{v||P("focus")}),Ue(T,"blur",()=>S(!0)));return{destroy(){B(),x=!1}}}}),U=Je(xl("content"),{stores:[A,p,u,g.content],returned:([T,B,z,G])=>({role:"tooltip",hidden:T?void 0:!0,tabindex:-1,style:T?void 0:qr({display:"none"}),id:G,"data-portal":ry(z),"data-state":B?"open":"closed"}),action:T=>{let B=ze,z=ze,G=ze,j=ze;const M=Zt([A,n,u],([O,V,$])=>{z(),B(),G(),j();const Q=_("trigger");!O||!Q||zr().then(()=>{z(),B(),G(),j();const ue=fm(T,$);ue!==null&&(z=km(T,ue).destroy),B=Tm(Q,T,V).destroy,G=kc(T).destroy,j=mm(T,{behaviorType:c,handler:()=>{w&&(window.clearTimeout(w),w=null),p.set(!1)}}).destroy})});function H(O){if(!p.get())return;const V=O.target;if(!es(V)&&!sy(V))return;const $=_("trigger");$&&V.contains($)&&S()}const W=ft(Ue(T,"pointerenter",()=>{b=!0,P("pointer")}),Ue(T,"pointerleave",()=>{b=!1}),Ue(T,"pointerdown",()=>P("pointer")),Nn(window,"scroll",H,{capture:!0}));return{destroy(){b=!1,W(),z(),B(),M(),G()}}}}),L=Je(xl("arrow"),{stores:i,returned:T=>({"data-arrow":!0,style:qr({position:"absolute",width:`var(--arrow-size, ${T}px)`,height:`var(--arrow-size, ${T}px)`})})});let R=!1;return Zt(p,T=>{const B=h.get();if(B===void 0||B===!1)return;if(!T){_o.get(B)===p&&_o.delete(B);return}_o.get(B)?.set(!1),_o.set(B,p)}),Zt([p,m],([T,B])=>{if(!(!T||!an))return ft(Nn(document,"mousemove",z=>{const G=_("content"),j=_("trigger");if(!G||!j)return;const M=d.get()?[j]:[j,G],H=Ey(M);R=x||b||zy(z,H),B==="pointer"&&(R||S())}))}),{ids:g,elements:{trigger:E,content:U,arrow:L},states:{open:p},options:t}}const R1=r=>r;function k1(r){const e=r-1;return e*e*e+1}function Fm(r,{delay:e=0,duration:t=400,easing:n=R1}={}){const i=+getComputedStyle(r).opacity;return{delay:e,duration:t,easing:n,css:s=>`opacity: ${s*i}`}}function Fc(r,{delay:e=0,duration:t=400,easing:n=k1,axis:i="y"}={}){const s=getComputedStyle(r),o=+s.opacity,a=i==="y"?"height":"width",l=parseFloat(s[a]),u=i==="y"?["top","bottom"]:["left","right"],c=u.map(v=>`${v[0].toUpperCase()}${v.slice(1)}`),d=parseFloat(s[`padding${c[0]}`]),h=parseFloat(s[`padding${c[1]}`]),f=parseFloat(s[`margin${c[0]}`]),p=parseFloat(s[`margin${c[1]}`]),m=parseFloat(s[`border${c[0]}Width`]),g=parseFloat(s[`border${c[1]}Width`]);return{delay:e,duration:t,easing:n,css:v=>`overflow: hidden;opacity: ${Math.min(v*20,1)*o};${a}: ${v*l}px;padding-${u[0]}: ${v*d}px;padding-${u[1]}: ${v*h}px;margin-${u[0]}: ${v*f}px;margin-${u[1]}: ${v*p}px;border-${u[0]}-width: ${v*m}px;border-${u[1]}-width: ${v*g}px;`}}var F1=Y('<div><div class="collapsible"><div class="item svelte-p8m809"><span><!></span></div></div></div>'),I1=Y('<div><div class="header svelte-p8m809"><span> </span> <button><div class="abs-center"><!></div></button></div> <!></div>');function ir(r,e){ye(e,!0);const t=$e(),n=()=>oe(l,"$root",t),i=()=>oe(c,"$trigger",t),s=()=>oe(d,"$open",t),o=()=>oe(u,"$content",t);let a=X(e,"collapsed",3,!1);const{elements:{root:l,content:u,trigger:c},states:{open:d}}=Wy();d.set(!a());var h=I1();let f;var p=ie(h),m=ie(p);let g;var v=ie(m),x=I(m,2);let b;var _=ie(x),w=ie(_);Fe(w,s,P=>{var S=Ar("-");N(P,S)},P=>{var S=Ar("+");N(P,S)});var C=I(p,2);Fe(C,s,P=>{var S=F1();let A;var E=ie(S),U=ie(E),L=ie(U),R=ie(L);Gi(R,()=>e.children),le(()=>A=at(S,A,{...o()},"svelte-p8m809")),xt(S,T=>u(T)),Gs(3,S,()=>Fc),N(P,S)}),le(()=>{f=at(h,f,{...n(),class:"root"},"svelte-p8m809"),g=at(m,g,{class:"label",...i()},"svelte-p8m809"),bt(v,e.title),b=at(x,b,{...i()},"svelte-p8m809")}),xt(m,P=>c(P)),xt(x,P=>c(P)),xt(h,P=>l(P)),N(r,h),Se()}var B1=Y('<div class="row svelte-9ejy6"><!></div>');function Te(r,e){ye(e,!0);var t=B1(),n=ie(t);Gi(n,()=>e.children),le(()=>ve(t,"style",e.style)),N(r,t),Se()}let O1=0;var U1=Y('<div class="container svelte-1dl1v59"><div class="label svelte-1dl1v59"> </div> <div class="switch svelte-1dl1v59"><input type="checkbox" class="svelte-1dl1v59"> <label class="svelte-1dl1v59"></label></div></div>');function Im(r,e){let t=X(e,"label",3,""),n=X(e,"checked",15,!1),i="input_toggle_"+((O1+=1)-1);var s=U1(),o=ie(s),a=ie(o),l=I(o,2),u=ie(l);ve(u,"id",i);var c=I(u,2);ve(c,"for",i),le(()=>{ve(s,"style",e.style),bt(a,t())}),lm(u,n),N(r,s)}var D1=Y('<label class="svelte-18hsjvr"> <input type="number"></label>');function Z(r,e){let t=X(e,"value",15,0),n=X(e,"step",3,1),i=X(e,"label",3,""),s=X(e,"placeholder",3,""),o=pt(()=>e.width?"width: "+e.width+"px;":"");function a(d){d.deltaY*-1>0?e.max&&t()<e.max&&t(t()+n()):e.min&&t()>e.min&&t(t()-n())}var l=D1(),u=ie(l),c=I(u);c.__input=function(...d){e.oninput?.apply(this,d)},c.__change=function(...d){e.onchange?.apply(this,d)},le(()=>{bt(u,`${i()??""} `),ve(c,"min",e.min),ve(c,"max",e.max),ve(c,"step",n()),ve(c,"placeholder",s()),ve(c,"style",k(o))}),ge("wheel",c,a),Ka(c,t),N(r,l)}Zn(["input","change"]);var G1={grad:.9,turn:360,rad:360/(2*Math.PI)},Br=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},dt=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*r)/t+0},Qt=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),r>t?t:r>e?r:e},Bm=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},Mh=function(r){return{r:Qt(r.r,0,255),g:Qt(r.g,0,255),b:Qt(r.b,0,255),a:Qt(r.a)}},bl=function(r){return{r:dt(r.r),g:dt(r.g),b:dt(r.b),a:dt(r.a,3)}},z1=/^#([0-9a-f]{3,8})$/i,yo=function(r){var e=r.toString(16);return e.length<2?"0"+e:e},Om=function(r){var e=r.r,t=r.g,n=r.b,i=r.a,s=Math.max(e,t,n),o=s-Math.min(e,t,n),a=o?s===e?(t-n)/o:s===t?2+(n-e)/o:4+(e-t)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},Um=function(r){var e=r.h,t=r.s,n=r.v,i=r.a;e=e/360*6,t/=100,n/=100;var s=Math.floor(e),o=n*(1-t),a=n*(1-(e-s)*t),l=n*(1-(1-e+s)*t),u=s%6;return{r:255*[n,a,o,o,l,n][u],g:255*[l,n,n,a,o,o][u],b:255*[o,o,l,n,n,a][u],a:i}},Rh=function(r){return{h:Bm(r.h),s:Qt(r.s,0,100),l:Qt(r.l,0,100),a:Qt(r.a)}},kh=function(r){return{h:dt(r.h),s:dt(r.s),l:dt(r.l),a:dt(r.a,3)}},Fh=function(r){return Um((t=(e=r).s,{h:e.h,s:(t*=((n=e.l)<50?n:100-n)/100)>0?2*t/(n+t)*100:0,v:n+t,a:e.a}));var e,t,n},Cs=function(r){return{h:(e=Om(r)).h,s:(i=(200-(t=e.s))*(n=e.v)/100)>0&&i<200?t*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,t,n,i},L1=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,N1=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,H1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,V1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ih={string:[[function(r){var e=z1.exec(r);return e?(r=e[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?dt(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?dt(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var e=H1.exec(r)||V1.exec(r);return e?e[2]!==e[4]||e[4]!==e[6]?null:Mh({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(r){var e=L1.exec(r)||N1.exec(r);if(!e)return null;var t,n,i=Rh({h:(t=e[1],n=e[2],n===void 0&&(n="deg"),Number(t)*(G1[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return Fh(i)},"hsl"]],object:[[function(r){var e=r.r,t=r.g,n=r.b,i=r.a,s=i===void 0?1:i;return Br(e)&&Br(t)&&Br(n)?Mh({r:Number(e),g:Number(t),b:Number(n),a:Number(s)}):null},"rgb"],[function(r){var e=r.h,t=r.s,n=r.l,i=r.a,s=i===void 0?1:i;if(!Br(e)||!Br(t)||!Br(n))return null;var o=Rh({h:Number(e),s:Number(t),l:Number(n),a:Number(s)});return Fh(o)},"hsl"],[function(r){var e=r.h,t=r.s,n=r.v,i=r.a,s=i===void 0?1:i;if(!Br(e)||!Br(t)||!Br(n))return null;var o=function(a){return{h:Bm(a.h),s:Qt(a.s,0,100),v:Qt(a.v,0,100),a:Qt(a.a)}}({h:Number(e),s:Number(t),v:Number(n),a:Number(s)});return Um(o)},"hsv"]]},Bh=function(r,e){for(var t=0;t<e.length;t++){var n=e[t][0](r);if(n)return[n,e[t][1]]}return[null,void 0]},W1=function(r){return typeof r=="string"?Bh(r.trim(),Ih.string):typeof r=="object"&&r!==null?Bh(r,Ih.object):[null,void 0]},_l=function(r,e){var t=Cs(r);return{h:t.h,s:Qt(t.s+100*e,0,100),l:t.l,a:t.a}},yl=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},Oh=function(r,e){var t=Cs(r);return{h:t.h,s:t.s,l:Qt(t.l+100*e,0,100),a:t.a}},Uh=function(){function r(e){this.parsed=W1(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return dt(yl(this.rgba),2)},r.prototype.isDark=function(){return yl(this.rgba)<.5},r.prototype.isLight=function(){return yl(this.rgba)>=.5},r.prototype.toHex=function(){return e=bl(this.rgba),t=e.r,n=e.g,i=e.b,o=(s=e.a)<1?yo(dt(255*s)):"","#"+yo(t)+yo(n)+yo(i)+o;var e,t,n,i,s,o},r.prototype.toRgb=function(){return bl(this.rgba)},r.prototype.toRgbString=function(){return e=bl(this.rgba),t=e.r,n=e.g,i=e.b,(s=e.a)<1?"rgba("+t+", "+n+", "+i+", "+s+")":"rgb("+t+", "+n+", "+i+")";var e,t,n,i,s},r.prototype.toHsl=function(){return kh(Cs(this.rgba))},r.prototype.toHslString=function(){return e=kh(Cs(this.rgba)),t=e.h,n=e.s,i=e.l,(s=e.a)<1?"hsla("+t+", "+n+"%, "+i+"%, "+s+")":"hsl("+t+", "+n+"%, "+i+"%)";var e,t,n,i,s},r.prototype.toHsv=function(){return e=Om(this.rgba),{h:dt(e.h),s:dt(e.s),v:dt(e.v),a:dt(e.a,3)};var e},r.prototype.invert=function(){return Tt({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},r.prototype.saturate=function(e){return e===void 0&&(e=.1),Tt(_l(this.rgba,e))},r.prototype.desaturate=function(e){return e===void 0&&(e=.1),Tt(_l(this.rgba,-e))},r.prototype.grayscale=function(){return Tt(_l(this.rgba,-1))},r.prototype.lighten=function(e){return e===void 0&&(e=.1),Tt(Oh(this.rgba,e))},r.prototype.darken=function(e){return e===void 0&&(e=.1),Tt(Oh(this.rgba,-e))},r.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},r.prototype.alpha=function(e){return typeof e=="number"?Tt({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):dt(this.rgba.a,3);var t},r.prototype.hue=function(e){var t=Cs(this.rgba);return typeof e=="number"?Tt({h:e,s:t.s,l:t.l,a:t.a}):dt(t.h)},r.prototype.isEqual=function(e){return this.toHex()===Tt(e).toHex()},r}(),Tt=function(r){return r instanceof Uh?r:new Uh(r)},j1=Y('<input type="hidden">'),X1=Y('<div class="slider svelte-w4j1dz" role="slider" tabindex="0"><div class="track svelte-w4j1dz"></div> <div class="thumb svelte-w4j1dz"></div></div> <!>',1);function ba(r,e){ye(e,!1);const t=He(),n=He(),i=He(),s=He();let o=X(e,"min",8,0),a=X(e,"max",8,100),l=X(e,"step",8,1),u=X(e,"value",12,50),c=X(e,"ariaValueText",8,z=>z.toString()),d=X(e,"name",8,void 0),h=X(e,"direction",8,"horizontal"),f=X(e,"reverse",8,!1),p=X(e,"keyboardOnly",8,!1),m=X(e,"slider",12,void 0),g=X(e,"ariaLabel",8,void 0),v=X(e,"ariaLabelledBy",8,void 0),x=X(e,"ariaControls",8,void 0),b=X(e,"isDragging",12,!1);const _=ro();function w(z){const G=1/k(i),j=Math.round(z*G)/G;return Math.max(k(t),Math.min(k(n),j))}function C(z){const G=z.shiftKey?k(i)*10:k(i);z.key==="ArrowUp"||z.key==="ArrowRight"?(u(u()+G),z.preventDefault()):z.key==="ArrowDown"||z.key==="ArrowLeft"?(u(u()-G),z.preventDefault()):z.key==="Home"?(u(k(t)),z.preventDefault()):z.key==="End"?(u(k(n)),z.preventDefault()):z.key==="PageUp"?(u(u()+k(i)*10),z.preventDefault()):z.key==="PageDown"&&(u(u()-k(i)*10),z.preventDefault()),u(w(u())),_("input",u())}const P={horizontal:{clientSize:"clientWidth",offset:"left",client:"clientX"},vertical:{clientSize:"clientHeight",offset:"top",client:"clientY"}};function S(z){const G=m()?.[P[h()].clientSize]||120,j=m()?.getBoundingClientRect()[P[h()].offset]||0;let M=z[P[h()].client]-j;h()==="vertical"&&(M=-1*M+G),f()?u(k(n)-M/G*(k(n)-k(t))):u(M/G*(k(n)-k(t))+k(t)),u(w(u())),_("input",u())}function A(z){S(z),b(!0)}function E(z){b()&&S(z)}function U(){b(!1)}function L(z){S({clientX:z.changedTouches[0].clientX,clientY:z.changedTouches[0].clientY})}it(()=>rt(o()),()=>{ne(t,typeof o()=="string"?parseFloat(o()):o())}),it(()=>rt(a()),()=>{ne(n,typeof a()=="string"?parseFloat(a()):a())}),it(()=>rt(l()),()=>{ne(i,typeof l()=="string"?parseFloat(l()):l())}),it(()=>(rt(u()),k(t),k(n)),()=>{ne(s,((u()-k(t))/(k(n)-k(t))*1).toFixed(4))}),Kn(),kt();var R=X1();ge("mousemove",zt,E),ge("mouseup",zt,U);var T=K(R);Qn(T,z=>m(z),()=>m()),le(()=>ve(T,"aria-valuetext",c()(u())));var B=I(T,2);Fe(B,d,z=>{var G=j1();le(()=>{ve(G,"name",d()),dr(G,u())}),N(z,G)}),le(()=>{ve(T,"aria-orientation",h()),ve(T,"aria-valuemax",k(n)),ve(T,"aria-valuemin",k(t)),ve(T,"aria-valuenow",u()),ve(T,"aria-label",g()),ve(T,"aria-labelledby",v()),ve(T,"aria-controls",x()),Ya(T,"reverse",f()),Lr(T,"--position",k(s))}),ge("keydown",T,C),ge("mousedown",T,N_(function(...z){(p()?void 0:A)?.apply(this,z)})),ge("touchstart",T,pr(function(...z){(p()?void 0:L)?.apply(this,z)}),void 0,!1),ge("touchmove",T,pr(function(...z){(p()?void 0:L)?.apply(this,z)}),void 0,!1),ge("touchend",T,pr(function(...z){(p()?void 0:L)?.apply(this,z)}),void 0,!1),N(r,R),Se()}var q1=Y('<div class="picker svelte-1x9tz9y"><!> <div class="s svelte-1x9tz9y"><!></div> <div class="v svelte-1x9tz9y"><!></div></div>');function Y1(r,e){ye(e,!1);const t=ro();let n=X(e,"components",8),i=X(e,"h",8),s=X(e,"s",12),o=X(e,"v",12),a=X(e,"isDark",8),l=X(e,"texts",8),u=He(),c=!1,d=He(),h=He({x:100,y:0});function f(E,U,L){return Math.min(Math.max(U,E),L)}function p(E){const{width:U,left:L,height:R,top:T}=k(u).getBoundingClientRect(),B={x:f(E.clientX-L,0,U),y:f(E.clientY-T,0,R)};s(f(B.x/U,0,1)*100),o(f((R-B.y)/R,0,1)*100)}function m(E){E.button===0&&(c=!0,p(E))}function g(){c=!1}function v(E){c&&p(E)}function x(E){E.target.isSameNode(k(u))}function b(E){E.preventDefault(),p(E.changedTouches[0])}it(()=>(rt(i()),Tt),()=>{typeof i()=="number"&&ne(d,Tt({h:i(),s:100,v:100,a:1}).toHex())}),it(()=>(rt(s()),rt(o()),k(u)),()=>{typeof s()=="number"&&typeof o()=="number"&&k(u)&&ne(h,{x:s(),y:100-o()})}),it(()=>(rt(s()),rt(o())),()=>{t("input",{s:s(),v:o()})}),Kn(),kt();var _=q1();ge("mouseup",zt,g),ge("mousedown",zt,x),ge("mousemove",zt,v),Qn(_,E=>ne(u,E),()=>k(u));var w=ie(_);Ot(w,()=>n().pickerIndicator,(E,U)=>{U(E,{get pos(){return k(h)},get isDark(){return a()}})});var C=I(w,2),P=ie(C);ba(P,{get value(){return s()},set value(E){s(E)},keyboardOnly:!0,ariaValueText:E=>`${E}%`,get ariaLabel(){return l().label.s},$$legacy:!0});var S=I(C,2),A=ie(S);ba(A,{get value(){return o()},set value(E){o(E)},keyboardOnly:!0,ariaValueText:E=>`${E}%`,direction:"vertical",get ariaLabel(){return l().label.v},$$legacy:!0}),le(()=>{Lr(_,"--picker-color-bg",k(d)),Lr(C,"--pos-y",k(h).y),Lr(S,"--pos-x",k(h).x)}),ge("mousedown",_,pr(m)),ge("touchstart",_,b,void 0,!1),ge("touchmove",_,pr(b),void 0,!1),ge("touchend",_,b,void 0,!1),N(r,_),Se()}var K1=Y('<div class="picker-indicator svelte-i5mg2p"></div>');function $1(r,e){ye(e,!1);let t=X(e,"pos",8),n=X(e,"isDark",8);kt();var i=K1();le(()=>{Ya(i,"is-dark",n()),Lr(i,"--pos-x",t().x),Lr(i,"--pos-y",t().y)}),N(r,i),Se()}var Z1=Y('<input class="svelte-qtukzs">'),Q1=Y('<input type="number" min="0" max="255" class="svelte-qtukzs"> <input type="number" min="0" max="255" class="svelte-qtukzs"> <input type="number" min="0" max="255" class="svelte-qtukzs">',1),J1=Y('<input type="number" min="0" max="360" class="svelte-qtukzs"> <input type="number" min="0" max="100" class="svelte-qtukzs"> <input type="number" min="0" max="100" class="svelte-qtukzs">',1),e3=Y('<input type="number" min="0" max="1" step="0.01" class="svelte-qtukzs">'),t3=Y('<button type="button" class="svelte-qtukzs"><span class="disappear svelte-qtukzs" aria-hidden="true"> </span> <span class="appear svelte-qtukzs"> </span></button>'),r3=Y('<div class="button-like svelte-qtukzs"> </div>'),n3=Y('<div class="text-input svelte-qtukzs"><div class="input-container svelte-qtukzs"><!> <!></div> <!></div>');function i3(r,e){ye(e,!1);const t=He(),n=He(),i=He(),s=He(),o=He(),a=ro();let l=X(e,"isAlpha",8),u=X(e,"rgb",12),c=X(e,"hsv",12),d=X(e,"hex",12),h=X(e,"textInputModes",8),f=X(e,"texts",8);const p=/^#?([A-F0-9]{6}|[A-F0-9]{8})$/i;let m=He(h()[0]||"hex");function g(S){const A=S.target;p.test(A.value)&&(d(A.value),a("input",{hex:d()}))}function v(S){return function(A){u({...u(),[S]:parseFloat(A.target.value)}),a("input",{rgb:u()})}}function x(S){return function(A){c({...c(),[S]:parseFloat(A.target.value)}),a("input",{hsv:c()})}}it(()=>(rt(h()),k(m)),()=>{ne(t,h()[(h().indexOf(k(m))+1)%h().length])}),it(()=>rt(c()),()=>{ne(n,Math.round(c().h))}),it(()=>rt(c()),()=>{ne(i,Math.round(c().s))}),it(()=>rt(c()),()=>{ne(s,Math.round(c().v))}),it(()=>rt(c()),()=>{ne(o,c().a===void 0?1:Math.round(c().a*100)/100)}),Kn(),kt();var b=n3(),_=ie(b),w=ie(_);Fe(w,()=>k(m)==="hex",S=>{var A=Z1();le(()=>{ve(A,"aria-label",f().label.hex),dr(A,d()),Lr(A,"flex",3)}),ge("input",A,g),N(S,A)},S=>{var A=Pe(),E=K(A);Fe(E,()=>k(m)==="rgb",U=>{var L=Q1(),R=K(L),T=pt(()=>v("r")),B=I(R,2),z=pt(()=>v("g")),G=I(B,2),j=pt(()=>v("b"));le(()=>{ve(R,"aria-label",f().label.r),dr(R,u().r),ve(B,"aria-label",f().label.g),dr(B,u().g),ve(G,"aria-label",f().label.b),dr(G,u().b)}),ge("input",R,function(...M){k(T)?.apply(this,M)}),ge("input",B,function(...M){k(z)?.apply(this,M)}),ge("input",G,function(...M){k(j)?.apply(this,M)}),N(U,L)},U=>{var L=J1(),R=K(L),T=pt(()=>x("h")),B=I(R,2),z=pt(()=>x("s")),G=I(B,2),j=pt(()=>x("v"));le(()=>{ve(R,"aria-label",f().label.h),dr(R,k(n)),ve(B,"aria-label",f().label.s),dr(B,k(i)),ve(G,"aria-label",f().label.v),dr(G,k(s))}),ge("input",R,function(...M){k(T)?.apply(this,M)}),ge("input",B,function(...M){k(z)?.apply(this,M)}),ge("input",G,function(...M){k(j)?.apply(this,M)}),N(U,L)},!0),N(S,A)});var C=I(w,2);Fe(C,l,S=>{var A=e3(),E=pt(()=>k(m)==="hsv"?x("a"):v("a"));le(()=>{ve(A,"aria-label",f().label.a),dr(A,k(o))}),ge("input",A,function(...U){k(E)?.apply(this,U)}),N(S,A)});var P=I(_,2);Fe(P,()=>h().length>1,S=>{var A=t3(),E=ie(A),U=ie(E),L=I(E,2),R=ie(L);le(()=>{bt(U,f().color[k(m)]),bt(R,`${f().changeTo??""} ${k(t)??""}`)}),ge("click",A,()=>ne(m,k(t))),N(S,A)},S=>{var A=r3(),E=ie(A);le(()=>bt(E,f().color[k(m)])),N(S,A)}),N(r,b),Se()}var s3=Y('<label class="svelte-lemcb1"><div class="container svelte-lemcb1"><input type="color" aria-haspopup="dialog" class="svelte-lemcb1"> <div class="alpha svelte-lemcb1"></div> <div class="color svelte-lemcb1"></div></div> </label>');function o3(r,e){let t=X(e,"labelElement",12),n=X(e,"hex",8),i=X(e,"label",8),s=X(e,"name",8,void 0);X(e,"isOpen",8);function o(){}var a=s3();Qn(a,h=>t(h),()=>t());var l=ie(a),u=ie(l),c=I(u,4),d=I(l);le(()=>{ve(u,"name",s()),dr(u,n()),Lr(c,"background",n()),bt(d,` ${i()??""}`)}),ge("click",u,pr(o)),ge("mousedown",u,pr(o)),ge("click",a,pr(o)),ge("mousedown",a,pr(o)),N(r,a)}var a3=Y('<div class="wrapper svelte-h9ar9" aria-label="color picker"><!></div>');function l3(r,e){let t=X(e,"wrapper",12),n=X(e,"isOpen",8),i=X(e,"isDialog",8);var s=a3();Qn(s,a=>t(a),()=>t());var o=ie(s);tr(o,rr(e),{}),le(()=>{ve(s,"role",i()?"dialog":void 0),Ya(s,"is-open",n())}),N(r,s)}const Sl={label:{h:"hue channel",s:"saturation channel",v:"brightness channel",r:"red channel",g:"green channel",b:"blue channel",a:"alpha channel",hex:"hex color",withoutColor:"without color"},color:{rgb:"rgb",hsv:"hsv",hex:"hex"},changeTo:"change to "},Dm="a[href], area[href], input:not([type='hidden']):not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]";function u3(r){return function(e){if(e.target===window)return;const t=e.target;if(!r.contains(t))return;const n=r.querySelectorAll(Dm),i=n[0],s=n[n.length-1];function o(l){return l.code==="Tab"&&!l.shiftKey}function a(l){return l.code==="Tab"&&l.shiftKey}o(e)&&e.target===s?(e.preventDefault(),i.focus()):a(e)&&e.target===i&&(e.preventDefault(),s.focus())}}const c3=r=>{const e=r.querySelector(Dm);e&&e.focus();const t=u3(r);return document.addEventListener("keydown",t),{destroy(){document.removeEventListener("keydown",t)}}};var d3=Y('<label class="nullability-checkbox svelte-oskb5b"><div class="svelte-oskb5b"><input type="checkbox" class="svelte-oskb5b"> <span class="svelte-oskb5b"></span></div> </label>');function h3(r,e){ye(e,!1);let t=X(e,"isUndefined",12),n=X(e,"texts",8);kt();var i=d3(),s=ie(i),o=ie(s),a=I(s);le(()=>bt(a,` ${n().label.withoutColor??""}`)),lm(o,t),N(r,i),Se()}var f3=Y('<input type="hidden">'),p3=Y('<div class="a svelte-tsvobk"><!></div>'),m3=Y('<!> <!> <div class="h svelte-tsvobk"><!></div> <!> <!> <!>',1),g3=Y("<span><!> <!></span>");function v3(r,e){ye(e,!1);const t=ro();let n=X(e,"components",24,()=>({})),i=X(e,"label",8,"Choose a color"),s=X(e,"name",8,void 0),o=X(e,"nullable",8,!1),a=X(e,"rgb",28,()=>o()?void 0:{r:255,g:0,b:0,a:1}),l=X(e,"hsv",28,()=>o()?void 0:{h:0,s:100,v:100,a:1}),u=X(e,"hex",28,()=>o()?void 0:"#ff0000"),c=X(e,"color",12,void 0),d=X(e,"isDark",12,!1),h=X(e,"isAlpha",8,!0),f=X(e,"isDialog",8,!0),p=X(e,"isOpen",28,()=>!f()),m=X(e,"position",8,"fixed"),g=X(e,"isTextInput",8,!0),v=X(e,"textInputModes",24,()=>["hex","rgb","hsv"]),x=X(e,"sliderDirection",8,"vertical"),b=X(e,"disableCloseClickOutside",8,!1),_=X(e,"a11yColors",24,()=>[{bgHex:"#ffffff"}]),w=X(e,"a11yLevel",8,"AA"),C=X(e,"texts",8,void 0),P=X(e,"a11yTexts",8,void 0),S=He({r:255,g:0,b:0,a:1}),A=He({h:0,s:100,v:100,a:1}),E=He("#ff0000"),U=He(!1),L=k(U),R=He(),T=He(),B=He(),z,G=He(),j=He();const M=12,H={pickerIndicator:$1,textInput:i3,input:o3,nullabilityCheckbox:h3,wrapper:l3};function W(){return{...H,...n()}}function O(){return{label:{...Sl.label,...C()?.label},color:{...Sl.color,...C()?.color},changeTo:C()?.changeTo??Sl.changeTo}}function V({target:Ce}){f()&&(k(T).contains(Ce)||k(T).isSameNode(Ce)?p(!p()):p()&&!k(B).contains(Ce)&&!b()&&p(!1))}function $({key:Ce,target:q}){if(f())Ce==="Enter"&&k(T).contains(q)?(p(!p()),setTimeout(()=>{z=c3(k(B))})):Ce==="Escape"&&p()&&(p(!1),k(R).contains(q)&&(k(T)?.focus(),z?.destroy()));else return}function Q(){if(k(U)&&!L){L=!0,l(a(u(void 0))),t("input",{color:c(),hsv:l(),rgb:a(),hex:u()});return}else if(L&&!k(U)){L=!1,l(k(A)),a(k(S)),u(k(E)),t("input",{color:c(),hsv:l(),rgb:a(),hex:u()});return}if(!l()&&!a()&&!u()){ne(U,!0),L=!0,t("input",{color:void 0,hsv:l(),rgb:a(),hex:u()});return}l()&&a()&&l().h===k(A).h&&l().s===k(A).s&&l().v===k(A).v&&l().a===k(A).a&&a().r===k(S).r&&a().g===k(S).g&&a().b===k(S).b&&a().a===k(S).a&&u()===k(E)||(ne(U,!1),l()&&l().a===void 0&&l(l().a=1,!0),k(A).a===void 0&&ii(A,k(A).a=1),a()&&a().a===void 0&&a(a().a=1,!0),k(S).a===void 0&&ii(S,k(S).a=1),u()?.substring(7)==="ff"&&u(u().substring(0,7)),u()?.substring(7)==="ff"&&u(u().substring(0,7)),l()&&(l().h!==k(A).h||l().s!==k(A).s||l().v!==k(A).v||l().a!==k(A).a||!a()&&!u())?(c(Tt(l())),a(c().toRgb()),u(c().toHex())):a()&&(a().r!==k(S).r||a().g!==k(S).g||a().b!==k(S).b||a().a!==k(S).a||!l()&&!u())?(c(Tt(a())),u(c().toHex()),l(c().toHsv())):u()&&(u()!==k(E)||!l()&&!a())&&(c(Tt(u())),a(c().toRgb()),l(c().toHsv())),c()&&d(c().isDark()),u()&&(ne(A,Object.assign({},l())),ne(S,Object.assign({},a())),ne(E,u()),L=k(U),t("input",{color:c(),hsv:l(),rgb:a(),hex:u()})))}function ue(Ce){return q=>{l()||l({...k(A)}),l(l()[Ce]=q.detail,!0)}}function De(Ce){return q=>{l()||l({...k(A)}),Ce.forEach(re=>{l()&&l(l()[re]=q.detail[re],!0)})}}async function st(){if(await zr(),m()!=="fixed"&&p()&&f()&&k(T)&&k(B)){const Ce=k(B).getBoundingClientRect(),q=k(T).getBoundingClientRect();(m()==="responsive"||m()==="responsive-y")&&(q.top+Ce.height+M>k(j)?ii(B,k(B).style.top=`-${Ce.height+M}px`):ii(B,k(B).style.top=`${q.height+M}px`)),(m()==="responsive"||m()==="responsive-x")&&(q.left+Ce.width+M>k(G)?ii(B,k(B).style.left=`-${Ce.width-q.width+M}px`):ii(B,k(B).style.left=`${M}px`))}}it(()=>(rt(l()),rt(a()),rt(u())),()=>{(l()||a()||u())&&Q()}),it(()=>k(U),()=>{k(U),Q()}),it(()=>(k(G),k(j),rt(p())),()=>{k(G),k(j),p(),st()}),Kn(),kt();var Xt=g3();ge("mousedown",zt,V),ge("keyup",zt,$),ge("scroll",zt,st),Qn(Xt,Ce=>ne(R,Ce),()=>k(R));var xn=ie(Xt);Fe(xn,f,Ce=>{var q=Pe(),re=K(q);Ot(re,()=>W().input,(we,ce)=>{ce(we,{get labelElement(){return k(T)},set labelElement(ot){ne(T,ot)},isOpen:!0,get hex(){return u()},get label(){return i()},get name(){return s()},$$legacy:!0})}),N(Ce,q)},Ce=>{var q=Pe(),re=K(q);Fe(re,s,we=>{var ce=f3();le(()=>{dr(ce,u()),ve(ce,"name",s())}),N(we,ce)},null,!0),N(Ce,q)});var ri=I(xn,2);Ot(ri,()=>W().wrapper,(Ce,q)=>{q(Ce,{get wrapper(){return k(B)},set wrapper(re){ne(B,re)},get isOpen(){return p()},get isDialog(){return f()},children:(re,we)=>{var ce=m3(),ot=K(ce);Fe(ot,o,lr=>{var Yt=Pe(),bn=K(Yt),_n=ut(O);Ot(bn,()=>W().nullabilityCheckbox,(yn,Sn)=>{Sn(yn,{get isUndefined(){return k(U)},set isUndefined(wn){ne(U,wn)},get texts(){return k(_n)},$$legacy:!0})}),N(lr,Yt)});var je=I(ot,2),or=ut(W),Ze=ut(()=>l()?.h??k(A).h),_r=ut(()=>l()?.s??k(A).s),qt=ut(()=>l()?.v??k(A).v),yr=pt(()=>De(["s","v"])),cl=ut(O);Y1(je,{get components(){return k(or)},get h(){return k(Ze)},get s(){return k(_r)},get v(){return k(qt)},get isDark(){return d()},get texts(){return k(cl)},$$events:{input(...lr){k(yr)?.apply(this,lr)}}});var ar=I(je,2),fo=ie(ar),wb=ut(()=>l()?.h??k(A).h),Tb=pt(()=>ue("h")),Cb=ut(()=>x()==="vertical");ba(fo,{min:0,max:360,step:1,get value(){return k(wb)},get direction(){return x()},get reverse(){return k(Cb)},get ariaLabel(){return O().label.h},$$events:{input(...lr){k(Tb)?.apply(this,lr)}}});var Vd=I(ar,2);Fe(Vd,h,lr=>{var Yt=p3();const bn=ut(()=>(u()?u():k(E)).substring(0,7));le(()=>Lr(Yt,"--alphaless-color",k(bn)));var _n=ie(Yt),yn=ut(()=>l()?.a??k(A).a),Sn=pt(()=>ue("a")),wn=ut(()=>x()==="vertical");ba(_n,{min:0,max:1,step:.01,get value(){return k(yn)},get direction(){return x()},get reverse(){return k(wn)},get ariaLabel(){return O().label.a},$$events:{input(...dl){k(Sn)?.apply(this,dl)}}}),N(lr,Yt)});var Wd=I(Vd,2);Fe(Wd,g,lr=>{var Yt=Pe(),bn=K(Yt),_n=ut(()=>u()??k(E)),yn=ut(()=>a()??k(S)),Sn=ut(()=>l()??k(A)),wn=ut(O);Ot(bn,()=>W().textInput,(dl,Ab)=>{Ab(dl,{get hex(){return k(_n)},get rgb(){return k(yn)},get hsv(){return k(Sn)},get isAlpha(){return h()},get textInputModes(){return v()},get texts(){return k(wn)},$$events:{input:({detail:ni})=>{ni.hsv?l(ni.hsv):ni.rgb?a(ni.rgb):ni.hex&&u(ni.hex)}}})}),N(lr,Yt)});var Pb=I(Wd,2);Fe(Pb,()=>W().a11yNotice,lr=>{var Yt=Pe(),bn=K(Yt),_n=ut(W),yn=ut(()=>u()||"#00000000");Ot(bn,()=>W().a11yNotice,(Sn,wn)=>{wn(Sn,{get components(){return k(_n)},get a11yColors(){return _()},get hex(){return k(yn)},get a11yTexts(){return P()},get a11yLevel(){return w()}})}),N(lr,Yt)}),N(re,ce)},$$slots:{default:!0},$$legacy:!0})}),le(()=>sm(Xt,`color-picker ${x()??""} svelte-tsvobk`)),sh("innerWidth",Ce=>ne(G,Ce)),sh("innerHeight",Ce=>ne(j,Ce)),N(r,Xt),Se()}var x3=Y("<span> </span>"),b3=Y("<!> <!>",1);function At(r,e){let t=X(e,"label",3,""),n=X(e,"hex",15),i=pt(()=>!t()||t()===""?"hide":"");var s=b3(),o=K(s);Fe(o,t,l=>{var u=x3(),c=ie(u);le(()=>{sm(u,`${k(i)??""} svelte-cj1vhf`),bt(c,t())}),N(l,u)});var a=I(o,2);v3(a,{label:"",get hex(){return n()},set hex(l){n(l)},position:"responsive",$$events:{input(l){bu.call(this,e,l)},change(l){bu.call(this,e,l)}}}),N(r,s)}function _3(r){return Object.keys(r).reduce((e,t)=>r[t]===void 0?e:e+`${t}:${r[t]};`,"")}function Dh(r){return r?!0:void 0}_3({position:"absolute",opacity:0,"pointer-events":"none",margin:0,transform:"translateX(-100%)"});function Gh(r){function e(t){return t(r),()=>{}}return{subscribe:e}}const So=r=>new Proxy(r,{get(e,t,n){return Reflect.get(e,t,n)},ownKeys(e){return Reflect.ownKeys(e).filter(t=>t!=="action")}}),zh=r=>typeof r=="function";Gm("empty");function Gm(r,e){const{stores:t,action:n,returned:i}=e??{},s=(()=>{if(t&&i)return mt(t,a=>{const l=i(a);if(zh(l)){const u=(...c)=>So({...l(...c),[`data-melt-${r}`]:"",action:n??ui});return u.action=n??ui,u}return So({...l,[`data-melt-${r}`]:"",action:n??ui})});{const l=i?.();if(zh(l)){const u=(...c)=>So({...l(...c),[`data-melt-${r}`]:"",action:n??ui});return u.action=n??ui,Gh(u)}return Gh(So({...l,[`data-melt-${r}`]:"",action:n??ui}))}})(),o=n??(()=>{});return o.subscribe=s.subscribe,o}function y3(r){return r instanceof HTMLElement}function S3(...r){return(...e)=>{for(const t of r)typeof t=="function"&&t(...e)}}function ui(){}function zm(r,e,t,n){const i=Array.isArray(e)?e:[e];return i.forEach(s=>r.addEventListener(s,t,n)),()=>{i.forEach(s=>r.removeEventListener(s,t,n))}}function Lh(r,e,t,n){const i=Array.isArray(e)?e:[e];if(typeof t=="function"){const s=T3(o=>t(o));return i.forEach(o=>r.addEventListener(o,s,n)),()=>{i.forEach(o=>r.removeEventListener(o,s,n))}}return()=>void 0}function w3(r){const e=r.currentTarget;if(!y3(e))return null;const t=new CustomEvent(`m-${r.type}`,{detail:{originalEvent:r},cancelable:!0});return e.dispatchEvent(t),t}function T3(r){return e=>{if(!w3(e)?.defaultPrevented)return r(e)}}function Lm(r,...e){const t={};for(const n of Object.keys(r))e.includes(n)||(t[n]=r[n]);return t}function el(r){return{...r,get:()=>$a(r)}}el.writable=function(r){const e=xe(r);let t=r;return{subscribe:e.subscribe,set(n){e.set(n),t=n},update(n){const i=n(t);e.set(i),t=i},get(){return t}}};el.derived=function(r,e){const t=new Map,n=()=>{const s=Array.isArray(r)?r.map(o=>o.get()):r.get();return e(s)};return{get:n,subscribe:s=>{const o=[];return(Array.isArray(r)?r:[r]).forEach(l=>{o.push(l.subscribe(()=>{s(n())}))}),s(n()),t.set(s,o),()=>{const l=t.get(s);if(l)for(const u of l)u();t.delete(s)}}}};const C3=(r,e)=>{const t=el(r),n=(s,o)=>{t.update(a=>{const l=s(a);let u=l;return e&&(u=e({curr:a,next:l})),o?.(u),u})};return{...t,update:n,set:s=>{n(()=>s)}}},Au={ALT:"Alt",ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",BACKSPACE:"Backspace",CAPS_LOCK:"CapsLock",CONTROL:"Control",DELETE:"Delete",END:"End",ENTER:"Enter",ESCAPE:"Escape",F1:"F1",F10:"F10",F11:"F11",F12:"F12",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",HOME:"Home",META:"Meta",PAGE_DOWN:"PageDown",PAGE_UP:"PageUp",SHIFT:"Shift",SPACE:" ",TAB:"Tab",CTRL:"Control",ASTERISK:"*",A:"a",P:"p"};function P3(r){const e={};return Object.keys(r).forEach(t=>{const n=t,i=r[n];e[n]=el(xe(i))}),e}Gt(void 0,r=>{function e(n){r(n),r(void 0)}return zm(document,"pointerup",e,{passive:!1,capture:!0})});Gt(void 0,r=>{function e(n){n&&n.key===Au.ESCAPE&&r(n),r(void 0)}return zm(document,"keydown",e,{passive:!1})});Gt(!1),Gt(!1),Gt(void 0);const A3={isDateDisabled:void 0,isDateUnavailable:void 0,value:void 0,preventDeselect:!1,numberOfMonths:1,pagedNavigation:!1,weekStartsOn:0,fixedWeeks:!1,calendarLabel:"Event Date",locale:"en",minValue:void 0,maxValue:void 0,disabled:!1,readonly:!1,weekdayFormat:"narrow"};({...Lm(A3,"isDateDisabled","isDateUnavailable","value","locale","disabled","readonly","minValue","maxValue","weekdayFormat")});const E3={defaultPressed:!1,disabled:!1};function M3(r){const e={...E3,...r},t=P3(Lm(e,"pressed")),{disabled:n}=t,i=e.pressed??xe(e.defaultPressed),s=C3(i,e?.onPressedChange);function o(){n.get()||s.update(u=>!u)}return{elements:{root:Gm("toggle",{stores:[s,n],returned:([l,u])=>({"data-disabled":Dh(u),disabled:Dh(u),"data-state":l?"on":"off","aria-pressed":l,type:"button"}),action:l=>({destroy:S3(Lh(l,"click",()=>{o()}),Lh(l,"keydown",c=>{c.key!==Au.ENTER&&c.key!==Au.SPACE||(c.preventDefault(),o())}))})})},states:{pressed:s},options:t}}function R3(r,e){const t={};return e.forEach(n=>{t[n]={[`data-${r}-${n}`]:""}}),n=>t[n]}function k3(){const r=ro();return e=>{const{originalEvent:t}=e.detail,{cancelable:n}=e,i=t.type;r(i,{originalEvent:t,currentTarget:t.currentTarget},{cancelable:n})||e.preventDefault()}}function F3(r){const e={};for(const t in r){const n=r[t];n!==void 0&&(e[t]=n)}return e}function I3(r){return function(e,t){if(t===void 0)return;const n=r[e];n&&n.set(t)}}function B3(){return{NAME:"toggle",PARTS:["root","input"]}}function O3(r){const{NAME:e,PARTS:t}=B3(),n=R3(e,t),i={...M3(F3(r)),getAttrs:n};return p_(e,i),{...i,updateOption:I3(i.options)}}var U3=Y("<button><!></button>");function D3(r,e){const t=nr(e,["children","$$slots","$$events","$$legacy"]),n=nr(t,["disabled","pressed","onPressedChange","asChild","el"]);ye(e,!1);const i=$e(),s=()=>oe(h,"$root",i),o=He();let a=X(e,"disabled",24,()=>{}),l=X(e,"pressed",28,()=>{}),u=X(e,"onPressedChange",24,()=>{}),c=X(e,"asChild",8,!1),d=X(e,"el",28,()=>{});const{elements:{root:h},states:{pressed:f},updateOption:p,getAttrs:m}=O3({disabled:a(),defaultPressed:l(),onPressedChange:({next:_})=>(l()!==_&&(u()?.(_),l(_)),_)}),g=k3(),v=m("root");it(()=>rt(l()),()=>{l()!==void 0&&f.set(l())}),it(()=>rt(a()),()=>{p("disabled",a())}),it(()=>s(),()=>{ne(o,s())}),it(()=>k(o),()=>{Object.assign(k(o),v)}),Kn(),kt();var x=Pe(),b=K(x);Fe(b,c,_=>{var w=Pe(),C=K(w);tr(C,rr(e),{get builder(){return k(o)}}),N(_,w)},_=>{var w=U3();Qn(w,S=>d(S),()=>d());let C;var P=ie(w);tr(P,rr(e),{get builder(){return k(o)}}),le(()=>C=at(w,C,{...k(o),type:"button",...n})),xt(w,S=>k(o).action(S)),Ln(()=>ge("m-click",w,g)),Ln(()=>ge("m-keydown",w,g)),N(_,w)}),N(r,x),Se()}var G3=Y('<div><div></div> <p class="tooltip-text svelte-57nmje"> </p></div>'),z3=Y("<div><!></div> <!>",1);function _a(r,e){ye(e,!0);const t=$e(),n=()=>oe(a,"$trigger",t),i=()=>oe(c,"$open",t),s=()=>oe(l,"$content",t),o=()=>oe(u,"$arrow",t);X(e,"checked",11,!1);const{elements:{trigger:a,content:l,arrow:u},states:{open:c}}=M1({positioning:{placement:"top"},openDelay:500,closeDelay:0,closeOnPointerDown:!1,forceVisible:!0});var d=Pe(),h=K(d);Fe(h,()=>e.tooltip,f=>{var p=z3(),m=K(p);let g;var v=ie(m);Gi(v,()=>e.children);var x=I(m,2);Fe(x,i,b=>{var _=G3();let w;var C=ie(_);let P;var S=I(C,2),A=ie(S);le(()=>{w=at(_,w,{...s(),class:"tooltip"},"svelte-57nmje"),P=at(C,P,{...o()},"svelte-57nmje"),bt(A,e.tooltip)}),xt(C,E=>u(E)),xt(_,E=>l(E)),Gs(3,_,()=>Fm,()=>({duration:100})),N(b,_)}),le(()=>g=at(m,g,{...n(),class:"content"},"svelte-57nmje")),xt(m,b=>a(b)),N(f,p)},f=>{var p=Pe(),m=K(p);Gi(m,()=>e.children),N(f,p)}),N(r,d),Se()}function Qr(r,e){ye(e,!0);let t=X(e,"checked",15,!1),n=um(e,["$$slots","$$events","$$legacy","children","checked","tooltip"]);_a(r,{get tooltip(){return e.tooltip},children:(i,s)=>{var o=Pe(),a=K(o);Ot(a,()=>D3,(l,u)=>{u(l,Kr({class:"toggle",get pressed(){return t()},set pressed(c){t(c)}},()=>n,{children:(c,d)=>{var h=Pe(),f=K(h);Gi(f,()=>e.children),N(c,h)},$$slots:{default:!0}}))}),N(i,o)},$$slots:{default:!0}}),Se()}var L3=Y('<button class="reset_filters svelte-r37183">↺</button>'),N3=Y('<!> <!> <div class="reset svelte-r37183"><!></div>',1),H3=Y("<!> <!> <!> <!> <!> <!> <!>",1),V3=Y("<!> <!> <!> <!> <!> <!>",1),W3=Y("<!> <!> <!> <!> <!>",1),j3=Y("<!> <!> <!> <!>",1),X3=Y("<!> <!> <!> <!> <!>",1),q3=Y("<!> <!> <!> <!> <!> <!>",1);function Ic(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.filter,"$filter",t);let i=X(e,"collapsed",3,!1);const s="flex: 0 0 4.5rem; justify-content: center; font-size: smaller; height: 1.7rem;";function o(){e.filter.set(structuredClone(e.defaults))}ir(r,{title:"Фильтры",get collapsed(){return i()},children:(a,l)=>{var u=q3(),c=K(u);Te(c,{children:(g,v)=>{var x=N3(),b=K(x);Qr(b,{get checked(){return n().blur.enabled},set checked(P){D(e.filter,y(n).blur.enabled=P,y(n))},style:s,children:(P,S)=>{var A=Ar("blur");N(P,A)},$$slots:{default:!0}});var _=I(b,2);Z(_,{label:"value",get value(){return n().blur.value},set value(P){D(e.filter,y(n).blur.value=P,y(n))},step:.1,min:0});var w=I(_,2),C=ie(w);_a(C,{tooltip:"сбросить фильтры",children:(P,S)=>{var A=L3();A.__click=o,N(P,A)},$$slots:{default:!0}}),N(g,x)},$$slots:{default:!0}});var d=I(c,2);Te(d,{children:(g,v)=>{var x=H3(),b=K(x);Qr(b,{get checked(){return n().gradient.enabled},set checked(E){D(e.filter,y(n).gradient.enabled=E,y(n))},style:s,children:(E,U)=>{var L=Ar("gradient");N(E,L)},$$slots:{default:!0}});var _=I(b,2);Z(_,{label:"#1",get value(){return n().gradient.start.value},set value(E){D(e.filter,y(n).gradient.start.value=E,y(n))},step:.01,min:0,max:1});var w=I(_,2);At(w,{get hex(){return n().gradient.start.color},set hex(E){D(e.filter,y(n).gradient.start.color=E,y(n))}});var C=I(w,2);Z(C,{label:"#2",get value(){return n().gradient.mid.value},set value(E){D(e.filter,y(n).gradient.mid.value=E,y(n))},step:.01,min:0,max:1});var P=I(C,2);At(P,{get hex(){return n().gradient.mid.color},set hex(E){D(e.filter,y(n).gradient.mid.color=E,y(n))}});var S=I(P,2);Z(S,{label:"#3",get value(){return n().gradient.end.value},set value(E){D(e.filter,y(n).gradient.end.value=E,y(n))},step:.01,min:0,max:1});var A=I(S,2);At(A,{get hex(){return n().gradient.end.color},set hex(E){D(e.filter,y(n).gradient.end.color=E,y(n))}}),N(g,x)},$$slots:{default:!0}});var h=I(d,2);Te(h,{children:(g,v)=>{var x=V3(),b=K(x);Qr(b,{get checked(){return n().tilt_shift.enabled},set checked(A){D(e.filter,y(n).tilt_shift.enabled=A,y(n))},style:s,children:(A,E)=>{var U=Ar("tilt-shift");N(A,U)},$$slots:{default:!0}});var _=I(b,2);Z(_,{label:"X₁",get value(){return n().tilt_shift.start.x},set value(A){D(e.filter,y(n).tilt_shift.start.x=A,y(n))}});var w=I(_,2);Z(w,{label:"Y₁",get value(){return n().tilt_shift.start.y},set value(A){D(e.filter,y(n).tilt_shift.start.y=A,y(n))}});var C=I(w,2);Z(C,{label:"X₂",get value(){return n().tilt_shift.end.x},set value(A){D(e.filter,y(n).tilt_shift.end.x=A,y(n))}});var P=I(C,2);Z(P,{label:"Y₂",get value(){return n().tilt_shift.end.y},set value(A){D(e.filter,y(n).tilt_shift.end.y=A,y(n))}});var S=I(P,2);Z(S,{label:"blur",get value(){return n().tilt_shift.blur},set value(A){D(e.filter,y(n).tilt_shift.blur=A,y(n))},step:.1,min:0}),N(g,x)},$$slots:{default:!0}});var f=I(h,2);Te(f,{children:(g,v)=>{var x=W3(),b=K(x);Qr(b,{get checked(){return n().zoom_blur.enabled},set checked(S){D(e.filter,y(n).zoom_blur.enabled=S,y(n))},style:s,children:(S,A)=>{var E=Ar("zoomblur");N(S,E)},$$slots:{default:!0}});var _=I(b,2);Z(_,{label:"X",get value(){return n().zoom_blur.center.x},set value(S){D(e.filter,y(n).zoom_blur.center.x=S,y(n))}});var w=I(_,2);Z(w,{label:"Y",get value(){return n().zoom_blur.center.y},set value(S){D(e.filter,y(n).zoom_blur.center.y=S,y(n))}});var C=I(w,2);Z(C,{label:"R",get value(){return n().zoom_blur.radius},set value(S){D(e.filter,y(n).zoom_blur.radius=S,y(n))},min:0});var P=I(C,2);Z(P,{label:"blur",get value(){return n().zoom_blur.value},set value(S){D(e.filter,y(n).zoom_blur.value=S,y(n))},step:.01,min:0}),N(g,x)},$$slots:{default:!0}});var p=I(f,2);Te(p,{children:(g,v)=>{var x=j3(),b=K(x);Qr(b,{get checked(){return n().vignetting.enabled},set checked(P){D(e.filter,y(n).vignetting.enabled=P,y(n))},style:s,children:(P,S)=>{var A=Ar("vignette");N(P,A)},$$slots:{default:!0}});var _=I(b,2);Z(_,{label:"value",get value(){return n().vignetting.value},set value(P){D(e.filter,y(n).vignetting.value=P,y(n))},step:.01,min:0});var w=I(_,2);Z(w,{label:"α",get value(){return n().vignetting.alpha},set value(P){D(e.filter,y(n).vignetting.alpha=P,y(n))},step:.01,min:0,max:1});var C=I(w,2);Z(C,{label:"blur",get value(){return n().vignetting.blur},set value(P){D(e.filter,y(n).vignetting.blur=P,y(n))},step:.01,min:0}),N(g,x)},$$slots:{default:!0}});var m=I(p,2);Te(m,{children:(g,v)=>{var x=X3(),b=K(x);Qr(b,{get checked(){return n().adjustment.enabled},set checked(S){D(e.filter,y(n).adjustment.enabled=S,y(n))},style:s,children:(S,A)=>{var E=Ar("adjust");N(S,E)},$$slots:{default:!0}});var _=I(b,2);Z(_,{label:"gam",get value(){return n().adjustment.gamma},set value(S){D(e.filter,y(n).adjustment.gamma=S,y(n))},step:.01,min:0});var w=I(_,2);Z(w,{label:"con",get value(){return n().adjustment.contrast},set value(S){D(e.filter,y(n).adjustment.contrast=S,y(n))},step:.01,min:0});var C=I(w,2);Z(C,{label:"bri",get value(){return n().adjustment.brightness},set value(S){D(e.filter,y(n).adjustment.brightness=S,y(n))},step:.01,min:0});var P=I(C,2);Z(P,{label:"sat",get value(){return n().adjustment.saturation},set value(S){D(e.filter,y(n).adjustment.saturation=S,y(n))},step:.01,min:0}),N(g,x)},$$slots:{default:!0}}),N(a,u)},$$slots:{default:!0}}),Se()}Zn(["click"]);let Y3=0;var K3=Y('<label class="svelte-18hsjvr"> </label>'),$3=Y("<!> <input>",1);function Vt(r,e){let t=X(e,"value",15),n=um(e,["$$slots","$$events","$$legacy","placeholder","value","label","width","cl","onchange","oninput"]),i=pt(()=>e.width?"width: "+e.width+"px;":""),s="input_text_"+((Y3+=1)-1);var o=$3(),a=K(o);Fe(a,()=>e.label,c=>{var d=K3();ve(d,"for",s);var h=ie(d);le(()=>bt(h,e.label)),N(c,d)});var l=I(a,2);let u;le(()=>u=at(l,u,{id:s,class:e.cl,type:"text",onchange:e.onchange,oninput:e.oninput,placeholder:e.placeholder,style:k(i),...n},"svelte-18hsjvr")),Ka(l,t),N(r,o)}var Z3=Y("<!> <!> <!> <!> <!> <!>",1),Q3=Y("<!> <!>",1);function Bc(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.logo,"$logo",t),i=()=>oe(e.appstate,"$appstate",t);function s(o){D(e.logo,y(n).src=o.target?.value,y(n))}ir(r,{title:"Лого",collapsed:!0,children:(o,a)=>{var l=Q3(),u=K(l);Te(u,{children:(d,h)=>{Vt(d,{placeholder:"ссылка на картинку логотипа",get value(){return i().logo},set value(f){D(e.appstate,y(i).logo=f,y(i))},onchange:s})},$$slots:{default:!0}});var c=I(u,2);Te(c,{children:(d,h)=>{var f=Z3(),p=K(f);Z(p,{label:"X",get value(){return n().x},set value(_){D(e.logo,y(n).x=_,y(n))}});var m=I(p,2);Z(m,{label:"Y",get value(){return n().y},set value(_){D(e.logo,y(n).y=_,y(n))}});var g=I(m,2);Z(g,{label:"W",get value(){return n().w},set value(_){D(e.logo,y(n).w=_,y(n))}});var v=I(g,2);Z(v,{label:"H",get value(){return n().h},set value(_){D(e.logo,y(n).h=_,y(n))}});var x=I(v,2);Z(x,{label:"blur",get value(){return n().blur},set value(_){D(e.logo,y(n).blur=_,y(n))},step:.1,min:0});var b=I(x,2);Z(b,{label:"α",get value(){return n().alpha},set value(_){D(e.logo,y(n).alpha=_,y(n))},step:.01,min:0,max:1}),N(d,f)},$$slots:{default:!0}}),N(o,l)},$$slots:{default:!0}}),Se()}/**
 * @license lucide-svelte v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var eS=v_("<svg><!><!></svg>");function mn(r,e){const t=nr(e,["children","$$slots","$$events","$$legacy"]),n=nr(t,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);ye(e,!1);let i=X(e,"name",8,void 0),s=X(e,"color",8,"currentColor"),o=X(e,"size",8,24),a=X(e,"strokeWidth",8,2),l=X(e,"absoluteStrokeWidth",8,!1),u=X(e,"iconNode",24,()=>[]);const c=(...m)=>m.filter((g,v,x)=>!!g&&x.indexOf(g)===v).join(" ");kt();var d=eS();let h;var f=ie(d);Di(f,1,u,Ui,(m,g)=>{let v=()=>k(g)[0],x=()=>k(g)[1];var b=Pe(),_=K(b);k_(_,v,!0,(w,C)=>{let P;le(()=>P=at(w,P,{...x()},void 0,w.namespaceURI!==Op,w.nodeName.includes("-")))}),N(m,b)});var p=I(f);tr(p,rr(e),{}),le(()=>h=at(d,h,{...J3,...n,width:o(),height:o(),stroke:s(),"stroke-width":l()?Number(a())*24/Number(o()):a(),class:c("lucide-icon","lucide",i()?`lucide-${i()}`:"",t.class)},void 0,!0)),N(r,d),Se()}function tS(r,e){const t=nr(e,["children","$$slots","$$events","$$legacy"]);mn(r,Kr({name:"folder-open"},()=>t,{iconNode:[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2"}]],children:(i,s)=>{var o=Pe(),a=K(o);tr(a,rr(e),{}),N(i,o)},$$slots:{default:!0}}))}function rS(r,e,t){const n=r.target?.files[0];if(n){const i=new FileReader;i.onload=async s=>{const o=s.target?.result;e()&&e(o),t.onload&&t.onload(o,n.name)},i.readAsDataURL(n)}}var nS=Y('<label class="svelte-rey57u"><!> <input type="file" class="svelte-rey57u"></label>');function iS(r,e){ye(e,!0);let t=X(e,"src",15);var n=nS(),i=ie(n);tS(i,{size:20});var s=I(i,2);s.__change=[rS,t,e],le(()=>ve(s,"accept",e.accept)),N(r,n),Se()}Zn(["change"]);function Oc(r,e,t,n){const i=t/n;if(i<r/e){const s=Math.round(r/i);return{x:0,y:Math.round((e-s)/2),w:r,h:s}}else{const s=Math.round(e*i);return{x:Math.round((r-s)/2),y:0,w:s,h:e}}}var sS=Y("<button><!></button>"),oS=Y("<div></div>");function aS(r,e){ye(e,!0);const t=$e(),n=()=>oe(o,"$root",t),i=()=>oe(a,"$item",t);let s=X(e,"selected",15);const{elements:{root:o,item:a},states:{value:l}}=P1({type:"single",loop:!0,rovingFocus:!0,defaultValue:s(),onValueChange:({curr:d,next:h})=>h?(s(h),h):d});var u=oS();let c;Di(u,21,()=>e.options,Ui,(d,h,f)=>{var p=sS();let m;le(()=>m=at(p,m,{class:"toggle-item",...i()(k(h))},"svelte-1rzpjof"));var g=ie(p);Gi(g,()=>e.children[f]),xt(p,v=>a(v)),N(d,p)}),le(()=>c=at(u,c,{...n(),class:"container","aria-label":"Text alignment"},"svelte-1rzpjof")),xt(u,d=>o(d)),N(r,u),Se()}function lS(r,e){const t=nr(e,["children","$$slots","$$events","$$legacy"]);mn(r,Kr({name:"fold-horizontal"},()=>t,{iconNode:[["path",{d:"M2 12h6"}],["path",{d:"M22 12h-6"}],["path",{d:"M12 2v2"}],["path",{d:"M12 8v2"}],["path",{d:"M12 14v2"}],["path",{d:"M12 20v2"}],["path",{d:"m19 9-3 3 3 3"}],["path",{d:"m5 15 3-3-3-3"}]],children:(i,s)=>{var o=Pe(),a=K(o);tr(a,rr(e),{}),N(i,o)},$$slots:{default:!0}}))}function uS(r,e){const t=nr(e,["children","$$slots","$$events","$$legacy"]);mn(r,Kr({name:"fold-vertical"},()=>t,{iconNode:[["path",{d:"M12 22v-6"}],["path",{d:"M12 8V2"}],["path",{d:"M4 12H2"}],["path",{d:"M10 12H8"}],["path",{d:"M16 12h-2"}],["path",{d:"M22 12h-2"}],["path",{d:"m15 19-3-3-3 3"}],["path",{d:"m15 5-3 3-3-3"}]],children:(i,s)=>{var o=Pe(),a=K(o);tr(a,rr(e),{}),N(i,o)},$$slots:{default:!0}}))}function cS(r,e){const t=nr(e,["children","$$slots","$$events","$$legacy"]);mn(r,Kr({name:"maximize"},()=>t,{iconNode:[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"}]],children:(i,s)=>{var o=Pe(),a=K(o);tr(a,rr(e),{}),N(i,o)},$$slots:{default:!0}}))}function dS(r,e){const t=nr(e,["children","$$slots","$$events","$$legacy"]);mn(r,Kr({name:"minimize"},()=>t,{iconNode:[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3"}]],children:(i,s)=>{var o=Pe(),a=K(o);tr(a,rr(e),{}),N(i,o)},$$slots:{default:!0}}))}var hS=Y("<!> <!>",1),fS=Y('<!> <!> <!> <!> <div class="spacer svelte-sob386"></div> <!> <!> <!>',1),pS=Y("<!> <!>",1);function Uc(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.background,"$background",t),i=()=>oe(e.appstate,"$appstate",t),s=()=>oe(e.datastate,"$datastate",t),o=h=>{_a(h,{tooltip:"растянуть",children:(f,p)=>{cS(f,{size:"1.2rem"})},$$slots:{default:!0}})},a=h=>{_a(h,{tooltip:"сохранить пропорции",children:(f,p)=>{dS(f,{size:"1.2rem"})},$$slots:{default:!0}})};qe(n().paste_mode==="fit");let l=n().paste_mode,u="";window.addEventListener("texture_loaded",h=>{h.detail===u&&(D(e.appstate,y(i).background_loading=!1,y(i)),u="")});function c(h){D(e.background,y(n).src=h.target?.value,y(n))}function d(h,f){if(u=h,D(e.appstate,y(i).background_loading=!0,y(i)),n().paste_mode==="fit"){Gr(e.background,qe({...n(),src:h,x:0,y:0,w:s().width,h:s().height}));const p=new Image;p.src=h,p.onload=()=>{Gr(e.appstate,qe({...i(),background_width:p.width,background_height:p.height,background_aspect:p.width/p.height,background:f}))}}else if(n().paste_mode==="aspect"){const p=new Image;p.src=h,p.onload=()=>{const m=Oc(s().width,s().height,p.width,p.height);Gr(e.background,qe({...n(),...m,src:h})),Gr(e.appstate,qe({...i(),background_width:p.width,background_height:p.height,background_aspect:p.width/p.height,background:f}))}}}kr(()=>{l!==n().paste_mode&&y(()=>{D(e.appstate,y(i).background_loading=!0,y(i)),l=n().paste_mode,d(n().src,i().background),D(e.appstate,y(i).background_loading=!1,y(i))})}),ir(r,{title:"Фон",collapsed:!0,children:(h,f)=>{var p=pS(),m=K(p);Te(m,{children:(v,x)=>{var b=hS(),_=K(b);Vt(_,{placeholder:"ссылка на картинку фона",onchange:c,get value(){return i().background},set value(C){D(e.appstate,y(i).background=C,y(i))}});var w=I(_,2);iS(w,{onload:d,accept:"image/*"}),N(v,b)},$$slots:{default:!0}});var g=I(m,2);Te(g,{children:(v,x)=>{var b=fS(),_=K(b);Z(_,{label:"X",get value(){return n().x},set value(U){D(e.background,y(n).x=U,y(n))}});var w=I(_,2);Z(w,{label:"Y",get value(){return n().y},set value(U){D(e.background,y(n).y=U,y(n))}});var C=I(w,2);Z(C,{label:"W",get value(){return n().w},set value(U){D(e.background,y(n).w=U,y(n))}});var P=I(C,2);Z(P,{label:"H",get value(){return n().h},set value(U){D(e.background,y(n).h=U,y(n))}});var S=I(P,4);Qr(S,{get checked(){return n().flip_h},set checked(U){D(e.background,y(n).flip_h=U,y(n))},tooltip:"отразить горизонтально",children:(U,L)=>{lS(U,{size:"1.2rem"})},$$slots:{default:!0}});var A=I(S,2);Qr(A,{get checked(){return n().flip_v},set checked(U){D(e.background,y(n).flip_v=U,y(n))},tooltip:"отразить вертикально",children:(U,L)=>{uS(U,{size:"1.2rem"})},$$slots:{default:!0}});var E=I(A,2);aS(E,{options:["fit","aspect"],get selected(){return n().paste_mode},set selected(U){D(e.background,y(n).paste_mode=U,y(n))},children:[o,a]}),N(v,b)},$$slots:{default:!0}}),N(h,p)},$$slots:{default:!0}}),Se()}const mS="https://gql.twitch.tv/gql",gS="kimne78kx3ncx6brgo4mv6wki5h1ko";async function vS(r,e="285x380"){return(await xS(r.map(s=>_S.SearchResultsPage_SearchResults(s)))).map(s=>yS.SearchResultsPage_SearchResults(s)).map((s,o)=>{if(!s||s.length===0)return[{name:"Nothing found",cover:"https://static-cdn.jtvnw.net/ttv-static/404_boxart.jpg",tags:[]}];const a=s.findIndex(l=>l.name.toLowerCase()===r[o].toLowerCase());if(a){const l=s.splice(a,1)[0];s.unshift(l)}return s.forEach(l=>{l&&(l.cover=l?.cover?l.cover.replace("90x120",e):"https://static-cdn.jtvnw.net/ttv-static/404_boxart.jpg")}),s})}async function xS(r){return await(await fetch(mS,{headers:{"Client-Id":gS},method:"POST",body:JSON.stringify(r)})).json()}const bS=(r,e=1)=>({extensions:{persistedQuery:{version:e,sha256Hash:r}}}),_S={SearchResultsPage_SearchResults:r=>({operationName:"SearchResultsPage_SearchResults",variables:{query:r,options:null,requestID:crypto.randomUUID()},...bS("6ea6e6f66006485e41dbe3ebd69d5674c5b22896ce7b595d7fce6411a3790138")})},yS={SearchResultsPage_SearchResults:r=>{const e=r.data.searchFor?.games?.edges;return e?e?.map(n=>({name:n.item.name,cover:n.item.boxArtURL,tags:n.item.tags.map(i=>i.tagName)})):[]}};var SS=Y("<div> <button>🗙</button></div>"),wS=Y('<div class="loader svelte-3nax8w"></div>'),TS=Y('<li class="option svelte-3nax8w" role="option" aria-selected="false"> </li>'),CS=Y('<ul class="options svelte-3nax8w" role="listbox" aria-multiselectable="false"></ul>'),PS=Y('<div class="container svelte-3nax8w"><div><div class="tags svelte-3nax8w"><!> <div class="input-container svelte-3nax8w"><input type="text" placeholder="введите категорию..." class="input svelte-3nax8w"> <!></div></div> <!></div></div>');function AS(r,e){ye(e,!1);const t=$e(),n=()=>oe(w,"$tags",t),i=()=>oe(l(),"$categories",t),s=()=>oe(x,"$root",t),o=()=>oe(b,"$tag",t),a=()=>oe(_,"$deleteTrigger",t);let l=X(e,"categories",8),u=X(e,"selected",28,()=>[]),c=He([]),d=He(!1),h=He(!1),f=He(""),p="",m=null,g=0;const v=500,{elements:{root:x,tag:b,deleteTrigger:_},states:{tags:w}}=T1({defaultTags:[],remove:W=>(E(W.id),!0),add(W){return{id:(g+=1).toString(),value:W}}});u().length>0&&w.set(u().map((W,O)=>(g=O,{id:O.toString(),value:W.name})));function C(W){const O=W.target.dataset.value,V=W.target.dataset.src;A(O,V),setTimeout(()=>{ne(d,!1),ne(c,[]),ne(f,""),p=""},50)}async function P(){if(k(f)===p||k(f)==="")return;ne(h,!0),p=k(f);const W=await vS([k(f)]);ne(c,W[0].filter(O=>O.name!="Nothing found").filter(O=>!n().find(V=>V.value===O.name)).map(O=>({name:O.name,src:O.cover}))),ne(h,!1),ne(d,!0)}async function S(){if(!k(f)||k(f).length<3){ne(d,!1);return}m&&clearTimeout(m),m=setTimeout(async()=>await P(),v)}function A(W,O){u().push({name:W,src:O,id:g+=1}),l().set({...i(),src:u().map(V=>V.src)}),w.update(V=>(V.push({id:g.toString(),value:W}),V))}function E(W){u(u().filter(O=>O.id!==Number(W))),l().set({...i(),src:u().map(O=>O.src)})}function U(){setTimeout(()=>{k(d)&&(ne(c,[]),ne(d,!1),ne(f,""),p="")},300)}it(()=>k(f),()=>{k(f)&&S()}),Kn(),kt();var L=PS(),R=ie(L);let T;var B=ie(R),z=ie(B);Di(z,1,n,Ui,(W,O)=>{var V=SS();let $;le(()=>$=at(V,$,{...o()(k(O)),class:"tag"},"svelte-3nax8w"));var Q=ie(V),ue=I(Q);let De;le(()=>De=at(ue,De,{...a()(k(O)),class:"delete"},"svelte-3nax8w")),le(()=>bt(Q,`${k(O).value??""} `)),xt(ue,st=>_(st)),xt(V,st=>b(st)),Gs(3,V,()=>Fm,()=>({duration:150})),N(W,V)});var G=I(z,2),j=ie(G),M=I(j,2);Fe(M,()=>k(h),W=>{var O=wS();N(W,O)});var H=I(B,2);Fe(H,()=>k(d),W=>{var O=CS();Di(O,5,()=>k(c),Ui,(V,$)=>{var Q=TS(),ue=ie(Q);le(()=>{ve(Q,"data-value",k($).name),ve(Q,"data-src",k($).src),bt(ue,k($).name)}),ge("click",Q,C),N(V,Q)}),Gs(3,O,()=>Fc,()=>({duration:250})),N(W,O)}),le(()=>T=at(R,T,{...s(),class:"root"},"svelte-3nax8w")),Ka(j,()=>k(f),W=>ne(f,W)),ge("change",j,S),ge("focusout",j,U),xt(R,W=>x(W)),N(r,L),Se()}const Dc="data:image/jpeg;base64,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";var ES=Y("<!> <!> <!> <!>",1),MS=Y("<!> <!> <!> <!> <!>",1),RS=Y("<!> <!> <!>",1);function Nm(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.categories,"$categories",t);ir(r,{title:"Категории",children:(i,s)=>{var o=RS(),a=K(o);Te(a,{style:"display: block",children:(c,d)=>{AS(c,{get categories(){return e.categories},selected:[{name:"Just Chatting",src:Dc,id:0}]})},$$slots:{default:!0}});var l=I(a,2);Te(l,{children:(c,d)=>{var h=ES(),f=K(h);Z(f,{label:"X",get value(){return n().x},set value(v){D(e.categories,y(n).x=v,y(n))}});var p=I(f,2);Z(p,{label:"Y",get value(){return n().y},set value(v){D(e.categories,y(n).y=v,y(n))}});var m=I(p,2);Z(m,{label:"W",get value(){return n().w},set value(v){D(e.categories,y(n).w=v,y(n))}});var g=I(m,2);Z(g,{label:"H",get value(){return n().h},set value(v){D(e.categories,y(n).h=v,y(n))}}),N(c,h)},$$slots:{default:!0}});var u=I(l,2);Te(u,{children:(c,d)=>{var h=MS(),f=K(h);Z(f,{label:"blur",get value(){return n().blur},set value(x){D(e.categories,y(n).blur=x,y(n))},step:.1,min:0});var p=I(f,2);Z(p,{label:"margin",get value(){return n().margin},set value(x){D(e.categories,y(n).margin=x,y(n))},min:0});var m=I(p,2);Z(m,{label:"round",get value(){return n().round},set value(x){D(e.categories,y(n).round=x,y(n))},min:0});var g=I(m,2);Z(g,{label:"shadow",get value(){return n().shadow.value},set value(x){D(e.categories,y(n).shadow.value=x,y(n))},min:0});var v=I(g,2);At(v,{get hex(){return n().shadow.color},set hex(x){D(e.categories,y(n).shadow.color=x,y(n))}}),N(c,h)},$$slots:{default:!0}}),N(i,o)},$$slots:{default:!0}}),Se()}var kS=Y("<textarea></textarea>");function io(r,e){let t=X(e,"value",15,"");var n=kS();n.__input=function(...i){e.oninput?.apply(this,i)},n.__change=function(...i){e.onchange?.apply(this,i)},le(()=>{ve(n,"placeholder",e.placeholder),ve(n,"tabindex",e.tabindex)}),Ka(n,t),N(r,n)}Zn(["input","change"]);var FS=Y("<!> <!> <!> <!>",1),IS=Y("<!> <!> <!> <!> <!>",1),BS=Y("<!> <!> <!>",1);function Hm(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.title,"$title",t);ir(r,{title:"Заголовок",children:(i,s)=>{var o=BS(),a=K(o);Te(a,{children:(c,d)=>{io(c,{placeholder:"заголовок",get value(){return n().text},set value(h){D(e.title,y(n).text=h,y(n))},tabindex:1})},$$slots:{default:!0}});var l=I(a,2);Te(l,{children:(c,d)=>{var h=FS(),f=K(h);Z(f,{label:"X",get value(){return n().x},set value(v){D(e.title,y(n).x=v,y(n))}});var p=I(f,2);Z(p,{label:"Y",get value(){return n().y},set value(v){D(e.title,y(n).y=v,y(n))}});var m=I(p,2);Z(m,{label:"shadow",get value(){return n().shadow.value},set value(v){D(e.title,y(n).shadow.value=v,y(n))},min:0});var g=I(m,2);At(g,{get hex(){return n().shadow.color},set hex(v){D(e.title,y(n).shadow.color=v,y(n))}}),N(c,h)},$$slots:{default:!0}});var u=I(l,2);Te(u,{children:(c,d)=>{var h=IS(),f=K(h);Vt(f,{placeholder:"Arial",label:"font",get value(){return n().font.face},set value(x){D(e.title,y(n).font.face=x,y(n))},width:100});var p=I(f,2);Z(p,{placeholder:"60",label:"size",get value(){return n().font.size},set value(x){D(e.title,y(n).font.size=x,y(n))},min:0});var m=I(p,2);Z(m,{placeholder:"60",label:"lh",get value(){return n().font.line_height},set value(x){D(e.title,y(n).font.line_height=x,y(n))},min:0});var g=I(m,2);Vt(g,{placeholder:"bold",label:"weight",get value(){return n().font.weight},set value(x){D(e.title,y(n).font.weight=x,y(n))},width:40});var v=I(g,2);At(v,{label:"color",get hex(){return n().font.color},set hex(x){D(e.title,y(n).font.color=x,y(n))}}),N(c,h)},$$slots:{default:!0}}),N(i,o)},$$slots:{default:!0}}),Se()}var OS=Y("<!> <!> <!> <!>",1),US=Y("<!> <!> <!> <!> <!>",1),DS=Y("<!> <!> <!>",1);function GS(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.description,"$description",t);ir(r,{title:"Описание",children:(i,s)=>{var o=DS(),a=K(o);Te(a,{children:(c,d)=>{io(c,{placeholder:"описание",get value(){return n().text},set value(h){D(e.description,y(n).text=h,y(n))},tabindex:2})},$$slots:{default:!0}});var l=I(a,2);Te(l,{children:(c,d)=>{var h=OS(),f=K(h);Z(f,{label:"X",get value(){return n().x},set value(v){D(e.description,y(n).x=v,y(n))}});var p=I(f,2);Z(p,{label:"margin",get value(){return n().gap},set value(v){D(e.description,y(n).gap=v,y(n))}});var m=I(p,2);Z(m,{label:"shadow",get value(){return n().shadow.value},set value(v){D(e.description,y(n).shadow.value=v,y(n))},min:0});var g=I(m,2);At(g,{get hex(){return n().shadow.color},set hex(v){D(e.description,y(n).shadow.color=v,y(n))}}),N(c,h)},$$slots:{default:!0}});var u=I(l,2);Te(u,{children:(c,d)=>{var h=US(),f=K(h);Vt(f,{placeholder:"Arial",label:"font",get value(){return n().font.face},set value(x){D(e.description,y(n).font.face=x,y(n))},width:100});var p=I(f,2);Z(p,{placeholder:"60",label:"size",get value(){return n().font.size},set value(x){D(e.description,y(n).font.size=x,y(n))},min:0});var m=I(p,2);Z(m,{placeholder:"60",label:"lh",get value(){return n().font.line_height},set value(x){D(e.description,y(n).font.line_height=x,y(n))},min:0});var g=I(m,2);Vt(g,{placeholder:"bold",label:"weight",get value(){return n().font.weight},set value(x){D(e.description,y(n).font.weight=x,y(n))},width:40});var v=I(g,2);At(v,{label:"color",get hex(){return n().font.color},set hex(x){D(e.description,y(n).font.color=x,y(n))}}),N(c,h)},$$slots:{default:!0}}),N(i,o)},$$slots:{default:!0}}),Se()}const Vm="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1280' height='720'%3E%3Cdefs%3E%3ClinearGradient id='a' x1='0' x2='0' y1='0' y2='1'%3E%3Cstop offset='0' stop-color='%2380F'/%3E%3Cstop offset='1' stop-color='%23f40'/%3E%3C/linearGradient%3E%3Cpattern id='b' width='24' height='24' patternUnits='userSpaceOnUse'%3E%3Ccircle fill='%23ffffff' cx='12' cy='12' r='12'/%3E%3C/pattern%3E%3C/defs%3E%3Crect width='1280' height='720' fill='url(%23a)'/%3E%3Crect width='1280' height='720' fill='url(%23b)' fill-opacity='0.1'/%3E%3C/svg%3E",Wm="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' version='1.1' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns:svgjs='http://svgjs.dev/svgjs' width='1280' height='720' preserveAspectRatio='none' viewBox='0 0 1280 720'%3e%3cg mask='url(%26quot%3b%23SvgjsMask1035%26quot%3b)' fill='none'%3e%3crect width='1280' height='720' x='0' y='0' fill='url(%26quot%3b%23SvgjsLinearGradient1036%26quot%3b)'%3e%3c/rect%3e%3cpath d='M50 720L770 0L1050.5 0L330.5 720z' fill='url(%26quot%3b%23SvgjsLinearGradient1037%26quot%3b)'%3e%3c/path%3e%3cpath d='M433.40000000000003 720L1153.4 0L1679.9 0L959.9000000000001 720z' fill='url(%26quot%3b%23SvgjsLinearGradient1037%26quot%3b)'%3e%3c/path%3e%3cpath d='M1237 720L517 0L212.5 0L932.5 720z' fill='url(%26quot%3b%23SvgjsLinearGradient1038%26quot%3b)'%3e%3c/path%3e%3cpath d='M783.5999999999999 720L63.59999999999991 0L-36.90000000000009 0L683.0999999999999 720z' fill='url(%26quot%3b%23SvgjsLinearGradient1038%26quot%3b)'%3e%3c/path%3e%3cpath d='M761.1341444415203 720L1280 201.13414444152033L1280 720z' fill='url(%26quot%3b%23SvgjsLinearGradient1037%26quot%3b)'%3e%3c/path%3e%3cpath d='M0 720L518.8658555584797 720L 0 201.13414444152033z' fill='url(%26quot%3b%23SvgjsLinearGradient1038%26quot%3b)'%3e%3c/path%3e%3c/g%3e%3cdefs%3e%3cmask id='SvgjsMask1035'%3e%3crect width='1280' height='720' fill='white'%3e%3c/rect%3e%3c/mask%3e%3clinearGradient x1='10.94%25' y1='-19.44%25' x2='89.06%25' y2='119.44%25' gradientUnits='userSpaceOnUse' id='SvgjsLinearGradient1036'%3e%3cstop stop-color='%230e2a47' offset='0'%3e%3c/stop%3e%3cstop stop-color='rgba(144%2c 71%2c 254%2c 1)' offset='1'%3e%3c/stop%3e%3c/linearGradient%3e%3clinearGradient x1='0%25' y1='100%25' x2='100%25' y2='0%25' id='SvgjsLinearGradient1037'%3e%3cstop stop-color='rgba(15%2c 70%2c 185%2c 0.2)' offset='0'%3e%3c/stop%3e%3cstop stop-opacity='0' stop-color='rgba(15%2c 70%2c 185%2c 0.2)' offset='0.66'%3e%3c/stop%3e%3c/linearGradient%3e%3clinearGradient x1='100%25' y1='100%25' x2='0%25' y2='0%25' id='SvgjsLinearGradient1038'%3e%3cstop stop-color='rgba(15%2c 70%2c 185%2c 0.2)' offset='0'%3e%3c/stop%3e%3cstop stop-opacity='0' stop-color='rgba(15%2c 70%2c 185%2c 0.2)' offset='0.66'%3e%3c/stop%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",jm="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1280' height='960' viewBox='0 0 1280 960'%3E%3Cdefs%3E%3Cpattern id='polygonPattern' patternUnits='userSpaceOnUse' width='120' height='120'%3E%3Crect fill='%231B7DFF' width='120' height='120'/%3E%3Cpolygon fill='%231CABEE' fill-opacity='1' points='120 120 60 120 90 90 120 60 120 0 120 0 60 60 0 0 0 60 30 90 60 120 120 120'/%3E%3C/pattern%3E%3C/defs%3E%3Crect width='1280' height='960' fill='url(%23polygonPattern)'/%3E%3C/svg%3E",Xm="data:image/svg+xml,%3Csvg width='180' height='180' viewBox='0 0 180 180' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg filter='url(%23filter0_b_4708_581)'%3E%3Crect width='180' height='180' fill='%23E0353D'/%3E%3Cpath d='M127.965 100.325C128.202 96.5313 125.591 93.7559 122.915 91.3863C118.215 86.7356 109.585 88.8783 107.713 95.306C107.584 95.3316 107.523 95.2594 107.452 95.2072C106.34 94.3996 105.053 93.8537 103.693 93.6115C103.09 93.4223 102.322 93.6678 101.852 93.1866C100.213 91.5559 98.5517 89.9466 96.9076 88.3211C96.4885 87.8552 95.7153 87.7699 95.2308 88.1855C93.4715 89.8693 91.7662 91.6043 90.0088 93.2905C82.3937 86.6592 85.854 85.7404 78.1322 93.132C77.5571 93.6012 77.3765 94.3686 77.9098 94.937C79.626 96.6487 81.3706 98.3227 83.0868 100.039C81.4574 101.819 79.6175 103.443 77.9241 105.177C77.4737 105.674 77.4746 106.287 77.9269 106.791C79.6004 108.45 81.2881 110.099 82.9702 111.748C83.1489 111.888 83.2072 112.063 83.2162 112.292C83.2883 115.516 85.1026 117.66 87.3554 119.775C85.9995 120.192 84.7567 120.905 83.7195 121.859C82.6823 122.813 81.8773 123.985 81.3645 125.288C65.1695 120.475 57.6705 100.035 66.8477 86.1099C69.9818 81.2034 74.7226 77.5782 78.7404 73.4023C82.0248 76.3375 84.8888 80.785 89.8339 80.7096C98.161 80.915 102.235 70.7648 96.561 65.3556C94.9966 63.7407 93.3539 62.2219 91.7728 60.6219C97.8339 54.6583 103.574 47.5984 112.411 45.8093C127.227 41.9316 143.422 52.4606 145.592 67.2975C148.157 82.9655 138.193 90.4959 128.056 100.355L127.965 100.325ZM117.832 77.6248C117.581 70.9315 107.409 71.2922 107.592 77.8978C107.927 84.5579 117.932 84.093 117.832 77.6248ZM119.823 65.678C119.781 72.203 129.917 72.3689 130.056 65.7767C130.051 59.1241 119.887 59.1497 119.825 65.678H119.823ZM119.823 77.6984C119.736 84.2258 129.957 84.3898 130.059 77.7804C130.003 71.0932 119.902 71.1207 119.825 77.6979L119.823 77.6984ZM112.7 70.7387C119.398 70.7363 119.422 60.7724 112.741 60.6862C106.025 60.696 105.975 70.7107 112.7 70.7387ZM85.36 76.5075C91.2575 81.988 100.227 74.1314 95.4882 67.7885C90.6123 62.6668 85.3533 57.8819 80.3675 52.8557C74.2523 46.7705 65.1538 43.948 56.5891 45.4422C42.162 47.508 31.0804 62.5317 34.6867 77.5027C35.8278 82.4912 38.2044 86.8269 41.8733 90.4498C48.7228 97.1305 55.5087 104.015 62.4236 110.561C59.0733 102.139 60.0376 92.3549 64.8618 84.6688C58.9055 86.245 52.3755 83.6904 49.3391 78.3726C49.0949 77.9821 48.8901 77.5185 49.0963 77.068C49.3941 76.2033 50.6722 76.0365 51.1951 76.7908C53.9955 82.3337 61.7485 84.5579 67.1497 81.0613C67.675 80.7352 68.1875 80.389 68.6293 79.9557C72.0161 76.6818 75.3019 73.2807 78.7433 70.0706C81.0127 72.1369 83.1299 74.3914 85.36 76.5075ZM100.623 96.3086C95.6949 97.5009 94.0934 103.165 96.9725 107.024C92.1791 103.09 84.6977 107.517 86.0351 113.469C86.4527 116.016 88.6539 117.564 90.3563 119.315C91.3993 120.364 92.4963 121.362 93.5018 122.442C82.0206 117.506 78.7309 135.857 91.1708 134.969C95.9917 134.297 98.4573 128.414 95.692 124.528C102.508 128.38 109.462 121 104.826 114.74L104.878 114.667C111.394 119.534 119.303 111.718 114.426 105.253C121.257 110.303 129.374 101.495 123.598 95.422C121.309 92.9061 118.51 90.3529 114.827 91.4669C110.114 92.6051 108.443 98.0553 111.009 101.859C108.023 99.2317 105.25 94.9482 100.623 96.31V96.3086Z' fill='white'/%3E%3C/g%3E%3Cdefs%3E%3Cfilter id='filter0_b_4708_581' x='-20.1111' y='-20.1111' width='220.222' height='220.222' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3E%3CfeFlood flood-opacity='0' result='BackgroundImageFix'/%3E%3CfeGaussianBlur in='BackgroundImageFix' stdDeviation='10.0556'/%3E%3CfeComposite in2='SourceAlpha' operator='in' result='effect1_backgroundBlur_4708_581'/%3E%3CfeBlend mode='normal' in='SourceGraphic' in2='effect1_backgroundBlur_4708_581' result='shape'/%3E%3C/filter%3E%3C/defs%3E%3C/svg%3E",Gc="data:image/svg+xml,%3Csvg width='180' height='146' viewBox='0 0 112 90' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M93.9654 55.3252C94.2024 51.5313 91.5907 48.7559 88.9146 46.3863C84.215 41.7356 75.5854 43.8783 73.7128 50.306C73.5843 50.3316 73.5231 50.2594 73.452 50.2072C72.3396 49.3996 71.0535 48.8537 69.6926 48.6115C69.0896 48.4223 68.3215 48.6678 67.8522 48.1866C66.2129 46.5559 64.5517 44.9466 62.9076 43.3211C62.4885 42.8552 61.7153 42.7699 61.2308 43.1855C59.4715 44.8693 57.7662 46.6043 56.0088 48.2905C48.3937 41.6592 51.854 40.7404 44.1322 48.132C43.5571 48.6012 43.3765 49.3686 43.9098 49.937C45.626 51.6487 47.3706 53.3227 49.0868 55.0387C47.4574 56.8194 45.6175 58.443 43.9241 60.1772C43.4737 60.6743 43.4746 61.2874 43.9269 61.7906C45.6004 63.4497 47.2881 65.0985 48.9702 66.7483C49.1489 66.8881 49.2072 67.0628 49.2162 67.2916C49.2883 70.5161 51.1026 72.6598 53.3554 74.775C51.9995 75.1923 50.7567 75.9047 49.7195 76.8591C48.6823 77.8135 47.8773 78.9854 47.3645 80.2876C31.1695 75.4752 23.6705 55.0354 32.8477 41.1099C35.9818 36.2034 40.7226 32.5782 44.7404 28.4023C48.0248 31.3375 50.8888 35.785 55.8339 35.7096C64.161 35.915 68.2348 25.7648 62.561 20.3556C60.9966 18.7407 59.3539 17.2219 57.7728 15.6219C63.8339 9.65833 69.5741 2.59843 78.4109 0.809348C93.2272 -3.0684 109.422 7.46064 111.592 22.2975C114.157 37.9655 104.193 45.4959 94.0564 55.3555L93.9654 55.3252ZM83.832 32.6248C83.5807 25.9315 73.4094 26.2922 73.5919 32.8978C73.9266 39.5579 83.9315 39.093 83.832 32.6248ZM85.8231 20.678C85.7814 27.203 95.9172 27.3689 96.0556 20.7767C96.0508 14.1241 85.8871 14.1497 85.8245 20.678H85.8231ZM85.8231 32.6984C85.7359 39.2258 95.9575 39.3898 96.0594 32.7804C96.0034 26.0932 85.9023 26.1207 85.8245 32.6979L85.8231 32.6984ZM78.6996 25.7387C85.3978 25.7363 85.4225 15.7724 78.7408 15.6862C72.0246 15.696 71.9748 25.7107 78.6996 25.7387ZM51.36 31.5075C57.2575 36.988 66.2271 29.1314 61.4882 22.7885C56.6123 17.6668 51.3533 12.8819 46.3675 7.85573C40.2523 1.77051 31.1538 -1.05195 22.5891 0.442212C8.16199 2.50805 -2.91958 17.5317 0.68673 32.5027C1.82784 37.4912 4.20439 41.8269 7.87328 45.4498C14.7228 52.1305 21.5087 59.0147 28.4236 65.5612C25.0733 57.139 26.0376 47.3549 30.8618 39.6688C24.9055 41.245 18.3755 38.6904 15.3391 33.3726C15.0949 32.9821 14.8901 32.5185 15.0963 32.068C15.3941 31.2033 16.6722 31.0365 17.1951 31.7908C19.9955 37.3337 27.7485 39.5579 33.1497 36.0613C33.675 35.7352 34.1875 35.389 34.6293 34.9557C38.0161 31.6818 41.3019 28.2807 44.7433 25.0706C47.0127 27.1369 49.1299 29.3914 51.36 31.5075ZM66.6229 51.3086C61.6949 52.5009 60.0934 58.1649 62.9725 62.0245C58.1791 58.0904 50.6977 62.5174 52.0351 68.4689C52.4527 71.0165 54.6539 72.5642 56.3563 74.3151C57.3993 75.3639 58.4963 76.3619 59.5018 77.4423C48.0206 72.5065 44.7309 90.8572 57.1708 89.9687C61.9917 89.2973 64.4573 83.4138 61.692 79.5277C68.5079 83.3798 75.4616 75.9998 70.8256 69.7399L70.8778 69.6668C77.3935 74.5341 85.3026 66.7176 80.4262 60.2526C87.2572 65.3026 95.3743 56.4951 89.5977 50.422C87.3088 47.9061 84.5104 45.3529 80.8273 46.4669C76.114 47.6051 74.4428 53.0553 77.009 56.859C74.0228 54.2317 71.2499 49.9482 66.6229 51.31V51.3086Z' fill='white'/%3E%3C/svg%3E%0A",qm=Gc,Ym="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='358' height='146' viewBox='0 0 86 35' fill='none'%3E%3Cpath d='M38.5483 10.3587H40.5521V13.6884C40.0941 14.0176 39.5674 14.2702 38.9719 14.4462C38.3765 14.6223 37.7811 14.7103 37.1856 14.7103C36.3459 14.7103 35.5901 14.5342 34.9184 14.1821C34.2466 13.8224 33.7199 13.3248 33.3382 12.6895C32.9565 12.0542 32.7656 11.3347 32.7656 10.5309C32.7656 9.7272 32.9565 9.00768 33.3382 8.37235C33.7199 7.73703 34.2504 7.24331 34.9298 6.89121C35.6092 6.53144 36.3764 6.35156 37.2314 6.35156C37.9795 6.35156 38.6513 6.47786 39.2468 6.73046C39.8422 6.98306 40.3384 7.34665 40.7353 7.82123L39.2926 9.13015C38.7506 8.5331 38.1017 8.23457 37.3459 8.23457C36.6589 8.23457 36.1054 8.44507 35.6856 8.86607C35.2657 9.27941 35.0558 9.83437 35.0558 10.5309C35.0558 10.9749 35.1512 11.3729 35.342 11.725C35.5329 12.0695 35.8001 12.3412 36.1436 12.5402C36.4871 12.7316 36.8803 12.8273 37.323 12.8273C37.7582 12.8273 38.1666 12.7393 38.5483 12.5632V10.3587Z' fill='white'/%3E%3Cpath d='M47.589 12.988H44.1996L43.5698 14.5495H41.2567L44.795 6.51231H47.0279L50.5776 14.5495H48.2188L47.589 12.988ZM46.9248 11.3117L45.8943 8.73977L44.8637 11.3117H46.9248Z' fill='white'/%3E%3Cpath d='M58.6863 14.5495L58.6634 10.2898L56.6022 13.7573H55.5946L53.5449 10.4046V14.5495H51.4494V6.51231H53.3159L56.1328 11.1509L58.8809 6.51231H60.7474L60.7703 14.5495H58.6863Z' fill='white'/%3E%3Cpath d='M69.0389 12.7928V14.5495H62.6036V6.51231H68.8901V8.26902H64.8479V9.62387H68.4091V11.3232H64.8479V12.7928H69.0389Z' fill='white'/%3E%3Cpath d='M74.03 12.4139H72.7933V14.5495H70.5261V6.51231H74.1903C74.9155 6.51231 75.5453 6.63478 76.0797 6.87972C76.6141 7.11701 77.0263 7.46147 77.3164 7.91308C77.6065 8.35705 77.7515 8.88138 77.7515 9.48609C77.7515 10.0678 77.6141 10.5769 77.3393 11.0132C77.0721 11.4418 76.6866 11.7786 76.1828 12.0236L77.9118 14.5495H75.4843L74.03 12.4139ZM75.4614 9.48609C75.4614 9.11102 75.343 8.82014 75.1064 8.61347C74.8697 8.4068 74.5186 8.30346 74.0529 8.30346H72.7933V10.6572H74.0529C74.5186 10.6572 74.8697 10.5577 75.1064 10.3587C75.343 10.152 75.4614 9.86116 75.4614 9.48609Z' fill='white'/%3E%3Cpath d='M82.0482 14.7103C81.3994 14.7103 80.7696 14.6299 80.1589 14.4692C79.5481 14.3084 79.0519 14.0941 78.6703 13.8262L79.4146 12.1499C79.7733 12.3871 80.1894 12.5785 80.6627 12.7239C81.136 12.8694 81.6017 12.9421 82.0597 12.9421C82.9299 12.9421 83.3651 12.7239 83.3651 12.2876C83.3651 12.058 83.2391 11.8896 82.9872 11.7824C82.7429 11.6676 82.346 11.549 81.7963 11.4265C81.1932 11.2964 80.6894 11.1586 80.2848 11.0132C79.8802 10.8601 79.5329 10.619 79.2428 10.2898C78.9527 9.96067 78.8077 9.5167 78.8077 8.95793C78.8077 8.46804 78.9413 8.0279 79.2084 7.63752C79.4756 7.23949 79.8726 6.92565 80.3993 6.69602C80.9337 6.46638 81.5864 6.35156 82.3574 6.35156C82.8841 6.35156 83.4032 6.4128 83.9147 6.53527C84.4262 6.65009 84.8766 6.82232 85.2659 7.05195L84.5674 8.73977C83.804 8.32643 83.0635 8.11976 82.346 8.11976C81.8956 8.11976 81.5673 8.18865 81.3612 8.32643C81.1551 8.45655 81.052 8.62878 81.052 8.84311C81.052 9.05743 81.1742 9.21818 81.4184 9.32534C81.6627 9.43251 82.0559 9.5435 82.5979 9.65831C83.2086 9.78844 83.7124 9.93005 84.1094 10.0831C84.514 10.2286 84.8613 10.4659 85.1514 10.795C85.4491 11.1165 85.598 11.5566 85.598 12.1154C85.598 12.5976 85.4644 13.034 85.1972 13.4243C84.93 13.8147 84.5292 14.1286 83.9949 14.3658C83.4605 14.5955 82.8116 14.7103 82.0482 14.7103Z' fill='white'/%3E%3Cpath d='M39.3384 24.3521C39.7964 24.5129 40.1552 24.7655 40.4147 25.1099C40.6743 25.4467 40.8041 25.8562 40.8041 26.3385C40.8041 27.0427 40.5216 27.5861 39.9567 27.9689C39.3918 28.3516 38.575 28.543 37.5062 28.543H33.1779V20.5057H37.2772C38.3002 20.5057 39.0788 20.6971 39.6132 21.0798C40.1475 21.4549 40.4147 21.9639 40.4147 22.6069C40.4147 22.9896 40.3193 23.3341 40.1285 23.6402C39.9452 23.9388 39.6819 24.1761 39.3384 24.3521ZM35.4222 22.1476V23.6976H36.9795C37.7429 23.6976 38.1246 23.4374 38.1246 22.9169C38.1246 22.404 37.7429 22.1476 36.9795 22.1476H35.4222ZM37.323 26.9011C38.1169 26.9011 38.5139 26.6293 38.5139 26.0859C38.5139 25.5424 38.1169 25.2707 37.323 25.2707H35.4222V26.9011H37.323Z' fill='white'/%3E%3Cpath d='M47.5778 26.9814H44.1884L43.5586 28.543H41.2455L44.7838 20.5057H47.0167L50.5664 28.543H48.2076L47.5778 26.9814ZM46.9137 25.3051L45.8831 22.7332L44.8525 25.3051H46.9137Z' fill='white'/%3E%3Cpath d='M54.2551 28.7037C53.6062 28.7037 52.9764 28.6233 52.3657 28.4626C51.755 28.3018 51.2588 28.0875 50.8771 27.8196L51.6214 26.1433C51.9802 26.3806 52.3963 26.5719 52.8696 26.7174C53.3429 26.8628 53.8085 26.9355 54.2666 26.9355C55.1368 26.9355 55.5719 26.7174 55.5719 26.281C55.5719 26.0514 55.446 25.883 55.1941 25.7759C54.9498 25.661 54.5528 25.5424 54.0032 25.4199C53.4001 25.2898 52.8963 25.152 52.4917 25.0066C52.0871 24.8535 51.7398 24.6124 51.4497 24.2832C51.1596 23.9541 51.0145 23.5101 51.0145 22.9513C51.0145 22.4614 51.1481 22.0213 51.4153 21.6309C51.6825 21.2329 52.0795 20.9191 52.6062 20.6894C53.1406 20.4598 53.7933 20.345 54.5643 20.345C55.091 20.345 55.6101 20.4062 56.1216 20.5287C56.633 20.6435 57.0834 20.8157 57.4728 21.0454L56.7743 22.7332C56.0109 22.3198 55.2704 22.1132 54.5528 22.1132C54.1024 22.1132 53.7742 22.1821 53.5681 22.3198C53.3619 22.45 53.2589 22.6222 53.2589 22.8365C53.2589 23.0508 53.381 23.2116 53.6253 23.3188C53.8696 23.4259 54.2627 23.5369 54.8047 23.6517C55.4155 23.7819 55.9193 23.9235 56.3162 24.0765C56.7208 24.222 57.0682 24.4593 57.3583 24.7884C57.656 25.1099 57.8048 25.55 57.8048 26.1088C57.8048 26.5911 57.6713 27.0274 57.4041 27.4177C57.1369 27.8081 56.7361 28.122 56.2017 28.3593C55.6674 28.5889 55.0185 28.7037 54.2551 28.7037Z' fill='white'/%3E%3Cpath d='M65.5165 26.7862V28.543H59.0812V20.5057H65.3676V22.2624H61.3255V23.6173H64.8867V25.3166H61.3255V26.7862H65.5165Z' fill='white'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M17.8484 32.3762C17.8484 32.3762 21.7337 28.5373 22.5805 23.3751C24.8584 23.3751 26.2654 17.887 23.9871 15.9561C23.9952 15.7834 24.023 15.5248 24.0585 15.1963C24.4399 11.6579 25.6965 0 12.5732 0C-0.548609 0 0.7064 11.655 1.08758 15.195C1.12303 15.5241 1.15092 15.7832 1.15899 15.9561C-1.11914 17.887 0.287659 23.3751 2.56567 23.3751C3.41236 28.5373 7.29775 32.3762 7.29775 32.3762C8.09939 33.1835 10.2768 34.7982 12.5732 34.7982C14.8696 34.7982 17.0469 33.1835 17.8484 32.3762ZM4.26764 19.8591C6.92754 24.2208 10.9345 21.1863 10.9345 21.1863C11.3922 20.8411 11.9318 20.5869 12.5586 20.5924C13.1854 20.5979 13.6858 20.8439 14.1367 21.1845C14.1367 21.1845 18.144 24.2197 20.8043 19.858C23.4638 15.4978 22.392 10.7493 22.392 10.7493C22.2043 9.58662 21.5854 8.81075 20.4175 8.90821C19.2529 9.00528 16.7252 12.0394 16.7252 12.0394C16.5164 12.2894 16.0789 12.4937 15.7541 12.4937L9.31969 12.4948C8.99448 12.4948 8.55736 12.2905 8.34894 12.0405C8.34894 12.0405 5.82085 9.00641 4.65444 8.90933C3.48803 8.81188 2.86765 9.58849 2.68101 10.7504C2.68101 10.7504 1.60773 15.4982 4.26764 19.8591ZM7.20848 18.8402C7.20848 18.4262 7.54475 18.0906 7.95955 18.0906C8.37435 18.0906 8.71062 18.4262 8.71062 18.8402C8.71062 19.2542 8.37435 19.5898 7.95955 19.5898C7.54475 19.5898 7.20848 19.2542 7.20848 18.8402ZM16.8752 18.5073C16.8752 18.8169 17.1267 19.0679 17.4369 19.0679C17.7471 19.0679 17.9986 18.8169 17.9986 18.5073V17.2875H19.2206C19.5308 17.2875 19.7823 17.0365 19.7823 16.7268C19.7823 16.4172 19.5308 16.1662 19.2206 16.1662H17.9986V14.9465C17.9986 14.6369 17.7471 14.3859 17.4369 14.3859C17.1267 14.3859 16.8752 14.6369 16.8752 14.9465V16.1662H15.653C15.3427 16.1662 15.0912 16.4172 15.0912 16.7268C15.0912 17.0365 15.3427 17.2875 15.653 17.2875H16.8752V18.5073ZM7.95971 14.7174C7.54491 14.7174 7.20864 15.053 7.20864 15.467C7.20864 15.881 7.54491 16.2166 7.95971 16.2166C8.37451 16.2166 8.71078 15.881 8.71078 15.467C8.71078 15.053 8.37451 14.7174 7.95971 14.7174ZM6.2698 16.4038C6.6846 16.4038 7.02087 16.7395 7.02087 17.1535C7.02087 17.5675 6.6846 17.9031 6.2698 17.9031C5.855 17.9031 5.51873 17.5675 5.51873 17.1535C5.51873 16.7395 5.855 16.4038 6.2698 16.4038ZM10.4007 17.1535C10.4007 16.7395 10.0644 16.4039 9.64961 16.4039C9.2348 16.4039 8.89854 16.7395 8.89854 17.1535C8.89854 17.5675 9.2348 17.9032 9.64961 17.9032C10.0644 17.9032 10.4007 17.5675 10.4007 17.1535Z' fill='white'/%3E%3C/svg%3E",zS=(r="#f27930")=>`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 378 125'%3E%3Cpath fill='${r.replace("#","%23")}' d='M351.8 23.6 328.7 59.5 326.4 23.6H307.1 301.1 293.2C296.3 13.1 298.7 4.6 298.7 4.6L300 .4H274.5L273.3 4.6 267.8 23.6H246.1C242.5 23.6 240.7 23.6 240.7 23.6 218.4 23.6 205.9 30 200.7 42 197.7 31 187.8 23.6 172.5 23.6 159.3 23.6 147.6 28.5 138.9 36.3 134.4 28.5 125.5 23.6 113.1 23.6 98.9 23.6 86.6 29.3 77.6 38 73.5 29.3 64.2 23.6 50.9 23.6 46.3 23.6 42 24.2 37.9 25.3L39.9 18.4C39.9 18.3 40 18.2 40 18.1L45.1.4H19.7L3.5 56.2C3.1 57.3 2.7 58.4 2.4 59.6 1.7 62.2 1.2 64.7 1 67.1-1.1 82.7 5.7 94.4 24.6 95.2 26.3 95.4 28.1 95.5 30.1 95.5 43.5 95.5 56 89.8 65.2 81.1 69.1 89.8 78.2 95.5 92.3 95.5 104.8 95.5 116.6 90.6 125.5 82.8 129.8 90.6 138.6 95.5 151.7 95.5 180.1 95.5 201.3 95.5 215.3 95.5 235 95.5 246.1 91.6 251.9 83.2 251.9 91.3 256.5 95.5 268.1 95.5 277.5 95.5 290.1 93.4 307.4 89.2L282.3 125H307L377.2 23.6H351.8ZM53.3 59.5C50.9 67.7 43.3 74.3 36.3 74.3 29.3 74.3 25.5 67.7 27.9 59.5 30.3 51.3 37.9 44.7 44.9 44.7 51.9 44.7 55.7 51.3 53.3 59.5ZM115.4 59.5C113 67.7 105.4 74.3 98.4 74.3S87.6 67.7 90 59.5 100 44.7 107 44.7 117.8 51.3 115.4 59.5ZM149.5 59.5C151.9 51.3 159.5 44.7 166.5 44.7S177.3 51.3 174.9 59.5C172.6 67.6 165.1 74.1 158.2 74.3 158 74.3 157.8 74.3 157.6 74.3 150.8 74.1 147.2 67.6 149.5 59.5ZM231.2 71.7C229.9 74.7 219.9 74.2 217.4 74.3 217.4 74.3 210.8 74.3 192.8 74.3 196.1 69.8 198.7 64.8 200.2 59.5 200.4 59 200.5 58.4 200.6 57.9 203.3 61.7 208.9 65.1 219.8 67.3 230.2 69.3 232.1 68.7 231.2 71.7ZM256.3 63.6C254.1 55.2 244.8 51.8 231.7 50.2 226.2 49.5 223.1 49.3 223.8 46.9 224.3 45.1 227.1 44.7 233 44.7 236.7 44.7 241.1 44.7 246.2 44.7H261.8L256.3 63.6ZM281.6 63.7C281.6 63.5 284.1 55.1 287.1 44.7H303.2L305.8 71.6C279.3 77.3 278.7 75.8 281.6 63.7Z'/%3E%3C/svg%3E`,Eu=zS,Km={adjustment:{enabled:!1,gamma:1,saturation:1,contrast:1,brightness:1},blur:{enabled:!0,value:.2},tilt_shift:{enabled:!1,blur:5,start:{x:600,y:0},end:{x:600,y:720}},vignetting:{enabled:!1,value:.3,alpha:1,blur:.3},zoom_blur:{enabled:!1,center:{x:900,y:360},value:.03,radius:500},gradient:{enabled:!0,orientation:"horizontal",start:{value:0,color:"#0000008c"},mid:{value:.34,color:"#00000066"},end:{value:.6,color:"#00000000"}}},LS={src:Vm,x:0,y:0,w:1280,h:720,flip_h:!1,flip_v:!1,paste_mode:"aspect"},NS={src:Xm,x:1100,y:0,w:180,h:180,blur:0,alpha:1},HS={text:"Заголовок",x:60,y:58,font:{face:"Gilroy",size:80,weight:"700",color:"#ffffff",line_height:97},shadow:{value:0,color:"#00000088"}},VS={text:"Очень интересный текст",x:60,gap:7,font:{face:"Gilroy",size:50,weight:"600",color:"#ffffff",line_height:60},shadow:{value:0,color:"#00000088"}},WS={src:[Dc],x:60,y:432,w:170,h:228,round:12,blur:.1,margin:32,shadow:{value:2,color:"#00000066"}},ya=xe(structuredClone(Km)),Ei=xe(structuredClone(LS)),zc=xe(structuredClone(NS)),Sa=xe(structuredClone(HS)),wa=xe(structuredClone(VS)),Lc=xe(structuredClone(WS)),Nc=mt([ya,Ei,zc,Sa,wa,Lc],([r,e,t,n,i,s])=>({version:0,width:1280,height:720,scale:1,debug:!1,filter:r,background:e,logo:t,title:n,description:i,categories:s})),Ta=xe({background:Vm.split(",")[0],background_loading:!1,background_width:1280,background_height:720,background_aspect:1280/720,logo:Xm.split(",")[0],app:void 0});var jS=Y("<!> <!> <!> <!> <!> <!>",1);function XS(r){var e=jS(),t=K(e);Uc(t,{background:Ei,appstate:Ta,datastate:Nc});var n=I(t,2);Bc(n,{logo:zc,appstate:Ta});var i=I(n,2);Ic(i,{filter:ya,defaults:Km});var s=I(i,2);Nm(s,{categories:Lc});var o=I(s,2);Hm(o,{title:Sa});var a=I(o,2);GS(a,{description:wa}),N(r,e)}const qS="modulepreload",YS=function(r,e){return new URL(r,e).href},Nh={},Ca=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");i=Promise.allSettled(t.map(u=>{if(u=YS(u,n),u in Nh)return;Nh[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(!!n)for(let p=o.length-1;p>=0;p--){const m=o[p];if(m.href===u&&(!c||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${d}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":qS,c||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),c)return new Promise((p,m)=>{f.addEventListener("load",p),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};var F=(r=>(r.Application="application",r.WebGLPipes="webgl-pipes",r.WebGLPipesAdaptor="webgl-pipes-adaptor",r.WebGLSystem="webgl-system",r.WebGPUPipes="webgpu-pipes",r.WebGPUPipesAdaptor="webgpu-pipes-adaptor",r.WebGPUSystem="webgpu-system",r.CanvasSystem="canvas-system",r.CanvasPipesAdaptor="canvas-pipes-adaptor",r.CanvasPipes="canvas-pipes",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r.MaskEffect="mask-effect",r.BlendMode="blend-mode",r.TextureSource="texture-source",r.Environment="environment",r.ShapeBuilder="shape-builder",r.Batcher="batcher",r))(F||{});const Mu=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},wo=(r,e)=>Mu(r).priority??e,he={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(Mu).forEach(e=>{e.type.forEach(t=>this._removeHandlers[t]?.(e))}),this},add(...r){return r.map(Mu).forEach(e=>{e.type.forEach(t=>{const n=this._addHandlers,i=this._queue;n[t]?n[t]?.(e):(i[t]=i[t]||[],i[t]?.push(e))})}),this},handle(r,e,t){const n=this._addHandlers,i=this._removeHandlers;if(n[r]||i[r])throw new Error(`Extension type ${r} already has a handler`);n[r]=e,i[r]=t;const s=this._queue;return s[r]&&(s[r]?.forEach(o=>e(o)),delete s[r]),this},handleByMap(r,e){return this.handle(r,t=>{t.name&&(e[t.name]=t.ref)},t=>{t.name&&delete e[t.name]})},handleByNamedList(r,e,t=-1){return this.handle(r,n=>{e.findIndex(s=>s.name===n.name)>=0||(e.push({name:n.name,value:n.ref}),e.sort((s,o)=>wo(o.value,t)-wo(s.value,t)))},n=>{const i=e.findIndex(s=>s.name===n.name);i!==-1&&e.splice(i,1)})},handleByList(r,e,t=-1){return this.handle(r,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((i,s)=>wo(s,t)-wo(i,t)))},n=>{const i=e.indexOf(n.ref);i!==-1&&e.splice(i,1)})}},KS={extension:{type:F.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Ca(()=>Promise.resolve().then(()=>sF),void 0,import.meta.url)}},$S={extension:{type:F.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Ca(()=>Promise.resolve().then(()=>oF),void 0,import.meta.url)}};class yt{constructor(e,t,n){this._x=t||0,this._y=n||0,this._observer=e}clone(e){return new yt(e??this._observer,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}function tl(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var $m={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,d,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new i(c,d||l,h),p=t?t+u:u;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,d;if(this._eventsCount===0)return u;for(d in c=this._events)e.call(c,d)&&u.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=t?t+u:u,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(u){var c=t?t+u:u,d=this._events[c];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,c,d,h,f,p){var m=t?t+u:u;if(!this._events[m])return!1;var g=this._events[m],v=arguments.length,x,b;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),v){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,d),!0;case 4:return g.fn.call(g.context,c,d,h),!0;case 5:return g.fn.call(g.context,c,d,h,f),!0;case 6:return g.fn.call(g.context,c,d,h,f,p),!0}for(b=1,x=new Array(v-1);b<v;b++)x[b-1]=arguments[b];g.fn.apply(g.context,x)}else{var _=g.length,w;for(b=0;b<_;b++)switch(g[b].once&&this.removeListener(u,g[b].fn,void 0,!0),v){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,c);break;case 3:g[b].fn.call(g[b].context,c,d);break;case 4:g[b].fn.call(g[b].context,c,d,h);break;default:if(!x)for(w=1,x=new Array(v-1);w<v;w++)x[w-1]=arguments[w];g[b].fn.apply(g[b].context,x)}}return!0},a.prototype.on=function(u,c,d){return s(this,u,c,d,!1)},a.prototype.once=function(u,c,d){return s(this,u,c,d,!0)},a.prototype.removeListener=function(u,c,d,h){var f=t?t+u:u;if(!this._events[f])return this;if(!c)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!h||p.once)&&(!d||p.context===d)&&o(this,f);else{for(var m=0,g=[],v=p.length;m<v;m++)(p[m].fn!==c||h&&!p[m].once||d&&p[m].context!==d)&&g.push(p[m]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&o(this,c)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,r.exports=a})($m);var ZS=$m.exports;const jt=tl(ZS),QS=Math.PI*2,JS=180/Math.PI,Ni=Math.PI/180;class We{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new We(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return wl.x=0,wl.y=0,wl}}const wl=new We;class ae{constructor(e=1,t=0,n=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=t,this.c=n,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,n,i,s,o){return this.a=e,this.b=t,this.c=n,this.d=i,this.tx=s,this.ty=o,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const n=t||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,t){t=t||new We;const n=e.x,i=e.y;return t.x=this.a*n+this.c*i+this.tx,t.y=this.b*n+this.d*i+this.ty,t}applyInverse(e,t){t=t||new We;const n=this.a,i=this.b,s=this.c,o=this.d,a=this.tx,l=this.ty,u=1/(n*o+s*-i),c=e.x,d=e.y;return t.x=o*u*c+-s*u*d+(l*s-a*o)*u,t.y=n*u*d+-i*u*c+(-l*n+a*i)*u,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*t-this.b*n,this.b=i*n+this.b*t,this.c=s*t-this.d*n,this.d=s*n+this.d*t,this.tx=o*t-this.ty*n,this.ty=o*n+this.ty*t,this}append(e){const t=this.a,n=this.b,i=this.c,s=this.d;return this.a=e.a*t+e.b*i,this.b=e.a*n+e.b*s,this.c=e.c*t+e.d*i,this.d=e.c*n+e.d*s,this.tx=e.tx*t+e.ty*i+this.tx,this.ty=e.tx*n+e.ty*s+this.ty,this}appendFrom(e,t){const n=e.a,i=e.b,s=e.c,o=e.d,a=e.tx,l=e.ty,u=t.a,c=t.b,d=t.c,h=t.d;return this.a=n*u+i*d,this.b=n*c+i*h,this.c=s*u+o*d,this.d=s*c+o*h,this.tx=a*u+l*d+t.tx,this.ty=a*c+l*h+t.ty,this}setTransform(e,t,n,i,s,o,a,l,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(n*this.a+i*this.c),this.ty=t-(n*this.b+i*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,i=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,n=this.b,i=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-i,s),l=Math.atan2(n,t),u=Math.abs(a+l);return u<1e-5||Math.abs(QS-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(t*t+n*n),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*t+o.y*i),e.position.y=this.ty+(o.x*n+o.y*s),e}invert(){const e=this.a,t=this.b,n=this.c,i=this.d,s=this.tx,o=e*i-t*n;return this.a=i/o,this.b=-t/o,this.c=-n/o,this.d=e/o,this.tx=(n*this.ty-i*s)/o,this.ty=-(e*this.ty-t*s)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new ae;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return tw.identity()}static get shared(){return ew.identity()}}const ew=new ae,tw=new ae,Pn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],An=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],En=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Mn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ru=[],Zm=[],To=Math.sign;function rw(){for(let r=0;r<16;r++){const e=[];Ru.push(e);for(let t=0;t<16;t++){const n=To(Pn[r]*Pn[t]+En[r]*An[t]),i=To(An[r]*Pn[t]+Mn[r]*An[t]),s=To(Pn[r]*En[t]+En[r]*Mn[t]),o=To(An[r]*En[t]+Mn[r]*Mn[t]);for(let a=0;a<16;a++)if(Pn[a]===n&&An[a]===i&&En[a]===s&&Mn[a]===o){e.push(a);break}}}for(let r=0;r<16;r++){const e=new ae;e.set(Pn[r],An[r],En[r],Mn[r],0,0),Zm.push(e)}}rw();const Qe={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>Pn[r],uY:r=>An[r],vX:r=>En[r],vY:r=>Mn[r],inv:r=>r&8?r&15:-r&7,add:(r,e)=>Ru[r][e],sub:(r,e)=>Ru[r][Qe.inv(e)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,e)=>Math.abs(r)*2<=Math.abs(e)?e>=0?Qe.S:Qe.N:Math.abs(e)*2<=Math.abs(r)?r>0?Qe.E:Qe.W:e>0?r>0?Qe.SE:Qe.SW:r>0?Qe.NE:Qe.NW,matrixAppendRotationInv:(r,e,t=0,n=0)=>{const i=Zm[Qe.inv(e)];i.tx=t,i.ty=n,r.append(i)}},Co=[new We,new We,new We,new We];class Le{constructor(e=0,t=0,n=0,i=0){this.type="rectangle",this.x=Number(e),this.y=Number(t),this.width=Number(n),this.height=Number(i)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Le(0,0,0,0)}clone(){return new Le(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}strokeContains(e,t,n){const{width:i,height:s}=this;if(i<=0||s<=0)return!1;const o=this.x,a=this.y,l=o-n/2,u=o+i+n/2,c=a-n/2,d=a+s+n/2,h=o+n/2,f=o+i-n/2,p=a+n/2,m=a+s-n/2;return e>=l&&e<=u&&t>=c&&t<=d&&!(e>h&&e<f&&t>p&&t<m)}intersects(e,t){if(!t){const S=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=S)return!1;const E=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>E}const n=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=n||o<=s)return!1;const a=Co[0].set(e.left,e.top),l=Co[1].set(e.left,e.bottom),u=Co[2].set(e.right,e.top),c=Co[3].set(e.right,e.bottom);if(u.x<=a.x||l.y<=a.y)return!1;const d=Math.sign(t.a*t.d-t.b*t.c);if(d===0||(t.apply(a,a),t.apply(l,l),t.apply(u,u),t.apply(c,c),Math.max(a.x,l.x,u.x,c.x)<=n||Math.min(a.x,l.x,u.x,c.x)>=i||Math.max(a.y,l.y,u.y,c.y)<=s||Math.min(a.y,l.y,u.y,c.y)>=o))return!1;const h=d*(l.y-a.y),f=d*(a.x-l.x),p=h*n+f*s,m=h*i+f*s,g=h*n+f*o,v=h*i+f*o;if(Math.max(p,m,g,v)<=h*a.x+f*a.y||Math.min(p,m,g,v)>=h*c.x+f*c.y)return!1;const x=d*(a.y-u.y),b=d*(u.x-a.x),_=x*n+b*s,w=x*i+b*s,C=x*n+b*o,P=x*i+b*o;return!(Math.max(_,w,C,P)<=x*a.x+b*a.y||Math.min(_,w,C,P)>=x*c.x+b*c.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(n-t,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,t=.001){const n=Math.ceil((this.x+this.width-t)*e)/e,i=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=n-this.x,this.height=i-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=n-t,this.y=i,this.height=s-i,this}getBounds(e){return e=e||new Le,e.copyFrom(this),e}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Tl={default:-1};function tt(r="default"){return Tl[r]===void 0&&(Tl[r]=-1),++Tl[r]}const Hh={},Me="8.0.0",nw="8.3.4";function J(r,e,t=3){if(Hh[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${r}`):(n=n.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${r}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${r}`),console.warn(n))),Hh[e]=!0}const Qm=()=>{};function Hi(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function Vh(r){return!(r&r-1)&&!!r}function iw(r){const e={};for(const t in r)r[t]!==void 0&&(e[t]=r[t]);return e}const Wh=Object.create(null);function sw(r){const e=Wh[r];return e===void 0&&(Wh[r]=tt("resource")),e}const Jm=class eg extends jt{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...eg.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){J(Me,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=sw(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Jm.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let tg=Jm;const rg=class ng extends jt{constructor(e={}){super(),this.options=e,this.uid=tt("textureSource"),this._resourceType="textureSource",this._resourceId=tt("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...ng.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new tg(iw(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=tt("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,t,n){n=n||this._resolution,e=e||this.width,t=t||this.height;const i=Math.round(e*n),s=Math.round(t*n);return this.width=i/n,this.height=s/n,this._resolution=n,this.pixelWidth===i&&this.pixelHeight===s?!1:(this._refreshPOT(),this.pixelWidth=i,this.pixelHeight=s,this.emit("resize",this),this._resourceId=tt("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Vh(this.pixelWidth)&&Vh(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};rg.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let lt=rg;class Hc extends lt{constructor(e){const t=e.resource||new Float32Array(e.width*e.height*4);let n=e.format;n||(t instanceof Float32Array?n="rgba32float":t instanceof Int32Array||t instanceof Uint32Array?n="rgba32uint":t instanceof Int16Array||t instanceof Uint16Array?n="rgba16uint":(t instanceof Int8Array,n="bgra8unorm")),super({...e,resource:t,format:n}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}Hc.extension=F.TextureSource;const jh=new ae;class ig{constructor(e,t){this.mapCoord=new ae,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof t>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=t,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,t){t===void 0&&(t=e);const n=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];t[i]=s*n.a+o*n.c+n.tx,t[i+1]=s*n.b+o*n.d+n.ty}return t}update(){const e=this._texture;this._updateID++;const t=e.uvs;this.mapCoord.set(t.x1-t.x0,t.y1-t.y0,t.x3-t.x0,t.y3-t.y0,t.x0,t.y0);const n=e.orig,i=e.trim;i&&(jh.set(n.width/i.width,0,0,n.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(jh));const s=e.source,o=this.uClampFrame,a=this.clampMargin/s._resolution,l=this.clampOffset/s._resolution;return o[0]=(e.frame.x+a+l)/s.width,o[1]=(e.frame.y+a+l)/s.height,o[2]=(e.frame.x+e.frame.width-a+l)/s.width,o[3]=(e.frame.y+e.frame.height-a+l)/s.height,this.uClampOffset[0]=this.clampOffset/s.pixelWidth,this.uClampOffset[1]=this.clampOffset/s.pixelHeight,this.isSimple=e.frame.width===s.width&&e.frame.height===s.height&&e.rotate===0,!0}}class te extends jt{constructor({source:e,label:t,frame:n,orig:i,trim:s,defaultAnchor:o,defaultBorders:a,rotate:l,dynamic:u}={}){if(super(),this.uid=tt("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Le,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=t,this.source=e?.source??new lt,this.noFrame=!n,n)this.frame.copyFrom(n);else{const{width:c,height:d}=this._source;this.frame.width=c,this.frame.height=d}this.orig=i||this.frame,this.trim=s,this.rotate=l??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=u||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new ig(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:t}=this,{width:n,height:i}=this._source,s=t.x/n,o=t.y/i,a=t.width/n,l=t.height/i;let u=this.rotate;if(u){const c=a/2,d=l/2,h=s+c,f=o+d;u=Qe.add(u,Qe.NW),e.x0=h+c*Qe.uX(u),e.y0=f+d*Qe.uY(u),u=Qe.add(u,2),e.x1=h+c*Qe.uX(u),e.y1=f+d*Qe.uY(u),u=Qe.add(u,2),e.x2=h+c*Qe.uX(u),e.y2=f+d*Qe.uY(u),u=Qe.add(u,2),e.x3=h+c*Qe.uX(u),e.y3=f+d*Qe.uY(u)}else e.x0=s,e.y0=o,e.x1=s+a,e.y1=o,e.x2=s+a,e.y2=o+l,e.x3=s,e.y3=o+l}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return J(Me,"Texture.baseTexture is now Texture.source"),this._source}}te.EMPTY=new te({label:"EMPTY",source:new lt({label:"EMPTY"})});te.EMPTY.destroy=Qm;te.WHITE=new te({source:new Hc({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});te.WHITE.destroy=Qm;function Pa(r,e,t,n){const{width:i,height:s}=t.orig,o=t.trim;if(o){const a=o.width,l=o.height;r.minX=o.x-e._x*i-n,r.maxX=r.minX+a,r.minY=o.y-e._y*s-n,r.maxY=r.minY+l}else r.minX=-e._x*i-n,r.maxX=r.minX+i,r.minY=-e._y*s-n,r.maxY=r.minY+s}const Xh=new ae;class Mt{constructor(e=1/0,t=1/0,n=-1/0,i=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Xh,this.minX=e,this.minY=t,this.maxX=n,this.maxY=i}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Le);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Xh,this}set(e,t,n,i){this.minX=e,this.minY=t,this.maxX=n,this.maxY=i}addFrame(e,t,n,i,s){s||(s=this.matrix);const o=s.a,a=s.b,l=s.c,u=s.d,c=s.tx,d=s.ty;let h=this.minX,f=this.minY,p=this.maxX,m=this.maxY,g=o*e+l*t+c,v=a*e+u*t+d;g<h&&(h=g),v<f&&(f=v),g>p&&(p=g),v>m&&(m=v),g=o*n+l*t+c,v=a*n+u*t+d,g<h&&(h=g),v<f&&(f=v),g>p&&(p=g),v>m&&(m=v),g=o*e+l*i+c,v=a*e+u*i+d,g<h&&(h=g),v<f&&(f=v),g>p&&(p=g),v>m&&(m=v),g=o*n+l*i+c,v=a*n+u*i+d,g<h&&(h=g),v<f&&(f=v),g>p&&(p=g),v>m&&(m=v),this.minX=h,this.minY=f,this.maxX=p,this.maxY=m}addRect(e,t){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,t)}addBounds(e,t){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,t)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const t=this.minX,n=this.minY,i=this.maxX,s=this.maxY,{a:o,b:a,c:l,d:u,tx:c,ty:d}=e;let h=o*t+l*n+c,f=a*t+u*n+d;this.minX=h,this.minY=f,this.maxX=h,this.maxY=f,h=o*i+l*n+c,f=a*i+u*n+d,this.minX=h<this.minX?h:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=h>this.maxX?h:this.maxX,this.maxY=f>this.maxY?f:this.maxY,h=o*t+l*s+c,f=a*t+u*s+d,this.minX=h<this.minX?h:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=h>this.maxX?h:this.maxX,this.maxY=f>this.maxY?f:this.maxY,h=o*i+l*s+c,f=a*i+u*s+d,this.minX=h<this.minX?h:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=h>this.maxX?h:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,t,n,i){return this.minX<e&&(this.minX=e),this.maxX>t&&(this.maxX=t),this.minY<n&&(this.minY=n),this.maxY>i&&(this.maxY=i),this}pad(e,t=e){return this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Mt(this.minX,this.minY,this.maxX,this.maxY)}scale(e,t=e){return this.minX*=e,this.minY*=t,this.maxX*=e,this.maxY*=t,this}get x(){return this.minX}set x(e){const t=this.maxX-this.minX;this.minX=e,this.maxX=e+t}get y(){return this.minY}set y(e){const t=this.maxY-this.minY;this.minY=e,this.maxY=e+t}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,t,n,i){let s=this.minX,o=this.minY,a=this.maxX,l=this.maxY;i||(i=this.matrix);const u=i.a,c=i.b,d=i.c,h=i.d,f=i.tx,p=i.ty;for(let m=t;m<n;m+=2){const g=e[m],v=e[m+1],x=u*g+d*v+f,b=c*g+h*v+p;s=x<s?x:s,o=b<o?b:o,a=x>a?x:a,l=b>l?b:l}this.minX=s,this.minY=o,this.maxX=a,this.maxY=l}containsPoint(e,t){return this.minX<=e&&this.minY<=t&&this.maxX>=e&&this.maxY>=t}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}}var ow={grad:.9,turn:360,rad:360/(2*Math.PI)},Or=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},ht=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*r)/t+0},Jt=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),r>t?t:r>e?r:e},sg=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},qh=function(r){return{r:Jt(r.r,0,255),g:Jt(r.g,0,255),b:Jt(r.b,0,255),a:Jt(r.a)}},Cl=function(r){return{r:ht(r.r),g:ht(r.g),b:ht(r.b),a:ht(r.a,3)}},aw=/^#([0-9a-f]{3,8})$/i,Po=function(r){var e=r.toString(16);return e.length<2?"0"+e:e},og=function(r){var e=r.r,t=r.g,n=r.b,i=r.a,s=Math.max(e,t,n),o=s-Math.min(e,t,n),a=o?s===e?(t-n)/o:s===t?2+(n-e)/o:4+(e-t)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},ag=function(r){var e=r.h,t=r.s,n=r.v,i=r.a;e=e/360*6,t/=100,n/=100;var s=Math.floor(e),o=n*(1-t),a=n*(1-(e-s)*t),l=n*(1-(1-e+s)*t),u=s%6;return{r:255*[n,a,o,o,l,n][u],g:255*[l,n,n,a,o,o][u],b:255*[o,o,l,n,n,a][u],a:i}},Yh=function(r){return{h:sg(r.h),s:Jt(r.s,0,100),l:Jt(r.l,0,100),a:Jt(r.a)}},Kh=function(r){return{h:ht(r.h),s:ht(r.s),l:ht(r.l),a:ht(r.a,3)}},$h=function(r){return ag((t=(e=r).s,{h:e.h,s:(t*=((n=e.l)<50?n:100-n)/100)>0?2*t/(n+t)*100:0,v:n+t,a:e.a}));var e,t,n},Ps=function(r){return{h:(e=og(r)).h,s:(i=(200-(t=e.s))*(n=e.v)/100)>0&&i<200?t*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,t,n,i},lw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,cw=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,dw=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ku={string:[[function(r){var e=aw.exec(r);return e?(r=e[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?ht(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?ht(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var e=cw.exec(r)||dw.exec(r);return e?e[2]!==e[4]||e[4]!==e[6]?null:qh({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(r){var e=lw.exec(r)||uw.exec(r);if(!e)return null;var t,n,i=Yh({h:(t=e[1],n=e[2],n===void 0&&(n="deg"),Number(t)*(ow[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return $h(i)},"hsl"]],object:[[function(r){var e=r.r,t=r.g,n=r.b,i=r.a,s=i===void 0?1:i;return Or(e)&&Or(t)&&Or(n)?qh({r:Number(e),g:Number(t),b:Number(n),a:Number(s)}):null},"rgb"],[function(r){var e=r.h,t=r.s,n=r.l,i=r.a,s=i===void 0?1:i;if(!Or(e)||!Or(t)||!Or(n))return null;var o=Yh({h:Number(e),s:Number(t),l:Number(n),a:Number(s)});return $h(o)},"hsl"],[function(r){var e=r.h,t=r.s,n=r.v,i=r.a,s=i===void 0?1:i;if(!Or(e)||!Or(t)||!Or(n))return null;var o=function(a){return{h:sg(a.h),s:Jt(a.s,0,100),v:Jt(a.v,0,100),a:Jt(a.a)}}({h:Number(e),s:Number(t),v:Number(n),a:Number(s)});return ag(o)},"hsv"]]},Zh=function(r,e){for(var t=0;t<e.length;t++){var n=e[t][0](r);if(n)return[n,e[t][1]]}return[null,void 0]},hw=function(r){return typeof r=="string"?Zh(r.trim(),ku.string):typeof r=="object"&&r!==null?Zh(r,ku.object):[null,void 0]},Pl=function(r,e){var t=Ps(r);return{h:t.h,s:Jt(t.s+100*e,0,100),l:t.l,a:t.a}},Al=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},Qh=function(r,e){var t=Ps(r);return{h:t.h,s:t.s,l:Jt(t.l+100*e,0,100),a:t.a}},Fu=function(){function r(e){this.parsed=hw(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return ht(Al(this.rgba),2)},r.prototype.isDark=function(){return Al(this.rgba)<.5},r.prototype.isLight=function(){return Al(this.rgba)>=.5},r.prototype.toHex=function(){return e=Cl(this.rgba),t=e.r,n=e.g,i=e.b,o=(s=e.a)<1?Po(ht(255*s)):"","#"+Po(t)+Po(n)+Po(i)+o;var e,t,n,i,s,o},r.prototype.toRgb=function(){return Cl(this.rgba)},r.prototype.toRgbString=function(){return e=Cl(this.rgba),t=e.r,n=e.g,i=e.b,(s=e.a)<1?"rgba("+t+", "+n+", "+i+", "+s+")":"rgb("+t+", "+n+", "+i+")";var e,t,n,i,s},r.prototype.toHsl=function(){return Kh(Ps(this.rgba))},r.prototype.toHslString=function(){return e=Kh(Ps(this.rgba)),t=e.h,n=e.s,i=e.l,(s=e.a)<1?"hsla("+t+", "+n+"%, "+i+"%, "+s+")":"hsl("+t+", "+n+"%, "+i+"%)";var e,t,n,i,s},r.prototype.toHsv=function(){return e=og(this.rgba),{h:ht(e.h),s:ht(e.s),v:ht(e.v),a:ht(e.a,3)};var e},r.prototype.invert=function(){return Tr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},r.prototype.saturate=function(e){return e===void 0&&(e=.1),Tr(Pl(this.rgba,e))},r.prototype.desaturate=function(e){return e===void 0&&(e=.1),Tr(Pl(this.rgba,-e))},r.prototype.grayscale=function(){return Tr(Pl(this.rgba,-1))},r.prototype.lighten=function(e){return e===void 0&&(e=.1),Tr(Qh(this.rgba,e))},r.prototype.darken=function(e){return e===void 0&&(e=.1),Tr(Qh(this.rgba,-e))},r.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},r.prototype.alpha=function(e){return typeof e=="number"?Tr({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):ht(this.rgba.a,3);var t},r.prototype.hue=function(e){var t=Ps(this.rgba);return typeof e=="number"?Tr({h:e,s:t.s,l:t.l,a:t.a}):ht(t.h)},r.prototype.isEqual=function(e){return this.toHex()===Tr(e).toHex()},r}(),Tr=function(r){return r instanceof Fu?r:new Fu(r)},Jh=[],fw=function(r){r.forEach(function(e){Jh.indexOf(e)<0&&(e(Fu,ku),Jh.push(e))})};function pw(r,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in t)n[t[i]]=i;var s={};r.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,u=n[this.toHex()];if(u)return u;if(o?.closest){var c=this.toRgb(),d=1/0,h="black";if(!s.length)for(var f in t)s[f]=new r(t[f]).toRgb();for(var p in t){var m=(a=c,l=s[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));m<d&&(d=m,h=p)}return h}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":t[a];return l?new r(l).toRgb():null},"name"])}fw([pw]);const Vi=class _s{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof _s)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,t){const n=typeof e;if(n!==typeof t)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((s,o)=>s===t[o]);if(e!==null&&t!==null){const s=Object.keys(e),o=Object.keys(t);return s.length!==o.length?!1:s.every(a=>e[a]===t[a])}return e===t}toRgba(){const[e,t,n,i]=this._components;return{r:e,g:t,b:n,a:i}}toRgb(){const[e,t,n]=this._components;return{r:e,g:t,b:n}}toRgbaString(){const[e,t,n]=this.toUint8RgbArray();return`rgba(${e},${t},${n},${this.alpha})`}toUint8RgbArray(e){const[t,n,i]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e=e||this._arrayRgb,e[0]=Math.round(t*255),e[1]=Math.round(n*255),e[2]=Math.round(i*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e=e||this._arrayRgba;const[t,n,i,s]=this._components;return e[0]=t,e[1]=n,e[2]=i,e[3]=s,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e=e||this._arrayRgb;const[t,n,i]=this._components;return e[0]=t,e[1]=n,e[2]=i,e}toNumber(){return this._int}toBgrNumber(){const[e,t,n]=this.toUint8RgbArray();return(n<<16)+(t<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,n,i,s]=_s._temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=n,this._components[2]*=i,this._components[3]*=s,this._refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let n=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return t&&(n=n*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(n<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let t,n,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;t=(o>>16&255)/255,n=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,n,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,n,i,s=255]=e,t/=255,n/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=_s.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=Tr(e);o.isValid()&&({r:t,g:n,b:i,a:s}=o.rgba,t/=255,n/=255,i/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=n,this._components[2]=i,this._components[3]=s,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,t,n]=this._components;this._int=(e*255<<16)+(t*255<<8)+(n*255|0)}_clamp(e,t=0,n=1){return typeof e=="number"?Math.min(Math.max(e,t),n):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,t),n)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof _s||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};Vi.shared=new Vi;Vi._temp=new Vi;Vi.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let pe=Vi;const mw={cullArea:null,cullable:!1,cullableChildren:!0};class Vc{constructor(e,t){this._pool=[],this._count=0,this._index=0,this._classType=e,t&&this.prepopulate(t)}prepopulate(e){for(let t=0;t<e;t++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let t;return this._index>0?t=this._pool[--this._index]:t=new this._classType,t.init?.(e),t}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class gw{constructor(){this._poolsByClass=new Map}prepopulate(e,t){this.getPool(e).prepopulate(t)}get(e,t){return this.getPool(e).get(t)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new Vc(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(t=>{const n=e[t._classType.name]?t._classType.name+t._classType.ID:t._classType.name;e[n]={free:t.totalFree,used:t.totalUsed,size:t.totalSize}}),e}}const Re=new gw;function lg(r,e,t){const n=r.length;let i;if(e>=n||t===0)return;t=e+t>n?n-e:t;const s=n-t;for(i=e;i<s;++i)r[i]=r[i+t];r.length=s}const vw={allowChildren:!0,removeChildren(r=0,e){const t=e??this.children.length,n=t-r,i=[];if(n>0&&n<=t){for(let o=t-1;o>=r;o--){const a=this.children[o];a&&(i.push(a),a.parent=null)}lg(this.children,r,t);const s=this.renderGroup||this.parentRenderGroup;s&&s.removeChildren(i);for(let o=0;o<i.length;++o)this.emit("childRemoved",i[o],this,o),i[o].emit("removed",this);return i}else if(n===0&&this.children.length===0)return i;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(r){const e=this.getChildAt(r);return this.removeChild(e)},getChildAt(r){if(r<0||r>=this.children.length)throw new Error(`getChildAt: Index (${r}) does not exist.`);return this.children[r]},setChildIndex(r,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(r),this.addChildAt(r,e)},getChildIndex(r){const e=this.children.indexOf(r);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(r,e){this.allowChildren||J(Me,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:t}=this;if(e<0||e>t.length)throw new Error(`${r}addChildAt: The index ${e} supplied is out of bounds ${t.length}`);if(r.parent){const i=r.parent.children.indexOf(r);if(r.parent===this&&i===e)return r;i!==-1&&r.parent.children.splice(i,1)}e===t.length?t.push(r):t.splice(e,0,r),r.parent=this,r.didChange=!0,r._updateFlags=15;const n=this.renderGroup||this.parentRenderGroup;return n&&n.addChild(r),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",r,this,e),r.emit("added",this),r},swapChildren(r,e){if(r===e)return;const t=this.getChildIndex(r),n=this.getChildIndex(e);this.children[t]=e,this.children[n]=r;const i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...r){return r.length===1?this.reparentChildAt(r[0],this.children.length):(r.forEach(e=>this.reparentChildAt(e,this.children.length)),r[0])},reparentChildAt(r,e){if(r.parent===this)return this.setChildIndex(r,e),r;const t=r.worldTransform.clone();r.removeFromParent(),this.addChildAt(r,e);const n=this.worldTransform.clone();return n.invert(),t.prepend(n),r.setFromMatrix(t),r}};class Aa{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class xw{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let t=0;t<this._tests.length;t++){const n=this._tests[t];if(n.test(e))return Re.get(n.maskClass,e)}return e}returnMaskEffect(e){Re.return(e)}}const Iu=new xw;he.handleByList(F.MaskEffect,Iu._effectClasses);const bw={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],addEffect(r){if(this.effects.indexOf(r)!==-1)return;this.effects.push(r),this.effects.sort((n,i)=>n.priority-i.priority);const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0),this._updateIsSimple()},removeEffect(r){const e=this.effects.indexOf(r);e!==-1&&(this.effects.splice(e,1),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateIsSimple())},set mask(r){const e=this._maskEffect;e?.mask!==r&&(e&&(this.removeEffect(e),Iu.returnMaskEffect(e),this._maskEffect=null),r!=null&&(this._maskEffect=Iu.getMaskEffect(r),this.addEffect(this._maskEffect)))},setMask(r){this._maskOptions={...this._maskOptions,...r},r.mask&&(this.mask=r.mask)},get mask(){return this._maskEffect?.mask},set filters(r){!Array.isArray(r)&&r&&(r=[r]);const e=this._filterEffect||(this._filterEffect=new Aa);r=r;const t=r?.length>0,n=e.filters?.length>0,i=t!==n;r=Array.isArray(r)?r.slice(0):r,e.filters=Object.freeze(r),i&&(t?this.addEffect(e):(this.removeEffect(e),e.filters=r??null))},get filters(){return this._filterEffect?.filters},set filterArea(r){this._filterEffect||(this._filterEffect=new Aa),this._filterEffect.filterArea=r},get filterArea(){return this._filterEffect?.filterArea}},_w={label:null,get name(){return J(Me,"Container.name property has been removed, use Container.label instead"),this.label},set name(r){J(Me,"Container.name property has been removed, use Container.label instead"),this.label=r},getChildByName(r,e=!1){return this.getChildByLabel(r,e)},getChildByLabel(r,e=!1){const t=this.children;for(let n=0;n<t.length;n++){const i=t[n];if(i.label===r||r instanceof RegExp&&r.test(i.label))return i}if(e)for(let n=0;n<t.length;n++){const s=t[n].getChildByLabel(r,!0);if(s)return s}return null},getChildrenByLabel(r,e=!1,t=[]){const n=this.children;for(let i=0;i<n.length;i++){const s=n[i];(s.label===r||r instanceof RegExp&&r.test(s.label))&&t.push(s)}if(e)for(let i=0;i<n.length;i++)n[i].getChildrenByLabel(r,!0,t);return t}},Nr=new Vc(ae),Hr=new Vc(Mt);function Wc(r,e,t){t.clear();let n,i;return r.parent?e?n=r.parent.worldTransform:(i=Nr.get().identity(),n=Ea(r,i)):n=ae.IDENTITY,ug(r,t,n,e),i&&Nr.return(i),t.isValid||t.set(0,0,0,0),t}function ug(r,e,t,n){if(!r.visible||!r.measurable)return;let i;n?i=r.worldTransform:(r.updateLocalTransform(),i=Nr.get(),i.appendFrom(r.localTransform,t));const s=e,o=!!r.effects.length;if(o&&(e=Hr.get().clear()),r.boundsArea)e.addRect(r.boundsArea,i);else{r.addBounds&&(e.matrix=i,r.addBounds(e));for(let a=0;a<r.children.length;a++)ug(r.children[a],e,i,n)}if(o){for(let a=0;a<r.effects.length;a++)r.effects[a].addBounds?.(e);s.addBounds(e,ae.IDENTITY),Hr.return(e)}n||Nr.return(i)}function Ea(r,e){const t=r.parent;return t&&(Ea(t,e),t.updateLocalTransform(),e.append(t.localTransform)),e}let El=0;const ef=500;function de(...r){El!==ef&&(El++,El===ef?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...r))}function jc(r,e,t){return e.clear(),t||(t=ae.IDENTITY),cg(r,e,t,r,!0),e.isValid||e.set(0,0,0,0),e}function cg(r,e,t,n,i){let s;if(i)s=Nr.get(),s=t.copyTo(s);else{if(!r.visible||!r.measurable)return;r.updateLocalTransform();const l=r.localTransform;s=Nr.get(),s.appendFrom(l,t)}const o=e,a=!!r.effects.length;if(a&&(e=Hr.get().clear()),r.boundsArea)e.addRect(r.boundsArea,s);else{r.renderPipeId&&(e.matrix=s,r.addBounds(e));const l=r.children;for(let u=0;u<l.length;u++)cg(l[u],e,s,n,!1)}if(a){for(let l=0;l<r.effects.length;l++)r.effects[l].addLocalBounds?.(e,n);o.addBounds(e,ae.IDENTITY),Hr.return(e)}Nr.return(s)}function dg(r,e){const t=r.children;for(let n=0;n<t.length;n++){const i=t[n],s=i.uid,o=(i._didViewChangeTick&65535)<<16|i._didContainerChangeTick&65535,a=e.index;(e.data[a]!==s||e.data[a+1]!==o)&&(e.data[e.index]=s,e.data[e.index+1]=o,e.didChange=!0),e.index=a+2,i.children.length&&dg(i,e)}return e.didChange}const yw=new ae,Sw={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(r,e){const t=Math.sign(this.scale.x)||1;e!==0?this.scale.x=r/e*t:this.scale.x=t},_setHeight(r,e){const t=Math.sign(this.scale.y)||1;e!==0?this.scale.y=r/e*t:this.scale.y=t},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Mt});const r=this._localBoundsCacheData;return r.index=1,r.didChange=!1,r.data[0]!==this._didViewChangeTick&&(r.didChange=!0,r.data[0]=this._didViewChangeTick),dg(this,r),r.didChange&&jc(this,r.localBounds,yw),r.localBounds},getBounds(r,e){return Wc(this,r,e||new Mt)}},ww={_onRender:null,set onRender(r){const e=this.renderGroup||this.parentRenderGroup;if(!r){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=r},get onRender(){return this._onRender}},Tw={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(r){this._zIndex!==r&&(this._zIndex=r,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Cw))}};function Cw(r,e){return r._zIndex-e._zIndex}const Pw={getGlobalPosition(r=new We,e=!1){return this.parent?this.parent.toGlobal(this._position,r,e):(r.x=this._position.x,r.y=this._position.y),r},toGlobal(r,e,t=!1){if(!t){this.updateLocalTransform();const n=Ea(this,new ae);return n.append(this.localTransform),n.apply(r,e)}return this.worldTransform.apply(r,e)},toLocal(r,e,t,n){if(e&&(r=e.toGlobal(r,t,n)),!n){this.updateLocalTransform();const i=Ea(this,new ae);return i.append(this.localTransform),i.applyInverse(r,t)}return this.worldTransform.applyInverse(r,t)}};let Aw=0;class hg{constructor(){this.uid=tt("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.tick=0}reset(){this.instructionSize=0,this.tick=Aw++}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}class Ew{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new ae,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new hg,this._onRenderContainers=[]}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const t=e.children;for(let n=0;n<t.length;n++)this.addChild(t[n])}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const t=this.childrenToUpdate[e];t.list.fill(null),t.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const t=this.renderGroupChildren.indexOf(e);t>-1&&this.renderGroupChildren.splice(t,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const t=e.children;for(let n=0;n<t.length;n++)this.addChild(t[n])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const t=e.children;for(let n=0;n<t.length;n++)this.removeChild(t[n])}removeChildren(e){for(let t=0;t<e.length;t++)this.removeChild(e[t])}onChildUpdate(e){let t=this.childrenToUpdate[e.relativeRenderGroupDepth];t||(t=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),t.list[t.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender()}destroy(){this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const t=this.root.children;for(let n=0;n<t.length;n++)this._getChildren(t[n],e);return e}_getChildren(e,t=[]){if(t.push(e),e.renderGroup)return t;const n=e.children;for(let i=0;i<n.length;i++)this._getChildren(n[i],t);return t}}function Mw(r,e,t={}){for(const n in e)!t[n]&&e[n]!==void 0&&(r[n]=e[n])}const Ml=new yt(null),Rl=new yt(null),kl=new yt(null,1,1),Ma=1,Xc=2,As=4;class fe extends jt{constructor(e={}){super(),this.uid=tt("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new ae,this.relativeGroupTransform=new ae,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new yt(this,0,0),this._scale=kl,this._pivot=Rl,this._skew=Ml,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Mw(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(t=>this.addChild(t)),e.parent?.addChild(this)}static mixin(e){Object.defineProperties(fe.prototype,Object.getOwnPropertyDescriptors(e))}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||J(Me,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let i=0;i<e.length;i++)this.addChild(e[i]);return e[0]}const t=e[0];if(t.parent===this)return this.children.splice(this.children.indexOf(t),1),this.children.push(t),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),t;t.parent&&t.parent.removeChild(t),this.children.push(t),this.sortableChildren&&(this.sortDirty=!0),t.parent=this,t.didChange=!0,t._updateFlags=15;const n=this.renderGroup||this.parentRenderGroup;return n&&n.addChild(t),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this),this._didViewChangeTick++,t._zIndex!==0&&t.depthOfChildModified(),t}removeChild(...e){if(e.length>1){for(let i=0;i<e.length;i++)this.removeChild(e[i]);return e[0]}const t=e[0],n=this.children.indexOf(t);return n>-1&&(this._didViewChangeTick++,this.children.splice(n,1),this.renderGroup?this.renderGroup.removeChild(t):this.parentRenderGroup&&this.parentRenderGroup.removeChild(t),t.parent=null,this.emit("childRemoved",t,this,n),t.emit("removed",this)),t}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=Re.get(Ew,this),this.groupTransform=ae.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),Re.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new ae),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*JS}set angle(e){this.rotation=e*Ni}get pivot(){return this._pivot===Rl&&(this._pivot=new yt(this,0,0)),this._pivot}set pivot(e){this._pivot===Rl&&(this._pivot=new yt(this,0,0)),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===Ml&&(this._skew=new yt(this,0,0)),this._skew}set skew(e){this._skew===Ml&&(this._skew=new yt(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===kl&&(this._scale=new yt(this,1,1)),this._scale}set scale(e){this._scale===kl&&(this._scale=new yt(this,0,0)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const t=this.getLocalBounds().width;this._setWidth(e,t)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const t=this.getLocalBounds().height;this._setHeight(e,t)}getSize(e){e||(e={});const t=this.getLocalBounds();return e.width=Math.abs(this.scale.x*t.width),e.height=Math.abs(this.scale.y*t.height),e}setSize(e,t){const n=this.getLocalBounds();typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,n.width),t!==void 0&&this._setHeight(t,n.height)}_updateSkew(){const e=this._rotation,t=this._skew;this._cx=Math.cos(e+t._y),this._sx=Math.sin(e+t._y),this._cy=-Math.sin(e-t._x),this._sy=Math.cos(e-t._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const t=this.localTransform,n=this._scale,i=this._pivot,s=this._position,o=n._x,a=n._y,l=i._x,u=i._y;t.a=this._cx*o,t.b=this._sx*o,t.c=this._cy*a,t.d=this._sy*a,t.tx=s._x-(l*t.a+u*t.c),t.ty=s._y-(l*t.b+u*t.d)}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=Ma,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const n=pe.shared.setValue(e??16777215).toBgrNumber();n!==this.localColor&&(this.localColor=n,this._updateFlags|=Ma,this._onUpdate())}get tint(){const e=this.localColor;return((e&255)<<16)+(e&65280)+(e>>16&255)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Xc,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const t=e?2:0;(this.localDisplayStatus&2)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=As,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const t=e?0:4;(this.localDisplayStatus&4)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=As,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const t=e?1:0;(this.localDisplayStatus&1)!==t&&(this._updateFlags|=As,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;const t=this.removeChildren(0,this.children.length);if(this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.children)for(let i=0;i<t.length;++i)t[i].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}fe.mixin(vw);fe.mixin(Pw);fe.mixin(ww);fe.mixin(Sw);fe.mixin(bw);fe.mixin(_w);fe.mixin(Tw);fe.mixin(mw);class qc extends fe{constructor(){super(...arguments),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=0,this._lastInstructionTick=-1,this._bounds=new Mt(0,1,0,0),this._boundsDirty=!0}_updateBounds(){}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const t=this.bounds,{x:n,y:i}=e;return n>=t.minX&&n<=t.maxX&&i>=t.minY&&i<=t.maxY}onViewUpdate(){if(this._didViewChangeTick++,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null}}class Ke extends qc{constructor(e=te.EMPTY){e instanceof te&&(e={texture:e});const{texture:t=te.EMPTY,anchor:n,roundPixels:i,width:s,height:o,...a}=e;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._sourceBounds={minX:0,maxX:1,minY:0,maxY:0},this._sourceBoundsDirty=!0,this._anchor=new yt({_onUpdate:()=>{this.onViewUpdate()}}),n?this.anchor=n:t.defaultAnchor&&(this.anchor=t.defaultAnchor),this.texture=t,this.allowChildren=!1,this.roundPixels=i??!1,s!==void 0&&(this.width=s),o!==void 0&&(this.height=o)}static from(e,t=!1){return e instanceof te?new Ke(e):new Ke(te.from(e,t))}set texture(e){e||(e=te.EMPTY);const t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get sourceBounds(){return this._sourceBoundsDirty&&(this._updateSourceBounds(),this._sourceBoundsDirty=!1),this._sourceBounds}containsPoint(e){const t=this.sourceBounds;return e.x>=t.maxX&&e.x<=t.minX&&e.y>=t.maxY&&e.y<=t.minY}addBounds(e){const t=this._texture.trim?this.sourceBounds:this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}onViewUpdate(){this._sourceBoundsDirty=this._boundsDirty=!0,super.onViewUpdate()}_updateBounds(){Pa(this._bounds,this._anchor,this._texture,0)}_updateSourceBounds(){const e=this._anchor,t=this._texture,n=this._sourceBounds,{width:i,height:s}=t.orig;n.maxX=-e._x*i,n.minX=n.maxX+i,n.maxY=-e._y*s,n.minY=n.maxY+s}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(n)}this._texture=null,this._bounds=null,this._sourceBounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),t!==void 0&&this._setHeight(t,this._texture.orig.height)}}const Rw=new Mt;function fg(r,e,t){const n=Rw;r.measurable=!0,Wc(r,t,n),e.addBoundsMask(n),r.measurable=!1}function pg(r,e,t){const n=Hr.get();r.measurable=!0;const i=Nr.get().identity(),s=mg(r,t,i);jc(r,n,s),r.measurable=!1,e.addBoundsMask(n),Nr.return(i),Hr.return(n)}function mg(r,e,t){return r?(r!==e&&(mg(r.parent,e,t),r.updateLocalTransform(),t.append(r.localTransform)),t):(de("Mask bounds, renderable is not inside the root container"),t)}class gg{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Ke),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(e,t){this.inverse||fg(this.mask,e,t)}addLocalBounds(e,t){pg(this.mask,e,t)}containsPoint(e,t){const n=this.mask;return t(n,e)}destroy(){this.reset()}static test(e){return e instanceof Ke}}gg.extension=F.MaskEffect;class vg{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}vg.extension=F.MaskEffect;class xg{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(e,t){fg(this.mask,e,t)}addLocalBounds(e,t){pg(this.mask,e,t)}containsPoint(e,t){const n=this.mask;return t(n,e)}destroy(){this.reset()}static test(e){return e instanceof fe}}xg.extension=F.MaskEffect;const kw={createCanvas:(r,e)=>{const t=document.createElement("canvas");return t.width=r,t.height=e,t},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,e)=>fetch(r,e),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")};let tf=kw;const Ee={get(){return tf},set(r){tf=r}};class Xn extends lt{constructor(e){e.resource||(e.resource=Ee.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity;const t=e.resource;(this.pixelWidth!==t.width||this.pixelWidth!==t.height)&&this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,t=this.height,n=this._resolution){const i=super.resize(e,t,n);return i&&this.resizeCanvas(),i}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}Xn.extension=F.TextureSource;class ei extends lt{constructor(e){if(e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){const t=Ee.get().createCanvas(e.resource.width,e.resource.height);t.getContext("2d").drawImage(e.resource,0,0,e.resource.width,e.resource.height),e.resource=t,de("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}ei.extension=F.TextureSource;var Ls=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(Ls||{});class Fl{constructor(e,t=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=t,this.priority=n,this._once=i}match(e,t=null){return this._fn===e&&this._context===t}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const t=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const bg=class It{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Fl(null,null,1/0),this.deltaMS=1/It.targetFPMS,this.elapsedMS=1/It.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,n=Ls.NORMAL){return this._addListener(new Fl(e,t,n))}addOnce(e,t,n=Ls.NORMAL){return this._addListener(new Fl(e,t,n,!0))}_addListener(e){let t=this._head.next,n=this._head;if(!t)e.connect(n);else{for(;t;){if(e.priority>t.priority){e.connect(n);break}n=t,t=t.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,t){let n=this._head.next;for(;n;)n.match(e,t)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*It.targetFPMS;const n=this._head;let i=n.next;for(;i;)i=i.emit(this);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,t)/1e3,It.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!It._shared){const e=It._shared=new It;e.autoStart=!0,e._protected=!0}return It._shared}static get system(){if(!It._system){const e=It._system=new It;e.autoStart=!0,e._protected=!0}return It._system}};bg.targetFPMS=.06;let Er=bg,Il;async function _g(){return Il??(Il=(async()=>{const e=document.createElement("canvas").getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const t=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!t)return"premultiply-alpha-on-upload";const n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);const s=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,s),e.deleteFramebuffer(i),e.deleteTexture(n),e.getExtension("WEBGL_lose_context")?.loseContext(),s[0]<=s[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Il}const rl=class yg extends lt{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...yg.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=Er.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,t=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(t.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await _g(),this._load=new Promise((n,i)=>{this.isValid?n(this):(this._resolve=n,this._reject=i,t.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${t.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Er.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Er.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Er.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};rl.extension=F.TextureSource;rl.defaultOptions={...lt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};rl.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let qo=rl;const fr=(r,e,t=!1)=>(Array.isArray(r)||(r=[r]),e?r.map(n=>typeof n=="string"||t?e(n):n):r);class Fw{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||de(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const n=fr(e);let i;for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];if(u.test(t)){i=u.getCacheableAssets(n,t);break}}const s=new Map(Object.entries(i||{}));i||n.forEach(l=>{s.set(l,t)});const o=[...s.keys()],a={cacheKeys:o,keys:n};n.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{const u=i?i[l]:t;this._cache.has(l)&&this._cache.get(l)!==u&&de("[Cache] already has key:",l),this._cache.set(l,s.get(l))})}remove(e){if(!this._cacheMap.has(e)){de(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(i=>{this._cache.delete(i)}),t.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const Xe=new Fw,Bu=[];he.handleByList(F.TextureSource,Bu);function Sg(r={}){const e=r&&r.resource,t=e?r.resource:r,n=e?r:{resource:r};for(let i=0;i<Bu.length;i++){const s=Bu[i];if(s.test(t))return new s(n)}throw new Error(`Could not find a source type for resource: ${n.resource}`)}function Iw(r={},e=!1){const t=r&&r.resource,n=t?r.resource:r,i=t?r:{resource:r};if(!e&&Xe.has(n))return Xe.get(n);const s=new te({source:Sg(i)});return s.on("destroy",()=>{Xe.has(n)&&Xe.remove(n)}),e||Xe.set(n,s),s}function Bw(r,e=!1){return typeof r=="string"?Xe.get(r):r instanceof lt?new te({source:r}):Iw(r,e)}te.from=Bw;lt.from=Sg;he.add(gg,vg,xg,qo,ei,Xn,Hc);var gn=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(gn||{});function ur(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function ds(r){return r.split("?")[0].split("#")[0]}function Ow(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Uw(r,e,t){return r.replace(new RegExp(Ow(e),"g"),t)}function Dw(r,e){let t="",n=0,i=-1,s=0,o=-1;for(let a=0;a<=r.length;++a){if(a<r.length)o=r.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(t.length<2||n!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",n=0):(t=t.slice(0,l),n=t.length-1-t.lastIndexOf("/")),i=a,s=0;continue}}else if(t.length===2||t.length===1){t="",n=0,i=a,s=0;continue}}}else t.length>0?t+=`/${r.slice(i+1,a)}`:t=r.slice(i+1,a),n=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return t}const Nt={toPosix(r){return Uw(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){ur(r),r=this.toPosix(r);const e=/^file:\/\/\//.exec(r);if(e)return e[0];const t=/^[^/:]+:\/{0,2}/.exec(r);return t?t[0]:""},toAbsolute(r,e,t){if(ur(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;const n=ds(this.toPosix(e??Ee.get().getBaseUrl())),i=ds(this.toPosix(t??this.rootname(n)));return r=this.toPosix(r),r.startsWith("/")?Nt.join(i,r.slice(1)):this.isAbsolute(r)?r:this.join(n,r)},normalize(r){if(ur(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let e="";const t=r.startsWith("/");this.hasProtocol(r)&&(e=this.rootname(r),r=r.slice(e.length));const n=r.endsWith("/");return r=Dw(r),r.length>0&&n&&(r+="/"),t?`/${r}`:e+r},isAbsolute(r){return ur(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){const n=r[t];if(ur(n),n.length>0)if(e===void 0)e=n;else{const i=r[t-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(r){if(ur(r),r.length===0)return".";r=this.toPosix(r);let e=r.charCodeAt(0);const t=e===47;let n=-1,i=!0;const s=this.getProtocol(r),o=r;r=r.slice(s.length);for(let a=r.length-1;a>=1;--a)if(e=r.charCodeAt(a),e===47){if(!i){n=a;break}}else i=!1;return n===-1?t?"/":this.isUrl(o)?s+r:s:t&&n===1?"//":s+r.slice(0,n)},rootname(r){ur(r),r=this.toPosix(r);let e="";if(r.startsWith("/")?e="/":e=this.getProtocol(r),this.isUrl(r)){const t=r.indexOf("/",e.length);t!==-1?e=r.slice(0,t):e=r,e.endsWith("/")||(e+="/")}return e},basename(r,e){ur(r),e&&ur(e),r=ds(this.toPosix(r));let t=0,n=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e.length===r.length&&e===r)return"";let o=e.length-1,a=-1;for(s=r.length-1;s>=0;--s){const l=r.charCodeAt(s);if(l===47){if(!i){t=s+1;break}}else a===-1&&(i=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(n=s):(o=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(s=r.length-1;s>=0;--s)if(r.charCodeAt(s)===47){if(!i){t=s+1;break}}else n===-1&&(i=!1,n=s+1);return n===-1?"":r.slice(t,n)},extname(r){ur(r),r=ds(this.toPosix(r));let e=-1,t=0,n=-1,i=!0,s=0;for(let o=r.length-1;o>=0;--o){const a=r.charCodeAt(o);if(a===47){if(!i){t=o+1;break}continue}n===-1&&(i=!1,n=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===t+1?"":r.slice(e,n)},parse(r){ur(r);const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;r=ds(this.toPosix(r));let t=r.charCodeAt(0);const n=this.isAbsolute(r);let i;e.root=this.rootname(r),n||this.hasProtocol(r)?i=1:i=0;let s=-1,o=0,a=-1,l=!0,u=r.length-1,c=0;for(;u>=i;--u){if(t=r.charCodeAt(u),t===47){if(!l){o=u+1;break}continue}a===-1&&(l=!1,a=u+1),t===46?s===-1?s=u:c!==1&&(c=1):s!==-1&&(c=-1)}return s===-1||a===-1||c===0||c===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&n?e.base=e.name=r.slice(1,a):e.base=e.name=r.slice(o,a)):(o===0&&n?(e.name=r.slice(1,s),e.base=r.slice(1,a)):(e.name=r.slice(o,s),e.base=r.slice(o,a)),e.ext=r.slice(s,a)),e.dir=this.dirname(r),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function wg(r,e,t,n,i){const s=e[t];for(let o=0;o<s.length;o++){const a=s[o];t<e.length-1?wg(r.replace(n[t],a),e,t+1,n,i):i.push(r.replace(n[t],a))}}function Gw(r){const e=/\{(.*?)\}/g,t=r.match(e),n=[];if(t){const i=[];t.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),wg(r,i,0,t,n)}else n.push(r);return n}const Ra=r=>!Array.isArray(r);class is{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(t[n])}`).join("&")}}getAlias(e){const{alias:t,src:n}=e;return fr(t||n,s=>typeof s=="string"?s:Array.isArray(s)?s.map(o=>o?.src??o):s?.src?s.src:s,!0)}addManifest(e){this._manifest&&de("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const n=[];let i=t;Array.isArray(t)||(i=Object.entries(t).map(([s,o])=>typeof o=="string"||Array.isArray(o)?{alias:s,src:o}:{alias:s,...o})),i.forEach(s=>{const o=s.src,a=s.alias;let l;if(typeof a=="string"){const u=this._createBundleAssetId(e,a);n.push(u),l=[a,u]}else{const u=a.map(c=>this._createBundleAssetId(e,c));n.push(...u),l=[...a,...u]}this.add({...s,alias:l,src:o})}),this._bundles[e]=n}add(e){const t=[];Array.isArray(e)?t.push(...e):t.push(e);let n;n=s=>{this.hasKey(s)&&de(`[Resolver] already has key: ${s} overwriting`)},fr(t).forEach(s=>{const{src:o}=s;let{data:a,format:l,loadParser:u}=s;const c=fr(o).map(f=>typeof f=="string"?Gw(f):Array.isArray(f)?f:[f]),d=this.getAlias(s);Array.isArray(d)?d.forEach(n):n(d);const h=[];c.forEach(f=>{f.forEach(p=>{let m={};if(typeof p!="object"){m.src=p;for(let g=0;g<this._parsers.length;g++){const v=this._parsers[g];if(v.test(p)){m=v.parse(p);break}}}else a=p.data??a,l=p.format??l,u=p.loadParser??u,m={...m,...p};if(!d)throw new Error(`[Resolver] alias is undefined for this asset: ${m.src}`);m=this._buildResolvedAsset(m,{aliases:d,data:a,format:l,loadParser:u}),h.push(m)})}),d.forEach(f=>{this._assetMap[f]=h})})}resolveBundle(e){const t=Ra(e);e=fr(e);const n={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const l in o){const u=o[l];a[this._extractAssetIdFromBundle(i,l)]=u}n[i]=a}}),t?n[e[0]]:n}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const n={};for(const i in t)n[i]=t[i].src;return n}return t.src}resolve(e){const t=Ra(e);e=fr(e);const n={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=this._getPreferredOrder(s);o?.priority.forEach(a=>{o.params[a].forEach(l=>{const u=s.filter(c=>c[a]?c[a]===l:!1);u.length&&(s=u)})}),this._resolverHash[i]=s[0]}else this._resolverHash[i]=this._buildResolvedAsset({alias:[i],src:i},{});n[i]=this._resolverHash[i]}),t?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const n=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}_buildResolvedAsset(e,t){const{aliases:n,data:i,loadParser:s,format:o}=t;return(this._basePath||this._rootPath)&&(e.src=Nt.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??zw(e.src),e}}is.RETINA_PREFIX=/@([0-9\.]+)x/;function zw(r){return r.split(".").pop().split("?").shift().split("#").shift()}const Ou=(r,e)=>{const t=e.split("?")[1];return t&&(r+=`?${t}`),r},Tg=class ys{constructor(e,t){this.linkedSheets=[],this._texture=e instanceof te?e:null,this.textureSource=e.source,this.textures={},this.animations={},this.data=t;const n=parseFloat(t.meta.scale);n?(this.resolution=n,e.source.resolution=this.resolution):this.resolution=e.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=ys.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const n=ys.BATCH_SIZE;for(;t-e<n&&t<this._frameKeys.length;){const i=this._frameKeys[t],s=this._frames[i],o=s.frame;if(o){let a=null,l=null;const u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,c=new Le(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new Le(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Le(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new Le(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new te({source:this.textureSource,frame:a,orig:c,trim:l,rotate:s.rotated?2:0,defaultAnchor:s.anchor,defaultBorders:s.borders,label:i.toString()})}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let n=0;n<e[t].length;n++){const i=e[t][n];this.animations[t].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ys.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ys.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Tg.BATCH_SIZE=1e3;let rf=Tg;const Lw=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Cg(r,e,t){const n={};if(r.forEach(i=>{n[i]=e}),Object.keys(e.textures).forEach(i=>{n[i]=e.textures[i]}),!t){const i=Nt.dirname(r[0]);e.linkedSheets.forEach((s,o)=>{const a=Cg([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0);Object.assign(n,a)})}return n}const Nw={extension:F.Asset,cache:{test:r=>r instanceof rf,getCacheableAssets:(r,e)=>Cg(r,e,!1)},resolver:{extension:{type:F.ResolveParser,name:"resolveSpritesheet"},test:r=>{const t=r.split("?")[0].split("."),n=t.pop(),i=t.pop();return n==="json"&&Lw.includes(i)},parse:r=>{const e=r.split(".");return{resolution:parseFloat(is.RETINA_PREFIX.exec(r)?.[1]??"1"),format:e[e.length-2],src:r}}},loader:{name:"spritesheetLoader",extension:{type:F.LoadParser,priority:gn.Normal,name:"spritesheetLoader"},async testParse(r,e){return Nt.extname(e.src).toLowerCase()===".json"&&!!r.frames},async parse(r,e,t){const{texture:n,imageFilename:i}=e?.data??{};let s=Nt.dirname(e.src);s&&s.lastIndexOf("/")!==s.length-1&&(s+="/");let o;if(n instanceof te)o=n;else{const u=Ou(s+(i??r.meta.image),e.src);o=(await t.load([u]))[u]}const a=new rf(o.source,r);await a.parse();const l=r?.meta?.related_multi_packs;if(Array.isArray(l)){const u=[];for(const d of l){if(typeof d!="string")continue;let h=s+d;e.data?.ignoreMultiPack||(h=Ou(h,e.src),u.push(t.load({src:h,data:{ignoreMultiPack:!0}})))}const c=await Promise.all(u);a.linkedSheets=c,c.forEach(d=>{d.linkedSheets=[a].concat(a.linkedSheets.filter(h=>h!==d))})}return a},async unload(r,e,t){await t.unload(r.textureSource._sourceOrigin),r.destroy(!1)}}};he.add(Nw);class so{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=so.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new We,this.page=new We,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,n,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}var Bl=/iPhone/i,nf=/iPod/i,sf=/iPad/i,of=/\biOS-universal(?:.+)Mac\b/i,Ol=/\bAndroid(?:.+)Mobile\b/i,af=/Android/i,ci=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Ao=/Silk/i,Ur=/Windows Phone/i,lf=/\bWindows(?:.+)ARM\b/i,uf=/BlackBerry/i,cf=/BB10/i,df=/Opera Mini/i,hf=/\b(CriOS|Chrome)(?:.+)Mobile/i,ff=/Mobile(?:.+)Firefox\b/i,pf=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function Hw(r){return function(e){return e.test(r)}}function mf(r){var e={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?e.userAgent=r:r&&r.userAgent&&(e={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var t=e.userAgent,n=t.split("[FBAN");typeof n[1]<"u"&&(t=n[0]),n=t.split("Twitter"),typeof n[1]<"u"&&(t=n[0]);var i=Hw(t),s={apple:{phone:i(Bl)&&!i(Ur),ipod:i(nf),tablet:!i(Bl)&&(i(sf)||pf(e))&&!i(Ur),universal:i(of),device:(i(Bl)||i(nf)||i(sf)||i(of)||pf(e))&&!i(Ur)},amazon:{phone:i(ci),tablet:!i(ci)&&i(Ao),device:i(ci)||i(Ao)},android:{phone:!i(Ur)&&i(ci)||!i(Ur)&&i(Ol),tablet:!i(Ur)&&!i(ci)&&!i(Ol)&&(i(Ao)||i(af)),device:!i(Ur)&&(i(ci)||i(Ao)||i(Ol)||i(af))||i(/\bokhttp\b/i)},windows:{phone:i(Ur),tablet:i(lf),device:i(Ur)||i(lf)},other:{blackberry:i(uf),blackberry10:i(cf),opera:i(df),firefox:i(ff),chrome:i(hf),device:i(uf)||i(cf)||i(df)||i(ff)||i(hf)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const Vw=mf.default??mf,Ww=Vw(globalThis.navigator),jw=9,Eo=100,Xw=0,qw=0,gf=2,vf=1,Yw=-1e3,Kw=-1e3,$w=2;class Pg{constructor(e,t=Ww){this._mobileInfo=t,this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this._pool=[],this._renderId=0,this._children=[],this._androidUpdateCount=0,this._androidUpdateFrequency=500,this._hookDiv=null,(t.tablet||t.phone)&&this._createTouchHook();const n=document.createElement("div");n.style.width=`${Eo}px`,n.style.height=`${Eo}px`,n.style.position="absolute",n.style.top=`${Xw}px`,n.style.left=`${qw}px`,n.style.zIndex=gf.toString(),this._div=n,this._renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}get hookDiv(){return this._hookDiv}_createTouchHook(){const e=document.createElement("button");e.style.width=`${vf}px`,e.style.height=`${vf}px`,e.style.position="absolute",e.style.top=`${Yw}px`,e.style.left=`${Kw}px`,e.style.zIndex=$w.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this._activate(),this._destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}_destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}_activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this._renderer.runners.postrender.add(this),this._renderer.view.canvas.parentNode?.appendChild(this._div))}_deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this._renderer.runners.postrender.remove(this),this._div.parentNode?.removeChild(this._div))}_updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this._addChild(e),e._renderId=this._renderId);const t=e.children;if(t)for(let n=0;n<t.length;n++)this._updateAccessibleObjects(t[n])}init(e){this.debug=e?.debug??this.debug,this._renderer.runners.postrender.remove(this)}postrender(){const e=performance.now();if(this._mobileInfo.android.device&&e<this._androidUpdateCount||(this._androidUpdateCount=e+this._androidUpdateFrequency,!this._renderer.renderingToScreen||!this._renderer.view.canvas))return;this._renderer.lastObjectRendered&&this._updateAccessibleObjects(this._renderer.lastObjectRendered);const{x:t,y:n,width:i,height:s}=this._renderer.view.canvas.getBoundingClientRect(),{width:o,height:a,resolution:l}=this._renderer,u=i/o*l,c=s/a*l;let d=this._div;d.style.left=`${t}px`,d.style.top=`${n}px`,d.style.width=`${o}px`,d.style.height=`${a}px`;for(let h=0;h<this._children.length;h++){const f=this._children[h];if(f._renderId!==this._renderId)f._accessibleActive=!1,lg(this._children,h,1),this._div.removeChild(f._accessibleDiv),this._pool.push(f._accessibleDiv),f._accessibleDiv=null,h--;else{d=f._accessibleDiv;let p=f.hitArea;const m=f.worldTransform;f.hitArea?(d.style.left=`${(m.tx+p.x*m.a)*u}px`,d.style.top=`${(m.ty+p.y*m.d)*c}px`,d.style.width=`${p.width*m.a*u}px`,d.style.height=`${p.height*m.d*c}px`):(p=f.getBounds().rectangle,this._capHitArea(p),d.style.left=`${p.x*u}px`,d.style.top=`${p.y*c}px`,d.style.width=`${p.width*u}px`,d.style.height=`${p.height*c}px`,d.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(d.title=f.accessibleTitle||""),d.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&d.setAttribute("aria-label",f.accessibleHint||"")),(f.accessibleTitle!==d.title||f.tabIndex!==d.tabIndex)&&(d.title=f.accessibleTitle||"",d.tabIndex=f.tabIndex,this.debug&&this._updateDebugHTML(d))}}this._renderId++}_updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}_capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:t,height:n}=this._renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>n&&(e.height=n-e.y)}_addChild(e){let t=this._pool.pop();t||(t=document.createElement("button"),t.style.width=`${Eo}px`,t.style.height=`${Eo}px`,t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=gf.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title=`container ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this._updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.container=e,this._children.push(e),this._div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){const{container:n}=e.target,i=this._renderer.events.rootBoundary,s=Object.assign(new so(i),{target:n});i.rootTarget=this._renderer.lastObjectRendered,t.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===jw&&this._activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this._deactivate()}destroy(){this._destroyTouchHook(),this._div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this._pool=null,this._children=null,this._renderer=null}}Pg.extension={type:[F.WebGLSystem,F.WebGPUSystem],name:"accessibility"};const Zw={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,_renderId:-1},Ul=Object.create(null),xf=Object.create(null);function Ns(r,e){let t=xf[r];return t===void 0&&(Ul[e]===void 0&&(Ul[e]=1),xf[r]=t=Ul[e]++),t}let Mo;function Ag(){return(!Mo||Mo?.isContextLost())&&(Mo=Ee.get().createCanvas().getContext("webgl",{})),Mo}let Ro;function Qw(){if(!Ro){Ro="mediump";const r=Ag();r&&r.getShaderPrecisionFormat&&(Ro=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision?"highp":"mediump")}return Ro}function Jw(r,e,t){return e?r:t?(r=r.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${r}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${r}
        `}function eT(r,e,t){const n=t?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(r.substring(0,9)!=="precision"){let i=t?e.requestedFragmentPrecision:e.requestedVertexPrecision;return i==="highp"&&n!=="highp"&&(i="mediump"),`precision ${i} float;
${r}`}else if(n!=="highp"&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}function tT(r,e){return e?`#version 300 es
${r}`:r}const rT={},nT={};function iT(r,{name:e="pixi-program"},t=!0){e=e.replace(/\s+/g,"-"),e+=t?"-fragment":"-vertex";const n=t?rT:nT;return n[e]?(n[e]++,e+=`-${n[e]}`):n[e]=1,r.indexOf("#define SHADER_NAME")!==-1?r:`${`#define SHADER_NAME ${e}`}
${r}`}function sT(r,e){return e?r.replace("#version 300 es",""):r}const Dl={stripVersion:sT,ensurePrecision:eT,addProgramDefines:Jw,setProgramName:iT,insertVersion:tT},Gl=Object.create(null),Eg=class Uu{constructor(e){e={...Uu.defaultOptions,...e};const t=e.fragment.indexOf("#version 300 es")!==-1,n={stripVersion:t,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:Qw()},setProgramName:{name:e.name},addProgramDefines:t,insertVersion:t};let i=e.fragment,s=e.vertex;Object.keys(Dl).forEach(o=>{const a=n[o];i=Dl[o](i,a,!0),s=Dl[o](s,a,!1)}),this.fragment=i,this.vertex=s,this._key=Ns(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(e){const t=`${e.vertex}:${e.fragment}`;return Gl[t]||(Gl[t]=new Uu(e)),Gl[t]}};Eg.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let be=Eg;const bf={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function hn(r){return bf[r]??bf.float32}const oT={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function aT({source:r,entryPoint:e}){const t={},n=r.indexOf(`fn ${e}`);if(n!==-1){const i=r.indexOf("->",n);if(i!==-1){const s=r.substring(n,i),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(s))!==null;){const l=oT[a[3]]??"float32";t[a[2]]={location:parseInt(a[1],10),format:l,stride:hn(l).stride,offset:0,instance:!1,start:0}}}}return t}function zl(r){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,t=/@group\((\d+)\)/,n=/@binding\((\d+)\)/,i=/var(<[^>]+>)? (\w+)/,s=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,u=r.match(e)?.map(d=>({group:parseInt(d.match(t)[1],10),binding:parseInt(d.match(n)[1],10),name:d.match(i)[2],isUniform:d.match(i)[1]==="<uniform>",type:d.match(s)[1]}));if(!u)return{groups:[],structs:[]};const c=r.match(o)?.map(d=>{const h=d.match(l)[1],f=d.match(a).reduce((p,m)=>{const[g,v]=m.split(":");return p[g.trim()]=v.trim(),p},{});return f?{name:h,members:f}:null}).filter(({name:d})=>u.some(h=>h.type===d))??[];return{groups:u,structs:c}}var Ss=(r=>(r[r.VERTEX=1]="VERTEX",r[r.FRAGMENT=2]="FRAGMENT",r[r.COMPUTE=4]="COMPUTE",r))(Ss||{});function lT({groups:r}){const e=[];for(let t=0;t<r.length;t++){const n=r[t];e[n.group]||(e[n.group]=[]),n.isUniform?e[n.group].push({binding:n.binding,visibility:Ss.VERTEX|Ss.FRAGMENT,buffer:{type:"uniform"}}):n.type==="sampler"?e[n.group].push({binding:n.binding,visibility:Ss.FRAGMENT,sampler:{type:"filtering"}}):n.type==="texture_2d"&&e[n.group].push({binding:n.binding,visibility:Ss.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function uT({groups:r}){const e=[];for(let t=0;t<r.length;t++){const n=r[t];e[n.group]||(e[n.group]={}),e[n.group][n.name]=n.binding}return e}function cT(r,e){const t=new Set,n=new Set,i=[...r.structs,...e.structs].filter(o=>t.has(o.name)?!1:(t.add(o.name),!0)),s=[...r.groups,...e.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return n.has(a)?!1:(n.add(a),!0)});return{structs:i,groups:s}}const Ll=Object.create(null);class me{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:t,vertex:n,layout:i,gpuLayout:s,name:o}=e;if(this.name=o,this.fragment=t,this.vertex=n,t.source===n.source){const a=zl(t.source);this.structsAndGroups=a}else{const a=zl(n.source),l=zl(t.source);this.structsAndGroups=cT(a,l)}this.layout=i??uT(this.structsAndGroups),this.gpuLayout=s??lT(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:t}=this,n=e.source+t.source+e.entryPoint+t.entryPoint;this._layoutKey=Ns(n,"program")}get attributeData(){return this._attributeData??(this._attributeData=aT(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(e){const t=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return Ll[t]||(Ll[t]=new me(e)),Ll[t]}}const Mg=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>"],dT=Mg.reduce((r,e)=>(r[e]=!0,r),{});function hT(r,e){switch(r){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Rg=class kg{constructor(e,t){this._touched=0,this.uid=tt("uniform"),this._resourceType="uniformGroup",this._resourceId=tt("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,t={...kg.defaultOptions,...t},this.uniformStructures=e;const n={};for(const i in e){const s=e[i];if(s.name=i,s.size=s.size??1,!dT[s.type])throw new Error(`Uniform type ${s.type} is not supported. Supported uniform types are: ${Mg.join(", ")}`);s.value??(s.value=hT(s.type,s.size)),n[i]=s.value}this.uniforms=n,this._dirtyId=1,this.ubo=t.ubo,this.isStatic=t.isStatic,this._signature=Ns(Object.keys(n).map(i=>`${i}-${e[i].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Rg.defaultOptions={ubo:!1,isStatic:!1};let _t=Rg;class Vr{constructor(e){this.resources=Object.create(null),this._dirty=!0;let t=0;for(const n in e){const i=e[n];this.setResource(i,t++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let t=0;for(const n in this.resources)e[t++]=this.resources[n]._resourceId;this._key=e.join("|")}setResource(e,t){const n=this.resources[t];e!==n&&(n&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[t]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const t=this.resources;for(const n in t)t[n]._touched=e}destroy(){const e=this.resources;for(const t in e)e[t].off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const t=this.resources;for(const n in t)t[n]===e&&(t[n]=null)}else this._updateKey()}}var Wt=(r=>(r[r.WEBGL=1]="WEBGL",r[r.WEBGPU=2]="WEBGPU",r[r.BOTH=3]="BOTH",r))(Wt||{});class sr extends jt{constructor(e){super(),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:t,glProgram:n,groups:i,resources:s,compatibleRenderers:o,groupMap:a}=e;this.gpuProgram=t,this.glProgram=n,o===void 0&&(o=0,t&&(o|=Wt.WEBGPU),n&&(o|=Wt.WEBGL)),this.compatibleRenderers=o;const l={};if(!s&&!i&&(s={}),s&&i)throw new Error("[Shader] Cannot have both resources and groups");if(!t&&i&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!t&&i&&a)for(const u in a)for(const c in a[u]){const d=a[u][c];l[d]={group:u,binding:c,name:d}}else if(t&&i&&!a){const u=t.structsAndGroups.groups;a={},u.forEach(c=>{a[c.group]=a[c.group]||{},a[c.group][c.binding]=c.name,l[c.name]=c})}else if(s){i={},a={},t&&t.structsAndGroups.groups.forEach(d=>{a[d.group]=a[d.group]||{},a[d.group][d.binding]=d.name,l[d.name]=d});let u=0;for(const c in s)l[c]||(i[99]||(i[99]=new Vr,this._ownedBindGroups.push(i[99])),l[c]={group:99,binding:u,name:c},a[99]=a[99]||{},a[99][u]=c,u++);for(const c in s){const d=c;let h=s[c];!h.source&&!h._resourceType&&(h=new _t(h));const f=l[d];f&&(i[f.group]||(i[f.group]=new Vr,this._ownedBindGroups.push(i[f.group])),i[f.group].setResource(h,f.binding))}}this.groups=i,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(i,l)}addResource(e,t,n){var i,s;(i=this._uniformBindMap)[t]||(i[t]={}),(s=this._uniformBindMap[t])[n]||(s[n]=e),this.groups[t]||(this.groups[t]=new Vr,this._ownedBindGroups.push(this.groups[t]))}_buildResourceAccessor(e,t){const n={};for(const i in t){const s=t[i];Object.defineProperty(n,s.name,{get(){return e[s.group].getResource(s.binding)},set(o){e[s.group].setResource(o,s.binding)}})}return n}destroy(e=!1){this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(t=>{t.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(e){const{gpu:t,gl:n,...i}=e;let s,o;return t&&(s=me.from(t)),n&&(o=be.from(n)),new sr({gpuProgram:s,glProgram:o,...i})}}const fT={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},Nl=0,Hl=1,Vl=2,Wl=3,jl=4,Xl=5,Du=class Fg{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Nl)}set blend(e){!!(this.data&1<<Nl)!==e&&(this.data^=1<<Nl)}get offsets(){return!!(this.data&1<<Hl)}set offsets(e){!!(this.data&1<<Hl)!==e&&(this.data^=1<<Hl)}set cullMode(e){if(e==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=e==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<Vl)}set culling(e){!!(this.data&1<<Vl)!==e&&(this.data^=1<<Vl)}get depthTest(){return!!(this.data&1<<Wl)}set depthTest(e){!!(this.data&1<<Wl)!==e&&(this.data^=1<<Wl)}get depthMask(){return!!(this.data&1<<Xl)}set depthMask(e){!!(this.data&1<<Xl)!==e&&(this.data^=1<<Xl)}get clockwiseFrontFace(){return!!(this.data&1<<jl)}set clockwiseFrontFace(e){!!(this.data&1<<jl)!==e&&(this.data^=1<<jl)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!=="none",this._blendMode=e,this._blendModeId=fT[e]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new Fg;return e.depthTest=!1,e.blend=!0,e}};Du.default2d=Du.for2d();let vr=Du;const Ig=class Gu extends sr{constructor(e){e={...Gu.defaultOptions,...e},super(e),this.enabled=!0,this._state=vr.for2d(),this.blendMode=e.blendMode,this.padding=e.padding,typeof e.antialias=="boolean"?this.antialias=e.antialias?"on":"off":this.antialias=e.antialias,this.resolution=e.resolution,this.blendRequired=e.blendRequired,this.clipToViewport=e.clipToViewport,this.addResource("uTexture",0,1)}apply(e,t,n,i){e.applyFilter(this,t,n,i)}get blendMode(){return this._state.blendMode}set blendMode(e){this._state.blendMode=e}static from(e){const{gpu:t,gl:n,...i}=e;let s,o;return t&&(s=me.from(t)),n&&(o=be.from(n)),new Gu({gpuProgram:s,glProgram:o,...i})}};Ig.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let _e=Ig;const zu=[];he.handleByNamedList(F.Environment,zu);async function pT(r){if(!r)for(let e=0;e<zu.length;e++){const t=zu[e];if(t.value.test()){await t.value.load();return}}}let hs;function Bg(){if(typeof hs=="boolean")return hs;try{hs=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{hs=!1}return hs}var Yc={exports:{}};Yc.exports=nl;Yc.exports.default=nl;function nl(r,e,t){t=t||2;var n=e&&e.length,i=n?e[0]*t:r.length,s=Og(r,0,i,t,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,u,c,d,h,f;if(n&&(s=bT(r,e,s,t)),r.length>80*t){a=u=r[0],l=c=r[1];for(var p=t;p<i;p+=t)d=r[p],h=r[p+1],d<a&&(a=d),h<l&&(l=h),d>u&&(u=d),h>c&&(c=h);f=Math.max(u-a,c-l),f=f!==0?32767/f:0}return Hs(s,o,t,a,l,f,0),o}function Og(r,e,t,n,i){var s,o;if(i===Hu(r,e,t,n)>0)for(s=e;s<t;s+=n)o=_f(s,r[s],r[s+1],o);else for(s=t-n;s>=e;s-=n)o=_f(s,r[s],r[s+1],o);return o&&il(o,o.next)&&(Ws(o),o=o.next),o}function qn(r,e){if(!r)return r;e||(e=r);var t=r,n;do if(n=!1,!t.steiner&&(il(t,t.next)||et(t.prev,t,t.next)===0)){if(Ws(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Hs(r,e,t,n,i,s,o){if(r){!o&&s&&TT(r,n,i,s);for(var a=r,l,u;r.prev!==r.next;){if(l=r.prev,u=r.next,s?gT(r,n,i,s):mT(r)){e.push(l.i/t|0),e.push(r.i/t|0),e.push(u.i/t|0),Ws(r),r=u.next,a=u.next;continue}if(r=u,r===a){o?o===1?(r=vT(qn(r),e,t),Hs(r,e,t,n,i,s,2)):o===2&&xT(r,e,t,n,i,s):Hs(qn(r),e,t,n,i,s,1);break}}}}function mT(r){var e=r.prev,t=r,n=r.next;if(et(e,t,n)>=0)return!1;for(var i=e.x,s=t.x,o=n.x,a=e.y,l=t.y,u=n.y,c=i<s?i<o?i:o:s<o?s:o,d=a<l?a<u?a:u:l<u?l:u,h=i>s?i>o?i:o:s>o?s:o,f=a>l?a>u?a:u:l>u?l:u,p=n.next;p!==e;){if(p.x>=c&&p.x<=h&&p.y>=d&&p.y<=f&&_i(i,a,s,l,o,u,p.x,p.y)&&et(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function gT(r,e,t,n){var i=r.prev,s=r,o=r.next;if(et(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,u=o.x,c=i.y,d=s.y,h=o.y,f=a<l?a<u?a:u:l<u?l:u,p=c<d?c<h?c:h:d<h?d:h,m=a>l?a>u?a:u:l>u?l:u,g=c>d?c>h?c:h:d>h?d:h,v=Lu(f,p,e,t,n),x=Lu(m,g,e,t,n),b=r.prevZ,_=r.nextZ;b&&b.z>=v&&_&&_.z<=x;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==o&&_i(a,c,l,d,u,h,b.x,b.y)&&et(b.prev,b,b.next)>=0||(b=b.prevZ,_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==o&&_i(a,c,l,d,u,h,_.x,_.y)&&et(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;b&&b.z>=v;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==o&&_i(a,c,l,d,u,h,b.x,b.y)&&et(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;_&&_.z<=x;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==o&&_i(a,c,l,d,u,h,_.x,_.y)&&et(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function vT(r,e,t){var n=r;do{var i=n.prev,s=n.next.next;!il(i,s)&&Ug(i,n,n.next,s)&&Vs(i,s)&&Vs(s,i)&&(e.push(i.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),Ws(n),Ws(n.next),n=r=s),n=n.next}while(n!==r);return qn(n)}function xT(r,e,t,n,i,s){var o=r;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&AT(o,a)){var l=Dg(o,a);o=qn(o,o.next),l=qn(l,l.next),Hs(o,e,t,n,i,s,0),Hs(l,e,t,n,i,s,0);return}a=a.next}o=o.next}while(o!==r)}function bT(r,e,t,n){var i=[],s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:r.length,u=Og(r,a,l,n,!1),u===u.next&&(u.steiner=!0),i.push(PT(u));for(i.sort(_T),s=0;s<i.length;s++)t=yT(i[s],t);return t}function _T(r,e){return r.x-e.x}function yT(r,e){var t=ST(r,e);if(!t)return e;var n=Dg(t,r);return qn(n,n.next),qn(t,t.next)}function ST(r,e){var t=e,n=r.x,i=r.y,s=-1/0,o;do{if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){var a=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=n&&a>s&&(s=a,o=t.x<t.next.x?t:t.next,a===n))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,u=o.x,c=o.y,d=1/0,h;t=o;do n>=t.x&&t.x>=u&&n!==t.x&&_i(i<c?n:s,i,u,c,i<c?s:n,i,t.x,t.y)&&(h=Math.abs(i-t.y)/(n-t.x),Vs(t,r)&&(h<d||h===d&&(t.x>o.x||t.x===o.x&&wT(o,t)))&&(o=t,d=h)),t=t.next;while(t!==l);return o}function wT(r,e){return et(r.prev,r,e.prev)<0&&et(e.next,r,r.next)<0}function TT(r,e,t,n){var i=r;do i.z===0&&(i.z=Lu(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,CT(i)}function CT(r){var e,t,n,i,s,o,a,l,u=1;do{for(t=r,r=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<u&&(a++,n=n.nextZ,!!n);e++);for(l=u;a>0||l>0&&n;)a!==0&&(l===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,a--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:r=i,i.prevZ=s,s=i;t=n}s.nextZ=null,u*=2}while(o>1);return r}function Lu(r,e,t,n,i){return r=(r-t)*i|0,e=(e-n)*i|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function PT(r){var e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function _i(r,e,t,n,i,s,o,a){return(i-o)*(e-a)>=(r-o)*(s-a)&&(r-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(i-o)*(n-a)}function AT(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!ET(r,e)&&(Vs(r,e)&&Vs(e,r)&&MT(r,e)&&(et(r.prev,r,e.prev)||et(r,e.prev,e))||il(r,e)&&et(r.prev,r,r.next)>0&&et(e.prev,e,e.next)>0)}function et(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function il(r,e){return r.x===e.x&&r.y===e.y}function Ug(r,e,t,n){var i=Fo(et(r,e,t)),s=Fo(et(r,e,n)),o=Fo(et(t,n,r)),a=Fo(et(t,n,e));return!!(i!==s&&o!==a||i===0&&ko(r,t,e)||s===0&&ko(r,n,e)||o===0&&ko(t,r,n)||a===0&&ko(t,e,n))}function ko(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function Fo(r){return r>0?1:r<0?-1:0}function ET(r,e){var t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&Ug(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function Vs(r,e){return et(r.prev,r,r.next)<0?et(r,e,r.next)>=0&&et(r,r.prev,e)>=0:et(r,e,r.prev)<0||et(r,r.next,e)<0}function MT(r,e){var t=r,n=!1,i=(r.x+e.x)/2,s=(r.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==r);return n}function Dg(r,e){var t=new Nu(r.i,r.x,r.y),n=new Nu(e.i,e.x,e.y),i=r.next,s=e.prev;return r.next=e,e.prev=r,t.next=i,i.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function _f(r,e,t,n){var i=new Nu(r,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Ws(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Nu(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}nl.deviation=function(r,e,t,n){var i=e&&e.length,s=i?e[0]*t:r.length,o=Math.abs(Hu(r,0,s,t));if(i)for(var a=0,l=e.length;a<l;a++){var u=e[a]*t,c=a<l-1?e[a+1]*t:r.length;o-=Math.abs(Hu(r,u,c,t))}var d=0;for(a=0;a<n.length;a+=3){var h=n[a]*t,f=n[a+1]*t,p=n[a+2]*t;d+=Math.abs((r[h]-r[p])*(r[f+1]-r[h+1])-(r[h]-r[f])*(r[p+1]-r[h+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function Hu(r,e,t,n){for(var i=0,s=e,o=t-n;s<t;s+=n)i+=(r[o]-r[s])*(r[s+1]+r[o+1]),o=s;return i}nl.flatten=function(r){for(var e=r[0][0].length,t={vertices:[],holes:[],dimensions:e},n=0,i=0;i<r.length;i++){for(var s=0;s<r[i].length;s++)for(var o=0;o<e;o++)t.vertices.push(r[i][s][o]);i>0&&(n+=r[i-1].length,t.holes.push(n))}return t};var RT=Yc.exports;const kT=tl(RT);var Dt=(r=>(r[r.NONE=0]="NONE",r[r.COLOR=16384]="COLOR",r[r.STENCIL=1024]="STENCIL",r[r.DEPTH=256]="DEPTH",r[r.COLOR_DEPTH=16640]="COLOR_DEPTH",r[r.COLOR_STENCIL=17408]="COLOR_STENCIL",r[r.DEPTH_STENCIL=1280]="DEPTH_STENCIL",r[r.ALL=17664]="ALL",r))(Dt||{});class Gg{constructor(e){this.items=[],this._name=e}emit(e,t,n,i,s,o,a,l){const{name:u,items:c}=this;for(let d=0,h=c.length;d<h;d++)c[d][u](e,t,n,i,s,o,a,l);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&this.items.splice(t,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const FT=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],zg=class Lg extends jt{constructor(e){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const t=[...FT,...this.config.runners??[]];this._addRunners(...t),this._unsafeEvalCheck()}async init(e={}){const t=e.skipExtensionImports===!0?!0:e.manageImports===!1;await pT(t),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const n in this._systemsHash)e={...this._systemsHash[n].constructor.defaultOptions,...e};e={...Lg.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let n=0;n<this.runners.init.items.length;n++)await this.runners.init.items[n].init(e);this._initOptions=e}render(e,t){let n=e;if(n instanceof fe&&(n={container:n},t&&(J(Me,"passing a second argument is deprecated, please use render options instead"),n.target=t.renderTexture)),n.target||(n.target=this.view.renderTarget),n.target===this.view.renderTarget&&(this._lastObjectRendered=n.container,n.clearColor=this.background.colorRgba),n.clearColor){const i=Array.isArray(n.clearColor)&&n.clearColor.length===4;n.clearColor=i?n.clearColor:pe.shared.setValue(n.clearColor).toArray()}n.transform||(n.container.updateLocalTransform(),n.transform=n.container.localTransform),this.runners.prerender.emit(n),this.runners.renderStart.emit(n),this.runners.render.emit(n),this.runners.renderEnd.emit(n),this.runners.postrender.emit(n)}resize(e,t,n){const i=this.view.resolution;this.view.resize(e,t,n),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),n!==void 0&&n!==i&&this.runners.resolutionChange.emit(n)}clear(e={}){const t=this;e.target||(e.target=t.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=Dt.ALL);const{clear:n,clearColor:i,target:s}=e;pe.shared.setValue(i??this.background.colorRgba),t.renderTarget.clear(s,n,pe.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(t=>{this.runners[t]=new Gg(t)})}_addSystems(e){let t;for(t in e){const n=e[t];this._addSystem(n.value,n.name)}}_addSystem(e,t){const n=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=n,this._systemsHash[t]=n;for(const i in this.runners)this.runners[i].add(n);return this}_addPipes(e,t){const n=t.reduce((i,s)=>(i[s.name]=s.value,i),{});e.forEach(i=>{const s=i.value,o=i.name,a=n[o];this.renderPipes[o]=new s(this,a?new a:null)})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Bg())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};zg.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let sl=zg,Io;function IT(r){return Io!==void 0||(Io=(()=>{const e={stencil:!0,failIfMajorPerformanceCaveat:r??sl.defaultOptions.failIfMajorPerformanceCaveat};try{if(!Ee.get().getWebGLRenderingContext())return!1;let n=Ee.get().createCanvas().getContext("webgl",e);const i=!!n?.getContextAttributes()?.stencil;if(n){const s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,i}catch{return!1}})()),Io}let Bo;async function BT(r={}){return Bo!==void 0||(Bo=await(async()=>{const e=Ee.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(r)).requestDevice(),!0}catch{return!1}})()),Bo}const yf=["webgl","webgpu","canvas"];async function OT(r){let e=[];r.preference?(e.push(r.preference),yf.forEach(s=>{s!==r.preference&&e.push(s)})):e=yf.slice();let t,n={};for(let s=0;s<e.length;s++){const o=e[s];if(o==="webgpu"&&await BT()){const{WebGPURenderer:a}=await Ca(async()=>{const{WebGPURenderer:l}=await Promise.resolve().then(()=>yE);return{WebGPURenderer:l}},void 0,import.meta.url);t=a,n={...r,...r.webgpu};break}else if(o==="webgl"&&IT(r.failIfMajorPerformanceCaveat??sl.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await Ca(async()=>{const{WebGLRenderer:l}=await Promise.resolve().then(()=>rE);return{WebGLRenderer:l}},void 0,import.meta.url);t=a,n={...r,...r.webgl};break}else if(o==="canvas")throw n={...r},new Error("CanvasRenderer is not yet implemented")}if(delete n.webgpu,delete n.webgl,!t)throw new Error("No available renderer for the current environment");const i=new t;return await i.init(n),i}const ka="8.5.0";class Ng{static init(){globalThis.__PIXI_APP_INIT__?.(this,ka)}static destroy(){}}Ng.extension=F.Application;class Hg{constructor(e){this._renderer=e}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,ka)}destroy(){this._renderer=null}}Hg.extension={type:[F.WebGLSystem,F.WebGPUSystem],name:"initHook",priority:-10};const Vg=class Vu{constructor(...e){this.stage=new fe,e[0]!==void 0&&J(Me,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.renderer=await OT(e),Vu._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return J(Me,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,t=!1){const n=Vu._plugins.slice(0);n.reverse(),n.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};Vg._plugins=[];let Wg=Vg;he.handleByList(F.Application,Wg._plugins);he.add(Ng);class jg{static init(e){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let t,n;if(this._resizeTo===globalThis.window)t=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;t=i,n=s}this.renderer.resize(t,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}jg.extension=F.Application;class Xg{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Ls.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Er.shared:new Er,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}Xg.extension=F.Application;class qg extends jt{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return J(Me,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return J(Me,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return J(Me,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return J(Me,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return J(Me,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const t in this.chars)this.chars[t].texture?.destroy();this.chars=null,e&&(this.pages.forEach(t=>t.texture.destroy(!0)),this.pages=null)}}const Yg=class Wu{constructor(e,t,n,i){this.uid=tt("fillGradient"),this.type="linear",this.gradientStops=[],this._styleKey=null,this.x0=e,this.y0=t,this.x1=n,this.y1=i}addColorStop(e,t){return this.gradientStops.push({offset:e,color:pe.shared.setValue(t).toHexa()}),this._styleKey=null,this}buildLinearGradient(){const e=Wu.defaultTextureSize,{gradientStops:t}=this,n=Ee.get().createCanvas();n.width=e,n.height=e;const i=n.getContext("2d"),s=i.createLinearGradient(0,0,Wu.defaultTextureSize,1);for(let m=0;m<t.length;m++){const g=t[m];s.addColorStop(g.offset,g.color)}i.fillStyle=s,i.fillRect(0,0,e,e),this.texture=new te({source:new ei({resource:n,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:o,y0:a,x1:l,y1:u}=this,c=new ae,d=l-o,h=u-a,f=Math.sqrt(d*d+h*h),p=Math.atan2(h,d);c.translate(-o,-a),c.scale(1/e,1/e),c.rotate(-p),c.scale(256/f,1),this.transform=c,this._styleKey=null}get styleKey(){if(this._styleKey)return this._styleKey;const e=this.gradientStops.map(i=>`${i.offset}-${i.color}`).join("-"),t=this.texture.uid,n=this.transform.toArray().join("-");return`fill-gradient-${this.uid}-${e}-${t}-${n}-${this.x0}-${this.y0}-${this.x1}-${this.y1}`}};Yg.defaultTextureSize=256;let js=Yg;const Sf={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class ol{constructor(e,t){this.uid=tt("fillPattern"),this.transform=new ae,this._styleKey=null,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),t&&(e.source.style.addressModeU=Sf[t].addressModeU,e.source.style.addressModeV=Sf[t].addressModeV)}setTransform(e){const t=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/t.frame.width,1/t.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var UT=GT,ql={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},DT=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function GT(r){var e=[];return r.replace(DT,function(t,n,i){var s=n.toLowerCase();for(i=LT(i),s=="m"&&i.length>2&&(e.push([n].concat(i.splice(0,2))),s="l",n=n=="m"?"l":"L");;){if(i.length==ql[s])return i.unshift(n),e.push(i);if(i.length<ql[s])throw new Error("malformed path data");e.push([n].concat(i.splice(0,ql[s])))}}),e}var zT=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function LT(r){var e=r.match(zT);return e?e.map(Number):[]}const NT=tl(UT);function HT(r,e){const t=NT(r),n=[];let i=null,s=0,o=0;for(let a=0;a<t.length;a++){const l=t[a],u=l[0],c=l;switch(u){case"M":s=c[1],o=c[2],e.moveTo(s,o);break;case"m":s+=c[1],o+=c[2],e.moveTo(s,o);break;case"H":s=c[1],e.lineTo(s,o);break;case"h":s+=c[1],e.lineTo(s,o);break;case"V":o=c[1],e.lineTo(s,o);break;case"v":o+=c[1],e.lineTo(s,o);break;case"L":s=c[1],o=c[2],e.lineTo(s,o);break;case"l":s+=c[1],o+=c[2],e.lineTo(s,o);break;case"C":s=c[5],o=c[6],e.bezierCurveTo(c[1],c[2],c[3],c[4],s,o);break;case"c":e.bezierCurveTo(s+c[1],o+c[2],s+c[3],o+c[4],s+c[5],o+c[6]),s+=c[5],o+=c[6];break;case"S":s=c[3],o=c[4],e.bezierCurveToShort(c[1],c[2],s,o);break;case"s":e.bezierCurveToShort(s+c[1],o+c[2],s+c[3],o+c[4]),s+=c[3],o+=c[4];break;case"Q":s=c[3],o=c[4],e.quadraticCurveTo(c[1],c[2],s,o);break;case"q":e.quadraticCurveTo(s+c[1],o+c[2],s+c[3],o+c[4]),s+=c[3],o+=c[4];break;case"T":s=c[1],o=c[2],e.quadraticCurveToShort(s,o);break;case"t":s+=c[1],o+=c[2],e.quadraticCurveToShort(s,o);break;case"A":s=c[6],o=c[7],e.arcToSvg(c[1],c[2],c[3],c[4],c[5],s,o);break;case"a":s+=c[6],o+=c[7],e.arcToSvg(c[1],c[2],c[3],c[4],c[5],s,o);break;case"Z":case"z":e.closePath(),n.length>0&&(i=n.pop(),i?(s=i.startX,o=i.startY):(s=0,o=0)),i=null;break;default:de(`Unknown SVG path command: ${u}`)}u!=="Z"&&u!=="z"&&i===null&&(i={startX:s,startY:o},n.push(i))}return e}class Kc{constructor(e=0,t=0,n=0){this.type="circle",this.x=e,this.y=t,this.radius=n}clone(){return new Kc(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-e,s=this.y-t;return i*=i,s*=s,i+s<=n}strokeContains(e,t,n){if(this.radius===0)return!1;const i=this.x-e,s=this.y-t,o=this.radius,a=n/2,l=Math.sqrt(i*i+s*s);return l<o+a&&l>o-a}getBounds(e){return e=e||new Le,e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class $c{constructor(e=0,t=0,n=0,i=0){this.type="ellipse",this.x=e,this.y=t,this.halfWidth=n,this.halfHeight=i}clone(){return new $c(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,t){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let n=(e-this.x)/this.halfWidth,i=(t-this.y)/this.halfHeight;return n*=n,i*=i,n+i<=1}strokeContains(e,t,n){const{halfWidth:i,halfHeight:s}=this;if(i<=0||s<=0)return!1;const o=n/2,a=i-o,l=s-o,u=i+o,c=s+o,d=e-this.x,h=t-this.y,f=d*d/(a*a)+h*h/(l*l),p=d*d/(u*u)+h*h/(c*c);return f>1&&p<=1}getBounds(e){return e=e||new Le,e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function VT(r,e,t,n,i,s){const o=r-t,a=e-n,l=i-t,u=s-n,c=o*l+a*u,d=l*l+u*u;let h=-1;d!==0&&(h=c/d);let f,p;h<0?(f=t,p=n):h>1?(f=i,p=s):(f=t+h*l,p=n+h*u);const m=r-f,g=e-p;return m*m+g*g}class Es{constructor(...e){this.type="polygon";let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const n=[];for(let i=0,s=t.length;i<s;i++)n.push(t[i].x,t[i].y);t=n}this.points=t,this.closePath=!0}clone(){const e=this.points.slice(),t=new Es(e);return t.closePath=this.closePath,t}contains(e,t){let n=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[s*2],l=this.points[s*2+1],u=this.points[o*2],c=this.points[o*2+1];l>t!=c>t&&e<(u-a)*((t-l)/(c-l))+a&&(n=!n)}return n}strokeContains(e,t,n){const i=n/2,s=i*i,{points:o}=this,a=o.length-(this.closePath?0:2);for(let l=0;l<a;l+=2){const u=o[l],c=o[l+1],d=o[(l+2)%o.length],h=o[(l+3)%o.length];if(VT(e,t,u,c,d,h)<=s)return!0}return!1}getBounds(e){e=e||new Le;const t=this.points;let n=1/0,i=-1/0,s=1/0,o=-1/0;for(let a=0,l=t.length;a<l;a+=2){const u=t[a],c=t[a+1];n=u<n?u:n,i=u>i?u:i,s=c<s?c:s,o=c>o?c:o}return e.x=n,e.width=i-n,e.y=s,e.height=o-s,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,t)=>`${e}, ${t}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Oo=(r,e,t,n,i,s)=>{const o=r-t,a=e-n,l=Math.sqrt(o*o+a*a);return l>=i-s&&l<=i+s};class Zc{constructor(e=0,t=0,n=0,i=0,s=20){this.type="roundedRectangle",this.x=e,this.y=t,this.width=n,this.height=i,this.radius=s}getBounds(e){return e=e||new Le,e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new Zc(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+n&&t<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let i=e-(this.x+n),s=t-(this.y+n);const o=n*n;if(i*i+s*s<=o||(i=e-(this.x+this.width-n),i*i+s*s<=o)||(s=t-(this.y+this.height-n),i*i+s*s<=o)||(i=e-(this.x+n),i*i+s*s<=o))return!0}return!1}strokeContains(e,t,n){const{x:i,y:s,width:o,height:a,radius:l}=this,u=n/2,c=i+l,d=s+l,h=o-l*2,f=a-l*2,p=i+o,m=s+a;return(e>=i-u&&e<=i+u||e>=p-u&&e<=p+u)&&t>=d&&t<=d+f||(t>=s-u&&t<=s+u||t>=m-u&&t<=m+u)&&e>=c&&e<=c+h?!0:e<c&&t<d&&Oo(e,t,c,d,l,u)||e>p-l&&t<d&&Oo(e,t,p-l,d,l,u)||e>p-l&&t>m-l&&Oo(e,t,p-l,m-l,l,u)||e<c&&t>m-l&&Oo(e,t,c,m-l,l,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const WT=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function jT(r){let e="";for(let t=0;t<r;++t)t>0&&(e+=`
else `),t<r-1&&(e+=`if(test == ${t}.0){}`);return e}function XT(r,e){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const n=WT.replace(/%forloop%/gi,jT(r));if(e.shaderSource(t,n),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))r=r/2|0;else break}}finally{e.deleteShader(t)}return r}let di=null;function ss(){if(di)return di;const r=Ag();return di=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),di=XT(di,r),r.getExtension("WEBGL_lose_context")?.loseContext(),di}const Kg={};function Qc(r,e){let t=2166136261;for(let n=0;n<e;n++)t^=r[n].uid,t=Math.imul(t,16777619),t>>>=0;return Kg[t]||qT(r,e,t)}let Yl=0;function qT(r,e,t){const n={};let i=0;Yl||(Yl=ss());for(let o=0;o<Yl;o++){const a=o<e?r[o]:te.EMPTY.source;n[i++]=a.source,n[i++]=a.style}const s=new Vr(n);return Kg[t]=s,s}class yi{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function ju(r,e){const t=r.byteLength/8|0,n=new Float64Array(r,0,t);new Float64Array(e,0,t).set(n);const s=r.byteLength-t*8;if(s>0){const o=new Uint8Array(r,t*8,s);new Uint8Array(e,t*8,s).set(o)}}const YT={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var nt=(r=>(r[r.DISABLED=0]="DISABLED",r[r.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",r[r.MASK_ACTIVE=2]="MASK_ACTIVE",r[r.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",r[r.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",r[r.NONE=5]="NONE",r))(nt||{});function Xs(r,e){return e.alphaMode==="no-premultiply-alpha"&&YT[r]||r}class KT{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const t=this.textures[e];this.textures[e]=null,this.ids[t.uid]=null}this.count=0}}class $T{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new KT,this.blendMode="normal",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const $g=[];let Xu=0;function wf(){return Xu>0?$g[--Xu]:new $T}function Tf(r){$g[Xu++]=r}let fs=0;const Zg=class Yo{constructor(e={}){this.uid=tt("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],Yo.defaultOptions.maxTextures=Yo.defaultOptions.maxTextures??ss(),e={...Yo.defaultOptions,...e};const{maxTextures:t,attributesInitialSize:n,indicesInitialSize:i}=e;this.attributeBuffer=new yi(n*4),this.indexBuffer=new Uint16Array(i),this.maxTextures=t}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)Tf(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,t){const n=e._batch.textures.ids[t._source.uid];return!n&&n!==0?!1:(e._textureId=n,e.texture=t,!0)}updateElement(e){this.dirty=!0;const t=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId)}break(e){const t=this._elements;if(!t[this.elementStart])return;let n=wf(),i=n.textures;i.clear();const s=t[this.elementStart];let o=Xs(s.blendMode,s.texture._source);this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const a=this.attributeBuffer.float32View,l=this.attributeBuffer.uint32View,u=this.indexBuffer;let c=this._batchIndexSize,d=this._batchIndexStart,h="startBatch";const f=this.maxTextures;for(let p=this.elementStart;p<this.elementSize;++p){const m=t[p];t[p]=null;const v=m.texture._source,x=Xs(m.blendMode,v),b=o!==x;if(v._batchTick===fs&&!b){m._textureId=v._textureBindLocation,c+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,a,l,m._attributeStart,m._textureId),this.packQuadIndex(u,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,a,l,m._attributeStart,m._textureId),this.packIndex(m,u,m._indexStart,m._attributeStart/this.vertexSize)),m._batch=n;continue}v._batchTick=fs,(i.count>=f||b)&&(this._finishBatch(n,d,c-d,i,o,e,h),h="renderBatch",d=c,o=x,n=wf(),i=n.textures,i.clear(),++fs),m._textureId=v._textureBindLocation=i.count,i.ids[v.uid]=i.count,i.textures[i.count++]=v,m._batch=n,c+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,a,l,m._attributeStart,m._textureId),this.packQuadIndex(u,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,a,l,m._attributeStart,m._textureId),this.packIndex(m,u,m._indexStart,m._attributeStart/this.vertexSize))}i.count>0&&(this._finishBatch(n,d,c-d,i,o,e,h),d=c,++fs),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=c}_finishBatch(e,t,n,i,s,o,a){e.gpuBindGroup=null,e.bindGroup=null,e.action=a,e.batcher=this,e.textures=i,e.blendMode=s,e.start=t,e.size=n,++fs,this.batches[this.batchIndex++]=e,o.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const t=Math.max(e,this.attributeBuffer.size*2),n=new yi(t);ju(this.attributeBuffer.rawBinaryData,n.rawBinaryData),this.attributeBuffer=n}_resizeIndexBuffer(e){const t=this.indexBuffer;let n=Math.max(e,t.length*1.5);n+=n%2;const i=n>65535?new Uint32Array(n):new Uint16Array(n);if(i.BYTES_PER_ELEMENT!==t.BYTES_PER_ELEMENT)for(let s=0;s<t.length;s++)i[s]=t[s];else ju(t.buffer,i.buffer);this.indexBuffer=i}packQuadIndex(e,t,n){e[t]=n+0,e[t+1]=n+1,e[t+2]=n+2,e[t+3]=n+0,e[t+4]=n+2,e[t+5]=n+3}packIndex(e,t,n,i){const s=e.indices,o=e.indexSize,a=e.indexOffset,l=e.attributeOffset;for(let u=0;u<o;u++)t[n++]=i+s[u+a]-l}destroy(){for(let e=0;e<this.batches.length;e++)Tf(this.batches[e]);this.batches=null;for(let e=0;e<this._elements.length;e++)this._elements[e]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};Zg.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let ZT=Zg;var Ae=(r=>(r[r.MAP_READ=1]="MAP_READ",r[r.MAP_WRITE=2]="MAP_WRITE",r[r.COPY_SRC=4]="COPY_SRC",r[r.COPY_DST=8]="COPY_DST",r[r.INDEX=16]="INDEX",r[r.VERTEX=32]="VERTEX",r[r.UNIFORM=64]="UNIFORM",r[r.STORAGE=128]="STORAGE",r[r.INDIRECT=256]="INDIRECT",r[r.QUERY_RESOLVE=512]="QUERY_RESOLVE",r[r.STATIC=1024]="STATIC",r))(Ae||{});class Ht extends jt{constructor(e){let{data:t,size:n}=e;const{usage:i,label:s,shrinkToFit:o}=e;super(),this.uid=tt("buffer"),this._resourceType="buffer",this._resourceId=tt("resource"),this._touched=0,this._updateID=1,this.shrinkToFit=!0,this.destroyed=!1,t instanceof Array&&(t=new Float32Array(t)),this._data=t,n=n??t?.byteLength;const a=!!t;this.descriptor={size:n,usage:i,mappedAtCreation:a,label:s},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get static(){return!!(this.descriptor.usage&Ae.STATIC)}set static(e){e?this.descriptor.usage|=Ae.STATIC:this.descriptor.usage&=~Ae.STATIC}setDataWithSize(e,t,n){if(this._updateID++,this._updateSize=t*e.BYTES_PER_ELEMENT,this._data===e){n&&this.emit("update",this);return}const i=this._data;if(this._data=e,i.length!==e.length){!this.shrinkToFit&&e.byteLength<i.byteLength?n&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=tt("resource"),this.emit("change",this));return}n&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function Qg(r,e){if(!(r instanceof Ht)){let t=e?Ae.INDEX:Ae.VERTEX;r instanceof Array&&(e?(r=new Uint32Array(r),t=Ae.INDEX|Ae.COPY_DST):(r=new Float32Array(r),t=Ae.VERTEX|Ae.COPY_DST)),r=new Ht({data:r,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:t})}return r}function QT(r,e,t){const n=r.getAttribute(e);if(!n)return t.minX=0,t.minY=0,t.maxX=0,t.maxY=0,t;const i=n.buffer.data;let s=1/0,o=1/0,a=-1/0,l=-1/0;const u=i.BYTES_PER_ELEMENT,c=(n.offset||0)/u,d=(n.stride||2*4)/u;for(let h=c;h<i.length;h+=d){const f=i[h],p=i[h+1];f>a&&(a=f),p>l&&(l=p),f<s&&(s=f),p<o&&(o=p)}return t.minX=s,t.minY=o,t.maxX=a,t.maxY=l,t}function JT(r){return(r instanceof Ht||Array.isArray(r)||r.BYTES_PER_ELEMENT)&&(r={buffer:r}),r.buffer=Qg(r.buffer,!1),r}class oo extends jt{constructor(e={}){super(),this.uid=tt("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Mt,this._boundsDirty=!0;const{attributes:t,indexBuffer:n,topology:i}=e;if(this.buffers=[],this.attributes={},t)for(const s in t)this.addAttribute(s,t[s]);this.instanceCount=e.instanceCount||1,n&&this.addIndex(n),this.topology=i||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const t=this.attributes[e];return t.buffer.data.length/(t.stride/4||t.size)}return 0}addAttribute(e,t){const n=JT(t);this.buffers.indexOf(n.buffer)===-1&&(this.buffers.push(n.buffer),n.buffer.on("update",this.onBufferUpdate,this),n.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=n}addIndex(e){this.indexBuffer=Qg(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,QT(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(t=>t.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const eC=new Float32Array(1),tC=new Uint32Array(1);class rC extends oo{constructor(){const t=new Ht({data:eC,label:"attribute-batch-buffer",usage:Ae.VERTEX|Ae.COPY_DST,shrinkToFit:!1}),n=new Ht({data:tC,label:"index-batch-buffer",usage:Ae.INDEX|Ae.COPY_DST,shrinkToFit:!1}),i=6*4;super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:i,offset:0},aUV:{buffer:t,format:"float32x2",stride:i,offset:2*4},aColor:{buffer:t,format:"unorm8x4",stride:i,offset:4*4},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:i,offset:5*4}},indexBuffer:n})}}function Cf(r,e,t){if(r)for(const n in r){const i=n.toLocaleLowerCase(),s=e[i];if(s){let o=r[n];n==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),t&&s.push(`//----${t}----//`),s.push(o)}else de(`${n} placement hook does not exist in shader`)}}const nC=/\{\{(.*?)\}\}/g;function Pf(r){const e={};return(r.match(nC)?.map(n=>n.replace(/[{()}]/g,""))??[]).forEach(n=>{e[n]=[]}),e}function Af(r,e){let t;const n=/@in\s+([^;]+);/g;for(;(t=n.exec(r))!==null;)e.push(t[1])}function Ef(r,e,t=!1){const n=[];Af(e,n),r.forEach(a=>{a.header&&Af(a.header,n)});const i=n;t&&i.sort();const s=i.map((a,l)=>`       @location(${l}) ${a},`).join(`
`);let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${s}
`),o}function Mf(r,e){let t;const n=/@out\s+([^;]+);/g;for(;(t=n.exec(r))!==null;)e.push(t[1])}function iC(r){const t=/\b(\w+)\s*:/g.exec(r);return t?t[1]:""}function sC(r){const e=/@.*?\s+/g;return r.replace(e,"")}function oC(r,e){const t=[];Mf(e,t),r.forEach(l=>{l.header&&Mf(l.header,t)});let n=0;const i=t.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${n++}) ${l}`).join(`,
`),s=t.sort().map(l=>`       var ${sC(l)};`).join(`
`),o=`return VSOutput(
                ${t.sort().map(l=>` ${iC(l)}`).join(`,
`)});`;let a=e.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${i}
`),a=a.replace("{{start}}",`
${s}
`),a=a.replace("{{return}}",`
${o}
`),a}function Rf(r,e){let t=r;for(const n in e){const i=e[n];i.join(`
`).length?t=t.replace(`{{${n}}}`,`//-----${n} START-----//
${i.join(`
`)}
//----${n} FINISH----//`):t=t.replace(`{{${n}}}`,"")}return t}const tn=Object.create(null),Kl=new Map;let aC=0;function lC({template:r,bits:e}){const t=Jg(r,e);if(tn[t])return tn[t];const{vertex:n,fragment:i}=cC(r,e);return tn[t]=ev(n,i,e),tn[t]}function uC({template:r,bits:e}){const t=Jg(r,e);return tn[t]||(tn[t]=ev(r.vertex,r.fragment,e)),tn[t]}function cC(r,e){const t=e.map(o=>o.vertex).filter(o=>!!o),n=e.map(o=>o.fragment).filter(o=>!!o);let i=Ef(t,r.vertex,!0);i=oC(t,i);const s=Ef(n,r.fragment,!0);return{vertex:i,fragment:s}}function Jg(r,e){return e.map(t=>(Kl.has(t)||Kl.set(t,aC++),Kl.get(t))).sort((t,n)=>t-n).join("-")+r.vertex+r.fragment}function ev(r,e,t){const n=Pf(r),i=Pf(e);return t.forEach(s=>{Cf(s.vertex,n,s.name),Cf(s.fragment,i,s.name)}),{vertex:Rf(r,n),fragment:Rf(e,i)}}const dC=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,hC=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,fC=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,pC=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,mC={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},gC={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function ao({bits:r,name:e}){const t=lC({template:{fragment:hC,vertex:dC},bits:[mC,...r]});return me.from({name:e,vertex:{source:t.vertex,entryPoint:"main"},fragment:{source:t.fragment,entryPoint:"main"}})}function lo({bits:r,name:e}){return new be({name:e,...uC({template:{vertex:fC,fragment:pC},bits:[gC,...r]})})}const Jc={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},ed={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},$l={};function vC(r){const e=[];if(r===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let t=0;for(let n=0;n<r;n++)e.push(`@group(1) @binding(${t++}) var textureSource${n+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${t++}) var textureSampler${n+1}: sampler;`)}return e.join(`
`)}function xC(r){const e=[];if(r===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let t=0;t<r;t++)t===r-1?e.push("  default:{"):e.push(`  case ${t}:{`),e.push(`      outColor = textureSampleGrad(textureSource${t+1}, textureSampler${t+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function td(r){return $l[r]||($l[r]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${vC(r)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${xC(r)}
            `}}),$l[r]}const Zl={};function bC(r){const e=[];for(let t=0;t<r;t++)t>0&&e.push("else"),t<r-1&&e.push(`if(vTextureId < ${t}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${t}], vUV);`),e.push("}");return e.join(`
`)}function rd(r){return Zl[r]||(Zl[r]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${r}];

            `,main:`

                ${bC(r)}
            `}}),Zl[r]}const uo={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},co={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},kf={};function nd(r){let e=kf[r];if(e)return e;const t=new Int32Array(r);for(let n=0;n<r;n++)t[n]=n;return e=kf[r]=new _t({uTextures:{value:t,type:"i32",size:r}},{isStatic:!0}),e}class _C extends sr{constructor(e){const t=lo({name:"batch",bits:[ed,rd(e),co]}),n=ao({name:"batch",bits:[Jc,td(e),uo]});super({glProgram:t,gpuProgram:n,resources:{batchSamplers:nd(e)}})}}let Ff=null;const tv=class rv extends ZT{constructor(){super(...arguments),this.geometry=new rC,this.shader=Ff||(Ff=new _C(this.maxTextures)),this.name=rv.extension.name,this.vertexSize=6}packAttributes(e,t,n,i,s){const o=s<<16|e.roundPixels&65535,a=e.transform,l=a.a,u=a.b,c=a.c,d=a.d,h=a.tx,f=a.ty,{positions:p,uvs:m}=e,g=e.color,v=e.attributeOffset,x=v+e.attributeSize;for(let b=v;b<x;b++){const _=b*2,w=p[_],C=p[_+1];t[i++]=l*w+c*C+h,t[i++]=d*C+u*w+f,t[i++]=m[_],t[i++]=m[_+1],n[i++]=g,n[i++]=o}}packQuadAttributes(e,t,n,i,s){const o=e.texture,a=e.transform,l=a.a,u=a.b,c=a.c,d=a.d,h=a.tx,f=a.ty,p=e.bounds,m=p.maxX,g=p.minX,v=p.maxY,x=p.minY,b=o.uvs,_=e.color,w=s<<16|e.roundPixels&65535;t[i+0]=l*g+c*x+h,t[i+1]=d*x+u*g+f,t[i+2]=b.x0,t[i+3]=b.y0,n[i+4]=_,n[i+5]=w,t[i+6]=l*m+c*x+h,t[i+7]=d*x+u*m+f,t[i+8]=b.x1,t[i+9]=b.y1,n[i+10]=_,n[i+11]=w,t[i+12]=l*m+c*v+h,t[i+13]=d*v+u*m+f,t[i+14]=b.x2,t[i+15]=b.y2,n[i+16]=_,n[i+17]=w,t[i+18]=l*g+c*v+h,t[i+19]=d*v+u*g+f,t[i+20]=b.x3,t[i+21]=b.y3,n[i+22]=_,n[i+23]=w}};tv.extension={type:[F.Batcher],name:"default"};let id=tv;function yC(r,e,t,n,i,s,o,a=null){let l=0;t*=e,i*=s;const u=a.a,c=a.b,d=a.c,h=a.d,f=a.tx,p=a.ty;for(;l<o;){const m=r[t],g=r[t+1];n[i]=u*m+d*g+f,n[i+1]=c*m+h*g+p,i+=s,t+=e,l++}}function SC(r,e,t,n){let i=0;for(e*=t;i<n;)r[e]=0,r[e+1]=0,e+=t,i++}function nv(r,e,t,n,i){const s=e.a,o=e.b,a=e.c,l=e.d,u=e.tx,c=e.ty;t=t||0,n=n||2,i=i||r.length/n-t;let d=t*n;for(let h=0;h<i;h++){const f=r[d],p=r[d+1];r[d]=s*f+a*p+u,r[d+1]=o*f+l*p+c,d+=n}}function wC(r,e){if(r===16777215||!e)return e;if(e===16777215||!r)return r;const t=r>>16&255,n=r>>8&255,i=r&255,s=e>>16&255,o=e>>8&255,a=e&255,l=t*s/255,u=n*o/255,c=i*a/255;return(l<<16)+(u<<8)+c}const TC=new ae;class sd{constructor(){this.packAsQuad=!1,this.batcherName="default",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,t=e>>16|e&65280|(e&255)<<16,n=this.renderable;return n?wC(t,n.groupColor)+(this.alpha*n.groupAlpha*255<<24):t+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||TC}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData}reset(){this.applyTransform=!0,this.renderable=null}}const qs={extension:{type:F.ShapeBuilder,name:"circle"},build(r,e){let t,n,i,s,o,a;if(r.type==="circle"){const _=r;t=_.x,n=_.y,o=a=_.radius,i=s=0}else if(r.type==="ellipse"){const _=r;t=_.x,n=_.y,o=_.halfWidth,a=_.halfHeight,i=s=0}else{const _=r,w=_.width/2,C=_.height/2;t=_.x+w,n=_.y+C,o=a=Math.max(0,Math.min(_.radius,Math.min(w,C))),i=w-o,s=C-a}if(!(o>=0&&a>=0&&i>=0&&s>=0))return e;const l=Math.ceil(2.3*Math.sqrt(o+a)),u=l*8+(i?4:0)+(s?4:0);if(u===0)return e;if(l===0)return e[0]=e[6]=t+i,e[1]=e[3]=n+s,e[2]=e[4]=t-i,e[5]=e[7]=n-s,e;let c=0,d=l*4+(i?2:0)+2,h=d,f=u,p=i+o,m=s,g=t+p,v=t-p,x=n+m;if(e[c++]=g,e[c++]=x,e[--d]=x,e[--d]=v,s){const _=n-m;e[h++]=v,e[h++]=_,e[--f]=_,e[--f]=g}for(let _=1;_<l;_++){const w=Math.PI/2*(_/l),C=i+Math.cos(w)*o,P=s+Math.sin(w)*a,S=t+C,A=t-C,E=n+P,U=n-P;e[c++]=S,e[c++]=E,e[--d]=E,e[--d]=A,e[h++]=A,e[h++]=U,e[--f]=U,e[--f]=S}p=i,m=s+a,g=t+p,v=t-p,x=n+m;const b=n-m;return e[c++]=g,e[c++]=x,e[--f]=b,e[--f]=g,i&&(e[c++]=v,e[c++]=x,e[--f]=b,e[--f]=v),e},triangulate(r,e,t,n,i,s){if(r.length===0)return;let o=0,a=0;for(let c=0;c<r.length;c+=2)o+=r[c],a+=r[c+1];o/=r.length/2,a/=r.length/2;let l=n;e[l*t]=o,e[l*t+1]=a;const u=l++;for(let c=0;c<r.length;c+=2)e[l*t]=r[c],e[l*t+1]=r[c+1],c>0&&(i[s++]=l,i[s++]=u,i[s++]=l-1),l++;i[s++]=u+1,i[s++]=u,i[s++]=l-1}},CC={...qs,extension:{...qs.extension,name:"ellipse"}},PC={...qs,extension:{...qs.extension,name:"roundedRectangle"}},AC=1e-4,If=1e-4;function EC(r){const e=r.length;if(e<6)return 1;let t=0;for(let n=0,i=r[e-2],s=r[e-1];n<e;n+=2){const o=r[n],a=r[n+1];t+=(o-i)*(a+s),i=o,s=a}return t<0?-1:1}function Bf(r,e,t,n,i,s,o,a){const l=r-t*i,u=e-n*i,c=r+t*s,d=e+n*s;let h,f;o?(h=n,f=-t):(h=-n,f=t);const p=l+h,m=u+f,g=c+h,v=d+f;return a.push(p,m),a.push(g,v),2}function Tn(r,e,t,n,i,s,o,a){const l=t-r,u=n-e;let c=Math.atan2(l,u),d=Math.atan2(i-r,s-e);a&&c<d?c+=Math.PI*2:!a&&c>d&&(d+=Math.PI*2);let h=c;const f=d-c,p=Math.abs(f),m=Math.sqrt(l*l+u*u),g=(15*p*Math.sqrt(m)/Math.PI>>0)+1,v=f/g;if(h+=v,a){o.push(r,e),o.push(t,n);for(let x=1,b=h;x<g;x++,b+=v)o.push(r,e),o.push(r+Math.sin(b)*m,e+Math.cos(b)*m);o.push(r,e),o.push(i,s)}else{o.push(t,n),o.push(r,e);for(let x=1,b=h;x<g;x++,b+=v)o.push(r+Math.sin(b)*m,e+Math.cos(b)*m),o.push(r,e);o.push(i,s),o.push(r,e)}return g*2}function MC(r,e,t,n,i,s,o,a,l){const u=AC;if(r.length===0)return;const c=e;let d=c.alignment;if(e.alignment!==.5){let O=EC(r);d=(d-.5)*O+.5}const h=new We(r[0],r[1]),f=new We(r[r.length-2],r[r.length-1]),p=n,m=Math.abs(h.x-f.x)<u&&Math.abs(h.y-f.y)<u;if(p){r=r.slice(),m&&(r.pop(),r.pop(),f.set(r[r.length-2],r[r.length-1]));const O=(h.x+f.x)*.5,V=(f.y+h.y)*.5;r.unshift(O,V),r.push(O,V)}const g=i,v=r.length/2;let x=r.length;const b=g.length/2,_=c.width/2,w=_*_,C=c.miterLimit*c.miterLimit;let P=r[0],S=r[1],A=r[2],E=r[3],U=0,L=0,R=-(S-E),T=P-A,B=0,z=0,G=Math.sqrt(R*R+T*T);R/=G,T/=G,R*=_,T*=_;const j=d,M=(1-j)*2,H=j*2;p||(c.cap==="round"?x+=Tn(P-R*(M-H)*.5,S-T*(M-H)*.5,P-R*M,S-T*M,P+R*H,S+T*H,g,!0)+2:c.cap==="square"&&(x+=Bf(P,S,R,T,M,H,!0,g))),g.push(P-R*M,S-T*M),g.push(P+R*H,S+T*H);for(let O=1;O<v-1;++O){P=r[(O-1)*2],S=r[(O-1)*2+1],A=r[O*2],E=r[O*2+1],U=r[(O+1)*2],L=r[(O+1)*2+1],R=-(S-E),T=P-A,G=Math.sqrt(R*R+T*T),R/=G,T/=G,R*=_,T*=_,B=-(E-L),z=A-U,G=Math.sqrt(B*B+z*z),B/=G,z/=G,B*=_,z*=_;const V=A-P,$=S-E,Q=A-U,ue=L-E,De=V*Q+$*ue,st=$*Q-ue*V,Xt=st<0;if(Math.abs(st)<.001*Math.abs(De)){g.push(A-R*M,E-T*M),g.push(A+R*H,E+T*H),De>=0&&(c.join==="round"?x+=Tn(A,E,A-R*M,E-T*M,A-B*M,E-z*M,g,!1)+4:x+=2,g.push(A-B*H,E-z*H),g.push(A+B*M,E+z*M));continue}const xn=(-R+P)*(-T+E)-(-R+A)*(-T+S),ri=(-B+U)*(-z+E)-(-B+A)*(-z+L),Ce=(V*ri-Q*xn)/st,q=(ue*xn-$*ri)/st,re=(Ce-A)*(Ce-A)+(q-E)*(q-E),we=A+(Ce-A)*M,ce=E+(q-E)*M,ot=A-(Ce-A)*H,je=E-(q-E)*H,or=Math.min(V*V+$*$,Q*Q+ue*ue),Ze=Xt?M:H,_r=or+Ze*Ze*w;re<=_r?c.join==="bevel"||re/w>C?(Xt?(g.push(we,ce),g.push(A+R*H,E+T*H),g.push(we,ce),g.push(A+B*H,E+z*H)):(g.push(A-R*M,E-T*M),g.push(ot,je),g.push(A-B*M,E-z*M),g.push(ot,je)),x+=2):c.join==="round"?Xt?(g.push(we,ce),g.push(A+R*H,E+T*H),x+=Tn(A,E,A+R*H,E+T*H,A+B*H,E+z*H,g,!0)+4,g.push(we,ce),g.push(A+B*H,E+z*H)):(g.push(A-R*M,E-T*M),g.push(ot,je),x+=Tn(A,E,A-R*M,E-T*M,A-B*M,E-z*M,g,!1)+4,g.push(A-B*M,E-z*M),g.push(ot,je)):(g.push(we,ce),g.push(ot,je)):(g.push(A-R*M,E-T*M),g.push(A+R*H,E+T*H),c.join==="round"?Xt?x+=Tn(A,E,A+R*H,E+T*H,A+B*H,E+z*H,g,!0)+2:x+=Tn(A,E,A-R*M,E-T*M,A-B*M,E-z*M,g,!1)+2:c.join==="miter"&&re/w<=C&&(Xt?(g.push(ot,je),g.push(ot,je)):(g.push(we,ce),g.push(we,ce)),x+=2),g.push(A-B*M,E-z*M),g.push(A+B*H,E+z*H),x+=2)}P=r[(v-2)*2],S=r[(v-2)*2+1],A=r[(v-1)*2],E=r[(v-1)*2+1],R=-(S-E),T=P-A,G=Math.sqrt(R*R+T*T),R/=G,T/=G,R*=_,T*=_,g.push(A-R*M,E-T*M),g.push(A+R*H,E+T*H),p||(c.cap==="round"?x+=Tn(A-R*(M-H)*.5,E-T*(M-H)*.5,A-R*M,E-T*M,A+R*H,E+T*H,g,!1)+2:c.cap==="square"&&(x+=Bf(A,E,R,T,M,H,!1,g)));const W=If*If;for(let O=b;O<x+b-2;++O)P=g[O*2],S=g[O*2+1],A=g[(O+1)*2],E=g[(O+1)*2+1],U=g[(O+2)*2],L=g[(O+2)*2+1],!(Math.abs(P*(E-L)+A*(L-S)+U*(S-E))<W)&&a.push(O,O+1,O+2)}function iv(r,e,t,n,i,s,o){const a=kT(r,e,2);if(!a)return;for(let u=0;u<a.length;u+=3)s[o++]=a[u]+i,s[o++]=a[u+1]+i,s[o++]=a[u+2]+i;let l=i*n;for(let u=0;u<r.length;u+=2)t[l]=r[u],t[l+1]=r[u+1],l+=n}const RC=[],kC={extension:{type:F.ShapeBuilder,name:"polygon"},build(r,e){for(let t=0;t<r.points.length;t++)e[t]=r.points[t];return e},triangulate(r,e,t,n,i,s){iv(r,RC,e,t,n,i,s)}},FC={extension:{type:F.ShapeBuilder,name:"rectangle"},build(r,e){const t=r,n=t.x,i=t.y,s=t.width,o=t.height;return s>=0&&o>=0&&(e[0]=n,e[1]=i,e[2]=n+s,e[3]=i,e[4]=n+s,e[5]=i+o,e[6]=n,e[7]=i+o),e},triangulate(r,e,t,n,i,s){let o=0;n*=t,e[n+o]=r[0],e[n+o+1]=r[1],o+=t,e[n+o]=r[2],e[n+o+1]=r[3],o+=t,e[n+o]=r[6],e[n+o+1]=r[7],o+=t,e[n+o]=r[4],e[n+o+1]=r[5],o+=t;const a=n/t;i[s++]=a,i[s++]=a+1,i[s++]=a+2,i[s++]=a+1,i[s++]=a+3,i[s++]=a+2}},IC={extension:{type:F.ShapeBuilder,name:"triangle"},build(r,e){return e[0]=r.x,e[1]=r.y,e[2]=r.x2,e[3]=r.y2,e[4]=r.x3,e[5]=r.y3,e},triangulate(r,e,t,n,i,s){let o=0;n*=t,e[n+o]=r[0],e[n+o+1]=r[1],o+=t,e[n+o]=r[2],e[n+o+1]=r[3],o+=t,e[n+o]=r[4],e[n+o+1]=r[5];const a=n/t;i[s++]=a,i[s++]=a+1,i[s++]=a+2}},al={};he.handleByMap(F.ShapeBuilder,al);he.add(FC,kC,IC,qs,CC,PC);const BC=new Le;function OC(r,e){const{geometryData:t,batches:n}=e;n.length=0,t.indices.length=0,t.vertices.length=0,t.uvs.length=0;for(let i=0;i<r.instructions.length;i++){const s=r.instructions[i];if(s.action==="texture")UC(s.data,n,t);else if(s.action==="fill"||s.action==="stroke"){const o=s.action==="stroke",a=s.data.path.shapePath,l=s.data.style,u=s.data.hole;o&&u&&Of(u.shapePath,l,null,!0,n,t),Of(a,l,u,o,n,t)}}}function UC(r,e,t){const{vertices:n,uvs:i,indices:s}=t,o=s.length,a=n.length/2,l=[],u=al.rectangle,c=BC,d=r.image;c.x=r.dx,c.y=r.dy,c.width=r.dw,c.height=r.dh;const h=r.transform;u.build(c,l),h&&nv(l,h),u.triangulate(l,n,2,a,s,o);const f=d.uvs;i.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const p=Re.get(sd);p.indexOffset=o,p.indexSize=s.length-o,p.attributeOffset=a,p.attributeSize=n.length/2-a,p.baseColor=r.style,p.alpha=r.alpha,p.texture=d,p.geometryData=t,e.push(p)}function Of(r,e,t,n,i,s){const{vertices:o,uvs:a,indices:l}=s,u=r.shapePrimitives.length-1;r.shapePrimitives.forEach(({shape:c,transform:d},h)=>{const f=l.length,p=o.length/2,m=[],g=al[c.type];if(g.build(c,m),d&&nv(m,d),n){const _=c.closePath??!0;MC(m,e,!1,_,o,2,p,l)}else if(t&&u===h){u!==0&&console.warn("[Pixi Graphics] only the last shape have be cut out");const _=[],w=m.slice();DC(t.shapePath).forEach(P=>{_.push(w.length/2),w.push(...P)}),iv(w,_,o,2,p,l,f)}else g.triangulate(m,o,2,p,l,f);const v=a.length/2,x=e.texture;if(x!==te.WHITE){const _=e.matrix;_&&(d&&_.append(d.clone().invert()),yC(o,2,p,a,v,2,o.length/2-p,_))}else SC(a,v,2,o.length/2-p);const b=Re.get(sd);b.indexOffset=f,b.indexSize=l.length-f,b.attributeOffset=p,b.attributeSize=o.length/2-p,b.baseColor=e.color,b.alpha=e.alpha,b.texture=x,b.geometryData=s,i.push(b)})}function DC(r){if(!r)return[];const e=r.shapePrimitives,t=[];for(let n=0;n<e.length;n++){const i=e[n].shape,s=[];al[i.type].build(i,s),t.push(s)}return t}class GC{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class zC{constructor(){this.batcher=new id,this.instructions=new hg}init(){this.instructions.reset()}get geometry(){return J(nw,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const od=class qu{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){qu.defaultOptions.bezierSmoothness=e?.bezierSmoothness??qu.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let t=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){t?this._cleanGraphicsContextData(e):t=this._initContext(e),OC(e,t);const n=e.batchMode;e.customShader||n==="no-batch"?t.isBatchable=!1:n==="auto"&&(t.isBatchable=t.geometryData.vertices.length<400),e.dirty=!1}return t}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const t=Re.get(zC),{batches:n,geometryData:i}=this._gpuContextHash[e.uid],s=i.vertices.length,o=i.indices.length;for(let c=0;c<n.length;c++)n[c].applyTransform=!1;const a=t.batcher;a.ensureAttributeBuffer(s),a.ensureIndexBuffer(o),a.begin();for(let c=0;c<n.length;c++){const d=n[c];a.add(d)}a.finish(t.instructions);const l=a.geometry;l.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),l.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const u=a.batches;for(let c=0;c<u.length;c++){const d=u[c];d.bindGroup=Qc(d.textures.textures,d.textures.count)}return this._graphicsDataContextHash[e.uid]=t,t}_initContext(e){const t=new GC;return t.context=e,this._gpuContextHash[e.uid]=t,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const t=this._gpuContextHash[e.uid];t.isBatchable||this._graphicsDataContextHash[e.uid]&&(Re.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),t.batches&&t.batches.forEach(n=>{Re.return(n)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}};od.extension={type:[F.WebGLSystem,F.WebGPUSystem,F.CanvasSystem],name:"graphicsContext"};od.defaultOptions={bezierSmoothness:.5};let ad=od;const LC=8,Uo=11920929e-14,NC=1;function sv(r,e,t,n,i,s,o,a,l,u){const d=Math.min(.99,Math.max(0,u??ad.defaultOptions.bezierSmoothness));let h=(NC-d)/1;return h*=h,HC(e,t,n,i,s,o,a,l,r,h),r}function HC(r,e,t,n,i,s,o,a,l,u){Yu(r,e,t,n,i,s,o,a,l,u,0),l.push(o,a)}function Yu(r,e,t,n,i,s,o,a,l,u,c){if(c>LC)return;const d=(r+t)/2,h=(e+n)/2,f=(t+i)/2,p=(n+s)/2,m=(i+o)/2,g=(s+a)/2,v=(d+f)/2,x=(h+p)/2,b=(f+m)/2,_=(p+g)/2,w=(v+b)/2,C=(x+_)/2;if(c>0){let P=o-r,S=a-e;const A=Math.abs((t-o)*S-(n-a)*P),E=Math.abs((i-o)*S-(s-a)*P);if(A>Uo&&E>Uo){if((A+E)*(A+E)<=u*(P*P+S*S)){l.push(w,C);return}}else if(A>Uo){if(A*A<=u*(P*P+S*S)){l.push(w,C);return}}else if(E>Uo){if(E*E<=u*(P*P+S*S)){l.push(w,C);return}}else if(P=w-(r+o)/2,S=C-(e+a)/2,P*P+S*S<=u){l.push(w,C);return}}Yu(r,e,d,h,v,x,w,C,l,u,c+1),Yu(w,C,b,_,m,g,o,a,l,u,c+1)}const VC=8,WC=11920929e-14,jC=1;function XC(r,e,t,n,i,s,o,a){const u=Math.min(.99,Math.max(0,a??ad.defaultOptions.bezierSmoothness));let c=(jC-u)/1;return c*=c,qC(e,t,n,i,s,o,r,c),r}function qC(r,e,t,n,i,s,o,a){Ku(o,r,e,t,n,i,s,a,0),o.push(i,s)}function Ku(r,e,t,n,i,s,o,a,l){if(l>VC)return;const u=(e+n)/2,c=(t+i)/2,d=(n+s)/2,h=(i+o)/2,f=(u+d)/2,p=(c+h)/2;let m=s-e,g=o-t;const v=Math.abs((n-s)*g-(i-o)*m);if(v>WC){if(v*v<=a*(m*m+g*g)){r.push(f,p);return}}else if(m=f-(e+s)/2,g=p-(t+o)/2,m*m+g*g<=a){r.push(f,p);return}Ku(r,e,t,u,c,f,p,a,l+1),Ku(r,f,p,d,h,s,o,a,l+1)}function ov(r,e,t,n,i,s,o,a){let l=Math.abs(i-s);(!o&&i>s||o&&s>i)&&(l=2*Math.PI-l),a=a||Math.max(6,Math.floor(6*Math.pow(n,1/3)*(l/Math.PI))),a=Math.max(a,3);let u=l/a,c=i;u*=o?-1:1;for(let d=0;d<a+1;d++){const h=Math.cos(c),f=Math.sin(c),p=e+h*n,m=t+f*n;r.push(p,m),c+=u}}function YC(r,e,t,n,i,s){const o=r[r.length-2],l=r[r.length-1]-t,u=o-e,c=i-t,d=n-e,h=Math.abs(l*d-u*c);if(h<1e-8||s===0){(r[r.length-2]!==e||r[r.length-1]!==t)&&r.push(e,t);return}const f=l*l+u*u,p=c*c+d*d,m=l*c+u*d,g=s*Math.sqrt(f)/h,v=s*Math.sqrt(p)/h,x=g*m/f,b=v*m/p,_=g*d+v*u,w=g*c+v*l,C=u*(v+x),P=l*(v+x),S=d*(g+b),A=c*(g+b),E=Math.atan2(P-w,C-_),U=Math.atan2(A-w,S-_);ov(r,_+e,w+t,s,E,U,u*c>d*l)}const Ms=Math.PI*2,Ql={centerX:0,centerY:0,ang1:0,ang2:0},Jl=({x:r,y:e},t,n,i,s,o,a,l)=>{r*=t,e*=n;const u=i*r-s*e,c=s*r+i*e;return l.x=u+o,l.y=c+a,l};function KC(r,e){const t=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),n=e===1.5707963267948966?.551915024494:t,i=Math.cos(r),s=Math.sin(r),o=Math.cos(r+e),a=Math.sin(r+e);return[{x:i-s*n,y:s+i*n},{x:o+a*n,y:a-o*n},{x:o,y:a}]}const Uf=(r,e,t,n)=>{const i=r*n-e*t<0?-1:1;let s=r*t+e*n;return s>1&&(s=1),s<-1&&(s=-1),i*Math.acos(s)},$C=(r,e,t,n,i,s,o,a,l,u,c,d,h)=>{const f=Math.pow(i,2),p=Math.pow(s,2),m=Math.pow(c,2),g=Math.pow(d,2);let v=f*p-f*g-p*m;v<0&&(v=0),v/=f*g+p*m,v=Math.sqrt(v)*(o===a?-1:1);const x=v*i/s*d,b=v*-s/i*c,_=u*x-l*b+(r+t)/2,w=l*x+u*b+(e+n)/2,C=(c-x)/i,P=(d-b)/s,S=(-c-x)/i,A=(-d-b)/s,E=Uf(1,0,C,P);let U=Uf(C,P,S,A);a===0&&U>0&&(U-=Ms),a===1&&U<0&&(U+=Ms),h.centerX=_,h.centerY=w,h.ang1=E,h.ang2=U};function ZC(r,e,t,n,i,s,o,a=0,l=0,u=0){if(s===0||o===0)return;const c=Math.sin(a*Ms/360),d=Math.cos(a*Ms/360),h=d*(e-n)/2+c*(t-i)/2,f=-c*(e-n)/2+d*(t-i)/2;if(h===0&&f===0)return;s=Math.abs(s),o=Math.abs(o);const p=Math.pow(h,2)/Math.pow(s,2)+Math.pow(f,2)/Math.pow(o,2);p>1&&(s*=Math.sqrt(p),o*=Math.sqrt(p)),$C(e,t,n,i,s,o,l,u,c,d,h,f,Ql);let{ang1:m,ang2:g}=Ql;const{centerX:v,centerY:x}=Ql;let b=Math.abs(g)/(Ms/4);Math.abs(1-b)<1e-7&&(b=1);const _=Math.max(Math.ceil(b),1);g/=_;let w=r[r.length-2],C=r[r.length-1];const P={x:0,y:0};for(let S=0;S<_;S++){const A=KC(m,g),{x:E,y:U}=Jl(A[0],s,o,d,c,v,x,P),{x:L,y:R}=Jl(A[1],s,o,d,c,v,x,P),{x:T,y:B}=Jl(A[2],s,o,d,c,v,x,P);sv(r,w,C,E,U,L,R,T,B),w=T,C=B,m+=g}}function QC(r,e,t){const n=(o,a)=>{const l=a.x-o.x,u=a.y-o.y,c=Math.sqrt(l*l+u*u),d=l/c,h=u/c;return{len:c,nx:d,ny:h}},i=(o,a)=>{o===0?r.moveTo(a.x,a.y):r.lineTo(a.x,a.y)};let s=e[e.length-1];for(let o=0;o<e.length;o++){const a=e[o%e.length],l=a.radius??t;if(l<=0){i(o,a),s=a;continue}const u=e[(o+1)%e.length],c=n(a,s),d=n(a,u);if(c.len<1e-4||d.len<1e-4){i(o,a),s=a;continue}let h=Math.asin(c.nx*d.ny-c.ny*d.nx),f=1,p=!1;c.nx*d.nx-c.ny*-d.ny<0?h<0?h=Math.PI+h:(h=Math.PI-h,f=-1,p=!0):h>0&&(f=-1,p=!0);const m=h/2;let g,v=Math.abs(Math.cos(m)*l/Math.sin(m));v>Math.min(c.len/2,d.len/2)?(v=Math.min(c.len/2,d.len/2),g=Math.abs(v*Math.sin(m)/Math.cos(m))):g=l;const x=a.x+d.nx*v+-d.ny*g*f,b=a.y+d.ny*v+d.nx*g*f,_=Math.atan2(c.ny,c.nx)+Math.PI/2*f,w=Math.atan2(d.ny,d.nx)-Math.PI/2*f;o===0&&r.moveTo(x+Math.cos(_)*g,b+Math.sin(_)*g),r.arc(x,b,g,_,w,p),s=a}}function JC(r,e,t,n){const i=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),s=(a,l,u)=>({x:a.x+(l.x-a.x)*u,y:a.y+(l.y-a.y)*u}),o=e.length;for(let a=0;a<o;a++){const l=e[(a+1)%o],u=l.radius??t;if(u<=0){a===0?r.moveTo(l.x,l.y):r.lineTo(l.x,l.y);continue}const c=e[a],d=e[(a+2)%o],h=i(c,l);let f;if(h<1e-4)f=l;else{const g=Math.min(h/2,u);f=s(l,c,g/h)}const p=i(d,l);let m;if(p<1e-4)m=l;else{const g=Math.min(p/2,u);m=s(l,d,g/p)}a===0?r.moveTo(f.x,f.y):r.lineTo(f.x,f.y),r.quadraticCurveTo(l.x,l.y,m.x,m.y,n)}}const eP=new Le;class tP{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Mt,this._graphicsPath2D=e}moveTo(e,t){return this.startPoly(e,t),this}lineTo(e,t){this._ensurePoly();const n=this._currentPoly.points,i=n[n.length-2],s=n[n.length-1];return(i!==e||s!==t)&&n.push(e,t),this}arc(e,t,n,i,s,o){this._ensurePoly(!1);const a=this._currentPoly.points;return ov(a,e,t,n,i,s,o),this}arcTo(e,t,n,i,s){this._ensurePoly();const o=this._currentPoly.points;return YC(o,e,t,n,i,s),this}arcToSvg(e,t,n,i,s,o,a){const l=this._currentPoly.points;return ZC(l,this._currentPoly.lastX,this._currentPoly.lastY,o,a,e,t,n,i,s),this}bezierCurveTo(e,t,n,i,s,o,a){this._ensurePoly();const l=this._currentPoly;return sv(this._currentPoly.points,l.lastX,l.lastY,e,t,n,i,s,o,a),this}quadraticCurveTo(e,t,n,i,s){this._ensurePoly();const o=this._currentPoly;return XC(this._currentPoly.points,o.lastX,o.lastY,e,t,n,i,s),this}closePath(){return this.endPoly(!0),this}addPath(e,t){this.endPoly(),t&&!t.isIdentity()&&(e=e.clone(!0),e.transform(t));for(let n=0;n<e.instructions.length;n++){const i=e.instructions[n];this[i.action](...i.data)}return this}finish(e=!1){this.endPoly(e)}rect(e,t,n,i,s){return this.drawShape(new Le(e,t,n,i),s),this}circle(e,t,n,i){return this.drawShape(new Kc(e,t,n),i),this}poly(e,t,n){const i=new Es(e);return i.closePath=t,this.drawShape(i,n),this}regularPoly(e,t,n,i,s=0,o){i=Math.max(i|0,3);const a=-1*Math.PI/2+s,l=Math.PI*2/i,u=[];for(let c=0;c<i;c++){const d=c*l+a;u.push(e+n*Math.cos(d),t+n*Math.sin(d))}return this.poly(u,!0,o),this}roundPoly(e,t,n,i,s,o=0,a){if(i=Math.max(i|0,3),s<=0)return this.regularPoly(e,t,n,i,o);const l=n*Math.sin(Math.PI/i)-.001;s=Math.min(s,l);const u=-1*Math.PI/2+o,c=Math.PI*2/i,d=(i-2)*Math.PI/i/2;for(let h=0;h<i;h++){const f=h*c+u,p=e+n*Math.cos(f),m=t+n*Math.sin(f),g=f+Math.PI+d,v=f-Math.PI-d,x=p+s*Math.cos(g),b=m+s*Math.sin(g),_=p+s*Math.cos(v),w=m+s*Math.sin(v);h===0?this.moveTo(x,b):this.lineTo(x,b),this.quadraticCurveTo(p,m,_,w,a)}return this.closePath()}roundShape(e,t,n=!1,i){return e.length<3?this:(n?JC(this,e,t,i):QC(this,e,t),this.closePath())}filletRect(e,t,n,i,s){if(s===0)return this.rect(e,t,n,i);const o=Math.min(n,i)/2,a=Math.min(o,Math.max(-o,s)),l=e+n,u=t+i,c=a<0?-a:0,d=Math.abs(a);return this.moveTo(e,t+d).arcTo(e+c,t+c,e+d,t,d).lineTo(l-d,t).arcTo(l-c,t+c,l,t+d,d).lineTo(l,u-d).arcTo(l-c,u-c,e+n-d,u,d).lineTo(e+d,u).arcTo(e+c,u-c,e,u-d,d).closePath()}chamferRect(e,t,n,i,s,o){if(s<=0)return this.rect(e,t,n,i);const a=Math.min(s,Math.min(n,i)/2),l=e+n,u=t+i,c=[e+a,t,l-a,t,l,t+a,l,u-a,l-a,u,e+a,u,e,u-a,e,t+a];for(let d=c.length-1;d>=2;d-=2)c[d]===c[d-2]&&c[d-1]===c[d-3]&&c.splice(d-1,2);return this.poly(c,!0,o)}ellipse(e,t,n,i,s){return this.drawShape(new $c(e,t,n,i),s),this}roundRect(e,t,n,i,s,o){return this.drawShape(new Zc(e,t,n,i,s),o),this}drawShape(e,t){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:t}),this}startPoly(e,t){let n=this._currentPoly;return n&&this.endPoly(),n=new Es,n.points.push(e,t),this._currentPoly=n,this}endPoly(e=!1){const t=this._currentPoly;return t&&t.points.length>2&&(t.closePath=e,this.shapePrimitives.push({shape:t})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new Es,e)){const t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let n=t.shape.x,i=t.shape.y;if(t.transform&&!t.transform.isIdentity()){const s=t.transform,o=n;n=s.a*n+s.c*i+s.tx,i=s.b*o+s.d*i+s.ty}this._currentPoly.points.push(n,i)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let t=0;t<e.instructions.length;t++){const n=e.instructions[t];this[n.action](...n.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const t=this.shapePrimitives;for(let n=0;n<t.length;n++){const i=t[n],s=i.shape.getBounds(eP);i.transform?e.addRect(s,i.transform):e.addRect(s)}return e}}class Wi{constructor(e){this.instructions=[],this.uid=tt("graphicsPath"),this._dirty=!0,typeof e=="string"?HT(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new tP(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,t){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,t]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,t,n,i,s){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(We.shared);let l=0,u=0;if(!o||o.action!=="bezierCurveTo")l=a.x,u=a.y;else{l=o.data[2],u=o.data[3];const c=a.x,d=a.y;l=c+(c-l),u=d+(d-u)}return this.instructions.push({action:"bezierCurveTo",data:[l,u,e,t,n,i,s]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,t,n){const i=this.instructions[this.instructions.length-1],s=this.getLastPoint(We.shared);let o=0,a=0;if(!i||i.action!=="quadraticCurveTo")o=s.x,a=s.y;else{o=i.data[0],a=i.data[1];const l=s.x,u=s.y;o=l+(l-o),a=u+(u-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,e,t,n]}),this._dirty=!0,this}rect(e,t,n,i,s){return this.instructions.push({action:"rect",data:[e,t,n,i,s]}),this._dirty=!0,this}circle(e,t,n,i){return this.instructions.push({action:"circle",data:[e,t,n,i]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,t,n,i,s,o,a){s=s||i/2;const l=-1*Math.PI/2+o,u=n*2,c=Math.PI*2/u,d=[];for(let h=0;h<u;h++){const f=h%2?s:i,p=h*c+l;d.push(e+f*Math.cos(p),t+f*Math.sin(p))}return this.poly(d,!0,a),this}clone(e=!1){const t=new Wi;if(!e)t.instructions=this.instructions.slice();else for(let n=0;n<this.instructions.length;n++){const i=this.instructions[n];t.instructions.push({action:i.action,data:i.data.slice()})}return t}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const t=e.a,n=e.b,i=e.c,s=e.d,o=e.tx,a=e.ty;let l=0,u=0,c=0,d=0,h=0,f=0,p=0,m=0;for(let g=0;g<this.instructions.length;g++){const v=this.instructions[g],x=v.data;switch(v.action){case"moveTo":case"lineTo":l=x[0],u=x[1],x[0]=t*l+i*u+o,x[1]=n*l+s*u+a;break;case"bezierCurveTo":c=x[0],d=x[1],h=x[2],f=x[3],l=x[4],u=x[5],x[0]=t*c+i*d+o,x[1]=n*c+s*d+a,x[2]=t*h+i*f+o,x[3]=n*h+s*f+a,x[4]=t*l+i*u+o,x[5]=n*l+s*u+a;break;case"quadraticCurveTo":c=x[0],d=x[1],l=x[2],u=x[3],x[0]=t*c+i*d+o,x[1]=n*c+s*d+a,x[2]=t*l+i*u+o,x[3]=n*l+s*u+a;break;case"arcToSvg":l=x[5],u=x[6],p=x[0],m=x[1],x[0]=t*p+i*m,x[1]=n*p+s*m,x[5]=t*l+i*u+o,x[6]=n*l+s*u+a;break;case"circle":x[4]=ps(x[3],e);break;case"rect":x[4]=ps(x[4],e);break;case"ellipse":x[8]=ps(x[8],e);break;case"roundRect":x[5]=ps(x[5],e);break;case"addPath":x[0].transform(e);break;case"poly":x[2]=ps(x[2],e);break;default:de("unknown transform action",v.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let t=this.instructions.length-1,n=this.instructions[t];if(!n)return e.x=0,e.y=0,e;for(;n.action==="closePath";){if(t--,t<0)return e.x=0,e.y=0,e;n=this.instructions[t]}switch(n.action){case"moveTo":case"lineTo":e.x=n.data[0],e.y=n.data[1];break;case"quadraticCurveTo":e.x=n.data[2],e.y=n.data[3];break;case"bezierCurveTo":e.x=n.data[4],e.y=n.data[5];break;case"arc":case"arcToSvg":e.x=n.data[5],e.y=n.data[6];break;case"addPath":n.data[0].getLastPoint(e);break}return e}}function ps(r,e){return r?r.prepend(e):e.clone()}function rP(r,e){if(typeof r=="string"){const n=document.createElement("div");n.innerHTML=r.trim(),r=n.querySelector("svg")}const t={context:e,path:new Wi};return av(r,t,null,null),e}function av(r,e,t,n){const i=r.children,{fillStyle:s,strokeStyle:o}=nP(r);s&&t?t={...t,...s}:s&&(t=s),o&&n?n={...n,...o}:o&&(n=o),e.context.fillStyle=t,e.context.strokeStyle=n;let a,l,u,c,d,h,f,p,m,g,v,x,b,_,w,C,P;switch(r.nodeName.toLowerCase()){case"path":_=r.getAttribute("d"),w=new Wi(_),e.context.path(w),t&&e.context.fill(),n&&e.context.stroke();break;case"circle":f=ct(r,"cx",0),p=ct(r,"cy",0),m=ct(r,"r",0),e.context.ellipse(f,p,m,m),t&&e.context.fill(),n&&e.context.stroke();break;case"rect":a=ct(r,"x",0),l=ct(r,"y",0),C=ct(r,"width",0),P=ct(r,"height",0),g=ct(r,"rx",0),v=ct(r,"ry",0),g||v?e.context.roundRect(a,l,C,P,g||v):e.context.rect(a,l,C,P),t&&e.context.fill(),n&&e.context.stroke();break;case"ellipse":f=ct(r,"cx",0),p=ct(r,"cy",0),g=ct(r,"rx",0),v=ct(r,"ry",0),e.context.beginPath(),e.context.ellipse(f,p,g,v),t&&e.context.fill(),n&&e.context.stroke();break;case"line":u=ct(r,"x1",0),c=ct(r,"y1",0),d=ct(r,"x2",0),h=ct(r,"y2",0),e.context.beginPath(),e.context.moveTo(u,c),e.context.lineTo(d,h),n&&e.context.stroke();break;case"polygon":b=r.getAttribute("points"),x=b.match(/\d+/g).map(S=>parseInt(S,10)),e.context.poly(x,!0),t&&e.context.fill(),n&&e.context.stroke();break;case"polyline":b=r.getAttribute("points"),x=b.match(/\d+/g).map(S=>parseInt(S,10)),e.context.poly(x,!1),n&&e.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${r.nodeName}> elements unsupported`);break}}for(let S=0;S<i.length;S++)av(i[S],e,t,n)}function ct(r,e,t){const n=r.getAttribute(e);return n?Number(n):t}function nP(r){const e=r.getAttribute("style"),t={},n={};let i=!1,s=!1;if(e){const o=e.split(";");for(let a=0;a<o.length;a++){const l=o[a],[u,c]=l.split(":");switch(u){case"stroke":c!=="none"&&(t.color=pe.shared.setValue(c).toNumber(),s=!0);break;case"stroke-width":t.width=Number(c);break;case"fill":c!=="none"&&(i=!0,n.color=pe.shared.setValue(c).toNumber());break;case"fill-opacity":n.alpha=Number(c);break;case"stroke-opacity":t.alpha=Number(c);break;case"opacity":n.alpha=Number(c),t.alpha=Number(c);break}}}else{const o=r.getAttribute("stroke");o&&o!=="none"&&(s=!0,t.color=pe.shared.setValue(o).toNumber(),t.width=ct(r,"stroke-width",1));const a=r.getAttribute("fill");a&&a!=="none"&&(i=!0,n.color=pe.shared.setValue(a).toNumber())}return{strokeStyle:s?t:null,fillStyle:i?n:null}}function iP(r){return pe.isColorLike(r)}function Df(r){return r instanceof ol}function Gf(r){return r instanceof js}function sP(r,e,t){const n=pe.shared.setValue(e??0);return r.color=n.toNumber(),r.alpha=n.alpha===1?t.alpha:n.alpha,r.texture=te.WHITE,{...t,...r}}function zf(r,e,t){return r.fill=e,r.color=16777215,r.texture=e.texture,r.matrix=e.transform,{...t,...r}}function Lf(r,e,t){return e.buildLinearGradient(),r.fill=e,r.color=16777215,r.texture=e.texture,r.matrix=e.transform,{...t,...r}}function oP(r,e){const t={...e,...r};if(t.texture){if(t.texture!==te.WHITE){const s=t.matrix?.invert()||new ae;s.translate(t.texture.frame.x,t.texture.frame.y),s.scale(1/t.texture.source.width,1/t.texture.source.height),t.matrix=s}const i=t.texture.source.style;i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update())}const n=pe.shared.setValue(t.color);return t.alpha*=n.alpha,t.color=n.toNumber(),t.matrix=t.matrix?t.matrix.clone():null,t}function Bn(r,e){if(r==null)return null;const t={},n=r;return iP(r)?sP(t,r,e):Df(r)?zf(t,r,e):Gf(r)?Lf(t,r,e):n.fill&&Df(n.fill)?zf(n,n.fill,e):n.fill&&Gf(n.fill)?Lf(n,n.fill,e):oP(n,e)}function Fa(r,e){const{width:t,alignment:n,miterLimit:i,cap:s,join:o,...a}=e,l=Bn(r,a);return l?{width:t,alignment:n,miterLimit:i,cap:s,join:o,...l}:null}const aP=new We,Nf=new ae,ld=class Cr extends jt{constructor(){super(...arguments),this.uid=tt("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Wi,this._transform=new ae,this._fillStyle={...Cr.defaultFillStyle},this._strokeStyle={...Cr.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Mt,this._boundsDirty=!0}clone(){const e=new Cr;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=Bn(e,Cr.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Fa(e,Cr.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=Bn(e,Cr.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=Bn(e,Cr.defaultStrokeStyle),this}texture(e,t,n,i,s,o){return this.instructions.push({action:"texture",data:{image:e,dx:n||0,dy:i||0,dw:s||e.frame.width,dh:o||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:t?pe.shared.setValue(t).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Wi,this}fill(e,t){let n;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="stroke"?n=i.data.path:n=this._activePath.clone(),n?(e!=null&&(t!==void 0&&typeof e=="number"&&(J(Me,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:t}),this._fillStyle=Bn(e,Cr.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:t}=this._activePath.getLastPoint(We.shared);this._activePath.clear(),this._activePath.moveTo(e,t)}stroke(e){let t;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="fill"?t=n.data.path:t=this._activePath.clone(),t?(e!=null&&(this._strokeStyle=Fa(e,Cr.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:t}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const t=this.instructions[this.instructions.length-1-e],n=this._activePath.clone();if(t&&(t.action==="stroke"||t.action==="fill"))if(t.data.hole)t.data.hole.addPath(n);else{t.data.hole=n;break}}return this._initNextPathLocation(),this}arc(e,t,n,i,s,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*e+a.c*t+a.tx,a.b*e+a.d*t+a.ty,n,i,s,o),this}arcTo(e,t,n,i,s){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*e+o.c*t+o.tx,o.b*e+o.d*t+o.ty,o.a*n+o.c*i+o.tx,o.b*n+o.d*i+o.ty,s),this}arcToSvg(e,t,n,i,s,o,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,t,n,i,s,l.a*o+l.c*a+l.tx,l.b*o+l.d*a+l.ty),this}bezierCurveTo(e,t,n,i,s,o,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*t+l.tx,l.b*e+l.d*t+l.ty,l.a*n+l.c*i+l.tx,l.b*n+l.d*i+l.ty,l.a*s+l.c*o+l.tx,l.b*s+l.d*o+l.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,t,n,i){return this._tick++,this._activePath.ellipse(e,t,n,i,this._transform.clone()),this}circle(e,t,n){return this._tick++,this._activePath.circle(e,t,n,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,t){this._tick++;const n=this._transform;return this._activePath.lineTo(n.a*e+n.c*t+n.tx,n.b*e+n.d*t+n.ty),this}moveTo(e,t){this._tick++;const n=this._transform,i=this._activePath.instructions,s=n.a*e+n.c*t+n.tx,o=n.b*e+n.d*t+n.ty;return i.length===1&&i[0].action==="moveTo"?(i[0].data[0]=s,i[0].data[1]=o,this):(this._activePath.moveTo(s,o),this)}quadraticCurveTo(e,t,n,i,s){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*e+o.c*t+o.tx,o.b*e+o.d*t+o.ty,o.a*n+o.c*i+o.tx,o.b*n+o.d*i+o.ty,s),this}rect(e,t,n,i){return this._tick++,this._activePath.rect(e,t,n,i,this._transform.clone()),this}roundRect(e,t,n,i,s){return this._tick++,this._activePath.roundRect(e,t,n,i,s,this._transform.clone()),this}poly(e,t){return this._tick++,this._activePath.poly(e,t,this._transform.clone()),this}regularPoly(e,t,n,i,s=0,o){return this._tick++,this._activePath.regularPoly(e,t,n,i,s,o),this}roundPoly(e,t,n,i,s,o){return this._tick++,this._activePath.roundPoly(e,t,n,i,s,o),this}roundShape(e,t,n,i){return this._tick++,this._activePath.roundShape(e,t,n,i),this}filletRect(e,t,n,i,s){return this._tick++,this._activePath.filletRect(e,t,n,i,s),this}chamferRect(e,t,n,i,s,o){return this._tick++,this._activePath.chamferRect(e,t,n,i,s,o),this}star(e,t,n,i,s=0,o=0){return this._tick++,this._activePath.star(e,t,n,i,s,o,this._transform.clone()),this}svg(e){return this._tick++,rP(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,t=e){return this._transform.scale(e,t),this}setTransform(e,t,n,i,s,o){return e instanceof ae?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,t,n,i,s,o),this)}transform(e,t,n,i,s,o){return e instanceof ae?(this._transform.append(e),this):(Nf.set(e,t,n,i,s,o),this._transform.append(Nf),this)}translate(e,t=e){return this._transform.translate(e,t),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const e=this._bounds;e.clear();for(let t=0;t<this.instructions.length;t++){const n=this.instructions[t],i=n.action;if(i==="fill"){const s=n.data;e.addBounds(s.path.bounds)}else if(i==="texture"){const s=n.data;e.addFrame(s.dx,s.dy,s.dx+s.dw,s.dy+s.dh,s.transform)}if(i==="stroke"){const s=n.data,o=s.style.width/2,a=s.path.bounds;e.addFrame(a.minX-o,a.minY-o,a.maxX+o,a.maxY+o)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const t=this.instructions;let n=!1;for(let i=0;i<t.length;i++){const s=t[i],o=s.data,a=o.path;if(!s.action||!a)continue;const l=o.style,u=a.shapePath.shapePrimitives;for(let c=0;c<u.length;c++){const d=u[c].shape;if(!l||!d)continue;const h=u[c].transform,f=h?h.applyInverse(e,aP):e;s.action==="fill"?n=d.contains(f.x,f.y):n=d.strokeContains(f.x,f.y,l.width);const p=o.hole;if(p){const m=p.shapePath?.shapePrimitives;if(m)for(let g=0;g<m.length;g++)m[g].shape.contains(f.x,f.y)&&(n=!1)}if(n)return!0}}return n}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(n),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(n)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};ld.defaultFillStyle={color:16777215,alpha:1,texture:te.WHITE,matrix:null,fill:null};ld.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:te.WHITE,matrix:null,fill:null};let $t=ld;const Hf=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function lv(r){const e=[];let t=0;for(let n=0;n<Hf.length;n++){const i=`_${Hf[n]}`;e[t++]=r[i]}return t=uv(r._fill,e,t),t=lP(r._stroke,e,t),t=uP(r.dropShadow,e,t),e.join("-")}function uv(r,e,t){return r&&(e[t++]=r.color,e[t++]=r.alpha,e[t++]=r.fill?.styleKey),t}function lP(r,e,t){return r&&(t=uv(r,e,t),e[t++]=r.width,e[t++]=r.alignment,e[t++]=r.cap,e[t++]=r.join,e[t++]=r.miterLimit),t}function uP(r,e,t){return r&&(e[t++]=r.alpha,e[t++]=r.angle,e[t++]=r.blur,e[t++]=r.distance,e[t++]=pe.shared.setValue(r.color).toNumber()),t}const ud=class fi extends jt{constructor(e={}){super(),cP(e);const t={...fi.defaultTextStyle,...e};for(const n in t){const i=n;this[i]=t[n]}this.update()}get align(){return this._align}set align(e){this._align=e,this.update()}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords=e,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...fi.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...fi.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e,this.update()}get fontSize(){return this._fontSize}set fontSize(e){typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e,this.update()}get leading(){return this._leading}set leading(e){this._leading=e,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing=e,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e,this.update()}get padding(){return this._padding}set padding(e){this._padding=e,this.update()}get trim(){return this._trim}set trim(e){this._trim=e,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace=e,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap=e,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth=e,this.update()}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...$t.defaultFillStyle,...e},()=>{this._fill=Bn({...this._originalFill},$t.defaultFillStyle)})),this._fill=Bn(e===0?"black":e,$t.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...$t.defaultStrokeStyle,...e},()=>{this._stroke=Fa({...this._originalStroke},$t.defaultStrokeStyle)})),this._stroke=Fa(e,$t.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=lv(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=fi.defaultTextStyle;for(const t in e)this[t]=e[t]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new fi({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(n),this._originalFill?.texture&&this._originalFill.texture.destroy(n),this._stroke?.texture&&this._stroke.texture.destroy(n),this._originalStroke?.texture&&this._originalStroke.texture.destroy(n)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,t){return new Proxy(e,{set:(n,i,s)=>(n[i]=s,t?.(i,s),this.update(),!0)})}_isFillStyle(e){return(e??null)!==null&&!(pe.isColorLike(e)||e instanceof js||e instanceof ol)}};ud.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};ud.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Yr=ud;function cP(r){const e=r;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const t=Yr.defaultDropShadow;r.dropShadow={alpha:e.dropShadowAlpha??t.alpha,angle:e.dropShadowAngle??t.angle,blur:e.dropShadowBlur??t.blur,color:e.dropShadowColor??t.color,distance:e.dropShadowDistance??t.distance}}if(e.strokeThickness!==void 0){J(Me,"strokeThickness is now a part of stroke");const t=e.stroke;let n={};if(pe.isColorLike(t))n.color=t;else if(t instanceof js||t instanceof ol)n.fill=t;else if(Object.hasOwnProperty.call(t,"color")||Object.hasOwnProperty.call(t,"fill"))n=t;else throw new Error("Invalid stroke value.");r.stroke={...n,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){J(Me,"gradient fill is now a fill pattern: `new FillGradient(...)`");let t;r.fontSize==null?r.fontSize=Yr.defaultTextStyle.fontSize:typeof r.fontSize=="string"?t=parseInt(r.fontSize,10):t=r.fontSize;const n=new js(0,0,0,t*1.7),i=e.fillGradientStops.map(s=>pe.shared.setValue(s).toNumber());i.forEach((s,o)=>{const a=o/(i.length-1);n.addColorStop(a,s)}),r.fill={fill:n}}}class dP{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,t){const n=Ee.get().createCanvas();n.width=e,n.height=t;const i=n.getContext("2d");return{canvas:n,context:i}}getOptimalCanvasAndContext(e,t,n=1){e=Math.ceil(e*n-1e-6),t=Math.ceil(t*n-1e-6),e=Hi(e),t=Hi(t);const i=(e<<17)+(t<<1);this._canvasPool[i]||(this._canvasPool[i]=[]);let s=this._canvasPool[i].pop();return s||(s=this._createCanvasAndContext(e,t)),s}returnCanvasAndContext(e){const t=e.canvas,{width:n,height:i}=t,s=(n<<17)+(i<<1);e.context.clearRect(0,0,n,i),this._canvasPool[s].push(e)}clear(){this._canvasPool={}}}const Wr=new dP,hP=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Ia(r){const e=typeof r.fontSize=="number"?`${r.fontSize}px`:r.fontSize;let t=r.fontFamily;Array.isArray(r.fontFamily)||(t=r.fontFamily.split(","));for(let n=t.length-1;n>=0;n--){let i=t[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!hP.includes(i)&&(i=`"${i}"`),t[n]=i}return`${r.fontStyle} ${r.fontVariant} ${r.fontWeight} ${e} ${t.join(",")}`}const eu={willReadFrequently:!0},br=class se{static get experimentalLetterSpacingSupported(){let e=se._experimentalLetterSpacingSupported;if(e!==void 0){const t=Ee.get().getCanvasRenderingContext2D().prototype;e=se._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,n,i,s,o,a,l,u){this.text=e,this.style=t,this.width=n,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=u}static measureText(e=" ",t,n=se._canvas,i=t.wordWrap){const s=`${e}:${t.styleKey}`;if(se._measurementCache[s])return se._measurementCache[s];const o=Ia(t),a=se.measureFont(o);a.fontSize===0&&(a.fontSize=t.fontSize,a.ascent=t.fontSize);const l=se.__context;l.font=o;const c=(i?se._wordWrap(e,t,n):e).split(/(?:\r\n|\r|\n)/),d=new Array(c.length);let h=0;for(let x=0;x<c.length;x++){const b=se._measureText(c[x],t.letterSpacing,l);d[x]=b,h=Math.max(h,b)}const f=t._stroke?.width||0;let p=h+f;t.dropShadow&&(p+=t.dropShadow.distance);const m=t.lineHeight||a.fontSize;let g=Math.max(m,a.fontSize+f)+(c.length-1)*(m+t.leading);return t.dropShadow&&(g+=t.dropShadow.distance),new se(e,t,p,g,c,d,m+t.leading,h,a)}static _measureText(e,t,n){let i=!1;se.experimentalLetterSpacingSupported&&(se.experimentalLetterSpacing?(n.letterSpacing=`${t}px`,n.textLetterSpacing=`${t}px`,i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));const s=n.measureText(e);let o=s.width;const a=-s.actualBoundingBoxLeft;let u=s.actualBoundingBoxRight-a;if(o>0)if(i)o-=t,u-=t;else{const c=(se.graphemeSegmenter(e).length-1)*t;o+=c,u+=c}return Math.max(o,u)}static _wordWrap(e,t,n=se._canvas){const i=n.getContext("2d",eu);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:u,whiteSpace:c}=t,d=se._collapseSpaces(c),h=se._collapseNewlines(c);let f=!d;const p=t.wordWrapWidth+u,m=se._tokenize(e);for(let g=0;g<m.length;g++){let v=m[g];if(se._isNewline(v)){if(!h){a+=se._addLine(o),f=!d,o="",s=0;continue}v=" "}if(d){const b=se.isBreakingSpace(v),_=se.isBreakingSpace(o[o.length-1]);if(b&&_)continue}const x=se._getFromCache(v,u,l,i);if(x>p)if(o!==""&&(a+=se._addLine(o),o="",s=0),se.canBreakWords(v,t.breakWords)){const b=se.wordWrapSplit(v);for(let _=0;_<b.length;_++){let w=b[_],C=w,P=1;for(;b[_+P];){const A=b[_+P];if(!se.canBreakChars(C,A,v,_,t.breakWords))w+=A;else break;C=A,P++}_+=P-1;const S=se._getFromCache(w,u,l,i);S+s>p&&(a+=se._addLine(o),f=!1,o="",s=0),o+=w,s+=S}}else{o.length>0&&(a+=se._addLine(o),o="",s=0);const b=g===m.length-1;a+=se._addLine(v,!b),f=!1,o="",s=0}else x+s>p&&(f=!1,a+=se._addLine(o),o="",s=0),(o.length>0||!se.isBreakingSpace(v)||f)&&(o+=v,s+=x)}return a+=se._addLine(o,!1),a}static _addLine(e,t=!0){return e=se._trimRight(e),e=t?`${e}
`:e,e}static _getFromCache(e,t,n,i){let s=n[e];return typeof s!="number"&&(s=se._measureText(e,t,i)+t,n[e]=s),s}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const n=e[t];if(!se.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:se._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:se._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const t=[];let n="";if(typeof e!="string")return t;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(se.isBreakingSpace(s,o)||se._isNewline(s)){n!==""&&(t.push(n),n=""),t.push(s);continue}n+=s}return n!==""&&t.push(n),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,n,i,s){return!0}static wordWrapSplit(e){return se.graphemeSegmenter(e)}static measureFont(e){if(se._fonts[e])return se._fonts[e];const t=se._context;t.font=e;const n=t.measureText(se.METRICS_STRING+se.BASELINE_SYMBOL),i={ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,fontSize:n.actualBoundingBoxAscent+n.actualBoundingBoxDescent};return se._fonts[e]=i,i}static clearMetrics(e=""){e?delete se._fonts[e]:se._fonts={}}static get _canvas(){if(!se.__canvas){let e;try{const t=new OffscreenCanvas(0,0);if(t.getContext("2d",eu)?.measureText)return se.__canvas=t,t;e=Ee.get().createCanvas()}catch{e=Ee.get().createCanvas()}e.width=e.height=10,se.__canvas=e}return se.__canvas}static get _context(){return se.__context||(se.__context=se._canvas.getContext("2d",eu)),se.__context}};br.METRICS_STRING="|ÉqÅ";br.BASELINE_SYMBOL="M";br.BASELINE_MULTIPLIER=1.4;br.HEIGHT_MULTIPLIER=2;br.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const r=new Intl.Segmenter;return e=>[...r.segment(e)].map(t=>t.segment)}return r=>[...r]})();br.experimentalLetterSpacing=!1;br._fonts={};br._newlines=[10,13];br._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];br._measurementCache={};let St=br;function Ba(r,e){if(r.texture===te.WHITE&&!r.fill)return pe.shared.setValue(r.color).setAlpha(r.alpha??1).toHexa();if(r.fill){if(r.fill instanceof ol){const t=r.fill,n=e.createPattern(t.texture.source.resource,"repeat"),i=t.transform.copyTo(ae.shared);return i.scale(t.texture.frame.width,t.texture.frame.height),n.setTransform(i),n}else if(r.fill instanceof js){const t=r.fill;if(t.type==="linear"){const n=e.createLinearGradient(t.x0,t.y0,t.x1,t.y1);return t.gradientStops.forEach(i=>{n.addColorStop(i.offset,pe.shared.setValue(i.color).toHex())}),n}}}else{const t=e.createPattern(r.texture.source.resource,"repeat"),n=r.matrix.copyTo(ae.shared);return n.scale(r.texture.frame.width,r.texture.frame.height),t.setTransform(n),t}return de("FillStyle not recognised",r),"red"}function cv(r){if(r==="")return[];typeof r=="string"&&(r=[r]);const e=[];for(let t=0,n=r.length;t<n;t++){const i=r[t];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);if(i[0].length===0||i[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...Array.from(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const dv=class hv extends qg{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const t={...hv.defaultOptions,...e};this._textureSize=t.textureSize,this._mipmap=t.mipmap;const n=t.style.clone();t.overrideFill&&(n._fill.color=16777215,n._fill.alpha=1,n._fill.texture=te.WHITE,n._fill.fill=null),this.applyFillAsTint=t.overrideFill;const i=n.fontSize;n.fontSize=this.baseMeasurementFontSize;const s=Ia(n);t.overrideSize?n._stroke&&(n._stroke.width*=this.baseRenderedFontSize/i):n.fontSize=this.baseRenderedFontSize=i,this._style=n,this._skipKerning=t.skipKerning??!1,this.resolution=t.resolution??1,this._padding=t.padding??4,this.fontMetrics=St.measureFont(s),this.lineHeight=n.lineHeight||this.fontMetrics.fontSize||n.fontSize}ensureCharacters(e){const t=cv(e).filter(p=>!this._currentChars.includes(p)).filter((p,m,g)=>g.indexOf(p)===m);if(!t.length)return;this._currentChars=[...this._currentChars,...t];let n;this._currentPageIndex===-1?n=this._nextPage():n=this.pages[this._currentPageIndex];let{canvas:i,context:s}=n.canvasAndContext,o=n.texture.source;const a=this._style;let l=this._currentX,u=this._currentY;const c=this.baseRenderedFontSize/this.baseMeasurementFontSize,d=this._padding*c;let h=0,f=!1;for(let p=0;p<t.length;p++){const m=t[p],g=St.measureText(m,a,i,!1),v=Math.ceil((a.fontStyle==="italic"?2:1)*g.width);g.lineHeight=g.height;const x=g.width*c,b=g.height*c,_=v+d*2,w=b+d*2;if(f=!1,m!==`
`&&m!=="\r"&&m!=="	"&&m!==" "&&(f=!0,h=Math.ceil(Math.max(w,h))),l+_>this._textureSize&&(u+=h,h=w,l=0,u+h>this._textureSize)){o.update();const P=this._nextPage();i=P.canvasAndContext.canvas,s=P.canvasAndContext.context,o=P.texture.source,u=0}const C=x/c-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[m]={id:m.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:C,kerning:{}},f){this._drawGlyph(s,g,l+d,u+d,c,a);const P=o.width*c,S=o.height*c,A=new Le(l/P*o.width,u/S*o.height,_/P*o.width,w/S*o.height);this.chars[m].texture=new te({source:o,frame:A}),l+=Math.ceil(_)}}o.update(),this._currentX=l,this._currentY=u,this._skipKerning&&this._applyKerning(t,s)}get pageTextures(){return J(Me,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,t){const n=this._measureCache;for(let i=0;i<e.length;i++){const s=e[i];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let l=n[s];l||(l=n[s]=t.measureText(s).width);let u=n[a];u||(u=n[a]=t.measureText(a).width);let c=t.measureText(s+a).width,d=c-(l+u);d&&(this.chars[s].kerning[a]=d),c=t.measureText(s+a).width,d=c-(l+u),d&&(this.chars[a].kerning[s]=d)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,t=Wr.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(t.context,this._style,e);const n=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),i=new te({source:new ei({resource:t.canvas,resolution:n,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),s={canvasAndContext:t,texture:i};return this.pages[this._currentPageIndex]=s,s}_setupContext(e,t,n){t.fontSize=this.baseRenderedFontSize,e.scale(n,n),e.font=Ia(t),t.fontSize=this.baseMeasurementFontSize,e.textBaseline=t.textBaseline;const i=t._stroke,s=i?.width??0;if(i&&(e.lineWidth=s,e.lineJoin=i.join,e.miterLimit=i.miterLimit,e.strokeStyle=Ba(i,e)),t._fill&&(e.fillStyle=Ba(t._fill,e)),t.dropShadow){const o=t.dropShadow,a=pe.shared.setValue(o.color).toArray(),l=o.blur*n,u=o.distance*n;e.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,e.shadowBlur=l,e.shadowOffsetX=Math.cos(o.angle)*u,e.shadowOffsetY=Math.sin(o.angle)*u}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,t,n,i,s,o){const a=t.text,l=t.fontProperties,c=(o._stroke?.width??0)*s,d=n+c/2,h=i-c/2,f=l.descent*s,p=t.lineHeight*s;o.stroke&&c&&e.strokeText(a,d,h+p-f),o._fill&&e.fillText(a,d,h+p-f)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:t,texture:n}=this.pages[e];Wr.returnCanvasAndContext(t),n.destroy(!0)}this.pages=null}};dv.defaultOptions={textureSize:512,style:new Yr,mipmap:!0};let Vf=dv;function fv(r,e,t,n){const i={width:0,height:0,offsetY:0,scale:e.fontSize/t.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};i.offsetY=t.baseLineOffset;let s=i.lines[0],o=null,a=!0;const l={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},u=p=>{const m=s.width;for(let g=0;g<l.index;g++){const v=p.positions[g];s.chars.push(p.chars[g]),s.charPositions.push(v+m)}s.width+=p.width,a=!1,l.width=0,l.index=0,l.chars.length=0},c=()=>{let p=s.chars.length-1;if(n){let m=s.chars[p];for(;m===" ";)s.width-=t.chars[m].xAdvance,m=s.chars[--p]}i.width=Math.max(i.width,s.width),s={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,i.lines.push(s),i.height+=t.lineHeight},d=t.baseMeasurementFontSize/e.fontSize,h=e.letterSpacing*d,f=e.wordWrapWidth*d;for(let p=0;p<r.length+1;p++){let m;const g=p===r.length;g||(m=r[p]);const v=t.chars[m]||t.chars[" "];if(/(?:\s)/.test(m)||m==="\r"||m===`
`||g){if(!a&&e.wordWrap&&s.width+l.width-h>f?(c(),u(l),g||s.charPositions.push(0)):(l.start=s.width,u(l),g||s.charPositions.push(0)),m==="\r"||m===`
`)s.width!==0&&c();else if(!g){const w=v.xAdvance+(v.kerning[o]||0)+h;s.width+=w,s.spaceWidth=w,s.spacesIndex.push(s.charPositions.length),s.chars.push(m)}}else{const _=v.kerning[o]||0,w=v.xAdvance+_+h;l.positions[l.index++]=l.width+_,l.chars.push(m),l.width+=w}o=m}return c(),e.align==="center"?fP(i):e.align==="right"?pP(i):e.align==="justify"&&mP(i),i}function fP(r){for(let e=0;e<r.lines.length;e++){const t=r.lines[e],n=r.width/2-t.width/2;for(let i=0;i<t.charPositions.length;i++)t.charPositions[i]+=n}}function pP(r){for(let e=0;e<r.lines.length;e++){const t=r.lines[e],n=r.width-t.width;for(let i=0;i<t.charPositions.length;i++)t.charPositions[i]+=n}}function mP(r){const e=r.width;for(let t=0;t<r.lines.length;t++){const n=r.lines[t];let i=0,s=n.spacesIndex[i++],o=0;const a=n.spacesIndex.length,u=(e-n.width)/a;for(let c=0;c<n.charPositions.length;c++)c===s&&(s=n.spacesIndex[i++],o+=u),n.charPositions[c]+=o}}let Do=0;class gP{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(e,t){let n=`${t.fontFamily}-bitmap`,i=!0;if(t._fill.fill&&!t._stroke)n+=t._fill.fill.styleKey,i=!1;else if(t._stroke||t.dropShadow){let o=t.styleKey;o=o.substring(0,o.lastIndexOf("-")),n=`${o}-bitmap`,i=!1}if(!Xe.has(n)){const o=new Vf({style:t,overrideFill:i,overrideSize:!0,...this.defaultOptions});Do++,Do>50&&de("BitmapText",`You have dynamically created ${Do} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{Do--,Xe.remove(n)}),Xe.set(n,o)}const s=Xe.get(n);return s.ensureCharacters?.(e),s}getLayout(e,t,n=!0){const i=this.getFont(e,t);return fv([...e],t,i,n)}measureText(e,t,n=!0){return this.getLayout(e,t,n)}install(...e){let t=e[0];typeof t=="string"&&(t={name:t,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},J(Me,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const n=t?.name;if(!n)throw new Error("[BitmapFontManager] Property `name` is required.");t={...this.defaultOptions,...t};const i=t.style,s=i instanceof Yr?i:new Yr(i),o=s._fill.fill!==null&&s._fill.fill!==void 0,a=new Vf({style:s,overrideFill:o,skipKerning:t.skipKerning,padding:t.padding,resolution:t.resolution,overrideSize:!1}),l=cv(t.chars);return a.ensureCharacters(l.join("")),Xe.set(`${n}-bitmap`,a),a.once("destroy",()=>Xe.remove(`${n}-bitmap`)),a}uninstall(e){const t=`${e}-bitmap`,n=Xe.get(t);n&&n.destroy()}}const $u=new gP;class pv extends qg{constructor(e,t){super();const{textures:n,data:i}=e;Object.keys(i.pages).forEach(s=>{const o=i.pages[parseInt(s,10)],a=n[o.id];this.pages.push({texture:a})}),Object.keys(i.chars).forEach(s=>{const o=i.chars[s],{frame:a,source:l}=n[o.page],u=new Le(o.x+a.x,o.y+a.y,o.width,o.height),c=new te({source:l,frame:u});this.chars[s]={id:s.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:c}}),this.baseRenderedFontSize=i.fontSize,this.baseMeasurementFontSize=i.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:i.fontSize},this.baseLineOffset=i.baseLineOffset,this.lineHeight=i.lineHeight,this.fontFamily=i.fontFamily,this.distanceField=i.distanceField??{type:"none",range:0},this.url=t}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:t}=this.pages[e];t.destroy(!0)}this.pages=null}static install(e){$u.install(e)}static uninstall(e){$u.uninstall(e)}}const tu={test(r){return typeof r=="string"&&r.startsWith("info face=")},parse(r){const e=r.match(/^[a-z]+\s+.+$/gm),t={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const d in e){const h=e[d].match(/^[a-z]+/gm)[0],f=e[d].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const m in f){const g=f[m].split("="),v=g[0],x=g[1].replace(/"/gm,""),b=parseFloat(x),_=isNaN(b)?x:b;p[v]=_}t[h].push(p)}const n={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[i]=t.info,[s]=t.common,[o]=t.distanceField??[];o&&(n.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),n.fontSize=parseInt(i.size,10),n.fontFamily=i.face,n.lineHeight=parseInt(s.lineHeight,10);const a=t.page;for(let d=0;d<a.length;d++)n.pages.push({id:parseInt(a[d].id,10)||0,file:a[d].file});const l={};n.baseLineOffset=n.lineHeight-parseInt(s.base,10);const u=t.char;for(let d=0;d<u.length;d++){const h=u[d],f=parseInt(h.id,10);let p=h.letter??h.char??String.fromCharCode(f);p==="space"&&(p=" "),l[f]=p,n.chars[p]={id:f,page:parseInt(h.page,10)||0,x:parseInt(h.x,10),y:parseInt(h.y,10),width:parseInt(h.width,10),height:parseInt(h.height,10),xOffset:parseInt(h.xoffset,10),yOffset:parseInt(h.yoffset,10),xAdvance:parseInt(h.xadvance,10),kerning:{}}}const c=t.kerning||[];for(let d=0;d<c.length;d++){const h=parseInt(c[d].first,10),f=parseInt(c[d].second,10),p=parseInt(c[d].amount,10);n.chars[l[f]].kerning[l[h]]=p}return n}},Wf={test(r){const e=r;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(r){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},t=r.getElementsByTagName("info")[0],n=r.getElementsByTagName("common")[0],i=r.getElementsByTagName("distanceField")[0];i&&(e.distanceField={type:i.getAttribute("fieldType"),range:parseInt(i.getAttribute("distanceRange"),10)});const s=r.getElementsByTagName("page"),o=r.getElementsByTagName("char"),a=r.getElementsByTagName("kerning");e.fontSize=parseInt(t.getAttribute("size"),10),e.fontFamily=t.getAttribute("face"),e.lineHeight=parseInt(n.getAttribute("lineHeight"),10);for(let u=0;u<s.length;u++)e.pages.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});const l={};e.baseLineOffset=e.lineHeight-parseInt(n.getAttribute("base"),10);for(let u=0;u<o.length;u++){const c=o[u],d=parseInt(c.getAttribute("id"),10);let h=c.getAttribute("letter")??c.getAttribute("char")??String.fromCharCode(d);h==="space"&&(h=" "),l[d]=h,e.chars[h]={id:d,page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xOffset:parseInt(c.getAttribute("xoffset"),10),yOffset:parseInt(c.getAttribute("yoffset"),10),xAdvance:parseInt(c.getAttribute("xadvance"),10),kerning:{}}}for(let u=0;u<a.length;u++){const c=parseInt(a[u].getAttribute("first"),10),d=parseInt(a[u].getAttribute("second"),10),h=parseInt(a[u].getAttribute("amount"),10);e.chars[l[d]].kerning[l[c]]=h}return e}},jf={test(r){return typeof r=="string"&&r.includes("<font>")?Wf.test(Ee.get().parseXML(r)):!1},parse(r){return Wf.parse(Ee.get().parseXML(r))}},vP=[".xml",".fnt"],xP={extension:{type:F.CacheParser,name:"cacheBitmapFont"},test:r=>r instanceof pv,getCacheableAssets(r,e){const t={};return r.forEach(n=>{t[n]=e,t[`${n}-bitmap`]=e}),t[`${e.fontFamily}-bitmap`]=e,t}},bP={extension:{type:F.LoadParser,priority:gn.Normal},name:"loadBitmapFont",test(r){return vP.includes(Nt.extname(r).toLowerCase())},async testParse(r){return tu.test(r)||jf.test(r)},async parse(r,e,t){const n=tu.test(r)?tu.parse(r):jf.parse(r),{src:i}=e,{pages:s}=n,o=[],a=n.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let d=0;d<s.length;++d){const h=s[d].file;let f=Nt.join(Nt.dirname(i),h);f=Ou(f,i),o.push({src:f,data:a})}const l=await t.load(o),u=o.map(d=>l[d.src]);return new pv({data:n,textures:u},i)},async load(r,e){return await(await Ee.get().fetch(r)).text()},async unload(r,e,t){await Promise.all(r.pages.map(n=>t.unload(n.texture.source._sourceOrigin))),r.destroy()}};class _P{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<t;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const yP={extension:{type:F.CacheParser,name:"cacheTextureArray"},test:r=>Array.isArray(r)&&r.every(e=>e instanceof te),getCacheableAssets:(r,e)=>{const t={};return r.forEach(n=>{e.forEach((i,s)=>{t[n+(s===0?"":s+1)]=i})}),t}};async function mv(r){if("Image"in globalThis)return new Promise(e=>{const t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(r)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const SP={extension:{type:F.DetectionParser,priority:1},test:async()=>mv("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async r=>[...r,"avif"],remove:async r=>r.filter(e=>e!=="avif")},Xf=["png","jpg","jpeg"],wP={extension:{type:F.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...Xf],remove:async r=>r.filter(e=>!Xf.includes(e))},TP="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function cd(r){return TP?!1:document.createElement("video").canPlayType(r)!==""}const CP={extension:{type:F.DetectionParser,priority:0},test:async()=>cd("video/mp4"),add:async r=>[...r,"mp4","m4v"],remove:async r=>r.filter(e=>e!=="mp4"&&e!=="m4v")},PP={extension:{type:F.DetectionParser,priority:0},test:async()=>cd("video/ogg"),add:async r=>[...r,"ogv"],remove:async r=>r.filter(e=>e!=="ogv")},AP={extension:{type:F.DetectionParser,priority:0},test:async()=>cd("video/webm"),add:async r=>[...r,"webm"],remove:async r=>r.filter(e=>e!=="webm")},EP={extension:{type:F.DetectionParser,priority:0},test:async()=>mv("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async r=>[...r,"webp"],remove:async r=>r.filter(e=>e!=="webp")};class MP{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,n)=>(this._parsersValidated=!1,e[t]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const n={promise:null,parser:null};return n.promise=(async()=>{let i=null,s=null;if(t.loadParser&&(s=this._parserHash[t.loadParser],s||de(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!s){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(e,t,this)){s=a;break}}if(!s)return de(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,t,this),n.parser=s;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(i,t,this)&&(i=await a.parse(i,t,this)||i,n.parser=a)}return i})(),n}async load(e,t){this._parsersValidated||this._validateParsers();let n=0;const i={},s=Ra(e),o=fr(e,u=>({alias:[u],src:u,data:{}})),a=o.length,l=o.map(async u=>{const c=Nt.toAbsolute(u.src);if(!i[u.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,u)),i[u.src]=await this.promiseCache[c].promise,t&&t(++n/a)}catch(d){throw delete this.promiseCache[c],delete i[u.src],new Error(`[Loader.load] Failed to load ${c}.
${d}`)}});return await Promise.all(l),s?i[o[0].src]:i}async unload(e){const n=fr(e,i=>({alias:[i],src:i})).map(async i=>{const s=Nt.toAbsolute(i.src),o=this.promiseCache[s];if(o){const a=await o.promise;delete this.promiseCache[s],await o.parser?.unload?.(a,i,this)}});await Promise.all(n)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,t)=>(t.name?e[t.name]&&de(`[Assets] loadParser name conflict "${t.name}"`):de("[Assets] loadParser should have a name"),{...e,[t.name]:t}),{})}}function os(r,e){if(Array.isArray(e)){for(const t of e)if(r.startsWith(`data:${t}`))return!0;return!1}return r.startsWith(`data:${e}`)}function as(r,e){const t=r.split("?")[0],n=Nt.extname(t).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const RP=".json",kP="application/json",FP={extension:{type:F.LoadParser,priority:gn.Low},name:"loadJson",test(r){return os(r,kP)||as(r,RP)},async load(r){return await(await Ee.get().fetch(r)).json()}},IP=".txt",BP="text/plain",OP={name:"loadTxt",extension:{type:F.LoadParser,priority:gn.Low,name:"loadTxt"},test(r){return os(r,BP)||as(r,IP)},async load(r){return await(await Ee.get().fetch(r)).text()}},UP=["normal","bold","100","200","300","400","500","600","700","800","900"],DP=[".ttf",".otf",".woff",".woff2"],GP=["font/ttf","font/otf","font/woff","font/woff2"],zP=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function LP(r){const e=Nt.extname(r),i=Nt.basename(r,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let s=i.length>0;for(const a of i)if(!a.match(zP)){s=!1;break}let o=i.join(" ");return s||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const NP=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function HP(r){return NP.test(r)?r:encodeURI(r)}const VP={extension:{type:F.LoadParser,priority:gn.Low},name:"loadWebFont",test(r){return os(r,GP)||as(r,DP)},async load(r,e){const t=Ee.get().getFontFaceSet();if(t){const n=[],i=e.data?.family??LP(r),s=e.data?.weights?.filter(a=>UP.includes(a))??["normal"],o=e.data??{};for(let a=0;a<s.length;a++){const l=s[a],u=new FontFace(i,`url(${HP(r)})`,{...o,weight:l});await u.load(),t.add(u),n.push(u)}return Xe.set(`${i}-and-url`,{url:r,fontFaces:n}),n.length===1?n[0]:n}return de("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){(Array.isArray(r)?r:[r]).forEach(e=>{Xe.remove(e.family),Ee.get().getFontFaceSet().delete(e)})}};function dd(r,e=1){const t=is.RETINA_PREFIX?.exec(r);return t?parseFloat(t[1]):e}function hd(r,e,t){r.label=t,r._sourceOrigin=t;const n=new te({source:r,label:t}),i=()=>{delete e.promiseCache[t],Xe.has(t)&&Xe.remove(t)};return n.source.once("destroy",()=>{e.promiseCache[t]&&(de("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),i())}),n.once("destroy",()=>{r.destroyed||(de("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),n}const WP=".svg",jP="image/svg+xml",XP={extension:{type:F.LoadParser,priority:gn.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(r){return os(r,jP)||as(r,WP)},async load(r,e,t){return e.data.parseAsGraphicsContext??this.config.parseAsGraphicsContext?YP(r):qP(r,e,t,this.config.crossOrigin)},unload(r){r.destroy(!0)}};async function qP(r,e,t,n){const s=await(await Ee.get().fetch(r)).blob(),o=URL.createObjectURL(s),a=new Image;a.src=o,a.crossOrigin=n,await a.decode(),URL.revokeObjectURL(o);const l=document.createElement("canvas"),u=l.getContext("2d"),c=e.data?.resolution||dd(r),d=e.data?.width??a.width,h=e.data?.height??a.height;l.width=d*c,l.height=h*c,u.drawImage(a,0,0,d*c,h*c);const{parseAsGraphicsContext:f,...p}=e.data,m=new ei({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:c,...p});return hd(m,t,r)}async function YP(r){const t=await(await Ee.get().fetch(r)).text(),n=new $t;return n.svg(t),n}const KP=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let Mi=null,Zu=class{constructor(){Mi||(Mi=URL.createObjectURL(new Blob([KP],{type:"application/javascript"}))),this.worker=new Worker(Mi)}};Zu.revokeObjectURL=function(){Mi&&(URL.revokeObjectURL(Mi),Mi=null)};const $P=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Ri=null;class gv{constructor(){Ri||(Ri=URL.createObjectURL(new Blob([$P],{type:"application/javascript"}))),this.worker=new Worker(Ri)}}gv.revokeObjectURL=function(){Ri&&(URL.revokeObjectURL(Ri),Ri=null)};let qf=0,ru;class ZP{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:t}=new Zu;t.addEventListener("message",n=>{t.terminate(),Zu.revokeObjectURL(),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,t){return this._run("loadImageBitmap",[e,t?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){ru===void 0&&(ru=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<ru&&(this._createdWorkers++,e=new gv().worker,e.addEventListener("message",t=>{this._complete(t.data),this._returnWorker(t.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const n=new Promise((i,s)=>{this._queue.push({id:e,arguments:t,resolve:i,reject:s})});return this._next(),n}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const t=this._queue.pop(),n=t.id;this._resolveHash[qf]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:qf++,id:n})}}const Yf=new ZP,QP=[".jpeg",".jpg",".png",".webp",".avif"],JP=["image/jpeg","image/png","image/webp","image/avif"];async function eA(r,e){const t=await Ee.get().fetch(r);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${t.status} ${t.statusText}`);const n=await t.blob();return e?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(n,{premultiplyAlpha:"none"}):createImageBitmap(n)}const vv={name:"loadTextures",extension:{type:F.LoadParser,priority:gn.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(r){return os(r,JP)||as(r,QP)},async load(r,e,t){let n=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Yf.isImageBitmapSupported()?n=await Yf.loadImageBitmap(r,e):n=await eA(r,e):n=await new Promise(s=>{n=new Image,n.crossOrigin=this.config.crossOrigin,n.src=r,n.complete?s(n):n.onload=()=>{s(n)}});const i=new ei({resource:n,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||dd(r),...e.data});return hd(i,t,r)},unload(r){r.destroy(!0)}},xv=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],tA=xv.map(r=>`video/${r.substring(1)}`);function rA(r,e,t){t===void 0&&!e.startsWith("data:")?r.crossOrigin=iA(e):t!==!1&&(r.crossOrigin=typeof t=="string"?t:"anonymous")}function nA(r){return new Promise((e,t)=>{r.addEventListener("canplaythrough",n),r.addEventListener("error",i),r.load();function n(){s(),e()}function i(o){s(),t(o)}function s(){r.removeEventListener("canplaythrough",n),r.removeEventListener("error",i)}})}function iA(r,e=globalThis.location){if(r.startsWith("data:"))return"";e=e||globalThis.location;const t=new URL(r,document.baseURI);return t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol?"anonymous":""}const sA={name:"loadVideo",extension:{type:F.LoadParser,name:"loadVideo"},test(r){const e=os(r,tA),t=as(r,xv);return e||t},async load(r,e,t){const n={...qo.defaultOptions,resolution:e.data?.resolution||dd(r),alphaMode:e.data?.alphaMode||await _g(),...e.data},i=document.createElement("video"),s={preload:n.autoLoad!==!1?"auto":void 0,"webkit-playsinline":n.playsinline!==!1?"":void 0,playsinline:n.playsinline!==!1?"":void 0,muted:n.muted===!0?"":void 0,loop:n.loop===!0?"":void 0,autoplay:n.autoPlay!==!1?"":void 0};Object.keys(s).forEach(l=>{const u=s[l];u!==void 0&&i.setAttribute(l,u)}),n.muted===!0&&(i.muted=!0),rA(i,r,n.crossorigin);const o=document.createElement("source");let a;if(r.startsWith("data:"))a=r.slice(5,r.indexOf(";"));else if(!r.startsWith("blob:")){const l=r.split("?")[0].slice(r.lastIndexOf(".")+1).toLowerCase();a=qo.MIME_TYPES[l]||`video/${l}`}return o.src=r,a&&(o.type=a),new Promise(l=>{const u=async()=>{const c=new qo({...n,resource:i});i.removeEventListener("canplay",u),e.data.preload&&await nA(i),l(hd(c,t,r))};i.addEventListener("canplay",u),i.appendChild(o)})},unload(r){r.destroy(!0)}},bv={extension:{type:F.ResolveParser,name:"resolveTexture"},test:vv.test,parse:r=>({resolution:parseFloat(is.RETINA_PREFIX.exec(r)?.[1]??"1"),format:r.split(".").pop(),src:r})},oA={extension:{type:F.ResolveParser,priority:-2,name:"resolveJson"},test:r=>is.RETINA_PREFIX.test(r)&&r.endsWith(".json"),parse:bv.parse};class aA{constructor(){this._detections=[],this._initialized=!1,this.resolver=new is,this.loader=new MP,this.cache=Xe,this._backgroundLoader=new _P(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){de("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let s=e.manifest;typeof s=="string"&&(s=await this.load(s)),this.resolver.addManifest(s)}const t=e.texturePreference?.resolution??1,n=typeof t=="number"?[t]:t,i=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:n}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,t){this._initialized||await this.init();const n=Ra(e),i=fr(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(u=>!this.resolver.hasKey(u))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,t);return n?o[i[0]]:o}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let a=0,l=0;const u=()=>{t?.(++a/l)},c=o.map(d=>{const h=i[d];return l+=Object.keys(h).length,this._mapLoadToResolve(h,u).then(f=>{s[d]=f})});return await Promise.all(c),n?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Xe.get(e);const t={};for(let n=0;n<e.length;n++)t[n]=Xe.get(e[n]);return t}async _mapLoadToResolve(e,t){const n=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const i=await this.loader.load(n,t);this._backgroundLoader.active=!0;const s={};return n.forEach(o=>{const a=i[o.src],l=[o.src];o.alias&&l.push(...o.alias),l.forEach(u=>{s[u]=a}),Xe.set(l,a)}),s}async unload(e){this._initialized||await this.init();const t=fr(e).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(t);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=fr(e);const t=this.resolver.resolveBundle(e),n=Object.keys(t).map(i=>this._unloadFromResolved(t[i]));await Promise.all(n)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(n=>{Xe.remove(n.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const n of e.detections)e.skipDetections||await n.test()?t=await n.add(t):e.skipDetections||(t=await n.remove(t));return t=t.filter((n,i)=>t.indexOf(n)===i),t}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(n=>n in e).forEach(n=>{t.config[n]=e[n]})})}}const ws=new aA;he.handleByList(F.LoadParser,ws.loader.parsers).handleByList(F.ResolveParser,ws.resolver.parsers).handleByList(F.CacheParser,ws.cache.parsers).handleByList(F.DetectionParser,ws.detections);he.add(yP,wP,SP,EP,CP,PP,AP,FP,OP,VP,XP,vv,sA,bP,xP,bv,oA);const Kf={loader:F.LoadParser,resolver:F.ResolveParser,cache:F.CacheParser,detection:F.DetectionParser};he.handle(F.Asset,r=>{const e=r.ref;Object.entries(Kf).filter(([t])=>!!e[t]).forEach(([t,n])=>he.add(Object.assign(e[t],{extension:e[t].extension??n})))},r=>{const e=r.ref;Object.keys(Kf).filter(t=>!!e[t]).forEach(t=>he.remove(e[t]))});class lA{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this._tickerAdded||!this.domElement||(Er.system.add(this._tickerUpdate,this,Ls.INTERACTION),this._tickerAdded=!0)}removeTickerListener(){this._tickerAdded&&(Er.system.remove(this._tickerUpdate,this),this._tickerAdded=!1)}pointerMoved(){this._didMove=!0}_update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events._rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY,pointerType:e.pointerType,pointerId:e.pointerId}))}_tickerUpdate(e){this._deltaTime+=e.deltaTime,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this._update())}}const Jr=new lA;class Oa extends so{constructor(){super(...arguments),this.client=new We,this.movement=new We,this.offset=new We,this.global=new We,this.screen=new We}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,n){return e.worldTransform.applyInverse(n||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,n,i,s,o,a,l,u,c,d,h,f,p,m){throw new Error("Method not implemented.")}}class cr extends Oa{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class ji extends Oa{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}ji.DOM_DELTA_PIXEL=0;ji.DOM_DELTA_LINE=1;ji.DOM_DELTA_PAGE=2;const uA=2048,cA=new We,ms=new We;class dA{constructor(e){this.dispatch=new jt,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((n,i)=>n.priority-i.priority)}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const t=this.mappingTable[e.type];if(t)for(let n=0,i=t.length;n<i;n++)t[n].fn(e);else de(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){Jr.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",s=this[i](this.rootTarget,this.rootTarget.eventMode,cA.set(e,t),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(e,t){if(!e.target)return;const n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=n.length-1;i<s;i++)if(e.currentTarget=n[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=n.length-2;i>=0;i--)if(e.currentTarget=n[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,n=this._allInteractiveElements){if(n.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(t)?t:[t];for(let s=n.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=n[s],this.notifyTarget(e,o)})}propagationPath(e){const t=[e];for(let n=0;n<uA&&e!==this.rootTarget&&e.parent;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestMoveRecursive(e,t,n,i,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&(Jr.pauseUpdate=!1),e.interactiveChildren&&e.children){const c=e.children;for(let d=c.length-1;d>=0;d--){const h=c[d],f=this.hitTestMoveRecursive(h,this._isInteractive(t)?t:h.eventMode,n,i,s,o||s(e,n));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=e.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(e),f.push(e)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const l=this._isInteractive(t),u=e.isInteractive();return u&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,n)&&i(e,n)?u?[e]:[]:null}hitTestRecursive(e,t,n,i,s){if(this._interactivePrune(e)||s(e,n))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&(Jr.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children,u=n;for(let c=l.length-1;c>=0;c--){const d=l[c],h=this.hitTestRecursive(d,this._isInteractive(t)?t:d.eventMode,u,i,s);if(h){if(h.length>0&&!h[h.length-1].parent)continue;const f=e.isInteractive();return(h.length>0||f)&&h.push(e),h}}}const o=this._isInteractive(t),a=e.isInteractive();return o&&i(e,n)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!e||!e.visible||!e.renderable||!e.includeInBuild||!e.measurable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren}hitPruneFn(e,t){if(e.hitArea&&(e.worldTransform.applyInverse(t,ms),!e.hitArea.contains(ms.x,ms.y)))return!0;if(e.effects&&e.effects.length)for(let n=0;n<e.effects.length;n++){const i=e.effects[n];if(i.containsPoint&&!i.containsPoint(t,this.hitTestFn))return!0}return!1}hitTestFn(e,t){return e.hitArea?!0:e?.containsPoint?(e.worldTransform.applyInverse(t,ms),e.containsPoint(ms)):!1}notifyTarget(e,t){if(!e.currentTarget.isInteractive())return;t=t??e.type;const n=`on${t}`;e.currentTarget[n]?.(e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this._notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this._notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof cr)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),t.pointerType==="touch")this.dispatchEvent(t,"touchstart");else if(t.pointerType==="mouse"||t.pointerType==="pen"){const i=t.button===2;this.dispatchEvent(t,i?"rightdown":"mousedown")}const n=this.trackingData(e.pointerId);n.pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){if(!(e instanceof cr)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const n=t.pointerType==="mouse"||t.pointerType==="pen",i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(i.overTargets?.length>0&&s!==t.target){const l=e.type==="mousemove"?"mouseout":"pointerout",u=this.createPointerEvent(e,l,s);if(this.dispatchEvent(u,"pointerout"),n&&this.dispatchEvent(u,"mouseout"),!t.composedPath().includes(s)){const c=this.createPointerEvent(e,"pointerleave",s);for(c.eventPhase=c.AT_TARGET;c.target&&!t.composedPath().includes(c.target);)c.currentTarget=c.target,this.notifyTarget(c),n&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(u)}if(s!==t.target){const l=e.type==="mousemove"?"mouseover":"pointerover",u=this.clonePointerEvent(t,l);this.dispatchEvent(u,"pointerover"),n&&this.dispatchEvent(u,"mouseover");let c=s?.parent;for(;c&&c!==this.rootTarget.parent&&c!==t.target;)c=c.parent;if(!c||c===this.rootTarget.parent){const h=this.clonePointerEvent(t,"pointerenter");for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==s&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),n&&this.notifyTarget(h,"mouseenter"),h.target=h.target.parent;this.freeEvent(h)}this.freeEvent(u)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(t,"pointermove"),a&&o.push("globalpointermove"),t.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),a&&o.push("globaltouchmove")),n&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),a&&o.push("globalmousemove"),this.cursor=t.target?.cursor),o.length>0&&this.all(t,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){if(!(e instanceof cr)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),n=this.createPointerEvent(e),i=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=n.target?.cursor);const s=this.clonePointerEvent(n,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;t.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof cr)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId);if(t.overTargets){const n=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(t.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),n&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;t.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof cr)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=performance.now(),n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const a=n.button===2;this.dispatchEvent(n,a?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!n.composedPath().includes(s)){let a=s;for(;a&&!n.composedPath().includes(a);){if(n.currentTarget=a,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const l=n.button===2;this.notifyTarget(n,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(n,"click");a.target=o,a.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:t});const l=i.clicksByButton[e.button];if(l.target===a.target&&t-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=t,a.detail=l.clickCount,a.pointerType==="mouse"){const u=a.button===2;this.dispatchEvent(a,u?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(n)}mapPointerUpOutside(e){if(!(e instanceof cr)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),n=this.findMountedTarget(t.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(n){let s=n;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof ji)){de("EventBoundary cannot map a non-wheel event as a wheel event");return}const t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let n=1;n<e.length&&e[n].parent===t;n++)t=e[n];return t}createPointerEvent(e,t,n){const i=this.allocateEvent(cr);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=n??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof t=="string"&&(i.type=t),i}createWheelEvent(e){const t=this.allocateEvent(ji);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){const n=this.allocateEvent(cr);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=t??n.type,n}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof cr&&t instanceof cr&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof Oa&&t instanceof Oa&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.defaultPrevented=!1,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}_notifyListeners(e,t){const n=e.currentTarget._events[t];if(n)if("fn"in n)n.once&&e.currentTarget.removeListener(t,n.fn,void 0,!0),n.fn.call(n.context,e);else for(let i=0,s=n.length;i<s&&!e.propagationImmediatelyStopped;i++)n[i].once&&e.currentTarget.removeListener(t,n[i].fn,void 0,!0),n[i].fn.call(n[i].context,e)}}const hA=1,fA={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},fd=class Qu{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new dA(null),Jr.init(this),this.autoPreventDefault=!0,this._eventsAdded=!1,this._rootPointerEvent=new cr(null),this._rootWheelEvent=new ji(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Qu.defaultEventFeatures},{set:(t,n,i)=>(n==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),t[n]=i,!0)}),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerUp=this._onPointerUp.bind(this),this._onPointerOverOut=this._onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{canvas:t,resolution:n}=this.renderer;this.setTargetElement(t),this.resolution=n,Qu._defaultEventMode=e.eventMode??"passive",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null,this._currentCursor=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this._currentCursor===e)return;this._currentCursor=e;const n=this.cursorStyles[e];if(n)switch(typeof n){case"string":t&&(this.domElement.style.cursor=n);break;case"function":n(e);break;case"object":t&&Object.assign(this.domElement.style,n);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this._rootPointerEvent}_onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this._normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let n=0,i=t.length;n<i;n++){const s=t[n],o=this._bootstrapEvent(this._rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}_onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Jr.pointerMoved();const t=this._normalizeToPointerData(e);for(let n=0,i=t.length;n<i;n++){const s=this._bootstrapEvent(this._rootPointerEvent,t[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}_onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const n=t!==this.domElement?"outside":"",i=this._normalizeToPointerData(e);for(let s=0,o=i.length;s<o;s++){const a=this._bootstrapEvent(this._rootPointerEvent,i[s]);a.type+=n,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}_onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this._normalizeToPointerData(e);for(let n=0,i=t.length;n<i;n++){const s=this._bootstrapEvent(this._rootPointerEvent,t[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this._removeEvents(),this.domElement=e,Jr.domElement=e,this._addEvents()}_addEvents(){if(this._eventsAdded||!this.domElement)return;Jr.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this._onPointerMove,!0),this.domElement.addEventListener("pointerdown",this._onPointerDown,!0),this.domElement.addEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this._onPointerOverOut,!0),globalThis.addEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this._onPointerMove,!0),this.domElement.addEventListener("mousedown",this._onPointerDown,!0),this.domElement.addEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this._onPointerOverOut,!0),globalThis.addEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this._onPointerDown,!0),this.domElement.addEventListener("touchend",this._onPointerUp,!0),this.domElement.addEventListener("touchmove",this._onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this._eventsAdded=!0}_removeEvents(){if(!this._eventsAdded||!this.domElement)return;Jr.removeTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction="")),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this._onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this._onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this._onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this._onPointerMove,!0),this.domElement.removeEventListener("mousedown",this._onPointerDown,!0),this.domElement.removeEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this._onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this._onPointerDown,!0),this.domElement.removeEventListener("touchend",this._onPointerUp,!0),this.domElement.removeEventListener("touchmove",this._onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this._eventsAdded=!1}mapPositionToPoint(e,t,n){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(t-i.left)*(this.domElement.width/i.width)*s,e.y=(n-i.top)*(this.domElement.height/i.height)*s}_normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let n=0,i=e.changedTouches.length;n<i;n++){const s=e.changedTouches[n];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,t.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const n=e;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=hA),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,t.push(n)}else t.push(e);return t}normalizeWheelEvent(e){const t=this._rootWheelEvent;return this._transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}_bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this._transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=fA[e.type]||e.type),e}_transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};fd.extension={name:"events",type:[F.WebGLSystem,F.CanvasSystem,F.WebGPUSystem],priority:-1};fd.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let _v=fd;const pA={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,get interactive(){return this.eventMode==="dynamic"||this.eventMode==="static"},set interactive(r){this.eventMode=r?"static":"passive"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??_v.defaultEventMode},set eventMode(r){this._internalEventMode=r},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(r,e,t){const n=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,i=typeof t=="object"?t.signal:void 0,s=typeof t=="object"?t.once===!0:!1,o=typeof e=="function"?void 0:e;r=n?`${r}capture`:r;const a=typeof e=="function"?e:e.handleEvent,l=this;i&&i.addEventListener("abort",()=>{l.off(r,a,o)}),s?l.once(r,a,o):l.on(r,a,o)},removeEventListener(r,e,t){const n=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,i=typeof e=="function"?void 0:e;r=n?`${r}capture`:r,e=typeof e=="function"?e:e.handleEvent,this.off(r,e,i)},dispatchEvent(r){if(!(r instanceof so))throw new Error("Container cannot propagate events outside of the Federated Events API");return r.defaultPrevented=!1,r.path=null,r.target=this,r.manager.dispatchEvent(r),!r.defaultPrevented}};var mA=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,gA=`
in vec2 vTextureCoord;

out vec4 finalColor;

uniform float uAlpha;
uniform sampler2D uTexture;

void main()
{
    finalColor =  texture(uTexture, vTextureCoord) * uAlpha;
}
`,$f=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct AlphaUniforms {
  uAlpha:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> alphaUniforms : AlphaUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
 
    var sample = textureSample(uTexture, uSampler, uv);
    
    return sample * alphaUniforms.uAlpha;
}`;const yv=class Sv extends _e{constructor(e){e={...Sv.defaultOptions,...e};const t=me.from({vertex:{source:$f,entryPoint:"mainVertex"},fragment:{source:$f,entryPoint:"mainFragment"}}),n=be.from({vertex:mA,fragment:gA,name:"alpha-filter"}),{alpha:i,...s}=e,o=new _t({uAlpha:{value:i,type:"f32"}});super({...s,gpuProgram:t,glProgram:n,resources:{alphaUniforms:o}})}get alpha(){return this.resources.alphaUniforms.uniforms.uAlpha}set alpha(e){this.resources.alphaUniforms.uniforms.uAlpha=e}};yv.defaultOptions={alpha:1};let vA=yv,xA=0;class bA{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1}createTexture(e,t,n){const i=new lt({...this.textureOptions,width:e,height:t,resolution:1,antialias:n,autoGarbageCollect:!0});return new te({source:i,label:`texturePool_${xA++}`})}getOptimalTexture(e,t,n=1,i){let s=Math.ceil(e*n-1e-6),o=Math.ceil(t*n-1e-6);s=Hi(s),o=Hi(o);const a=(s<<17)+(o<<1)+(i?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(s,o,i)),l.source._resolution=n,l.source.width=s/n,l.source.height=o/n,l.source.pixelWidth=s,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=t,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(e,t=!1){const n=e.source;return this.getOptimalTexture(e.width,e.height,n._resolution,t)}returnTexture(e){const t=this._poolKeyHash[e.uid];this._texturePool[t].push(e)}clear(e){if(e=e!==!1,e)for(const t in this._texturePool){const n=this._texturePool[t];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this._texturePool={}}}const Ge=new bA,wv={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},_A=["in vec2 vBlurTexCoords[%size%];","uniform sampler2D uTexture;","out vec4 finalColor;","void main(void)","{","    finalColor = vec4(0.0);","    %blur%","}"].join(`
`);function yA(r){const e=wv[r],t=e.length;let n=_A,i="";const s="finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<r;a++){let l=s.replace("%index%",a.toString());o=a,a>=t&&(o=r-a-1),l=l.replace("%value%",e[o].toString()),i+=l,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",r.toString()),n}const SA=`
    in vec2 aPosition;

    uniform float uStrength;

    out vec2 vBlurTexCoords[%size%];

    uniform vec4 uInputSize;
    uniform vec4 uOutputFrame;
    uniform vec4 uOutputTexture;

    vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

    vec2 filterTextureCoord( void )
    {
        return aPosition * (uOutputFrame.zw * uInputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        float pixelStrength = uInputSize.%dimension% * uStrength;

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function wA(r,e){const t=Math.ceil(r/2);let n=SA,i="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);";for(let o=0;o<r;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(t-1)}.0`),i+=a,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",r.toString()),n=n.replace("%dimension%",e?"z":"w"),n}function TA(r,e){const t=wA(e,r),n=yA(e);return be.from({vertex:t,fragment:n,name:`blur-${r?"horizontal":"vertical"}-pass-filter`})}var CA=`

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlurUniforms {
  uStrength:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    %blur-struct%
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}


@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {

  let filteredCord = filterTextureCoord(aPosition);

  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;

  return VSOutput(
   filterVertexPosition(aPosition),
    %blur-vertex-out%
  );
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  %blur-fragment-in%
) -> @location(0) vec4<f32> {

    var   finalColor = vec4(0.0);

    %blur-sampling%

    return finalColor;
}`;function PA(r,e){const t=wv[e],n=t.length,i=[],s=[],o=[];for(let d=0;d<e;d++){i[d]=`@location(${d}) offset${d}: vec2<f32>,`,r?s[d]=`filteredCord + vec2(${d-n+1} * pixelStrength, 0.0),`:s[d]=`filteredCord + vec2(0.0, ${d-n+1} * pixelStrength),`;const h=d<n?d:e-d-1,f=t[h].toString();o[d]=`finalColor += textureSample(uTexture, uSampler, offset${d}) * ${f};`}const a=i.join(`
`),l=s.join(`
`),u=o.join(`
`),c=CA.replace("%blur-struct%",a).replace("%blur-vertex-out%",l).replace("%blur-fragment-in%",a).replace("%blur-sampling%",u).replace("%dimension%",r?"z":"w");return me.from({vertex:{source:c,entryPoint:"mainVertex"},fragment:{source:c,entryPoint:"mainFragment"}})}const Tv=class Cv extends _e{constructor(e){e={...Cv.defaultOptions,...e};const t=TA(e.horizontal,e.kernelSize),n=PA(e.horizontal,e.kernelSize);super({glProgram:t,gpuProgram:n,resources:{blurUniforms:{uStrength:{value:0,type:"f32"}}},...e}),this.horizontal=e.horizontal,this._quality=0,this.quality=e.quality,this.blur=e.strength,this._uniforms=this.resources.blurUniforms.uniforms}apply(e,t,n,i){if(this._uniforms.uStrength=this.strength/this.passes,this.passes===1)e.applyFilter(this,t,n,i);else{const s=Ge.getSameSizeTexture(t);let o=t,a=s;this._state.blend=!1;const l=e.renderer.type===Wt.WEBGPU;for(let u=0;u<this.passes-1;u++){e.applyFilter(this,o,a,u===0?!0:l);const c=a;a=o,o=c}this._state.blend=!0,e.applyFilter(this,o,n,i),Ge.returnTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}};Tv.defaultOptions={strength:8,quality:4,kernelSize:5};let Rs=Tv;class er extends _e{constructor(...e){let t=e[0]??{};typeof t=="number"&&(J(Me,"BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }"),t={strength:t},e[1]!==void 0&&(t.quality=e[1]),e[2]!==void 0&&(t.resolution=e[2]||"inherit"),e[3]!==void 0&&(t.kernelSize=e[3])),t={...Rs.defaultOptions,...t};const{strength:n,strengthX:i,strengthY:s,quality:o,...a}=t;super({...a,compatibleRenderers:Wt.BOTH,resources:{}}),this._repeatEdgePixels=!1,this.blurXFilter=new Rs({horizontal:!0,...t}),this.blurYFilter=new Rs({horizontal:!1,...t}),this.quality=o,this.strengthX=i??n,this.strengthY=s??n,this.repeatEdgePixels=!1}apply(e,t,n,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=Ge.getSameSizeTexture(t);this.blurXFilter.blendMode="normal",this.blurXFilter.apply(e,t,a,!0),this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,a,n,i),Ge.returnTexture(a)}else o?(this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,t,n,i)):(this.blurXFilter.blendMode=this.blendMode,this.blurXFilter.apply(e,t,n,i))}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.blur),Math.abs(this.blurYFilter.blur))*2}get strength(){if(this.strengthX!==this.strengthY)throw new Error("BlurFilter's strengthX and strengthY are different");return this.strengthX}set strength(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get strengthX(){return this.blurXFilter.blur}set strengthX(e){this.blurXFilter.blur=e,this.updatePadding()}get strengthY(){return this.blurYFilter.blur}set strengthY(e){this.blurYFilter.blur=e,this.updatePadding()}get blur(){return J("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength}set blur(e){J("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength=e}get blurX(){return J("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX}set blurX(e){J("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX=e}get blurY(){return J("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY}set blurY(e){J("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}er.defaultOptions={strength:8,quality:4,kernelSize:5};class Pv{constructor(e){this._renderer=e}push(e,t,n){this._renderer.renderPipes.batch.break(n),n.add({renderPipeId:"filter",canBundle:!1,action:"pushFilter",container:t,filterEffect:e})}pop(e,t,n){this._renderer.renderPipes.batch.break(n),n.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}execute(e){e.action==="pushFilter"?this._renderer.filter.push(e):e.action==="popFilter"&&this._renderer.filter.pop()}destroy(){this._renderer=null}}Pv.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"filter"};const AA=new ae;function EA(r,e){return e.clear(),Av(r,e),e.isValid||e.set(0,0,0,0),r.renderGroup?e.applyMatrix(r.renderGroup.localTransform):e.applyMatrix(r.parentRenderGroup.worldTransform),e}function Av(r,e){if(r.localDisplayStatus!==7||!r.measurable)return;const t=!!r.effects.length;let n=e;if((r.renderGroup||t)&&(n=Hr.get().clear()),r.boundsArea)e.addRect(r.boundsArea,r.worldTransform);else{if(r.renderPipeId){const s=r.bounds;n.addFrame(s.minX,s.minY,s.maxX,s.maxY,r.groupTransform)}const i=r.children;for(let s=0;s<i.length;s++)Av(i[s],n)}if(t){let i=!1;for(let s=0;s<r.effects.length;s++)r.effects[s].addBounds&&(i||(i=!0,n.applyMatrix(r.parentRenderGroup.worldTransform)),r.effects[s].addBounds(n,!0));i&&(n.applyMatrix(r.parentRenderGroup.worldTransform.copyTo(AA).invert()),e.addBounds(n,r.relativeGroupTransform)),e.addBounds(n),Hr.return(n)}else r.renderGroup&&(e.addBounds(n,r.relativeGroupTransform),Hr.return(n))}function MA(r,e){e.clear();const t=e.matrix;for(let n=0;n<r.length;n++){const i=r[n];i.globalDisplayStatus<7||(e.matrix=i.worldTransform,i.addBounds(e))}return e.matrix=t,e}const RA=new oo({attributes:{aPosition:{buffer:new Float32Array([0,0,1,0,1,1,0,1]),format:"float32x2",stride:2*4,offset:0}},indexBuffer:new Uint32Array([0,1,2,0,2,3])});class Ev{constructor(e){this._filterStackIndex=0,this._filterStack=[],this._filterGlobalUniforms=new _t({uInputSize:{value:new Float32Array(4),type:"vec4<f32>"},uInputPixel:{value:new Float32Array(4),type:"vec4<f32>"},uInputClamp:{value:new Float32Array(4),type:"vec4<f32>"},uOutputFrame:{value:new Float32Array(4),type:"vec4<f32>"},uGlobalFrame:{value:new Float32Array(4),type:"vec4<f32>"},uOutputTexture:{value:new Float32Array(4),type:"vec4<f32>"}}),this._globalFilterBindGroup=new Vr({}),this.renderer=e}get activeBackTexture(){return this._activeFilterData?.backTexture}push(e){const t=this.renderer,n=e.filterEffect.filters;this._filterStack[this._filterStackIndex]||(this._filterStack[this._filterStackIndex]=this._getFilterData());const i=this._filterStack[this._filterStackIndex];if(this._filterStackIndex++,n.length===0){i.skip=!0;return}const s=i.bounds;e.renderables?MA(e.renderables,s):e.filterEffect.filterArea?(s.clear(),s.addRect(e.filterEffect.filterArea),s.applyMatrix(e.container.worldTransform)):EA(e.container,s);const o=t.renderTarget.renderTarget.colorTexture.source;let a=1/0,l=0,u=!0,c=!1,d=!1,h=!0;for(let f=0;f<n.length;f++){const p=n[f];if(a=Math.min(a,p.resolution==="inherit"?o._resolution:p.resolution),l+=p.padding,p.antialias==="off"?u=!1:p.antialias==="inherit"&&u&&(u=o.antialias),p.clipToViewport||(h=!1),!!!(p.compatibleRenderers&t.type)){d=!1;break}if(p.blendRequired&&!(t.backBuffer?.useBackBuffer??!0)){de("Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options."),d=!1;break}d=p.enabled||d,c=c||p.blendRequired}if(!d){i.skip=!0;return}if(s.scale(a),h){const f=t.renderTarget.rootViewPort;s.fitBounds(0,f.width,0,f.height)}if(s.ceil().scale(1/a).pad(l|0),!s.isPositive){i.skip=!0;return}i.skip=!1,i.bounds=s,i.blendRequired=c,i.container=e.container,i.filterEffect=e.filterEffect,i.previousRenderSurface=t.renderTarget.renderSurface,i.inputTexture=Ge.getOptimalTexture(s.width,s.height,a,u),t.renderTarget.bind(i.inputTexture,!0),t.globalUniforms.push({offset:s})}pop(){const e=this.renderer;this._filterStackIndex--;const t=this._filterStack[this._filterStackIndex];if(t.skip)return;this._activeFilterData=t;const n=t.inputTexture,i=t.bounds;let s=te.EMPTY;if(e.renderTarget.finishRenderPass(),t.blendRequired){const a=this._filterStackIndex>0?this._filterStack[this._filterStackIndex-1].bounds:null,l=e.renderTarget.getRenderTarget(t.previousRenderSurface);s=this.getBackTexture(l,i,a)}t.backTexture=s;const o=t.filterEffect.filters;if(this._globalFilterBindGroup.setResource(n.source.style,2),this._globalFilterBindGroup.setResource(s.source,3),e.globalUniforms.pop(),o.length===1)o[0].apply(this,n,t.previousRenderSurface,!1),Ge.returnTexture(n);else{let a=t.inputTexture,l=Ge.getOptimalTexture(i.width,i.height,a.source._resolution,!1),u=0;for(u=0;u<o.length-1;++u){o[u].apply(this,a,l,!0);const d=a;a=l,l=d}o[u].apply(this,a,t.previousRenderSurface,!1),Ge.returnTexture(a),Ge.returnTexture(l)}t.blendRequired&&Ge.returnTexture(s)}getBackTexture(e,t,n){const i=e.colorTexture.source._resolution,s=Ge.getOptimalTexture(t.width,t.height,i,!1);let o=t.minX,a=t.minY;n&&(o-=n.minX,a-=n.minY),o=Math.floor(o*i),a=Math.floor(a*i);const l=Math.ceil(t.width*i),u=Math.ceil(t.height*i);return this.renderer.renderTarget.copyToTexture(e,s,{x:o,y:a},{width:l,height:u},{x:0,y:0}),s}applyFilter(e,t,n,i){const s=this.renderer,o=this._filterStack[this._filterStackIndex],a=o.bounds,l=We.shared,c=o.previousRenderSurface===n;let d=this.renderer.renderTarget.rootRenderTarget.colorTexture.source._resolution,h=this._filterStackIndex-1;for(;h>0&&this._filterStack[h].skip;)--h;h>0&&(d=this._filterStack[h].inputTexture.source._resolution);const f=this._filterGlobalUniforms,p=f.uniforms,m=p.uOutputFrame,g=p.uInputSize,v=p.uInputPixel,x=p.uInputClamp,b=p.uGlobalFrame,_=p.uOutputTexture;if(c){let P=this._filterStackIndex;for(;P>0;){P--;const S=this._filterStack[this._filterStackIndex-1];if(!S.skip){l.x=S.bounds.minX,l.y=S.bounds.minY;break}}m[0]=a.minX-l.x,m[1]=a.minY-l.y}else m[0]=0,m[1]=0;m[2]=t.frame.width,m[3]=t.frame.height,g[0]=t.source.width,g[1]=t.source.height,g[2]=1/g[0],g[3]=1/g[1],v[0]=t.source.pixelWidth,v[1]=t.source.pixelHeight,v[2]=1/v[0],v[3]=1/v[1],x[0]=.5*v[2],x[1]=.5*v[3],x[2]=t.frame.width*g[2]-.5*v[2],x[3]=t.frame.height*g[3]-.5*v[3];const w=this.renderer.renderTarget.rootRenderTarget.colorTexture;b[0]=l.x*d,b[1]=l.y*d,b[2]=w.source.width*d,b[3]=w.source.height*d;const C=this.renderer.renderTarget.getRenderTarget(n);if(s.renderTarget.bind(n,!!i),n instanceof te?(_[0]=n.frame.width,_[1]=n.frame.height):(_[0]=C.width,_[1]=C.height),_[2]=C.isRoot?-1:1,f.update(),s.renderPipes.uniformBatch){const P=s.renderPipes.uniformBatch.getUboResource(f);this._globalFilterBindGroup.setResource(P,0)}else this._globalFilterBindGroup.setResource(f,0);this._globalFilterBindGroup.setResource(t.source,1),this._globalFilterBindGroup.setResource(t.source.style,2),e.groups[0]=this._globalFilterBindGroup,s.encoder.draw({geometry:RA,shader:e,state:e._state,topology:"triangle-list"}),s.type===Wt.WEBGL&&s.renderTarget.finishRenderPass()}_getFilterData(){return{skip:!1,inputTexture:null,bounds:new Mt,container:null,filterEffect:null,blendRequired:!1,previousRenderSurface:null}}calculateSpriteMatrix(e,t){const n=this._activeFilterData,i=e.set(n.inputTexture._source.width,0,0,n.inputTexture._source.height,n.bounds.minX,n.bounds.minY),s=t.worldTransform.copyTo(ae.shared);return s.invert(),i.prepend(s),i.scale(1/t.texture.frame.width,1/t.texture.frame.height),i.translate(t.anchor.x,t.anchor.y),i}}Ev.extension={type:[F.WebGLSystem,F.WebGPUSystem],name:"filter"};var kA=`in vec2 vMaskCoord;
in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform sampler2D uMaskTexture;

uniform float uAlpha;
uniform vec4 uMaskClamp;
uniform float uInverse;

out vec4 finalColor;

void main(void)
{
    float clip = step(3.5,
        step(uMaskClamp.x, vMaskCoord.x) +
        step(uMaskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, uMaskClamp.z) +
        step(vMaskCoord.y, uMaskClamp.w));

    // TODO look into why this is needed
    float npmAlpha = uAlpha;
    vec4 original = texture(uTexture, vTextureCoord);
    vec4 masky = texture(uMaskTexture, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    float a = alphaMul * masky.r * npmAlpha * clip;

    if (uInverse == 1.0) {
        a = 1.0 - a;
    }

    finalColor = original * a;
}
`,FA=`in vec2 aPosition;

out vec2 vTextureCoord;
out vec2 vMaskCoord;


uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;
uniform mat3 uFilterMatrix;

vec4 filterVertexPosition(  vec2 aPosition )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
       
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord(  vec2 aPosition )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

vec2 getFilterCoord( vec2 aPosition )
{
    return  ( uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}   

void main(void)
{
    gl_Position = filterVertexPosition(aPosition);
    vTextureCoord = filterTextureCoord(aPosition);
    vMaskCoord = getFilterCoord(aPosition);
}
`,Zf=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct MaskUniforms {
  uFilterMatrix:mat3x3<f32>,
  uMaskClamp:vec4<f32>,
  uAlpha:f32,
  uInverse:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> filterUniforms : MaskUniforms;
@group(1) @binding(1) var uMaskTexture: texture_2d<f32>;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) filterUv : vec2<f32>,
};

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);
}

fn getFilterCoord(aPosition:vec2<f32> ) -> vec2<f32>
{
  return ( filterUniforms.uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}

@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>,
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition),
   getFilterCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @location(1) filterUv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    var maskClamp = filterUniforms.uMaskClamp;
    var uAlpha = filterUniforms.uAlpha;

    var clip = step(3.5,
      step(maskClamp.x, filterUv.x) +
      step(maskClamp.y, filterUv.y) +
      step(filterUv.x, maskClamp.z) +
      step(filterUv.y, maskClamp.w));

    var mask = textureSample(uMaskTexture, uSampler, filterUv);
    var source = textureSample(uTexture, uSampler, uv);
    var alphaMul = 1.0 - uAlpha * (1.0 - mask.a);

    var a: f32 = alphaMul * mask.r * uAlpha * clip;

    if (filterUniforms.uInverse == 1.0) {
        a = 1.0 - a;
    }

    return source * a;
}
`;class IA extends _e{constructor(e){const{sprite:t,...n}=e,i=new ig(t.texture),s=new _t({uFilterMatrix:{value:new ae,type:"mat3x3<f32>"},uMaskClamp:{value:i.uClampFrame,type:"vec4<f32>"},uAlpha:{value:1,type:"f32"},uInverse:{value:e.inverse?1:0,type:"f32"}}),o=me.from({vertex:{source:Zf,entryPoint:"mainVertex"},fragment:{source:Zf,entryPoint:"mainFragment"}}),a=be.from({vertex:FA,fragment:kA,name:"mask-filter"});super({...n,gpuProgram:o,glProgram:a,resources:{filterUniforms:s,uMaskTexture:t.texture.source}}),this.sprite=t,this._textureMatrix=i}set inverse(e){this.resources.filterUniforms.uniforms.uInverse=e?1:0}get inverse(){return this.resources.filterUniforms.uniforms.uInverse===1}apply(e,t,n,i){this._textureMatrix.texture=this.sprite.texture,e.calculateSpriteMatrix(this.resources.filterUniforms.uniforms.uFilterMatrix,this.sprite).prepend(this._textureMatrix.mapCoord),this.resources.uMaskTexture=this.sprite.texture.source,e.applyFilter(this,t,n,i)}}class Rr extends qc{constructor(e){e instanceof $t&&(e={context:e});const{context:t,roundPixels:n,...i}=e||{};super({label:"Graphics",...i}),this.renderPipeId="graphics",t?this._context=t:this._context=this._ownedContext=new $t,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=n??!1}set context(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}addBounds(e){e.addBounds(this._context.bounds)}containsPoint(e){return this._context.containsPoint(e)}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):(e===!0||e?.context===!0)&&this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_callContextMethod(e,t){return this.context[e](...t),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){return e?new Rr(this._context.clone()):(this._ownedContext=null,new Rr(this._context))}lineStyle(e,t,n){J(Me,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const i={};return e&&(i.width=e),t&&(i.color=t),n&&(i.alpha=n),this.context.strokeStyle=i,this}beginFill(e,t){J(Me,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const n={};return e&&(n.color=e),t&&(n.alpha=t),this.context.fillStyle=n,this}endFill(){J(Me,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return(e.width!==$t.defaultStrokeStyle.width||e.color!==$t.defaultStrokeStyle.color||e.alpha!==$t.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...e){return J(Me,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return J(Me,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return J(Me,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return J(Me,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return J(Me,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return J(Me,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}}const Mv=class Rv extends oo{constructor(...e){let t=e[0]??{};t instanceof Float32Array&&(J(Me,"use new MeshGeometry({ positions, uvs, indices }) instead"),t={positions:t,uvs:e[1],indices:e[2]}),t={...Rv.defaultOptions,...t};const n=t.positions||new Float32Array([0,0,1,0,1,1,0,1]),i=t.uvs||new Float32Array([0,0,1,0,1,1,0,1]),s=t.indices||new Uint32Array([0,1,2,0,2,3]),o=t.shrinkBuffersToFit,a=new Ht({data:n,label:"attribute-mesh-positions",shrinkToFit:o,usage:Ae.VERTEX|Ae.COPY_DST}),l=new Ht({data:i,label:"attribute-mesh-uvs",shrinkToFit:o,usage:Ae.VERTEX|Ae.COPY_DST}),u=new Ht({data:s,label:"index-mesh-buffer",shrinkToFit:o,usage:Ae.INDEX|Ae.COPY_DST});super({attributes:{aPosition:{buffer:a,format:"float32x2",stride:2*4,offset:0},aUV:{buffer:l,format:"float32x2",stride:2*4,offset:0}},indexBuffer:u,topology:t.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(e){this.attributes.aPosition.buffer.data=e}get uvs(){return this.attributes.aUV.buffer.data}set uvs(e){this.attributes.aUV.buffer.data=e}get indices(){return this.indexBuffer.data}set indices(e){this.indexBuffer.data=e}};Mv.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let pd=Mv;class kv extends qc{constructor(e,t){const{text:n,resolution:i,style:s,anchor:o,width:a,height:l,roundPixels:u,...c}=e;super({...c}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=t,this.text=n??"",this.style=s,this.resolution=i??null,this.allowChildren=!1,this._anchor=new yt({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=u??!1,a!==void 0&&(this.width=a),l!==void 0&&(this.height=l)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){e=e||{},this._style?.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this.bounds.width),t!==void 0&&this._setHeight(t,this.bounds.height)}addBounds(e){const t=this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}containsPoint(e){const t=this.bounds.width,n=this.bounds.height,i=-t*this.anchor.x;let s=0;return e.x>=i&&e.x<=i+t&&(s=-n*this.anchor.y,e.y>=s&&e.y<=s+n)}onViewUpdate(){this._boundsDirty=!0,this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e?.style)&&this._style.destroy(e),this._style=null,this._text=null}}function Fv(r,e){let t=r[0]??{};return(typeof t=="string"||r[1])&&(J(Me,`use new ${e}({ text: "hi!", style }) instead`),t={text:t,style:r[1]}),t}let Qf=class extends kv{constructor(...e){const t=Fv(e,"Text");super(t,Yr),this.renderPipeId="text"}_updateBounds(){const e=this._bounds,t=this._anchor,n=St.measureText(this._text,this._style),{width:i,height:s}=n;e.minX=-t._x*i,e.maxX=e.minX+i,e.minY=-t._y*s,e.maxY=e.minY+s}};function BA(r){const e=r._stroke,t=r._fill,i=[`div { ${[`color: ${pe.shared.setValue(t.color).toHex()}`,`font-size: ${r.fontSize}px`,`font-family: ${r.fontFamily}`,`font-weight: ${r.fontWeight}`,`font-style: ${r.fontStyle}`,`font-variant: ${r.fontVariant}`,`letter-spacing: ${r.letterSpacing}px`,`text-align: ${r.align}`,`padding: ${r.padding}px`,`white-space: ${r.whiteSpace==="pre"&&r.wordWrap?"pre-wrap":r.whiteSpace}`,...r.lineHeight?[`line-height: ${r.lineHeight}px`]:[],...r.wordWrap?[`word-wrap: ${r.breakWords?"break-all":"break-word"}`,`max-width: ${r.wordWrapWidth}px`]:[],...e?[Bv(e)]:[],...r.dropShadow?[Iv(r.dropShadow)]:[],...r.cssOverrides].join(";")} }`];return OA(r.tagStyles,i),i.join(" ")}function Iv(r){const e=pe.shared.setValue(r.color).setAlpha(r.alpha).toHexa(),t=Math.round(Math.cos(r.angle)*r.distance),n=Math.round(Math.sin(r.angle)*r.distance),i=`${t}px ${n}px`;return r.blur>0?`text-shadow: ${i} ${r.blur}px ${e}`:`text-shadow: ${i} ${e}`}function Bv(r){return[`-webkit-text-stroke-width: ${r.width}px`,`-webkit-text-stroke-color: ${pe.shared.setValue(r.color).toHex()}`,`text-stroke-width: ${r.width}px`,`text-stroke-color: ${pe.shared.setValue(r.color).toHex()}`,"paint-order: stroke"].join(";")}const Jf={fontSize:"font-size: {{VALUE}}px",fontFamily:"font-family: {{VALUE}}",fontWeight:"font-weight: {{VALUE}}",fontStyle:"font-style: {{VALUE}}",fontVariant:"font-variant: {{VALUE}}",letterSpacing:"letter-spacing: {{VALUE}}px",align:"text-align: {{VALUE}}",padding:"padding: {{VALUE}}px",whiteSpace:"white-space: {{VALUE}}",lineHeight:"line-height: {{VALUE}}px",wordWrapWidth:"max-width: {{VALUE}}px"},ep={fill:r=>`color: ${pe.shared.setValue(r).toHex()}`,breakWords:r=>`word-wrap: ${r?"break-all":"break-word"}`,stroke:Bv,dropShadow:Iv};function OA(r,e){for(const t in r){const n=r[t],i=[];for(const s in n)ep[s]?i.push(ep[s](n[s])):Jf[s]&&i.push(Jf[s].replace("{{VALUE}}",n[s]));e.push(`${t} { ${i.join(";")} }`)}}class ll extends Yr{constructor(e={}){super(e),this._cssOverrides=[],this.cssOverrides??(this.cssOverrides=e.cssOverrides),this.tagStyles=e.tagStyles??{}}set cssOverrides(e){this._cssOverrides=e instanceof Array?e:[e],this.update()}get cssOverrides(){return this._cssOverrides}_generateKey(){return this._styleKey=lv(this)+this._cssOverrides.join("-"),this._styleKey}update(){this._cssStyle=null,super.update()}clone(){return new ll({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow?{...this.dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,cssOverrides:this.cssOverrides})}get cssStyle(){return this._cssStyle||(this._cssStyle=BA(this)),this._cssStyle}addOverride(...e){const t=e.filter(n=>!this.cssOverrides.includes(n));t.length>0&&(this.cssOverrides.push(...t),this.update())}removeOverride(...e){const t=e.filter(n=>this.cssOverrides.includes(n));t.length>0&&(this.cssOverrides=this.cssOverrides.filter(n=>!t.includes(n)),this.update())}set fill(e){typeof e!="string"&&typeof e!="number"&&de("[HTMLTextStyle] only color fill is not supported by HTMLText"),super.fill=e}set stroke(e){e&&typeof e!="string"&&typeof e!="number"&&de("[HTMLTextStyle] only color stroke is not supported by HTMLText"),super.stroke=e}}const tp="http://www.w3.org/2000/svg",rp="http://www.w3.org/1999/xhtml";class Ov{constructor(){this.svgRoot=document.createElementNS(tp,"svg"),this.foreignObject=document.createElementNS(tp,"foreignObject"),this.domElement=document.createElementNS(rp,"div"),this.styleElement=document.createElementNS(rp,"style"),this.image=new Image;const{foreignObject:e,svgRoot:t,styleElement:n,domElement:i}=this;e.setAttribute("width","10000"),e.setAttribute("height","10000"),e.style.overflow="hidden",t.appendChild(e),e.appendChild(n),e.appendChild(i)}}let np;function Uv(r,e,t,n){n=n||np||(np=new Ov);const{domElement:i,styleElement:s,svgRoot:o}=n;i.innerHTML=`<style>${e.cssStyle};</style><div style='padding:0'>${r}</div>`,i.setAttribute("style","transform-origin: top left; display: inline-block"),t&&(s.textContent=t),document.body.appendChild(o);const a=i.getBoundingClientRect();o.remove();const l=St.measureFont(e.fontStyle).descent,u=e.padding*2;return{width:a.width-u,height:a.height+l-u}}class Si extends kv{constructor(...e){const t=Fv(e,"HtmlText");super(t,ll),this.renderPipeId="htmlText"}_updateBounds(){const e=this._bounds,t=this._anchor,n=Uv(this.text,this._style),{width:i,height:s}=n;e.minX=-t._x*i,e.maxX=e.minX+i,e.minY=-t._y*s,e.maxY=e.minY+s}}class Dv{constructor(){this._didUpload=!1,this._tempState=vr.for2d()}init(e){e.renderer.runners.contextChange.add(this)}contextChange(){this._didUpload=!1}start(e,t,n){const i=e.renderer;i.shader.bind(n,this._didUpload),i.shader.updateUniformGroup(i.globalUniforms.uniformGroup),i.geometry.bind(t,n.glProgram)}execute(e,t){const n=e.renderer;this._didUpload=!0,this._tempState.blendMode=t.blendMode,n.state.set(this._tempState);const i=t.textures.textures;for(let s=0;s<t.textures.count;s++)n.texture.bind(i[s],s);n.geometry.draw("triangle-list",t.size,t.start)}}Dv.extension={type:[F.WebGLPipesAdaptor],name:"batch"};const Go=vr.for2d();class Gv{start(e,t,n){const i=e.renderer,s=i.encoder,o=n.gpuProgram;this._shader=n,this._geometry=t,s.setGeometry(t,o),Go.blendMode="normal",i.pipeline.getPipeline(t,o,Go);const a=i.globalUniforms.bindGroup;s.resetBindGroup(1),s.setBindGroup(0,a,o)}execute(e,t){const n=this._shader.gpuProgram,i=e.renderer,s=i.encoder;if(!t.bindGroup){const l=t.textures;t.bindGroup=Qc(l.textures,l.count)}Go.blendMode=t.blendMode;const o=i.bindGroup.getBindGroup(t.bindGroup,n,1),a=i.pipeline.getPipeline(this._geometry,n,Go);t.bindGroup._touch(i.textureGC.count),s.setPipeline(a),s.renderPassEncoder.setBindGroup(1,o),s.renderPassEncoder.drawIndexed(t.size,1,t.start)}}Gv.extension={type:[F.WebGPUPipesAdaptor],name:"batch"};const md=class zv{constructor(e,t){this.state=vr.for2d(),this._batchersByInstructionSet=Object.create(null),this._activeBatches=Object.create(null),this.renderer=e,this._adaptor=t,this._adaptor.init?.(this)}static getBatcher(e){return new this._availableBatchers[e]}buildStart(e){let t=this._batchersByInstructionSet[e.uid];t||(t=this._batchersByInstructionSet[e.uid]=Object.create(null),t.default||(t.default=new id)),this._activeBatches=t,this._activeBatch=this._activeBatches.default;for(const n in this._activeBatches)this._activeBatches[n].begin()}addToBatch(e,t){if(this._activeBatch.name!==e.batcherName){this._activeBatch.break(t);let n=this._activeBatches[e.batcherName];n||(n=this._activeBatches[e.batcherName]=zv.getBatcher(e.batcherName),n.begin()),this._activeBatch=n}this._activeBatch.add(e)}break(e){this._activeBatch.break(e)}buildEnd(e){this._activeBatch.break(e);const t=this._activeBatches;for(const n in t){const i=t[n],s=i.geometry;s.indexBuffer.setDataWithSize(i.indexBuffer,i.indexSize,!0),s.buffers[0].setDataWithSize(i.attributeBuffer.float32View,i.attributeSize,!1)}}upload(e){const t=this._batchersByInstructionSet[e.uid];for(const n in t){const i=t[n],s=i.geometry;i.dirty&&(i.dirty=!1,s.buffers[0].update(i.attributeSize*4))}}execute(e){if(e.action==="startBatch"){const t=e.batcher,n=t.geometry,i=t.shader;this._adaptor.start(this,n,i)}this._adaptor.execute(this,e)}destroy(){this.state=null,this.renderer=null,this._adaptor=null;for(const e in this._activeBatches)this._activeBatches[e].destroy();this._activeBatches=null}};md.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"batch"};md._availableBatchers=Object.create(null);let Lv=md;he.handleByMap(F.Batcher,Lv._availableBatchers);he.add(id);const ks={name:"local-uniform-bit",vertex:{header:`

            struct LocalUniforms {
                uTransformMatrix:mat3x3<f32>,
                uColor:vec4<f32>,
                uRound:f32,
            }

            @group(1) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `}},UA={...ks,vertex:{...ks.vertex,header:ks.vertex.header.replace("group(1)","group(2)")}},gd={name:"local-uniform-bit",vertex:{header:`

            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix = uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `}},DA={name:"texture-bit",vertex:{header:`

        struct TextureUniforms {
            uTextureMatrix:mat3x3<f32>,
        }

        @group(2) @binding(2) var<uniform> textureUniforms : TextureUniforms;
        `,main:`
            uv = (textureUniforms.uTextureMatrix * vec3(uv, 1.0)).xy;
        `},fragment:{header:`
            @group(2) @binding(0) var uTexture: texture_2d<f32>;
            @group(2) @binding(1) var uSampler: sampler;

         
        `,main:`
            outColor = textureSample(uTexture, uSampler, vUV);
        `}},GA={name:"texture-bit",vertex:{header:`
            uniform mat3 uTextureMatrix;
        `,main:`
            uv = (uTextureMatrix * vec3(uv, 1.0)).xy;
        `},fragment:{header:`
        uniform sampler2D uTexture;

         
        `,main:`
            outColor = texture(uTexture, vUV);
        `}};function zA(r,e){const t=r.root,n=r.instructionSet;n.reset();const i=e.renderPipes?e:e.batch.renderer,s=i.renderPipes;s.batch.buildStart(n),s.blendMode.buildStart(),s.colorMask.buildStart(),t.sortableChildren&&t.sortChildren(),Nv(t,n,i,!0),s.batch.buildEnd(n),s.blendMode.buildEnd(n)}function ul(r,e,t){const n=t.renderPipes?t:t.batch.renderer;r.globalDisplayStatus<7||!r.includeInBuild||(r.sortableChildren&&r.sortChildren(),r.isSimple?LA(r,e,n):Nv(r,e,n,!1))}function LA(r,e,t){if(r.renderPipeId){const n=r,{renderPipes:i,renderableGC:s}=t;i.blendMode.setBlendMode(n,r.groupBlendMode,e),i[n.renderPipeId].addRenderable(n,e),s.addRenderable(n,e),n.didViewUpdate=!1}if(!r.renderGroup){const n=r.children,i=n.length;for(let s=0;s<i;s++)ul(n[s],e,t)}}function Nv(r,e,t,n){const{renderPipes:i,renderableGC:s}=t;if(!n&&r.renderGroup)i.renderGroup.addRenderGroup(r.renderGroup,e);else{for(let u=0;u<r.effects.length;u++){const c=r.effects[u];i[c.pipe].push(c,r,e)}const o=r,a=o.renderPipeId;a&&(i.blendMode.setBlendMode(o,o.groupBlendMode,e),i[a].addRenderable(o,e),s.addRenderable(o,e),o.didViewUpdate=!1);const l=r.children;if(l.length)for(let u=0;u<l.length;u++)ul(l[u],e,t);for(let u=r.effects.length-1;u>=0;u--){const c=r.effects[u];i[c.pipe].pop(c,r,e)}}}const NA=new Mt;class HA extends Aa{constructor(){super(),this.filters=[new IA({sprite:new Ke(te.EMPTY),inverse:!1,resolution:"inherit",antialias:"inherit"})]}get sprite(){return this.filters[0].sprite}set sprite(e){this.filters[0].sprite=e}get inverse(){return this.filters[0].inverse}set inverse(e){this.filters[0].inverse=e}}class Hv{constructor(e){this._activeMaskStage=[],this._renderer=e}push(e,t,n){const i=this._renderer;if(i.renderPipes.batch.break(n),n.add({renderPipeId:"alphaMask",action:"pushMaskBegin",mask:e,inverse:t._maskOptions.inverse,canBundle:!1,maskedContainer:t}),e.inverse=t._maskOptions.inverse,e.renderMaskToTexture){const s=e.mask;s.includeInBuild=!0,ul(s,n,i),s.includeInBuild=!1}i.renderPipes.batch.break(n),n.add({renderPipeId:"alphaMask",action:"pushMaskEnd",mask:e,maskedContainer:t,inverse:t._maskOptions.inverse,canBundle:!1})}pop(e,t,n){this._renderer.renderPipes.batch.break(n),n.add({renderPipeId:"alphaMask",action:"popMaskEnd",mask:e,inverse:t._maskOptions.inverse,canBundle:!1})}execute(e){const t=this._renderer,n=e.mask.renderMaskToTexture;if(e.action==="pushMaskBegin"){const i=Re.get(HA);if(i.inverse=e.inverse,n){e.mask.mask.measurable=!0;const s=Wc(e.mask.mask,!0,NA);e.mask.mask.measurable=!1,s.ceil();const o=t.renderTarget.renderTarget.colorTexture.source,a=Ge.getOptimalTexture(s.width,s.height,o._resolution,o.antialias);t.renderTarget.push(a,!0),t.globalUniforms.push({offset:s,worldColor:4294967295});const l=i.sprite;l.texture=a,l.worldTransform.tx=s.minX,l.worldTransform.ty=s.minY,this._activeMaskStage.push({filterEffect:i,maskedContainer:e.maskedContainer,filterTexture:a})}else i.sprite=e.mask.mask,this._activeMaskStage.push({filterEffect:i,maskedContainer:e.maskedContainer})}else if(e.action==="pushMaskEnd"){const i=this._activeMaskStage[this._activeMaskStage.length-1];n&&(t.type===Wt.WEBGL&&t.renderTarget.finishRenderPass(),t.renderTarget.pop(),t.globalUniforms.pop()),t.filter.push({renderPipeId:"filter",action:"pushFilter",container:i.maskedContainer,filterEffect:i.filterEffect,canBundle:!1})}else if(e.action==="popMaskEnd"){t.filter.pop();const i=this._activeMaskStage.pop();n&&Ge.returnTexture(i.filterTexture),Re.return(i.filterEffect)}}destroy(){this._renderer=null,this._activeMaskStage=null}}Hv.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"alphaMask"};class Vv{constructor(e){this._colorStack=[],this._colorStackIndex=0,this._currentColor=0,this._renderer=e}buildStart(){this._colorStack[0]=15,this._colorStackIndex=1,this._currentColor=15}push(e,t,n){this._renderer.renderPipes.batch.break(n);const s=this._colorStack;s[this._colorStackIndex]=s[this._colorStackIndex-1]&e.mask;const o=this._colorStack[this._colorStackIndex];o!==this._currentColor&&(this._currentColor=o,n.add({renderPipeId:"colorMask",colorMask:o,canBundle:!1})),this._colorStackIndex++}pop(e,t,n){this._renderer.renderPipes.batch.break(n);const s=this._colorStack;this._colorStackIndex--;const o=s[this._colorStackIndex-1];o!==this._currentColor&&(this._currentColor=o,n.add({renderPipeId:"colorMask",colorMask:o,canBundle:!1}))}execute(e){this._renderer.colorMask.setMask(e.colorMask)}destroy(){this._colorStack=null}}Vv.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"colorMask"};class Wv{constructor(e){this._maskStackHash={},this._maskHash=new WeakMap,this._renderer=e}push(e,t,n){var i;const s=e,o=this._renderer;o.renderPipes.batch.break(n),o.renderPipes.blendMode.setBlendMode(s.mask,"none",n),n.add({renderPipeId:"stencilMask",action:"pushMaskBegin",mask:e,inverse:t._maskOptions.inverse,canBundle:!1});const a=s.mask;a.includeInBuild=!0,this._maskHash.has(s)||this._maskHash.set(s,{instructionsStart:0,instructionsLength:0});const l=this._maskHash.get(s);l.instructionsStart=n.instructionSize,ul(a,n,o),a.includeInBuild=!1,o.renderPipes.batch.break(n),n.add({renderPipeId:"stencilMask",action:"pushMaskEnd",mask:e,inverse:t._maskOptions.inverse,canBundle:!1});const u=n.instructionSize-l.instructionsStart-1;l.instructionsLength=u;const c=o.renderTarget.renderTarget.uid;(i=this._maskStackHash)[c]??(i[c]=0)}pop(e,t,n){const i=e,s=this._renderer;s.renderPipes.batch.break(n),s.renderPipes.blendMode.setBlendMode(i.mask,"none",n),n.add({renderPipeId:"stencilMask",action:"popMaskBegin",inverse:t._maskOptions.inverse,canBundle:!1});const o=this._maskHash.get(e);for(let a=0;a<o.instructionsLength;a++)n.instructions[n.instructionSize++]=n.instructions[o.instructionsStart++];n.add({renderPipeId:"stencilMask",action:"popMaskEnd",canBundle:!1})}execute(e){var t;const n=this._renderer,i=n.renderTarget.renderTarget.uid;let s=(t=this._maskStackHash)[i]??(t[i]=0);e.action==="pushMaskBegin"?(n.renderTarget.ensureDepthStencil(),n.stencil.setStencilMode(nt.RENDERING_MASK_ADD,s),s++,n.colorMask.setMask(0)):e.action==="pushMaskEnd"?(e.inverse?n.stencil.setStencilMode(nt.INVERSE_MASK_ACTIVE,s):n.stencil.setStencilMode(nt.MASK_ACTIVE,s),n.colorMask.setMask(15)):e.action==="popMaskBegin"?(n.colorMask.setMask(0),s!==0?n.stencil.setStencilMode(nt.RENDERING_MASK_REMOVE,s):(n.renderTarget.clear(null,Dt.STENCIL),n.stencil.setStencilMode(nt.DISABLED,s)),s--):e.action==="popMaskEnd"&&(e.inverse?n.stencil.setStencilMode(nt.INVERSE_MASK_ACTIVE,s):n.stencil.setStencilMode(nt.MASK_ACTIVE,s),n.colorMask.setMask(15)),this._maskStackHash[i]=s}destroy(){this._renderer=null,this._maskStackHash=null,this._maskHash=null}}Wv.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"stencilMask"};var Ko=(r=>(r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",r))(Ko||{});class VA{constructor(e,t){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.type=t}}class jv{constructor(e){this._gpuBuffers=Object.create(null),this._boundBufferBases=Object.create(null),this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_gpuBuffers")}destroy(){this._renderer=null,this._gl=null,this._gpuBuffers=null,this._boundBufferBases=null}contextChange(){this._gpuBuffers=Object.create(null),this._gl=this._renderer.gl}getGlBuffer(e){return this._gpuBuffers[e.uid]||this.createGLBuffer(e)}bind(e){const{_gl:t}=this,n=this.getGlBuffer(e);t.bindBuffer(n.type,n.buffer)}bindBufferBase(e,t){const{_gl:n}=this;if(this._boundBufferBases[t]!==e){const i=this.getGlBuffer(e);this._boundBufferBases[t]=e,n.bindBufferBase(n.UNIFORM_BUFFER,t,i.buffer)}}bindBufferRange(e,t,n){const{_gl:i}=this;n=n||0;const s=this.getGlBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,t||0,s.buffer,n*256,256)}updateBuffer(e){const{_gl:t}=this,n=this.getGlBuffer(e);if(e._updateID===n.updateID)return n;n.updateID=e._updateID,t.bindBuffer(n.type,n.buffer);const i=e.data;if(n.byteLength>=e.data.byteLength)t.bufferSubData(n.type,0,i,0,e._updateSize/i.BYTES_PER_ELEMENT);else{const s=e.descriptor.usage&Ae.STATIC?t.STATIC_DRAW:t.DYNAMIC_DRAW;n.byteLength=i.byteLength,t.bufferData(n.type,i,s)}return n}destroyAll(){const e=this._gl;for(const t in this._gpuBuffers)e.deleteBuffer(this._gpuBuffers[t].buffer);this._gpuBuffers=Object.create(null)}onBufferDestroy(e,t){const n=this._gpuBuffers[e.uid],i=this._gl;t||i.deleteBuffer(n.buffer),this._gpuBuffers[e.uid]=null}createGLBuffer(e){const{_gl:t}=this;let n=Ko.ARRAY_BUFFER;e.descriptor.usage&Ae.INDEX?n=Ko.ELEMENT_ARRAY_BUFFER:e.descriptor.usage&Ae.UNIFORM&&(n=Ko.UNIFORM_BUFFER);const i=new VA(t.createBuffer(),n);return this._gpuBuffers[e.uid]=i,e.on("destroy",this.onBufferDestroy,this),i}}jv.extension={type:[F.WebGLSystem],name:"buffer"};const vd=class Xv{constructor(e){this.supports={uint32Indices:!0,uniformBufferObject:!0,vertexArrayObject:!0,srgbTextures:!0,nonPowOf2wrapping:!0,msaa:!0,nonPowOf2mipmaps:!0},this._renderer=e,this.extensions=Object.create(null),this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this._renderer.gl=e}init(e){e={...Xv.defaultOptions,...e};let t=this.multiView=e.multiView;if(e.context&&t&&(de("Renderer created with both a context and multiview enabled. Disabling multiView as both cannot work together."),t=!1),t?this.canvas=Ee.get().createCanvas(this._renderer.canvas.width,this._renderer.canvas.height):this.canvas=this._renderer.view.canvas,e.context)this.initFromContext(e.context);else{const n=this._renderer.background.alpha<1,i=e.premultipliedAlpha??!0,s=e.antialias&&!this._renderer.backBuffer.useBackBuffer;this.createContext(e.preferWebGLVersion,{alpha:n,premultipliedAlpha:i,antialias:s,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference??"default"})}}ensureCanvasSize(e){if(!this.multiView){e!==this.canvas&&de("multiView is disabled, but targetCanvas is not the main canvas");return}const{canvas:t}=this;(t.width<e.width||t.height<e.height)&&(t.width=Math.max(e.width,e.width),t.height=Math.max(e.height,e.height))}initFromContext(e){this.gl=e,this.webGLVersion=e instanceof Ee.get().getWebGLRenderingContext()?1:2,this.getExtensions(),this.validateContext(e),this._renderer.runners.contextChange.emit(e);const t=this._renderer.view.canvas;t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}createContext(e,t){let n;const i=this.canvas;if(e===2&&(n=i.getContext("webgl2",t)),!n&&(n=i.getContext("webgl",t),!n))throw new Error("This browser does not support WebGL. Try using the canvas renderer");this.gl=n,this.initFromContext(this.gl)}getExtensions(){const{gl:e}=this,t={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc"),rgtc:e.getExtension("EXT_texture_compression_rgtc"),loseContext:e.getExtension("WEBGL_lose_context")};if(this.webGLVersion===1)this.extensions={...t,drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear"),vertexAttribDivisorANGLE:e.getExtension("ANGLE_instanced_arrays"),srgb:e.getExtension("EXT_sRGB")};else{this.extensions={...t,colorBufferFloat:e.getExtension("EXT_color_buffer_float")};const n=e.getExtension("WEBGL_provoking_vertex");n&&n.provokingVertexWEBGL(n.FIRST_VERTEX_CONVENTION_WEBGL)}}handleContextLost(e){e.preventDefault(),this._contextLossForced&&(this._contextLossForced=!1,setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext?.restoreContext()},0))}handleContextRestored(){this._renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this._renderer.view.canvas;this._renderer=null,e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext?.loseContext()}forceContextLoss(){this.extensions.loseContext?.loseContext(),this._contextLossForced=!0}validateContext(e){const t=e.getContextAttributes();t&&!t.stencil&&de("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const n=this.supports,i=this.webGLVersion===2,s=this.extensions;n.uint32Indices=i||!!s.uint32ElementIndex,n.uniformBufferObject=i,n.vertexArrayObject=i||!!s.vertexArrayObject,n.srgbTextures=i||!!s.srgb,n.nonPowOf2wrapping=i,n.nonPowOf2mipmaps=i,n.msaa=i,n.uint32Indices||de("Provided WebGL context does not support 32 index buffer, large scenes may not render correctly")}};vd.extension={type:[F.WebGLSystem],name:"context"};vd.defaultOptions={context:null,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:void 0,preferWebGLVersion:2,multiView:!1};let WA=vd;function qv(r,e){for(const t in r.attributes){const n=r.attributes[t],i=e[t];i?(n.format??(n.format=i.format),n.offset??(n.offset=i.offset),n.instance??(n.instance=i.instance)):de(`Attribute ${t} is not present in the shader, but is present in the geometry. Unable to infer attribute details.`)}jA(r)}function jA(r){const{buffers:e,attributes:t}=r,n={},i={};for(const s in e){const o=e[s];n[o.uid]=0,i[o.uid]=0}for(const s in t){const o=t[s];n[o.buffer.uid]+=hn(o.format).stride}for(const s in t){const o=t[s];o.stride??(o.stride=n[o.buffer.uid]),o.start??(o.start=i[o.buffer.uid]),i[o.buffer.uid]+=hn(o.format).stride}}var Ju=(r=>(r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r))(Ju||{}),Yv=(r=>(r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r))(Yv||{}),ke=(r=>(r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT",r))(ke||{});const ip={uint8x2:ke.UNSIGNED_BYTE,uint8x4:ke.UNSIGNED_BYTE,sint8x2:ke.BYTE,sint8x4:ke.BYTE,unorm8x2:ke.UNSIGNED_BYTE,unorm8x4:ke.UNSIGNED_BYTE,snorm8x2:ke.BYTE,snorm8x4:ke.BYTE,uint16x2:ke.UNSIGNED_SHORT,uint16x4:ke.UNSIGNED_SHORT,sint16x2:ke.SHORT,sint16x4:ke.SHORT,unorm16x2:ke.UNSIGNED_SHORT,unorm16x4:ke.UNSIGNED_SHORT,snorm16x2:ke.SHORT,snorm16x4:ke.SHORT,float16x2:ke.HALF_FLOAT,float16x4:ke.HALF_FLOAT,float32:ke.FLOAT,float32x2:ke.FLOAT,float32x3:ke.FLOAT,float32x4:ke.FLOAT,uint32:ke.UNSIGNED_INT,uint32x2:ke.UNSIGNED_INT,uint32x3:ke.UNSIGNED_INT,uint32x4:ke.UNSIGNED_INT,sint32:ke.INT,sint32x2:ke.INT,sint32x3:ke.INT,sint32x4:ke.INT};function XA(r){return ip[r]??ip.float32}const qA={"point-list":0,"line-list":1,"line-strip":3,"triangle-list":4,"triangle-strip":5};class Kv{constructor(e){this._geometryVaoHash=Object.create(null),this._renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this._renderer.renderableGC.addManagedHash(this,"_geometryVaoHash")}contextChange(){const e=this.gl=this._renderer.gl;if(!this._renderer.context.supports.vertexArrayObject)throw new Error("[PixiJS] Vertex Array Objects are not supported on this device");const t=this._renderer.context.extensions.vertexArrayObject;t&&(e.createVertexArray=()=>t.createVertexArrayOES(),e.bindVertexArray=i=>t.bindVertexArrayOES(i),e.deleteVertexArray=i=>t.deleteVertexArrayOES(i));const n=this._renderer.context.extensions.vertexAttribDivisorANGLE;n&&(e.drawArraysInstanced=(i,s,o,a)=>{n.drawArraysInstancedANGLE(i,s,o,a)},e.drawElementsInstanced=(i,s,o,a,l)=>{n.drawElementsInstancedANGLE(i,s,o,a,l)},e.vertexAttribDivisor=(i,s)=>n.vertexAttribDivisorANGLE(i,s)),this._activeGeometry=null,this._activeVao=null,this._geometryVaoHash=Object.create(null)}bind(e,t){const n=this.gl;this._activeGeometry=e;const i=this.getVao(e,t);this._activeVao!==i&&(this._activeVao=i,n.bindVertexArray(i)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this._renderer.buffer;for(let n=0;n<e.buffers.length;n++){const i=e.buffers[n];t.updateBuffer(i)}}checkCompatibility(e,t){const n=e.attributes,i=t._attributeData;for(const s in i)if(!n[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,t){const n=e.attributes,i=t._attributeData,s=["g",e.uid];for(const o in n)i[o]&&s.push(o,i[o].location);return s.join("-")}getVao(e,t){return this._geometryVaoHash[e.uid]?.[t._key]||this.initGeometryVao(e,t)}initGeometryVao(e,t,n=!0){const i=this._renderer.gl,s=this._renderer.buffer;this._renderer.shader._getProgramData(t),this.checkCompatibility(e,t);const o=this.getSignature(e,t);this._geometryVaoHash[e.uid]||(this._geometryVaoHash[e.uid]=Object.create(null),e.on("destroy",this.onGeometryDestroy,this));const a=this._geometryVaoHash[e.uid];let l=a[o];if(l)return a[t._key]=l,l;qv(e,t._attributeData);const u=e.buffers;l=i.createVertexArray(),i.bindVertexArray(l);for(let c=0;c<u.length;c++){const d=u[c];s.bind(d)}return this.activateVao(e,t),a[t._key]=l,a[o]=l,i.bindVertexArray(null),l}onGeometryDestroy(e,t){const n=this._geometryVaoHash[e.uid],i=this.gl;if(n){if(t)for(const s in n)this._activeVao!==n[s]&&this.unbind(),i.deleteVertexArray(n[s]);this._geometryVaoHash[e.uid]=null}}destroyAll(e=!1){const t=this.gl;for(const n in this._geometryVaoHash){if(e)for(const i in this._geometryVaoHash[n]){const s=this._geometryVaoHash[n];this._activeVao!==s&&this.unbind(),t.deleteVertexArray(s[i])}this._geometryVaoHash[n]=null}}activateVao(e,t){const n=this._renderer.gl,i=this._renderer.buffer,s=e.attributes;e.indexBuffer&&i.bind(e.indexBuffer);let o=null;for(const a in s){const l=s[a],u=l.buffer,c=i.getGlBuffer(u),d=t._attributeData[a];if(d){o!==c&&(i.bind(u),o=c);const h=d.location;n.enableVertexAttribArray(h);const f=hn(l.format),p=XA(l.format);if(d.format?.substring(1,4)==="int"?n.vertexAttribIPointer(h,f.size,p,l.stride,l.offset):n.vertexAttribPointer(h,f.size,p,f.normalised,l.stride,l.offset),l.instance)if(this.hasInstance){const m=l.divisor??1;n.vertexAttribDivisor(h,m)}else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,t,n,i){const{gl:s}=this._renderer,o=this._activeGeometry,a=qA[o.topology||e];if(i||(i=o.instanceCount),o.indexBuffer){const l=o.indexBuffer.data.BYTES_PER_ELEMENT,u=l===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;i>1?s.drawElementsInstanced(a,t||o.indexBuffer.data.length,u,(n||0)*l,i):s.drawElements(a,t||o.indexBuffer.data.length,u,(n||0)*l)}else i>1?s.drawArraysInstanced(a,n||0,t||o.getSize(),i):s.drawArrays(a,n||0,t||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this._renderer=null,this.gl=null,this._activeVao=null,this._activeGeometry=null}}Kv.extension={type:[F.WebGLSystem],name:"geometry"};const YA=new oo({attributes:{aPosition:[-1,-1,3,-1,-1,3]}}),xd=class $v{constructor(e){this.useBackBuffer=!1,this._useBackBufferThisRender=!1,this._renderer=e}init(e={}){const{useBackBuffer:t,antialias:n}={...$v.defaultOptions,...e};this.useBackBuffer=t,this._antialias=n,this._renderer.context.supports.msaa||(de("antialiasing, is not supported on when using the back buffer"),this._antialias=!1),this._state=vr.for2d();const i=new be({vertex:`
                attribute vec2 aPosition;
                out vec2 vUv;

                void main() {
                    gl_Position = vec4(aPosition, 0.0, 1.0);

                    vUv = (aPosition + 1.0) / 2.0;

                    // flip dem UVs
                    vUv.y = 1.0 - vUv.y;
                }`,fragment:`
                in vec2 vUv;
                out vec4 finalColor;

                uniform sampler2D uTexture;

                void main() {
                    finalColor = texture(uTexture, vUv);
                }`,name:"big-triangle"});this._bigTriangleShader=new sr({glProgram:i,resources:{uTexture:te.WHITE.source}})}renderStart(e){const t=this._renderer.renderTarget.getRenderTarget(e.target);if(this._useBackBufferThisRender=this.useBackBuffer&&!!t.isRoot,this._useBackBufferThisRender){const n=this._renderer.renderTarget.getRenderTarget(e.target);this._targetTexture=n.colorTexture,e.target=this._getBackBufferTexture(n.colorTexture)}}renderEnd(){this._presentBackBuffer()}_presentBackBuffer(){const e=this._renderer;e.renderTarget.finishRenderPass(),this._useBackBufferThisRender&&(e.renderTarget.bind(this._targetTexture,!1),this._bigTriangleShader.resources.uTexture=this._backBufferTexture.source,e.encoder.draw({geometry:YA,shader:this._bigTriangleShader,state:this._state}))}_getBackBufferTexture(e){return this._backBufferTexture=this._backBufferTexture||new te({source:new lt({width:e.width,height:e.height,resolution:e._resolution,antialias:this._antialias})}),this._backBufferTexture.source.resize(e.width,e.height,e._resolution),this._backBufferTexture}destroy(){this._backBufferTexture&&(this._backBufferTexture.destroy(),this._backBufferTexture=null)}};xd.extension={type:[F.WebGLSystem],name:"backBuffer",priority:1};xd.defaultOptions={useBackBuffer:!1};let KA=xd;class Zv{constructor(e){this._colorMaskCache=15,this._renderer=e}setMask(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.gl.colorMask(!!(e&8),!!(e&4),!!(e&2),!!(e&1)))}}Zv.extension={type:[F.WebGLSystem],name:"colorMask"};class Qv{constructor(e){this.commandFinished=Promise.resolve(),this._renderer=e}setGeometry(e,t){this._renderer.geometry.bind(e,t.glProgram)}finishRenderPass(){}draw(e){const t=this._renderer,{geometry:n,shader:i,state:s,skipSync:o,topology:a,size:l,start:u,instanceCount:c}=e;t.shader.bind(i,o),t.geometry.bind(n,t.shader._activeProgram),s&&t.state.set(s),t.geometry.draw(a,l,u,c??n.instanceCount)}destroy(){this._renderer=null}}Qv.extension={type:[F.WebGLSystem],name:"encoder"};class $A{constructor(){this.width=-1,this.height=-1,this.msaa=!1,this.msaaRenderBuffer=[]}}const vn=[];vn[nt.NONE]=void 0;vn[nt.DISABLED]={stencilWriteMask:0,stencilReadMask:0};vn[nt.RENDERING_MASK_ADD]={stencilFront:{compare:"equal",passOp:"increment-clamp"},stencilBack:{compare:"equal",passOp:"increment-clamp"}};vn[nt.RENDERING_MASK_REMOVE]={stencilFront:{compare:"equal",passOp:"decrement-clamp"},stencilBack:{compare:"equal",passOp:"decrement-clamp"}};vn[nt.MASK_ACTIVE]={stencilWriteMask:0,stencilFront:{compare:"equal",passOp:"keep"},stencilBack:{compare:"equal",passOp:"keep"}};vn[nt.INVERSE_MASK_ACTIVE]={stencilWriteMask:0,stencilFront:{compare:"not-equal",passOp:"replace"},stencilBack:{compare:"not-equal",passOp:"replace"}};class Jv{constructor(e){this._stencilCache={enabled:!1,stencilReference:0,stencilMode:nt.NONE},this._renderTargetStencilState=Object.create(null),e.renderTarget.onRenderTargetChange.add(this)}contextChange(e){this._gl=e,this._comparisonFuncMapping={always:e.ALWAYS,never:e.NEVER,equal:e.EQUAL,"not-equal":e.NOTEQUAL,less:e.LESS,"less-equal":e.LEQUAL,greater:e.GREATER,"greater-equal":e.GEQUAL},this._stencilOpsMapping={keep:e.KEEP,zero:e.ZERO,replace:e.REPLACE,invert:e.INVERT,"increment-clamp":e.INCR,"decrement-clamp":e.DECR,"increment-wrap":e.INCR_WRAP,"decrement-wrap":e.DECR_WRAP},this._stencilCache.enabled=!1,this._stencilCache.stencilMode=nt.NONE,this._stencilCache.stencilReference=0}onRenderTargetChange(e){if(this._activeRenderTarget===e)return;this._activeRenderTarget=e;let t=this._renderTargetStencilState[e.uid];t||(t=this._renderTargetStencilState[e.uid]={stencilMode:nt.DISABLED,stencilReference:0}),this.setStencilMode(t.stencilMode,t.stencilReference)}setStencilMode(e,t){const n=this._renderTargetStencilState[this._activeRenderTarget.uid],i=this._gl,s=vn[e],o=this._stencilCache;if(n.stencilMode=e,n.stencilReference=t,e===nt.DISABLED){this._stencilCache.enabled&&(this._stencilCache.enabled=!1,i.disable(i.STENCIL_TEST));return}this._stencilCache.enabled||(this._stencilCache.enabled=!0,i.enable(i.STENCIL_TEST)),(e!==o.stencilMode||o.stencilReference!==t)&&(o.stencilMode=e,o.stencilReference=t,i.stencilFunc(this._comparisonFuncMapping[s.stencilBack.compare],t,255),i.stencilOp(i.KEEP,i.KEEP,this._stencilOpsMapping[s.stencilBack.passOp]))}}Jv.extension={type:[F.WebGLSystem],name:"stencil"};class e0{constructor(e){this._syncFunctionHash=Object.create(null),this._adaptor=e,this._systemCheck()}_systemCheck(){if(!Bg())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}ensureUniformGroup(e){const t=this.getUniformGroupData(e);e.buffer||(e.buffer=new Ht({data:new Float32Array(t.layout.size/4),usage:Ae.UNIFORM|Ae.COPY_DST}))}getUniformGroupData(e){return this._syncFunctionHash[e._signature]||this._initUniformGroup(e)}_initUniformGroup(e){const t=e._signature;let n=this._syncFunctionHash[t];if(!n){const i=Object.keys(e.uniformStructures).map(a=>e.uniformStructures[a]),s=this._adaptor.createUboElements(i),o=this._generateUboSync(s.uboElements);n=this._syncFunctionHash[t]={layout:s,syncFunction:o}}return this._syncFunctionHash[t]}_generateUboSync(e){return this._adaptor.generateUboSync(e)}syncUniformGroup(e,t,n){const i=this.getUniformGroupData(e);return e.buffer||(e.buffer=new Ht({data:new Float32Array(i.layout.size/4),usage:Ae.UNIFORM|Ae.COPY_DST})),t||(t=e.buffer.data),n||(n=0),i.syncFunction(e.uniforms,t,n),!0}updateUniformGroup(e){if(e.isStatic&&!e._dirtyId)return!1;e._dirtyId=0;const t=this.syncUniformGroup(e);return e.buffer.update(),t}destroy(){this._syncFunctionHash=null}}const t0={f32:4,"vec2<f32>":8,"vec3<f32>":12,"vec4<f32>":16,"mat2x2<f32>":16*2,"mat3x3<f32>":16*3,"mat4x4<f32>":16*4};function ZA(r){const e=r.map(s=>({data:s,offset:0,size:0}));let t=0,n=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(t=t0[o.data.type],!t)throw new Error(`Unknown type ${o.data.type}`);if(o.data.size>1&&(t=Math.max(t,16)*o.data.size),o.size=t,n%t!==0&&n<16){const a=n%t%16;n+=a,i+=a}n+t>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=t,n=t):(o.offset=i,n+=t,i+=t)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}const On=[{type:"mat3x3<f32>",test:r=>r.value.a!==void 0,ubo:`
            var matrix = uv[name].toArray(true);
            data[offset] = matrix[0];
            data[offset + 1] = matrix[1];
            data[offset + 2] = matrix[2];
            data[offset + 4] = matrix[3];
            data[offset + 5] = matrix[4];
            data[offset + 6] = matrix[5];
            data[offset + 8] = matrix[6];
            data[offset + 9] = matrix[7];
            data[offset + 10] = matrix[8];
        `,uniform:`
            gl.uniformMatrix3fv(ud[name].location, false, uv[name].toArray(true));
        `},{type:"vec4<f32>",test:r=>r.type==="vec4<f32>"&&r.size===1&&r.value.width!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
            data[offset + 2] = v.width;
            data[offset + 3] = v.height;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height) {
                cv[0] = v.x;
                cv[1] = v.y;
                cv[2] = v.width;
                cv[3] = v.height;
                gl.uniform4f(ud[name].location, v.x, v.y, v.width, v.height);
            }
        `},{type:"vec2<f32>",test:r=>r.type==="vec2<f32>"&&r.size===1&&r.value.x!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y) {
                cv[0] = v.x;
                cv[1] = v.y;
                gl.uniform2f(ud[name].location, v.x, v.y);
            }
        `},{type:"vec4<f32>",test:r=>r.type==="vec4<f32>"&&r.size===1&&r.value.red!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
            data[offset + 3] = v.alpha;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                cv[3] = v.alpha;
                gl.uniform4f(ud[name].location, v.red, v.green, v.blue, v.alpha);
            }
        `},{type:"vec3<f32>",test:r=>r.type==="vec3<f32>"&&r.size===1&&r.value.red!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                gl.uniform3f(ud[name].location, v.red, v.green, v.blue);
            }
        `}];function r0(r,e,t,n){const i=[`
        var v = null;
        var v2 = null;
        var t = 0;
        var index = 0;
        var name = null;
        var arrayOffset = null;
    `];let s=0;for(let a=0;a<r.length;a++){const l=r[a],u=l.data.name;let c=!1,d=0;for(let h=0;h<On.length;h++)if(On[h].test(l.data)){d=l.offset/4,i.push(`name = "${u}";`,`offset += ${d-s};`,On[h][e]||On[h].ubo),c=!0;break}if(!c)if(l.data.size>1)d=l.offset/4,i.push(t(l,d-s));else{const h=n[l.data.type];d=l.offset/4,i.push(`
                    v = uv.${u};
                    offset += ${d-s};
                    ${h};
                `)}s=d}const o=i.join(`
`);return new Function("uv","data","offset",o)}function hi(r,e){return`
        for (let i = 0; i < ${r*e}; i++) {
            data[offset + (((i / ${r})|0) * 4) + (i % ${r})] = v[i];
        }
    `}const n0={f32:`
        data[offset] = v;`,i32:`
        data[offset] = v;`,"vec2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];`,"vec3<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];`,"vec4<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 3] = v[3];`,"mat2x2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 4] = v[2];
        data[offset + 5] = v[3];`,"mat3x3<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];
        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];`,"mat4x4<f32>":`
        for (let i = 0; i < 16; i++) {
            data[offset + i] = v[i];
        }`,"mat3x2<f32>":hi(3,2),"mat4x2<f32>":hi(4,2),"mat2x3<f32>":hi(2,3),"mat4x3<f32>":hi(4,3),"mat2x4<f32>":hi(2,4),"mat3x4<f32>":hi(3,4)},QA={...n0,"mat2x2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 3] = v[3];
    `};function JA(r,e){const t=Math.max(t0[r.data.type]/16,1),n=r.data.value.length/r.data.size,i=(4-n%4)%4;return`
        v = uv.${r.data.name};
        offset += ${e};

        arrayOffset = offset;

        t = 0;

        for(var i=0; i < ${r.data.size*t}; i++)
        {
            for(var j = 0; j < ${n}; j++)
            {
                data[arrayOffset++] = v[t++];
            }
            ${i!==0?`arrayOffset += ${i};`:""}
        }
    `}function e4(r){return r0(r,"uboStd40",JA,n0)}class i0 extends e0{constructor(){super({createUboElements:ZA,generateUboSync:e4})}}i0.extension={type:[F.WebGLSystem],name:"ubo"};class t4{constructor(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new Le}init(e,t){this._renderer=e,this._renderTargetSystem=t,e.runners.contextChange.add(this)}contextChange(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new Le}copyToTexture(e,t,n,i,s){const o=this._renderTargetSystem,a=this._renderer,l=o.getGpuRenderTarget(e),u=a.gl;return this.finishRenderPass(e),u.bindFramebuffer(u.FRAMEBUFFER,l.resolveTargetFramebuffer),a.texture.bind(t,0),u.copyTexSubImage2D(u.TEXTURE_2D,0,s.x,s.y,n.x,n.y,i.width,i.height),t}startRenderPass(e,t=!0,n,i){const s=this._renderTargetSystem,o=e.colorTexture,a=s.getGpuRenderTarget(e);let l=i.y;e.isRoot&&(l=o.pixelHeight-i.height),e.colorTextures.forEach(d=>{this._renderer.texture.unbind(d)});const u=this._renderer.gl;u.bindFramebuffer(u.FRAMEBUFFER,a.framebuffer);const c=this._viewPortCache;(c.x!==i.x||c.y!==l||c.width!==i.width||c.height!==i.height)&&(c.x=i.x,c.y=l,c.width=i.width,c.height=i.height,u.viewport(i.x,l,i.width,i.height)),!a.depthStencilRenderBuffer&&(e.stencil||e.depth)&&this._initStencil(a),this.clear(e,t,n)}finishRenderPass(e){const n=this._renderTargetSystem.getGpuRenderTarget(e);if(!n.msaa)return;const i=this._renderer.gl;i.bindFramebuffer(i.FRAMEBUFFER,n.resolveTargetFramebuffer),i.bindFramebuffer(i.READ_FRAMEBUFFER,n.framebuffer),i.blitFramebuffer(0,0,n.width,n.height,0,0,n.width,n.height,i.COLOR_BUFFER_BIT,i.NEAREST),i.bindFramebuffer(i.FRAMEBUFFER,n.framebuffer)}initGpuRenderTarget(e){const t=this._renderer,n=t.gl,i=new $A;return e.colorTexture.resource===t.canvas?(this._renderer.context.ensureCanvasSize(e.colorTexture.resource),i.framebuffer=null,i):(this._initColor(e,i),n.bindFramebuffer(n.FRAMEBUFFER,null),i)}destroyGpuRenderTarget(e){const t=this._renderer.gl;e.framebuffer&&(t.deleteFramebuffer(e.framebuffer),e.framebuffer=null),e.resolveTargetFramebuffer&&(t.deleteFramebuffer(e.resolveTargetFramebuffer),e.resolveTargetFramebuffer=null),e.depthStencilRenderBuffer&&(t.deleteRenderbuffer(e.depthStencilRenderBuffer),e.depthStencilRenderBuffer=null),e.msaaRenderBuffer.forEach(n=>{t.deleteRenderbuffer(n)}),e.msaaRenderBuffer=null}clear(e,t,n){if(!t)return;const i=this._renderTargetSystem;typeof t=="boolean"&&(t=t?Dt.ALL:Dt.NONE);const s=this._renderer.gl;if(t&Dt.COLOR){n??(n=i.defaultClearColor);const o=this._clearColorCache,a=n;(o[0]!==a[0]||o[1]!==a[1]||o[2]!==a[2]||o[3]!==a[3])&&(o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],s.clearColor(a[0],a[1],a[2],a[3]))}s.clear(t)}resizeGpuRenderTarget(e){if(e.isRoot)return;const n=this._renderTargetSystem.getGpuRenderTarget(e);this._resizeColor(e,n),(e.stencil||e.depth)&&this._resizeStencil(n)}_initColor(e,t){const n=this._renderer,i=n.gl,s=i.createFramebuffer();if(t.resolveTargetFramebuffer=s,i.bindFramebuffer(i.FRAMEBUFFER,s),t.width=e.colorTexture.source.pixelWidth,t.height=e.colorTexture.source.pixelHeight,e.colorTextures.forEach((o,a)=>{const l=o.source;l.antialias&&(n.context.supports.msaa?t.msaa=!0:de("[RenderTexture] Antialiasing on textures is not supported in WebGL1")),n.texture.bindSource(l,0);const c=n.texture.getGlSource(l).texture;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+a,3553,c,0)}),t.msaa){const o=i.createFramebuffer();t.framebuffer=o,i.bindFramebuffer(i.FRAMEBUFFER,o),e.colorTextures.forEach((a,l)=>{const u=i.createRenderbuffer();t.msaaRenderBuffer[l]=u})}else t.framebuffer=s;this._resizeColor(e,t)}_resizeColor(e,t){const n=e.colorTexture.source;if(t.width=n.pixelWidth,t.height=n.pixelHeight,e.colorTextures.forEach((i,s)=>{s!==0&&i.source.resize(n.width,n.height,n._resolution)}),t.msaa){const i=this._renderer,s=i.gl,o=t.framebuffer;s.bindFramebuffer(s.FRAMEBUFFER,o),e.colorTextures.forEach((a,l)=>{const u=a.source;i.texture.bindSource(u,0);const d=i.texture.getGlSource(u).internalFormat,h=t.msaaRenderBuffer[l];s.bindRenderbuffer(s.RENDERBUFFER,h),s.renderbufferStorageMultisample(s.RENDERBUFFER,4,d,u.pixelWidth,u.pixelHeight),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+l,s.RENDERBUFFER,h)})}}_initStencil(e){if(e.framebuffer===null)return;const t=this._renderer.gl,n=t.createRenderbuffer();e.depthStencilRenderBuffer=n,t.bindRenderbuffer(t.RENDERBUFFER,n),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,n),this._resizeStencil(e)}_resizeStencil(e){const t=this._renderer.gl;t.bindRenderbuffer(t.RENDERBUFFER,e.depthStencilRenderBuffer),e.msaa?t.renderbufferStorageMultisample(t.RENDERBUFFER,4,t.DEPTH24_STENCIL8,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,this._renderer.context.webGLVersion===2?t.DEPTH24_STENCIL8:t.DEPTH_STENCIL,e.width,e.height)}postrender(e){if(this._renderer.context.multiView&&Xn.test(e.colorTexture.resource)){const t=this._renderer.context.canvas,n=e.colorTexture;n.context2D.drawImage(t,0,n.pixelHeight-t.height)}}}function r4(r,e,t,n,i,s){const o=s?1:-1;return r.identity(),r.a=1/n*2,r.d=o*(1/i*2),r.tx=-1-e*r.a,r.ty=-o-t*r.d,r}const gs=new Map;function s0(r,e){if(!gs.has(r)){const t=new te({source:new Xn({resource:r,...e})}),n=()=>{gs.get(r)===t&&gs.delete(r)};t.once("destroy",n),t.source.once("destroy",n),gs.set(r,t)}return gs.get(r)}function n4(r){const e=r.colorTexture.source.resource;return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement&&document.body.contains(e)}const o0=class a0{constructor(e={}){if(this.uid=tt("renderTarget"),this.colorTextures=[],this.dirtyId=0,this.isRoot=!1,this._size=new Float32Array(2),this._managedColorTextures=!1,e={...a0.defaultOptions,...e},this.stencil=e.stencil,this.depth=e.depth,this.isRoot=e.isRoot,typeof e.colorTextures=="number"){this._managedColorTextures=!0;for(let t=0;t<e.colorTextures;t++)this.colorTextures.push(new lt({width:e.width,height:e.height,resolution:e.resolution,antialias:e.antialias}))}else{this.colorTextures=[...e.colorTextures.map(n=>n.source)];const t=this.colorTexture.source;this.resize(t.width,t.height,t._resolution)}this.colorTexture.source.on("resize",this.onSourceResize,this),(e.depthStencilTexture||this.stencil)&&(e.depthStencilTexture instanceof te||e.depthStencilTexture instanceof lt?this.depthStencilTexture=e.depthStencilTexture.source:this.ensureDepthStencilTexture())}get size(){const e=this._size;return e[0]=this.pixelWidth,e[1]=this.pixelHeight,e}get width(){return this.colorTexture.source.width}get height(){return this.colorTexture.source.height}get pixelWidth(){return this.colorTexture.source.pixelWidth}get pixelHeight(){return this.colorTexture.source.pixelHeight}get resolution(){return this.colorTexture.source._resolution}get colorTexture(){return this.colorTextures[0]}onSourceResize(e){this.resize(e.width,e.height,e._resolution,!0)}ensureDepthStencilTexture(){this.depthStencilTexture||(this.depthStencilTexture=new lt({width:this.width,height:this.height,resolution:this.resolution,format:"depth24plus-stencil8",autoGenerateMipmaps:!1,antialias:!1,mipLevelCount:1}))}resize(e,t,n=this.resolution,i=!1){this.dirtyId++,this.colorTextures.forEach((s,o)=>{i&&o===0||s.source.resize(e,t,n)}),this.depthStencilTexture&&this.depthStencilTexture.source.resize(e,t,n)}destroy(){this.colorTexture.source.off("resize",this.onSourceResize,this),this._managedColorTextures&&this.colorTextures.forEach(e=>{e.destroy()}),this.depthStencilTexture&&(this.depthStencilTexture.destroy(),delete this.depthStencilTexture)}};o0.defaultOptions={width:0,height:0,resolution:1,colorTextures:1,stencil:!1,depth:!1,antialias:!1,isRoot:!1};let ec=o0;class l0{constructor(e){this.rootViewPort=new Le,this.viewport=new Le,this.onRenderTargetChange=new Gg("onRenderTargetChange"),this.projectionMatrix=new ae,this.defaultClearColor=[0,0,0,0],this._renderSurfaceToRenderTargetHash=new Map,this._gpuRenderTargetHash=Object.create(null),this._renderTargetStack=[],this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuRenderTargetHash")}finishRenderPass(){this.adaptor.finishRenderPass(this.renderTarget)}renderStart({target:e,clear:t,clearColor:n,frame:i}){this._renderTargetStack.length=0,this.push(e,t,n,i),this.rootViewPort.copyFrom(this.viewport),this.rootRenderTarget=this.renderTarget,this.renderingToScreen=n4(this.rootRenderTarget)}postrender(){this.adaptor.postrender?.(this.rootRenderTarget)}bind(e,t=!0,n,i){const s=this.getRenderTarget(e),o=this.renderTarget!==s;this.renderTarget=s,this.renderSurface=e;const a=this.getGpuRenderTarget(s);(s.pixelWidth!==a.width||s.pixelHeight!==a.height)&&(this.adaptor.resizeGpuRenderTarget(s),a.width=s.pixelWidth,a.height=s.pixelHeight);const l=s.colorTexture,u=this.viewport,c=l.pixelWidth,d=l.pixelHeight;if(!i&&e instanceof te&&(i=e.frame),i){const h=l._resolution;u.x=i.x*h+.5|0,u.y=i.y*h+.5|0,u.width=i.width*h+.5|0,u.height=i.height*h+.5|0}else u.x=0,u.y=0,u.width=c,u.height=d;return r4(this.projectionMatrix,0,0,u.width/l.resolution,u.height/l.resolution,!s.isRoot),this.adaptor.startRenderPass(s,t,n,u),o&&this.onRenderTargetChange.emit(s),s}clear(e,t=Dt.ALL,n){t&&(e&&(e=this.getRenderTarget(e)),this.adaptor.clear(e||this.renderTarget,t,n,this.viewport))}contextChange(){this._gpuRenderTargetHash=Object.create(null)}push(e,t=Dt.ALL,n,i){const s=this.bind(e,t,n,i);return this._renderTargetStack.push({renderTarget:s,frame:i}),s}pop(){this._renderTargetStack.pop();const e=this._renderTargetStack[this._renderTargetStack.length-1];this.bind(e.renderTarget,!1,null,e.frame)}getRenderTarget(e){return e.isTexture&&(e=e.source),this._renderSurfaceToRenderTargetHash.get(e)??this._initRenderTarget(e)}copyToTexture(e,t,n,i,s){n.x<0&&(i.width+=n.x,s.x-=n.x,n.x=0),n.y<0&&(i.height+=n.y,s.y-=n.y,n.y=0);const{pixelWidth:o,pixelHeight:a}=e;return i.width=Math.min(i.width,o-n.x),i.height=Math.min(i.height,a-n.y),this.adaptor.copyToTexture(e,t,n,i,s)}ensureDepthStencil(){this.renderTarget.stencil||(this.renderTarget.stencil=!0,this.adaptor.startRenderPass(this.renderTarget,!1,null,this.viewport))}destroy(){this._renderer=null,this._renderSurfaceToRenderTargetHash.forEach((e,t)=>{e!==t&&e.destroy()}),this._renderSurfaceToRenderTargetHash.clear(),this._gpuRenderTargetHash=Object.create(null)}_initRenderTarget(e){let t=null;return Xn.test(e)&&(e=s0(e).source),e instanceof ec?t=e:e instanceof lt&&(t=new ec({colorTextures:[e]}),Xn.test(e.source.resource)&&(t.isRoot=!0),e.once("destroy",()=>{t.destroy(),this._renderSurfaceToRenderTargetHash.delete(e);const n=this._gpuRenderTargetHash[t.uid];n&&(this._gpuRenderTargetHash[t.uid]=null,this.adaptor.destroyGpuRenderTarget(n))})),this._renderSurfaceToRenderTargetHash.set(e,t),t}getGpuRenderTarget(e){return this._gpuRenderTargetHash[e.uid]||(this._gpuRenderTargetHash[e.uid]=this.adaptor.initGpuRenderTarget(e))}}class u0 extends l0{constructor(e){super(e),this.adaptor=new t4,this.adaptor.init(e,this)}}u0.extension={type:[F.WebGLSystem],name:"renderTarget"};class bd extends jt{constructor({buffer:e,offset:t,size:n}){super(),this.uid=tt("buffer"),this._resourceType="bufferResource",this._touched=0,this._resourceId=tt("resource"),this._bufferResource=!0,this.destroyed=!1,this.buffer=e,this.offset=t|0,this.size=n,this.buffer.on("change",this.onBufferChange,this)}onBufferChange(){this._resourceId=tt("resource"),this.emit("change",this)}destroy(e=!1){this.destroyed=!0,e&&this.buffer.destroy(),this.emit("change",this),this.buffer=null}}function i4(r,e){const t=[],n=[`
        var g = s.groups;
        var sS = r.shader;
        var p = s.glProgram;
        var ugS = r.uniformGroup;
        var resources;
    `];let i=!1,s=0,o=0;const a=e._getProgramData(r.glProgram);for(const u in r.groups){const c=r.groups[u];t.push(`
            resources = g[${u}].resources;
        `);for(const d in c.resources){const h=c.resources[d];if(h instanceof _t)h.ubo?t.push(`
                        sS.bindUniformBlock(
                            resources[${d}],
                            sS._uniformBindMap[${u}[${d}],
                            ${s++}
                        );
                    `):t.push(`
                        ugS.updateUniformGroup(resources[${d}], p, sD);
                    `);else if(h instanceof bd)t.push(`
                    sS.bindUniformBlock(
                        resources[${d}],
                        sS._uniformBindMap[${u}[${d}],
                        ${s++}
                    );
                `);else if(h instanceof lt){const f=r._uniformBindMap[u][d],p=a.uniformData[f];p&&(i||(i=!0,n.push(`
                        var tS = r.texture;
                        `)),e._gl.uniform1i(p.location,o),t.push(`
                        tS.bind(resources[${d}], ${o});
                    `),o++)}}}const l=[...n,...t].join(`
`);return new Function("r","s","sD",l)}class s4{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBlockBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBlockBindings=null,this.program=null}}function sp(r,e,t){const n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),n}function nu(r){const e=new Array(r);for(let t=0;t<e.length;t++)e[t]=!1;return e}function c0(r,e){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return nu(2*e);case"bvec3":return nu(3*e);case"bvec4":return nu(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}let zo=null;const op={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"},o4={float:"float32",vec2:"float32x2",vec3:"float32x3",vec4:"float32x4",int:"sint32",ivec2:"sint32x2",ivec3:"sint32x3",ivec4:"sint32x4",uint:"uint32",uvec2:"uint32x2",uvec3:"uint32x3",uvec4:"uint32x4",bool:"uint32",bvec2:"uint32x2",bvec3:"uint32x3",bvec4:"uint32x4"};function d0(r,e){if(!zo){const t=Object.keys(op);zo={};for(let n=0;n<t.length;++n){const i=t[n];zo[r[i]]=op[i]}}return zo[e]}function a4(r,e){const t=d0(r,e);return o4[t]||"float32"}function l4(r,e,t=!1){const n={},i=e.getProgramParameter(r,e.ACTIVE_ATTRIBUTES);for(let o=0;o<i;o++){const a=e.getActiveAttrib(r,o);if(a.name.startsWith("gl_"))continue;const l=a4(e,a.type);n[a.name]={location:0,format:l,stride:hn(l).stride,offset:0,instance:!1,start:0}}const s=Object.keys(n);if(t){s.sort((o,a)=>o>a?1:-1);for(let o=0;o<s.length;o++)n[s[o]].location=o,e.bindAttribLocation(r,o,s[o]);e.linkProgram(r)}else for(let o=0;o<s.length;o++)n[s[o]].location=e.getAttribLocation(r,s[o]);return n}function u4(r,e){if(!e.ACTIVE_UNIFORM_BLOCKS)return{};const t={},n=e.getProgramParameter(r,e.ACTIVE_UNIFORM_BLOCKS);for(let i=0;i<n;i++){const s=e.getActiveUniformBlockName(r,i),o=e.getUniformBlockIndex(r,s),a=e.getActiveUniformBlockParameter(r,i,e.UNIFORM_BLOCK_DATA_SIZE);t[s]={name:s,index:o,size:a}}return t}function c4(r,e){const t={},n=e.getProgramParameter(r,e.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const s=e.getActiveUniform(r,i),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=d0(e,s.type);t[o]={name:o,index:i,type:l,size:s.size,isArray:a,value:c0(l,s.size)}}return t}function ap(r,e){const t=r.getShaderSource(e).split(`
`).map((u,c)=>`${c}: ${u}`),n=r.getShaderInfoLog(e),i=n.split(`
`),s={},o=i.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!s[u]?(s[u]=!0,!0):!1),a=[""];o.forEach(u=>{t[u-1]=`%c${t[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=t.join(`
`);a[0]=l,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function d4(r,e,t,n){r.getProgramParameter(e,r.LINK_STATUS)||(r.getShaderParameter(t,r.COMPILE_STATUS)||ap(r,t),r.getShaderParameter(n,r.COMPILE_STATUS)||ap(r,n),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(e)))}function h4(r,e){const t=sp(r,r.VERTEX_SHADER,e.vertex),n=sp(r,r.FRAGMENT_SHADER,e.fragment),i=r.createProgram();r.attachShader(i,t),r.attachShader(i,n);const s=e.transformFeedbackVaryings;s&&(typeof r.transformFeedbackVaryings!="function"?de("TransformFeedback is not supported but TransformFeedbackVaryings are given."):r.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?r.SEPARATE_ATTRIBS:r.INTERLEAVED_ATTRIBS)),r.linkProgram(i),r.getProgramParameter(i,r.LINK_STATUS)||d4(r,i,t,n),e._attributeData=l4(i,r,!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertex)),e._uniformData=c4(i,r),e._uniformBlockData=u4(i,r),r.deleteShader(t),r.deleteShader(n);const o={};for(const l in e._uniformData){const u=e._uniformData[l];o[l]={location:r.getUniformLocation(i,l),value:c0(u.type,u.size)}}return new s4(i,o)}const Lo={textureCount:0,blockIndex:0};class h0{constructor(e){this._activeProgram=null,this._programDataHash=Object.create(null),this._nextIndex=0,this._boundUniformsIdsToIndexHash=Object.create(null),this._boundIndexToUniformsHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_programDataHash")}contextChange(e){this._gl=e,this._maxBindings=e.MAX_UNIFORM_BUFFER_BINDINGS?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0,this._programDataHash=Object.create(null),this._boundUniformsIdsToIndexHash=Object.create(null),this._boundIndexToUniformsHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._activeProgram=null,this.maxTextures=ss()}bind(e,t){if(this._setProgram(e.glProgram),t)return;Lo.textureCount=0,Lo.blockIndex=0;let n=this._shaderSyncFunctions[e.glProgram._key];n||(n=this._shaderSyncFunctions[e.glProgram._key]=this._generateShaderSync(e,this)),n(this._renderer,e,Lo)}updateUniformGroup(e){this._renderer.uniformGroup.updateUniformGroup(e,this._activeProgram,Lo)}bindUniformBlock(e,t,n=0){const i=this._renderer.buffer,s=this._getProgramData(this._activeProgram),o=e._bufferResource;o&&this._renderer.ubo.updateUniformGroup(e),i.updateBuffer(e.buffer);let a=this._boundUniformsIdsToIndexHash[e.uid];if(a===void 0){const c=this._nextIndex++%this._maxBindings,d=this._boundIndexToUniformsHash[c];d&&(this._boundUniformsIdsToIndexHash[d.uid]=void 0),a=this._boundUniformsIdsToIndexHash[e.uid]=c,this._boundIndexToUniformsHash[c]=e,o?i.bindBufferRange(e.buffer,c,e.offset):i.bindBufferBase(e.buffer,c)}const l=this._gl,u=this._activeProgram._uniformBlockData[t].index;s.uniformBlockBindings[n]!==a&&(s.uniformBlockBindings[n]=a,l.uniformBlockBinding(s.program,u,a))}_setProgram(e){if(this._activeProgram===e)return;this._activeProgram=e;const t=this._getProgramData(e);this._gl.useProgram(t.program)}_getProgramData(e){return this._programDataHash[e._key]||this._createProgramData(e)}_createProgramData(e){const t=e._key;return this._programDataHash[t]=h4(this._gl,e),this._programDataHash[t]}destroy(){for(const e of Object.keys(this._programDataHash))this._programDataHash[e].destroy(),this._programDataHash[e]=null;this._programDataHash=null,this._boundUniformsIdsToIndexHash=null}_generateShaderSync(e,t){return i4(e,t)}}h0.extension={type:[F.WebGLSystem],name:"shader"};const f4={f32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1f(location, v);
        }`,"vec2<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2f(location, v[0], v[1]);
        }`,"vec3<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3f(location, v[0], v[1], v[2]);
        }`,"vec4<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4f(location, v[0], v[1], v[2], v[3]);
        }`,i32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,"vec2<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,"vec3<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,"vec4<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,u32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1ui(location, v);
        }`,"vec2<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2ui(location, v[0], v[1]);
        }`,"vec3<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3ui(location, v[0], v[1], v[2]);
        }`,"vec4<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
        }`,bool:`if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,"vec2<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,"vec3<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,"vec4<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,"mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);"},p4={f32:"gl.uniform1fv(location, v);","vec2<f32>":"gl.uniform2fv(location, v);","vec3<f32>":"gl.uniform3fv(location, v);","vec4<f32>":"gl.uniform4fv(location, v);","mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);",i32:"gl.uniform1iv(location, v);","vec2<i32>":"gl.uniform2iv(location, v);","vec3<i32>":"gl.uniform3iv(location, v);","vec4<i32>":"gl.uniform4iv(location, v);",u32:"gl.uniform1iv(location, v);","vec2<u32>":"gl.uniform2iv(location, v);","vec3<u32>":"gl.uniform3iv(location, v);","vec4<u32>":"gl.uniform4iv(location, v);",bool:"gl.uniform1iv(location, v);","vec2<bool>":"gl.uniform2iv(location, v);","vec3<bool>":"gl.uniform3iv(location, v);","vec4<bool>":"gl.uniform4iv(location, v);"};function m4(r,e){const t=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
        var name = null;
    `];for(const n in r.uniforms){if(!e[n]){r.uniforms[n]instanceof _t?r.uniforms[n].ubo?t.push(`
                        renderer.shader.bindUniformBlock(uv.${n}, "${n}");
                    `):t.push(`
                        renderer.shader.updateUniformGroup(uv.${n});
                    `):r.uniforms[n]instanceof bd&&t.push(`
                        renderer.shader.bindBufferResource(uv.${n}, "${n}");
                    `);continue}const i=r.uniformStructures[n];let s=!1;for(let o=0;o<On.length;o++){const a=On[o];if(i.type===a.type&&a.test(i)){t.push(`name = "${n}";`,On[o].uniform),s=!0;break}}if(!s){const a=(i.size===1?f4:p4)[i.type].replace("location",`ud["${n}"].location`);t.push(`
            cu = ud["${n}"];
            cv = cu.value;
            v = uv["${n}"];
            ${a};`)}}return new Function("ud","uv","renderer","syncData",t.join(`
`))}class f0{constructor(e){this._cache={},this._uniformGroupSyncHash={},this._renderer=e,this.gl=null,this._cache={}}contextChange(e){this.gl=e}updateUniformGroup(e,t,n){const i=this._renderer.shader._getProgramData(t);(!e.isStatic||e._dirtyId!==i.uniformDirtyGroups[e.uid])&&(i.uniformDirtyGroups[e.uid]=e._dirtyId,this._getUniformSyncFunction(e,t)(i.uniformData,e.uniforms,this._renderer,n))}_getUniformSyncFunction(e,t){return this._uniformGroupSyncHash[e._signature]?.[t._key]||this._createUniformSyncFunction(e,t)}_createUniformSyncFunction(e,t){const n=this._uniformGroupSyncHash[e._signature]||(this._uniformGroupSyncHash[e._signature]={}),i=this._getSignature(e,t._uniformData,"u");return this._cache[i]||(this._cache[i]=this._generateUniformsSync(e,t._uniformData)),n[t._key]=this._cache[i],n[t._key]}_generateUniformsSync(e,t){return m4(e,t)}_getSignature(e,t,n){const i=e.uniforms,s=[`${n}-`];for(const o in i)s.push(o),t[o]&&s.push(t[o].type);return s.join("-")}destroy(){this._renderer=null,this._cache=null}}f0.extension={type:[F.WebGLSystem],name:"uniformGroup"};function g4(r){const e={};if(e.normal=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e.add=[r.ONE,r.ONE],e.multiply=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],e.screen=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],e.none=[0,0],e["normal-npm"]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],e["add-npm"]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],e["screen-npm"]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],e.erase=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],!(r instanceof Ee.get().getWebGLRenderingContext()))e.min=[r.ONE,r.ONE,r.ONE,r.ONE,r.MIN,r.MIN],e.max=[r.ONE,r.ONE,r.ONE,r.ONE,r.MAX,r.MAX];else{const n=r.getExtension("EXT_blend_minmax");n&&(e.min=[r.ONE,r.ONE,r.ONE,r.ONE,n.MIN_EXT,n.MIN_EXT],e.max=[r.ONE,r.ONE,r.ONE,r.ONE,n.MAX_EXT,n.MAX_EXT])}return e}const v4=0,x4=1,b4=2,_4=3,y4=4,S4=5,p0=class tc{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode="none",this._blendEq=!1,this.map=[],this.map[v4]=this.setBlend,this.map[x4]=this.setOffset,this.map[b4]=this.setCullFace,this.map[_4]=this.setDepthTest,this.map[y4]=this.setFrontFace,this.map[S4]=this.setDepthMask,this.checks=[],this.defaultState=vr.for2d()}contextChange(e){this.gl=e,this.blendModesMap=g4(e),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,n=0;for(;t;)t&1&&this.map[n].call(this,!!(e.data&1<<n)),t=t>>1,n++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this._updateCheck(tc._checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this._updateCheck(tc._checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(this.blendModesMap[e]||(e="normal"),e===this.blendMode)return;this.blendMode=e;const t=this.blendModesMap[e],n=this.gl;t.length===2?n.blendFunc(t[0],t[1]):n.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,n.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode="",this.setBlendMode("normal")}_updateCheck(e,t){const n=this.checks.indexOf(e);t&&n===-1?this.checks.push(e):!t&&n!==-1&&this.checks.splice(n,1)}static _checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static _checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null,this.checks.length=0}};p0.extension={type:[F.WebGLSystem],name:"state"};let w4=p0;class T4{constructor(e){this.target=Yv.TEXTURE_2D,this.texture=e,this.width=-1,this.height=-1,this.type=ke.UNSIGNED_BYTE,this.internalFormat=Ju.RGBA,this.format=Ju.RGBA,this.samplerType=0}}const C4={id:"buffer",upload(r,e,t){e.width===r.width||e.height===r.height?t.texSubImage2D(t.TEXTURE_2D,0,0,0,r.width,r.height,e.format,e.type,r.resource):t.texImage2D(e.target,0,e.internalFormat,r.width,r.height,0,e.format,e.type,r.resource),e.width=r.width,e.height=r.height}},P4={"bc1-rgba-unorm":!0,"bc1-rgba-unorm-srgb":!0,"bc2-rgba-unorm":!0,"bc2-rgba-unorm-srgb":!0,"bc3-rgba-unorm":!0,"bc3-rgba-unorm-srgb":!0,"bc4-r-unorm":!0,"bc4-r-snorm":!0,"bc5-rg-unorm":!0,"bc5-rg-snorm":!0,"bc6h-rgb-ufloat":!0,"bc6h-rgb-float":!0,"bc7-rgba-unorm":!0,"bc7-rgba-unorm-srgb":!0,"etc2-rgb8unorm":!0,"etc2-rgb8unorm-srgb":!0,"etc2-rgb8a1unorm":!0,"etc2-rgb8a1unorm-srgb":!0,"etc2-rgba8unorm":!0,"etc2-rgba8unorm-srgb":!0,"eac-r11unorm":!0,"eac-r11snorm":!0,"eac-rg11unorm":!0,"eac-rg11snorm":!0,"astc-4x4-unorm":!0,"astc-4x4-unorm-srgb":!0,"astc-5x4-unorm":!0,"astc-5x4-unorm-srgb":!0,"astc-5x5-unorm":!0,"astc-5x5-unorm-srgb":!0,"astc-6x5-unorm":!0,"astc-6x5-unorm-srgb":!0,"astc-6x6-unorm":!0,"astc-6x6-unorm-srgb":!0,"astc-8x5-unorm":!0,"astc-8x5-unorm-srgb":!0,"astc-8x6-unorm":!0,"astc-8x6-unorm-srgb":!0,"astc-8x8-unorm":!0,"astc-8x8-unorm-srgb":!0,"astc-10x5-unorm":!0,"astc-10x5-unorm-srgb":!0,"astc-10x6-unorm":!0,"astc-10x6-unorm-srgb":!0,"astc-10x8-unorm":!0,"astc-10x8-unorm-srgb":!0,"astc-10x10-unorm":!0,"astc-10x10-unorm-srgb":!0,"astc-12x10-unorm":!0,"astc-12x10-unorm-srgb":!0,"astc-12x12-unorm":!0,"astc-12x12-unorm-srgb":!0},A4={id:"compressed",upload(r,e,t){t.pixelStorei(t.UNPACK_ALIGNMENT,4);let n=r.pixelWidth,i=r.pixelHeight;const s=!!P4[r.format];for(let o=0;o<r.resource.length;o++){const a=r.resource[o];s?t.compressedTexImage2D(t.TEXTURE_2D,o,e.internalFormat,n,i,0,a):t.texImage2D(t.TEXTURE_2D,o,e.internalFormat,n,i,0,e.format,e.type,a),n=Math.max(n>>1,1),i=Math.max(i>>1,1)}}},m0={id:"image",upload(r,e,t,n){const i=r.alphaMode==="premultiply-alpha-on-upload";t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i);const s=e.width,o=e.height,a=r.pixelWidth,l=r.pixelHeight,u=r.resourceWidth,c=r.resourceHeight;u<a||c<l?((s!==a||o!==l)&&t.texImage2D(e.target,0,e.internalFormat,a,l,0,e.format,e.type,null),n===2?t.texSubImage2D(t.TEXTURE_2D,0,0,0,u,c,e.format,e.type,r.resource):t.texSubImage2D(t.TEXTURE_2D,0,0,0,e.format,e.type,r.resource)):s===a||o===l?t.texSubImage2D(t.TEXTURE_2D,0,0,0,e.format,e.type,r.resource):n===2?t.texImage2D(e.target,0,e.internalFormat,a,l,0,e.format,e.type,r.resource):t.texImage2D(e.target,0,e.internalFormat,e.format,e.type,r.resource),e.width=a,e.height=l}},E4={id:"video",upload(r,e,t,n){if(!r.isValid){t.texImage2D(e.target,0,e.internalFormat,1,1,0,e.format,e.type,null);return}m0.upload(r,e,t,n)}},lp={linear:9729,nearest:9728},M4={linear:{linear:9987,nearest:9985},nearest:{linear:9986,nearest:9984}},iu={"clamp-to-edge":33071,repeat:10497,"mirror-repeat":33648},R4={never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519};function up(r,e,t,n,i,s,o,a){const l=s;if(!a||r.addressModeU!=="repeat"||r.addressModeV!=="repeat"||r.addressModeW!=="repeat"){const u=iu[o?"clamp-to-edge":r.addressModeU],c=iu[o?"clamp-to-edge":r.addressModeV],d=iu[o?"clamp-to-edge":r.addressModeW];e[i](l,e.TEXTURE_WRAP_S,u),e[i](l,e.TEXTURE_WRAP_T,c),e.TEXTURE_WRAP_R&&e[i](l,e.TEXTURE_WRAP_R,d)}if((!a||r.magFilter!=="linear")&&e[i](l,e.TEXTURE_MAG_FILTER,lp[r.magFilter]),t){if(!a||r.mipmapFilter!=="linear"){const u=M4[r.minFilter][r.mipmapFilter];e[i](l,e.TEXTURE_MIN_FILTER,u)}}else e[i](l,e.TEXTURE_MIN_FILTER,lp[r.minFilter]);if(n&&r.maxAnisotropy>1){const u=Math.min(r.maxAnisotropy,e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));e[i](l,n.TEXTURE_MAX_ANISOTROPY_EXT,u)}r.compare&&e[i](l,e.TEXTURE_COMPARE_FUNC,R4[r.compare])}function k4(r){return{r8unorm:r.RED,r8snorm:r.RED,r8uint:r.RED,r8sint:r.RED,r16uint:r.RED,r16sint:r.RED,r16float:r.RED,rg8unorm:r.RG,rg8snorm:r.RG,rg8uint:r.RG,rg8sint:r.RG,r32uint:r.RED,r32sint:r.RED,r32float:r.RED,rg16uint:r.RG,rg16sint:r.RG,rg16float:r.RG,rgba8unorm:r.RGBA,"rgba8unorm-srgb":r.RGBA,rgba8snorm:r.RGBA,rgba8uint:r.RGBA,rgba8sint:r.RGBA,bgra8unorm:r.RGBA,"bgra8unorm-srgb":r.RGBA,rgb9e5ufloat:r.RGB,rgb10a2unorm:r.RGBA,rg11b10ufloat:r.RGB,rg32uint:r.RG,rg32sint:r.RG,rg32float:r.RG,rgba16uint:r.RGBA,rgba16sint:r.RGBA,rgba16float:r.RGBA,rgba32uint:r.RGBA,rgba32sint:r.RGBA,rgba32float:r.RGBA,stencil8:r.STENCIL_INDEX8,depth16unorm:r.DEPTH_COMPONENT,depth24plus:r.DEPTH_COMPONENT,"depth24plus-stencil8":r.DEPTH_STENCIL,depth32float:r.DEPTH_COMPONENT,"depth32float-stencil8":r.DEPTH_STENCIL}}function F4(r,e){let t={},n=r.RGBA;return r instanceof Ee.get().getWebGLRenderingContext()?e.srgb&&(t={"rgba8unorm-srgb":e.srgb.SRGB8_ALPHA8_EXT,"bgra8unorm-srgb":e.srgb.SRGB8_ALPHA8_EXT}):(t={"rgba8unorm-srgb":r.SRGB8_ALPHA8,"bgra8unorm-srgb":r.SRGB8_ALPHA8},n=r.RGBA8),{r8unorm:r.R8,r8snorm:r.R8_SNORM,r8uint:r.R8UI,r8sint:r.R8I,r16uint:r.R16UI,r16sint:r.R16I,r16float:r.R16F,rg8unorm:r.RG8,rg8snorm:r.RG8_SNORM,rg8uint:r.RG8UI,rg8sint:r.RG8I,r32uint:r.R32UI,r32sint:r.R32I,r32float:r.R32F,rg16uint:r.RG16UI,rg16sint:r.RG16I,rg16float:r.RG16F,rgba8unorm:r.RGBA,...t,rgba8snorm:r.RGBA8_SNORM,rgba8uint:r.RGBA8UI,rgba8sint:r.RGBA8I,bgra8unorm:n,rgb9e5ufloat:r.RGB9_E5,rgb10a2unorm:r.RGB10_A2,rg11b10ufloat:r.R11F_G11F_B10F,rg32uint:r.RG32UI,rg32sint:r.RG32I,rg32float:r.RG32F,rgba16uint:r.RGBA16UI,rgba16sint:r.RGBA16I,rgba16float:r.RGBA16F,rgba32uint:r.RGBA32UI,rgba32sint:r.RGBA32I,rgba32float:r.RGBA32F,stencil8:r.STENCIL_INDEX8,depth16unorm:r.DEPTH_COMPONENT16,depth24plus:r.DEPTH_COMPONENT24,"depth24plus-stencil8":r.DEPTH24_STENCIL8,depth32float:r.DEPTH_COMPONENT32F,"depth32float-stencil8":r.DEPTH32F_STENCIL8,...e.s3tc?{"bc1-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT,"bc2-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT,"bc3-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT}:{},...e.s3tc_sRGB?{"bc1-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,"bc2-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,"bc3-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}:{},...e.rgtc?{"bc4-r-unorm":e.rgtc.COMPRESSED_RED_RGTC1_EXT,"bc4-r-snorm":e.rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT,"bc5-rg-unorm":e.rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT,"bc5-rg-snorm":e.rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}:{},...e.bptc?{"bc6h-rgb-float":e.bptc.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,"bc6h-rgb-ufloat":e.bptc.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,"bc7-rgba-unorm":e.bptc.COMPRESSED_RGBA_BPTC_UNORM_EXT,"bc7-rgba-unorm-srgb":e.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT}:{},...e.etc?{"etc2-rgb8unorm":e.etc.COMPRESSED_RGB8_ETC2,"etc2-rgb8unorm-srgb":e.etc.COMPRESSED_SRGB8_ETC2,"etc2-rgb8a1unorm":e.etc.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgb8a1unorm-srgb":e.etc.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgba8unorm":e.etc.COMPRESSED_RGBA8_ETC2_EAC,"etc2-rgba8unorm-srgb":e.etc.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,"eac-r11unorm":e.etc.COMPRESSED_R11_EAC,"eac-rg11unorm":e.etc.COMPRESSED_SIGNED_RG11_EAC}:{},...e.astc?{"astc-4x4-unorm":e.astc.COMPRESSED_RGBA_ASTC_4x4_KHR,"astc-4x4-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,"astc-5x4-unorm":e.astc.COMPRESSED_RGBA_ASTC_5x4_KHR,"astc-5x4-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR,"astc-5x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_5x5_KHR,"astc-5x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,"astc-6x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_6x5_KHR,"astc-6x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,"astc-6x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_6x6_KHR,"astc-6x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,"astc-8x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x5_KHR,"astc-8x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,"astc-8x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x6_KHR,"astc-8x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,"astc-8x8-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x8_KHR,"astc-8x8-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,"astc-10x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x5_KHR,"astc-10x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,"astc-10x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x6_KHR,"astc-10x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,"astc-10x8-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x8_KHR,"astc-10x8-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,"astc-10x10-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x10_KHR,"astc-10x10-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,"astc-12x10-unorm":e.astc.COMPRESSED_RGBA_ASTC_12x10_KHR,"astc-12x10-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,"astc-12x12-unorm":e.astc.COMPRESSED_RGBA_ASTC_12x12_KHR,"astc-12x12-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR}:{}}}function I4(r){return{r8unorm:r.UNSIGNED_BYTE,r8snorm:r.BYTE,r8uint:r.UNSIGNED_BYTE,r8sint:r.BYTE,r16uint:r.UNSIGNED_SHORT,r16sint:r.SHORT,r16float:r.HALF_FLOAT,rg8unorm:r.UNSIGNED_BYTE,rg8snorm:r.BYTE,rg8uint:r.UNSIGNED_BYTE,rg8sint:r.BYTE,r32uint:r.UNSIGNED_INT,r32sint:r.INT,r32float:r.FLOAT,rg16uint:r.UNSIGNED_SHORT,rg16sint:r.SHORT,rg16float:r.HALF_FLOAT,rgba8unorm:r.UNSIGNED_BYTE,"rgba8unorm-srgb":r.UNSIGNED_BYTE,rgba8snorm:r.BYTE,rgba8uint:r.UNSIGNED_BYTE,rgba8sint:r.BYTE,bgra8unorm:r.UNSIGNED_BYTE,"bgra8unorm-srgb":r.UNSIGNED_BYTE,rgb9e5ufloat:r.UNSIGNED_INT_5_9_9_9_REV,rgb10a2unorm:r.UNSIGNED_INT_2_10_10_10_REV,rg11b10ufloat:r.UNSIGNED_INT_10F_11F_11F_REV,rg32uint:r.UNSIGNED_INT,rg32sint:r.INT,rg32float:r.FLOAT,rgba16uint:r.UNSIGNED_SHORT,rgba16sint:r.SHORT,rgba16float:r.HALF_FLOAT,rgba32uint:r.UNSIGNED_INT,rgba32sint:r.INT,rgba32float:r.FLOAT,stencil8:r.UNSIGNED_BYTE,depth16unorm:r.UNSIGNED_SHORT,depth24plus:r.UNSIGNED_INT,"depth24plus-stencil8":r.UNSIGNED_INT_24_8,depth32float:r.FLOAT,"depth32float-stencil8":r.FLOAT_32_UNSIGNED_INT_24_8_REV}}const B4=4;class g0{constructor(e){this.managedTextures=[],this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundTextures=[],this._activeTextureLocation=-1,this._boundSamplers=Object.create(null),this._uploads={image:m0,buffer:C4,video:E4,compressed:A4},this._useSeparateSamplers=!1,this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_glTextures"),this._renderer.renderableGC.addManagedHash(this,"_glSamplers")}contextChange(e){this._gl=e,this._mapFormatToInternalFormat||(this._mapFormatToInternalFormat=F4(e,this._renderer.context.extensions),this._mapFormatToType=I4(e),this._mapFormatToFormat=k4(e)),this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundSamplers=Object.create(null);for(let t=0;t<16;t++)this.bind(te.EMPTY,t)}initSource(e){this.bind(e)}bind(e,t=0){const n=e.source;e?(this.bindSource(n,t),this._useSeparateSamplers&&this._bindSampler(n.style,t)):(this.bindSource(null,t),this._useSeparateSamplers&&this._bindSampler(null,t))}bindSource(e,t=0){const n=this._gl;if(e._touched=this._renderer.textureGC.count,this._boundTextures[t]!==e){this._boundTextures[t]=e,this._activateLocation(t),e=e||te.EMPTY.source;const i=this.getGlSource(e);n.bindTexture(i.target,i.texture)}}_bindSampler(e,t=0){const n=this._gl;if(!e){this._boundSamplers[t]=null,n.bindSampler(t,null);return}const i=this._getGlSampler(e);this._boundSamplers[t]!==i&&(this._boundSamplers[t]=i,n.bindSampler(t,i))}unbind(e){const t=e.source,n=this._boundTextures,i=this._gl;for(let s=0;s<n.length;s++)if(n[s]===t){this._activateLocation(s);const o=this.getGlSource(t);i.bindTexture(o.target,null),n[s]=null}}_activateLocation(e){this._activeTextureLocation!==e&&(this._activeTextureLocation=e,this._gl.activeTexture(this._gl.TEXTURE0+e))}_initSource(e){const t=this._gl,n=new T4(t.createTexture());if(n.type=this._mapFormatToType[e.format],n.internalFormat=this._mapFormatToInternalFormat[e.format],n.format=this._mapFormatToFormat[e.format],e.autoGenerateMipmaps&&(this._renderer.context.supports.nonPowOf2mipmaps||e.isPowerOfTwo)){const i=Math.max(e.width,e.height);e.mipLevelCount=Math.floor(Math.log2(i))+1}return this._glTextures[e.uid]=n,this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceUpdate,this),e.on("styleChange",this.onStyleChange,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),this.updateStyle(e,!1),n}onStyleChange(e){this.updateStyle(e,!1)}updateStyle(e,t){const n=this._gl,i=this.getGlSource(e);n.bindTexture(n.TEXTURE_2D,i.texture),this._boundTextures[this._activeTextureLocation]=e,up(e.style,n,e.mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"texParameteri",n.TEXTURE_2D,!this._renderer.context.supports.nonPowOf2wrapping&&!e.isPowerOfTwo,t)}onSourceUnload(e){const t=this._glTextures[e.uid];t&&(this.unbind(e),this._glTextures[e.uid]=null,this._gl.deleteTexture(t.texture))}onSourceUpdate(e){const t=this._gl,n=this.getGlSource(e);t.bindTexture(t.TEXTURE_2D,n.texture),this._boundTextures[this._activeTextureLocation]=e,this._uploads[e.uploadMethodId]?this._uploads[e.uploadMethodId].upload(e,n,t,this._renderer.context.webGLVersion):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.pixelWidth,e.pixelHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e,!1)}onUpdateMipmaps(e,t=!0){t&&this.bindSource(e,0);const n=this.getGlSource(e);this._gl.generateMipmap(n.target)}onSourceDestroy(e){e.off("destroy",this.onSourceDestroy,this),e.off("update",this.onSourceUpdate,this),e.off("resize",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("styleChange",this.onStyleChange,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}_initSampler(e){const t=this._gl,n=this._gl.createSampler();return this._glSamplers[e._resourceId]=n,up(e,t,this._boundTextures[this._activeTextureLocation].mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"samplerParameteri",n,!1,!0),this._glSamplers[e._resourceId]}_getGlSampler(e){return this._glSamplers[e._resourceId]||this._initSampler(e)}getGlSource(e){return this._glTextures[e.uid]||this._initSource(e)}generateCanvas(e){const{pixels:t,width:n,height:i}=this.getPixels(e),s=Ee.get().createCanvas();s.width=n,s.height=i;const o=s.getContext("2d");if(o){const a=o.createImageData(n,i);a.data.set(t),o.putImageData(a,0,0)}return s}getPixels(e){const t=e.source.resolution,n=e.frame,i=Math.max(Math.round(n.width*t),1),s=Math.max(Math.round(n.height*t),1),o=new Uint8Array(B4*i*s),a=this._renderer,l=a.renderTarget.getRenderTarget(e),u=a.renderTarget.getGpuRenderTarget(l),c=a.gl;return c.bindFramebuffer(c.FRAMEBUFFER,u.resolveTargetFramebuffer),c.readPixels(Math.round(n.x*t),Math.round(n.y*t),i,s,c.RGBA,c.UNSIGNED_BYTE,o),{pixels:new Uint8ClampedArray(o.buffer),width:i,height:s}}destroy(){this.managedTextures.slice().forEach(e=>this.onSourceDestroy(e)),this.managedTextures=null,this._renderer=null}}g0.extension={type:[F.WebGLSystem],name:"texture"};class v0{init(){const e=new _t({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uRound:{value:0,type:"f32"}}),t=ss(),n=lo({name:"graphics",bits:[ed,rd(t),gd,co]});this.shader=new sr({glProgram:n,resources:{localUniforms:e,batchSamplers:nd(t)}})}execute(e,t){const n=t.context,i=n.customShader||this.shader,s=e.renderer,o=s.graphicsContext,{batcher:a,instructions:l}=o.getContextRenderData(n);i.groups[0]=s.globalUniforms.bindGroup,s.state.set(e.state),s.shader.bind(i),s.geometry.bind(a.geometry,i.glProgram);const u=l.instructions;for(let c=0;c<l.instructionSize;c++){const d=u[c];if(d.size){for(let h=0;h<d.textures.count;h++)s.texture.bind(d.textures.textures[h],h);s.geometry.draw("triangle-list",d.size,d.start)}}}destroy(){this.shader.destroy(!0),this.shader=null}}v0.extension={type:[F.WebGLPipesAdaptor],name:"graphics"};class x0{init(){const e=lo({name:"mesh",bits:[gd,GA,co]});this._shader=new sr({glProgram:e,resources:{uTexture:te.EMPTY.source,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new ae}}}})}execute(e,t){const n=e.renderer;let i=t._shader;if(i){if(!i.glProgram){de("Mesh shader has no glProgram",t.shader);return}}else{i=this._shader;const s=t.texture,o=s.source;i.resources.uTexture=o,i.resources.uSampler=o.style,i.resources.textureUniforms.uniforms.uTextureMatrix=s.textureMatrix.mapCoord}i.groups[100]=n.globalUniforms.bindGroup,i.groups[101]=e.localUniformsBindGroup,n.encoder.draw({geometry:t._geometry,shader:i,state:t.state})}destroy(){this._shader.destroy(!0),this._shader=null}}x0.extension={type:[F.WebGLPipesAdaptor],name:"mesh"};class b0{constructor(e){this._renderer=e}updateRenderable(){}destroyRenderable(){}validateRenderable(){return!1}addRenderable(e,t){this._renderer.renderPipes.batch.break(t),t.add(e)}execute(e){e.isRenderable&&e.render(this._renderer)}destroy(){this._renderer=null}}b0.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"customRender"};function _0(r,e){const t=r.instructionSet,n=t.instructions;for(let i=0;i<t.instructionSize;i++){const s=n[i];e[s.renderPipeId].execute(s)}}class y0{constructor(e){this._renderer=e}addRenderGroup(e,t){this._renderer.renderPipes.batch.break(t),t.add(e)}execute(e){e.isRenderable&&(this._renderer.globalUniforms.push({worldTransformMatrix:e.worldTransform,worldColor:e.worldColorAlpha}),_0(e,this._renderer.renderPipes),this._renderer.globalUniforms.pop())}destroy(){this._renderer=null}}y0.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"renderGroup"};function _d(r,e){e||(e=0);for(let t=e;t<r.length&&r[t];t++)r[t]=null}function S0(r,e=[]){e.push(r);for(let t=0;t<r.renderGroupChildren.length;t++)S0(r.renderGroupChildren[t],e);return e}function O4(r,e,t){const n=r>>16&255,i=r>>8&255,s=r&255,o=e>>16&255,a=e>>8&255,l=e&255,u=n+(o-n)*t,c=i+(a-i)*t,d=s+(l-s)*t;return(u<<16)+(c<<8)+d}const su=16777215;function w0(r,e){return r===su||e===su?r+e-su:O4(r,e,.5)}const U4=new fe,cp=As|Ma|Xc;function T0(r,e=!1){D4(r);const t=r.childrenToUpdate,n=r.updateTick++;for(const i in t){const s=Number(i),o=t[i],a=o.list,l=o.index;for(let u=0;u<l;u++){const c=a[u];c.parentRenderGroup===r&&c.relativeRenderGroupDepth===s&&C0(c,n,0)}_d(a,l),o.index=0}if(e)for(let i=0;i<r.renderGroupChildren.length;i++)T0(r.renderGroupChildren[i],e)}function D4(r){const e=r.root;let t;if(r.renderGroupParent){const n=r.renderGroupParent;r.worldTransform.appendFrom(e.relativeGroupTransform,n.worldTransform),r.worldColor=w0(e.groupColor,n.worldColor),t=e.groupAlpha*n.worldAlpha}else r.worldTransform.copyFrom(e.localTransform),r.worldColor=e.localColor,t=e.localAlpha;t=t<0?0:t>1?1:t,r.worldAlpha=t,r.worldColorAlpha=r.worldColor+((t*255|0)<<24)}function C0(r,e,t){if(e===r.updateTick)return;r.updateTick=e,r.didChange=!1;const n=r.localTransform;r.updateLocalTransform();const i=r.parent;if(i&&!i.renderGroup?(t=t|r._updateFlags,r.relativeGroupTransform.appendFrom(n,i.relativeGroupTransform),t&cp&&dp(r,i,t)):(t=r._updateFlags,r.relativeGroupTransform.copyFrom(n),t&cp&&dp(r,U4,t)),!r.renderGroup){const s=r.children,o=s.length;for(let u=0;u<o;u++)C0(s[u],e,t);const a=r.parentRenderGroup,l=r;l.renderPipeId&&!a.structureDidChange&&a.updateRenderable(l)}}function dp(r,e,t){if(t&Ma){r.groupColor=w0(r.localColor,e.groupColor);let n=r.localAlpha*e.groupAlpha;n=n<0?0:n>1?1:n,r.groupAlpha=n,r.groupColorAlpha=r.groupColor+((n*255|0)<<24)}t&Xc&&(r.groupBlendMode=r.localBlendMode==="inherit"?e.groupBlendMode:r.localBlendMode),t&As&&(r.globalDisplayStatus=r.localDisplayStatus&e.globalDisplayStatus),r._updateFlags=0}function G4(r,e){const{list:t,index:n}=r.childrenRenderablesToUpdate;let i=!1;for(let s=0;s<n;s++){const o=t[s];if(i=e[o.renderPipeId].validateRenderable(o),i)break}return r.structureDidChange=i,i}const z4=new ae;class P0{constructor(e){this._renderer=e}render({container:e,transform:t}){e.isRenderGroup=!0;const n=e.parent,i=e.renderGroup.renderGroupParent;e.parent=null,e.renderGroup.renderGroupParent=null;const s=this._renderer,o=S0(e.renderGroup,[]);let a=z4;t&&(a=a.copyFrom(e.renderGroup.localTransform),e.renderGroup.localTransform.copyFrom(t));const l=s.renderPipes;for(let u=0;u<o.length;u++){const c=o[u];c.runOnRender(),c.instructionSet.renderPipes=l,c.structureDidChange?_d(c.childrenRenderablesToUpdate.list,0):G4(c,l),T0(c),c.structureDidChange?(c.structureDidChange=!1,zA(c,s)):L4(c),c.childrenRenderablesToUpdate.index=0,s.renderPipes.batch.upload(c.instructionSet)}s.globalUniforms.start({worldTransformMatrix:t?e.renderGroup.localTransform:e.renderGroup.worldTransform,worldColor:e.renderGroup.worldColorAlpha}),_0(e.renderGroup,l),l.uniformBatch&&l.uniformBatch.renderEnd(),t&&e.renderGroup.localTransform.copyFrom(a),e.parent=n,e.renderGroup.renderGroupParent=i}destroy(){this._renderer=null}}P0.extension={type:[F.WebGLSystem,F.WebGPUSystem,F.CanvasSystem],name:"renderGroup"};function L4(r){const{list:e,index:t}=r.childrenRenderablesToUpdate;for(let n=0;n<t;n++){const i=e[n];i.didViewUpdate&&r.updateRenderable(i)}_d(e,t)}class yd{constructor(){this.batcherName="default",this.attributeSize=4,this.indexSize=6,this.packAsQuad=!0,this.roundPixels=0,this._attributeStart=0,this._batcher=null,this._batch=null}get blendMode(){return this.renderable.groupBlendMode}get color(){return this.renderable.groupColorAlpha}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.bounds=null}}class A0{constructor(e){this._gpuSpriteHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_gpuSpriteHash")}addRenderable(e,t){const n=this._getGpuSprite(e);e.didViewUpdate&&this._updateBatchableSprite(e,n),this._renderer.renderPipes.batch.addToBatch(n,t)}updateRenderable(e){const t=this._gpuSpriteHash[e.uid];e.didViewUpdate&&this._updateBatchableSprite(e,t),t._batcher.updateElement(t)}validateRenderable(e){const t=e._texture,n=this._getGpuSprite(e);return n.texture._source!==t._source?!n._batcher.checkAndUpdateTexture(n,t):!1}destroyRenderable(e){const t=this._gpuSpriteHash[e.uid];Re.return(t),this._gpuSpriteHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}_updateBatchableSprite(e,t){t.bounds=e.bounds,t.texture=e._texture}_getGpuSprite(e){return this._gpuSpriteHash[e.uid]||this._initGPUSprite(e)}_initGPUSprite(e){const t=Re.get(yd);return t.renderable=e,t.transform=e.groupTransform,t.texture=e._texture,t.bounds=e.bounds,t.roundPixels=this._renderer._roundPixels|e._roundPixels,this._gpuSpriteHash[e.uid]=t,e.on("destroyed",this._destroyRenderableBound),t}destroy(){for(const e in this._gpuSpriteHash)Re.return(this._gpuSpriteHash[e]);this._gpuSpriteHash=null,this._renderer=null}}A0.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"sprite"};const Sd=class E0{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new pe(0),this.color=this._backgroundColor,this.alpha=1}init(e){e={...E0.defaultOptions,...e},this.clearBeforeRender=e.clearBeforeRender,this.color=e.background||e.backgroundColor||this._backgroundColor,this.alpha=e.backgroundAlpha,this._backgroundColor.setAlpha(e.backgroundAlpha)}get color(){return this._backgroundColor}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get colorRgba(){return this._backgroundColor.toArray()}destroy(){}};Sd.extension={type:[F.WebGLSystem,F.WebGPUSystem,F.CanvasSystem],name:"background",priority:0};Sd.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};let N4=Sd;const Fs={};he.handle(F.BlendMode,r=>{if(!r.name)throw new Error("BlendMode extension must have a name property");Fs[r.name]=r.ref},r=>{delete Fs[r.name]});class M0{constructor(e){this._isAdvanced=!1,this._filterHash=Object.create(null),this._renderer=e}setBlendMode(e,t,n){if(this._activeBlendMode===t){this._isAdvanced&&this._renderableList.push(e);return}this._activeBlendMode=t,this._isAdvanced&&this._endAdvancedBlendMode(n),this._isAdvanced=!!Fs[t],this._isAdvanced&&(this._beginAdvancedBlendMode(n),this._renderableList.push(e))}_beginAdvancedBlendMode(e){this._renderer.renderPipes.batch.break(e);const t=this._activeBlendMode;if(!Fs[t]){de(`Unable to assign BlendMode: '${t}'. You may want to include: import 'pixi.js/advanced-blend-modes'`);return}let n=this._filterHash[t];n||(n=this._filterHash[t]=new Aa,n.filters=[new Fs[t]]);const i={renderPipeId:"filter",action:"pushFilter",renderables:[],filterEffect:n,canBundle:!1};this._renderableList=i.renderables,e.add(i)}_endAdvancedBlendMode(e){this._renderableList=null,this._renderer.renderPipes.batch.break(e),e.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}buildStart(){this._isAdvanced=!1}buildEnd(e){this._isAdvanced&&this._endAdvancedBlendMode(e)}destroy(){this._renderer=null,this._renderableList=null;for(const e in this._filterHash)this._filterHash[e].destroy();this._filterHash=null}}M0.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"blendMode"};const ou={png:"image/png",jpg:"image/jpeg",webp:"image/webp"},wd=class R0{constructor(e){this._renderer=e}_normalizeOptions(e,t={}){return e instanceof fe||e instanceof te?{target:e,...t}:{...t,...e}}async image(e){const t=new Image;return t.src=await this.base64(e),t}async base64(e){e=this._normalizeOptions(e,R0.defaultImageOptions);const{format:t,quality:n}=e,i=this.canvas(e);if(i.toBlob!==void 0)return new Promise((s,o)=>{i.toBlob(a=>{if(!a){o(new Error("ICanvas.toBlob failed!"));return}const l=new FileReader;l.onload=()=>s(l.result),l.onerror=o,l.readAsDataURL(a)},ou[t],n)});if(i.toDataURL!==void 0)return i.toDataURL(ou[t],n);if(i.convertToBlob!==void 0){const s=await i.convertToBlob({type:ou[t],quality:n});return new Promise((o,a)=>{const l=new FileReader;l.onload=()=>o(l.result),l.onerror=a,l.readAsDataURL(s)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e){e=this._normalizeOptions(e);const t=e.target,n=this._renderer;if(t instanceof te)return n.texture.generateCanvas(t);const i=n.textureGenerator.generateTexture(e),s=n.texture.generateCanvas(i);return i.destroy(),s}pixels(e){e=this._normalizeOptions(e);const t=e.target,n=this._renderer,i=t instanceof te?t:n.textureGenerator.generateTexture(e),s=n.texture.getPixels(i);return t instanceof fe&&i.destroy(),s}texture(e){return e=this._normalizeOptions(e),e.target instanceof te?e.target:this._renderer.textureGenerator.generateTexture(e)}download(e){e=this._normalizeOptions(e);const t=this.canvas(e),n=document.createElement("a");n.download=e.filename??"image.png",n.href=t.toDataURL("image/png"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}log(e){const t=e.width??200;e=this._normalizeOptions(e);const n=this.canvas(e),i=n.toDataURL();console.log(`[Pixi Texture] ${n.width}px ${n.height}px`);const s=["font-size: 1px;",`padding: ${t}px 300px;`,`background: url(${i}) no-repeat;`,"background-size: contain;"].join(" ");console.log("%c ",s)}destroy(){this._renderer=null}};wd.extension={type:[F.WebGLSystem,F.WebGPUSystem],name:"extract"};wd.defaultImageOptions={format:"png",quality:1};let H4=wd;class Td extends te{static create(e){return new Td({source:new lt(e)})}resize(e,t,n){return this.source.resize(e,t,n),this}}const V4=new Le,W4=new Mt,j4=[0,0,0,0];class k0{constructor(e){this._renderer=e}generateTexture(e){e instanceof fe&&(e={target:e,frame:void 0,textureSourceOptions:{},resolution:void 0});const t=e.resolution||this._renderer.resolution,n=e.antialias||this._renderer.view.antialias,i=e.target;let s=e.clearColor;s?s=Array.isArray(s)&&s.length===4?s:pe.shared.setValue(s).toArray():s=j4;const o=e.frame?.copyTo(V4)||jc(i,W4).rectangle;o.width=Math.max(o.width,1/t)|0,o.height=Math.max(o.height,1/t)|0;const a=Td.create({...e.textureSourceOptions,width:o.width,height:o.height,resolution:t,antialias:n}),l=ae.shared.translate(-o.x,-o.y);return this._renderer.render({container:i,transform:l,target:a,clearColor:s}),a.source.updateMipmaps(),a}destroy(){this._renderer=null}}k0.extension={type:[F.WebGLSystem,F.WebGPUSystem],name:"textureGenerator"};function ho(r,e,t){const n=(r>>24&255)/255;e[t++]=(r&255)/255*n,e[t++]=(r>>8&255)/255*n,e[t++]=(r>>16&255)/255*n,e[t++]=n}class F0{constructor(e){this._stackIndex=0,this._globalUniformDataStack=[],this._uniformsPool=[],this._activeUniforms=[],this._bindGroupPool=[],this._activeBindGroups=[],this._renderer=e}reset(){this._stackIndex=0;for(let e=0;e<this._activeUniforms.length;e++)this._uniformsPool.push(this._activeUniforms[e]);for(let e=0;e<this._activeBindGroups.length;e++)this._bindGroupPool.push(this._activeBindGroups[e]);this._activeUniforms.length=0,this._activeBindGroups.length=0}start(e){this.reset(),this.push(e)}bind({size:e,projectionMatrix:t,worldTransformMatrix:n,worldColor:i,offset:s}){const o=this._renderer.renderTarget.renderTarget,a=this._stackIndex?this._globalUniformDataStack[this._stackIndex-1]:{projectionData:o,worldTransformMatrix:new ae,worldColor:4294967295,offset:new We},l={projectionMatrix:t||this._renderer.renderTarget.projectionMatrix,resolution:e||o.size,worldTransformMatrix:n||a.worldTransformMatrix,worldColor:i||a.worldColor,offset:s||a.offset,bindGroup:null},u=this._uniformsPool.pop()||this._createUniforms();this._activeUniforms.push(u);const c=u.uniforms;c.uProjectionMatrix=l.projectionMatrix,c.uResolution=l.resolution,c.uWorldTransformMatrix.copyFrom(l.worldTransformMatrix),c.uWorldTransformMatrix.tx-=l.offset.x,c.uWorldTransformMatrix.ty-=l.offset.y,ho(l.worldColor,c.uWorldColorAlpha,0),u.update();let d;this._renderer.renderPipes.uniformBatch?d=this._renderer.renderPipes.uniformBatch.getUniformBindGroup(u,!1):(d=this._bindGroupPool.pop()||new Vr,this._activeBindGroups.push(d),d.setResource(u,0)),l.bindGroup=d,this._currentGlobalUniformData=l}push(e){this.bind(e),this._globalUniformDataStack[this._stackIndex++]=this._currentGlobalUniformData}pop(){this._currentGlobalUniformData=this._globalUniformDataStack[--this._stackIndex-1],this._renderer.type===Wt.WEBGL&&this._currentGlobalUniformData.bindGroup.resources[0].update()}get bindGroup(){return this._currentGlobalUniformData.bindGroup}get globalUniformData(){return this._currentGlobalUniformData}get uniformGroup(){return this._currentGlobalUniformData.bindGroup.resources[0]}_createUniforms(){return new _t({uProjectionMatrix:{value:new ae,type:"mat3x3<f32>"},uWorldTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uWorldColorAlpha:{value:new Float32Array(4),type:"vec4<f32>"},uResolution:{value:[0,0],type:"vec2<f32>"}},{isStatic:!0})}destroy(){this._renderer=null}}F0.extension={type:[F.WebGLSystem,F.WebGPUSystem,F.CanvasSystem],name:"globalUniforms"};let X4=1;class I0{constructor(){this._tasks=[],this._offset=0}init(){Er.system.add(this._update,this)}repeat(e,t,n=!0){const i=X4++;let s=0;return n&&(this._offset+=1e3,s=this._offset),this._tasks.push({func:e,duration:t,start:performance.now(),offset:s,last:performance.now(),repeat:!0,id:i}),i}cancel(e){for(let t=0;t<this._tasks.length;t++)if(this._tasks[t].id===e){this._tasks.splice(t,1);return}}_update(){const e=performance.now();for(let t=0;t<this._tasks.length;t++){const n=this._tasks[t];if(e-n.offset-n.last>=n.duration){const i=e-n.start;n.func(i),n.last=e}}}destroy(){Er.system.remove(this._update,this),this._tasks.length=0}}I0.extension={type:[F.WebGLSystem,F.WebGPUSystem,F.CanvasSystem],name:"scheduler",priority:0};let hp=!1;function q4(r){if(!hp){if(Ee.get().getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){const e=[`%c  %c  %c  %c  %c PixiJS %c v${ka} (${r}) http://www.pixijs.com/

`,"background: #E72264; padding:5px 0;","background: #6CA2EA; padding:5px 0;","background: #B5D33D; padding:5px 0;","background: #FED23F; padding:5px 0;","color: #FFFFFF; background: #E72264; padding:5px 0;","color: #E72264; background: #FFFFFF; padding:5px 0;"];globalThis.console.log(...e)}else globalThis.console&&globalThis.console.log(`PixiJS ${ka} - ${r} - http://www.pixijs.com/`);hp=!0}}class Cd{constructor(e){this._renderer=e}init(e){if(e.hello){let t=this._renderer.name;this._renderer.type===Wt.WEBGL&&(t+=` ${this._renderer.context.webGLVersion}`),q4(t)}}}Cd.extension={type:[F.WebGLSystem,F.WebGPUSystem,F.CanvasSystem],name:"hello",priority:-2};Cd.defaultOptions={hello:!1};function Y4(r){let e=!1;for(const n in r)if(r[n]==null){e=!0;break}if(!e)return r;const t=Object.create(null);for(const n in r){const i=r[n];i&&(t[n]=i)}return t}function K4(r){let e=0;for(let t=0;t<r.length;t++)r[t]==null?e++:r[t-e]=r[t];return r.length=r.length-e,r}const Pd=class B0{constructor(e){this._managedRenderables=[],this._managedHashes=[],this._managedArrays=[],this._renderer=e}init(e){e={...B0.defaultOptions,...e},this.maxUnusedTime=e.renderableGCMaxUnusedTime,this._frequency=e.renderableGCFrequency,this.enabled=e.renderableGCActive}get enabled(){return!!this._handler}set enabled(e){this.enabled!==e&&(e?(this._handler=this._renderer.scheduler.repeat(()=>this.run(),this._frequency,!1),this._hashHandler=this._renderer.scheduler.repeat(()=>{for(const t of this._managedHashes)t.context[t.hash]=Y4(t.context[t.hash])},this._frequency),this._arrayHandler=this._renderer.scheduler.repeat(()=>{for(const t of this._managedArrays)K4(t.context[t.hash])},this._frequency)):(this._renderer.scheduler.cancel(this._handler),this._renderer.scheduler.cancel(this._hashHandler),this._renderer.scheduler.cancel(this._arrayHandler)))}addManagedHash(e,t){this._managedHashes.push({context:e,hash:t})}addManagedArray(e,t){this._managedArrays.push({context:e,hash:t})}prerender(){this._now=performance.now()}addRenderable(e,t){this.enabled&&(e._lastUsed=this._now,e._lastInstructionTick===-1&&(this._managedRenderables.push(e),e.once("destroyed",this._removeRenderable,this)),e._lastInstructionTick=t.tick)}run(){const e=performance.now(),t=this._managedRenderables,n=this._renderer.renderPipes;let i=0;for(let s=0;s<t.length;s++){const o=t[s];if(o===null){i++;continue}const l=(o.renderGroup??o.parentRenderGroup)?.instructionSet?.tick??-1;o._lastInstructionTick!==l&&e-o._lastUsed>this.maxUnusedTime?(o.destroyed||n[o.renderPipeId].destroyRenderable(o),o._lastInstructionTick=-1,i++,o.off("destroyed",this._removeRenderable,this)):t[s-i]=o}t.length=t.length-i}destroy(){this.enabled=!1,this._renderer=null,this._managedRenderables.length=0,this._managedHashes.length=0,this._managedArrays.length=0}_removeRenderable(e){const t=this._managedRenderables.indexOf(e);t>=0&&(e.off("destroyed",this._removeRenderable,this),this._managedRenderables[t]=null)}};Pd.extension={type:[F.WebGLSystem,F.WebGPUSystem],name:"renderableGC",priority:0};Pd.defaultOptions={renderableGCActive:!0,renderableGCMaxUnusedTime:6e4,renderableGCFrequency:3e4};let $4=Pd;const Ad=class O0{constructor(e){this._renderer=e,this.count=0,this.checkCount=0}init(e){e={...O0.defaultOptions,...e},this.checkCountMax=e.textureGCCheckCountMax,this.maxIdle=e.textureGCAMaxIdle??e.textureGCMaxIdle,this.active=e.textureGCActive}postrender(){this._renderer.renderingToScreen&&(this.count++,this.active&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this._renderer.texture.managedTextures;for(let t=0;t<e.length;t++){const n=e[t];n.autoGarbageCollect&&n.resource&&n._touched>-1&&this.count-n._touched>this.maxIdle&&(n._touched=-1,n.unload())}}destroy(){this._renderer=null}};Ad.extension={type:[F.WebGLSystem,F.WebGPUSystem],name:"textureGC"};Ad.defaultOptions={textureGCActive:!0,textureGCAMaxIdle:null,textureGCMaxIdle:60*60,textureGCCheckCountMax:600};let Z4=Ad;const Ed=class U0{get autoDensity(){return this.texture.source.autoDensity}set autoDensity(e){this.texture.source.autoDensity=e}get resolution(){return this.texture.source._resolution}set resolution(e){this.texture.source.resize(this.texture.source.width,this.texture.source.height,e)}init(e){e={...U0.defaultOptions,...e},e.view&&(J(Me,"ViewSystem.view has been renamed to ViewSystem.canvas"),e.canvas=e.view),this.screen=new Le(0,0,e.width,e.height),this.canvas=e.canvas||Ee.get().createCanvas(),this.antialias=!!e.antialias,this.texture=s0(this.canvas,e),this.renderTarget=new ec({colorTextures:[this.texture],depth:!!e.depth,isRoot:!0}),this.texture.source.transparent=e.backgroundAlpha<1,this.resolution=e.resolution}resize(e,t,n){this.texture.source.resize(e,t,n),this.screen.width=this.texture.frame.width,this.screen.height=this.texture.frame.height}destroy(e=!1){(typeof e=="boolean"?e:!!e?.removeView)&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}};Ed.extension={type:[F.WebGLSystem,F.WebGPUSystem,F.CanvasSystem],name:"view",priority:0};Ed.defaultOptions={width:800,height:600,autoDensity:!1,antialias:!1};let D0=Ed;const G0=[N4,F0,Cd,D0,P0,Z4,k0,H4,Hg,$4,I0],z0=[M0,Lv,A0,y0,Hv,Wv,Vv,b0],Q4=[...G0,i0,KA,WA,jv,g0,u0,Kv,f0,h0,Qv,w4,Jv,Zv],J4=[...z0],eE=[Dv,x0,v0],L0=[],N0=[],H0=[];he.handleByNamedList(F.WebGLSystem,L0);he.handleByNamedList(F.WebGLPipes,N0);he.handleByNamedList(F.WebGLPipesAdaptor,H0);he.add(...Q4,...J4,...eE);class tE extends sl{constructor(){const e={name:"webgl",type:Wt.WEBGL,systems:L0,renderPipes:N0,renderPipeAdaptors:H0};super(e)}}const rE=Object.freeze(Object.defineProperty({__proto__:null,WebGLRenderer:tE},Symbol.toStringTag,{value:"Module"}));class V0{constructor(e){this._hash=Object.create(null),this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_hash")}contextChange(e){this._gpu=e}getBindGroup(e,t,n){return e._updateKey(),this._hash[e._key]||this._createBindGroup(e,t,n)}_createBindGroup(e,t,n){const i=this._gpu.device,s=t.layout[n],o=[],a=this._renderer;for(const c in s){const d=e.resources[c]??e.resources[s[c]];let h;if(d._resourceType==="uniformGroup"){const f=d;a.ubo.updateUniformGroup(f);const p=f.buffer;h={buffer:a.buffer.getGPUBuffer(p),offset:0,size:p.descriptor.size}}else if(d._resourceType==="buffer"){const f=d;h={buffer:a.buffer.getGPUBuffer(f),offset:0,size:f.descriptor.size}}else if(d._resourceType==="bufferResource"){const f=d;h={buffer:a.buffer.getGPUBuffer(f.buffer),offset:f.offset,size:f.size}}else if(d._resourceType==="textureSampler"){const f=d;h=a.texture.getGpuSampler(f)}else if(d._resourceType==="textureSource"){const f=d;h=a.texture.getGpuSource(f).createView({})}o.push({binding:s[c],resource:h})}const l=a.shader.getProgramData(t).bindGroups[n],u=i.createBindGroup({layout:l,entries:o});return this._hash[e._key]=u,u}destroy(){for(const e of Object.keys(this._hash))this._hash[e]=null;this._hash=null,this._renderer=null}}V0.extension={type:[F.WebGPUSystem],name:"bindGroup"};class W0{constructor(e){this._gpuBuffers=Object.create(null),this._managedBuffers=[],e.renderableGC.addManagedHash(this,"_gpuBuffers")}contextChange(e){this._gpu=e}getGPUBuffer(e){return this._gpuBuffers[e.uid]||this.createGPUBuffer(e)}updateBuffer(e){const t=this._gpuBuffers[e.uid]||this.createGPUBuffer(e),n=e.data;return e._updateID&&n&&(e._updateID=0,this._gpu.device.queue.writeBuffer(t,0,n.buffer,0,(e._updateSize||n.byteLength)+3&-4)),t}destroyAll(){for(const e in this._gpuBuffers)this._gpuBuffers[e].destroy();this._gpuBuffers={}}createGPUBuffer(e){this._gpuBuffers[e.uid]||(e.on("update",this.updateBuffer,this),e.on("change",this.onBufferChange,this),e.on("destroy",this.onBufferDestroy,this),this._managedBuffers.push(e));const t=this._gpu.device.createBuffer(e.descriptor);return e._updateID=0,e.data&&(ju(e.data.buffer,t.getMappedRange()),t.unmap()),this._gpuBuffers[e.uid]=t,t}onBufferChange(e){this._gpuBuffers[e.uid].destroy(),e._updateID=0,this._gpuBuffers[e.uid]=this.createGPUBuffer(e)}onBufferDestroy(e){this._managedBuffers.splice(this._managedBuffers.indexOf(e),1),this._destroyBuffer(e)}destroy(){this._managedBuffers.forEach(e=>this._destroyBuffer(e)),this._managedBuffers=null,this._gpuBuffers=null}_destroyBuffer(e){this._gpuBuffers[e.uid].destroy(),e.off("update",this.updateBuffer,this),e.off("change",this.onBufferChange,this),e.off("destroy",this.onBufferDestroy,this),this._gpuBuffers[e.uid]=null}}W0.extension={type:[F.WebGPUSystem],name:"buffer"};class nE{constructor({minUniformOffsetAlignment:e}){this._minUniformOffsetAlignment=256,this.byteIndex=0,this._minUniformOffsetAlignment=e,this.data=new Float32Array(65535)}clear(){this.byteIndex=0}addEmptyGroup(e){if(e>this._minUniformOffsetAlignment/4)throw new Error(`UniformBufferBatch: array is too large: ${e*4}`);const t=this.byteIndex;let n=t+e*4;if(n=Math.ceil(n/this._minUniformOffsetAlignment)*this._minUniformOffsetAlignment,n>this.data.length*4)throw new Error("UniformBufferBatch: ubo batch got too big");return this.byteIndex=n,t}addGroup(e){const t=this.addEmptyGroup(e.length);for(let n=0;n<e.length;n++)this.data[t/4+n]=e[n];return t}destroy(){this._buffer.destroy(),this._buffer=null,this.data=null}}class j0{constructor(e){this._colorMaskCache=15,this._renderer=e}setMask(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.pipeline.setColorMask(e))}destroy(){this._renderer=null,this._colorMaskCache=null}}j0.extension={type:[F.WebGPUSystem],name:"colorMask"};class Md{constructor(e){this._renderer=e}async init(e){return this._initPromise?this._initPromise:(this._initPromise=this._createDeviceAndAdaptor(e).then(t=>{this.gpu=t,this._renderer.runners.contextChange.emit(this.gpu)}),this._initPromise)}contextChange(e){this._renderer.gpu=e}async _createDeviceAndAdaptor(e){const t=await Ee.get().getNavigator().gpu.requestAdapter({powerPreference:e.powerPreference,forceFallbackAdapter:e.forceFallbackAdapter}),n=["texture-compression-bc","texture-compression-astc","texture-compression-etc2"].filter(s=>t.features.has(s)),i=await t.requestDevice({requiredFeatures:n});return{adapter:t,device:i}}destroy(){this.gpu=null,this._renderer=null}}Md.extension={type:[F.WebGPUSystem],name:"device"};Md.defaultOptions={powerPreference:void 0,forceFallbackAdapter:!1};class X0{constructor(e){this._boundBindGroup=Object.create(null),this._boundVertexBuffer=Object.create(null),this._renderer=e}renderStart(){this.commandFinished=new Promise(e=>{this._resolveCommandFinished=e}),this.commandEncoder=this._renderer.gpu.device.createCommandEncoder()}beginRenderPass(e){this.endRenderPass(),this._clearCache(),this.renderPassEncoder=this.commandEncoder.beginRenderPass(e.descriptor)}endRenderPass(){this.renderPassEncoder&&this.renderPassEncoder.end(),this.renderPassEncoder=null}setViewport(e){this.renderPassEncoder.setViewport(e.x,e.y,e.width,e.height,0,1)}setPipelineFromGeometryProgramAndState(e,t,n,i){const s=this._renderer.pipeline.getPipeline(e,t,n,i);this.setPipeline(s)}setPipeline(e){this._boundPipeline!==e&&(this._boundPipeline=e,this.renderPassEncoder.setPipeline(e))}_setVertexBuffer(e,t){this._boundVertexBuffer[e]!==t&&(this._boundVertexBuffer[e]=t,this.renderPassEncoder.setVertexBuffer(e,this._renderer.buffer.updateBuffer(t)))}_setIndexBuffer(e){if(this._boundIndexBuffer===e)return;this._boundIndexBuffer=e;const t=e.data.BYTES_PER_ELEMENT===2?"uint16":"uint32";this.renderPassEncoder.setIndexBuffer(this._renderer.buffer.updateBuffer(e),t)}resetBindGroup(e){this._boundBindGroup[e]=null}setBindGroup(e,t,n){if(this._boundBindGroup[e]===t)return;this._boundBindGroup[e]=t,t._touch(this._renderer.textureGC.count);const i=this._renderer.bindGroup.getBindGroup(t,n,e);this.renderPassEncoder.setBindGroup(e,i)}setGeometry(e,t){const n=this._renderer.pipeline.getBufferNamesToBind(e,t);for(const i in n)this._setVertexBuffer(i,e.attributes[n[i]].buffer);e.indexBuffer&&this._setIndexBuffer(e.indexBuffer)}_setShaderBindGroups(e,t){for(const n in e.groups){const i=e.groups[n];t||this._syncBindGroup(i),this.setBindGroup(n,i,e.gpuProgram)}}_syncBindGroup(e){for(const t in e.resources){const n=e.resources[t];n.isUniformGroup&&this._renderer.ubo.updateUniformGroup(n)}}draw(e){const{geometry:t,shader:n,state:i,topology:s,size:o,start:a,instanceCount:l,skipSync:u}=e;this.setPipelineFromGeometryProgramAndState(t,n.gpuProgram,i,s),this.setGeometry(t,n.gpuProgram),this._setShaderBindGroups(n,u),t.indexBuffer?this.renderPassEncoder.drawIndexed(o||t.indexBuffer.data.length,l||t.instanceCount,a||0):this.renderPassEncoder.draw(o||t.getSize(),l||t.instanceCount,a||0)}finishRenderPass(){this.renderPassEncoder&&(this.renderPassEncoder.end(),this.renderPassEncoder=null)}postrender(){this.finishRenderPass(),this._gpu.device.queue.submit([this.commandEncoder.finish()]),this._resolveCommandFinished(),this.commandEncoder=null}restoreRenderPass(){const e=this._renderer.renderTarget.adaptor.getDescriptor(this._renderer.renderTarget.renderTarget,!1,[0,0,0,1]);this.renderPassEncoder=this.commandEncoder.beginRenderPass(e);const t=this._boundPipeline,n={...this._boundVertexBuffer},i=this._boundIndexBuffer,s={...this._boundBindGroup};this._clearCache();const o=this._renderer.renderTarget.viewport;this.renderPassEncoder.setViewport(o.x,o.y,o.width,o.height,0,1),this.setPipeline(t);for(const a in n)this._setVertexBuffer(a,n[a]);for(const a in s)this.setBindGroup(a,s[a],null);this._setIndexBuffer(i)}_clearCache(){for(let e=0;e<16;e++)this._boundBindGroup[e]=null,this._boundVertexBuffer[e]=null;this._boundIndexBuffer=null,this._boundPipeline=null}destroy(){this._renderer=null,this._gpu=null,this._boundBindGroup=null,this._boundVertexBuffer=null,this._boundIndexBuffer=null,this._boundPipeline=null}contextChange(e){this._gpu=e}}X0.extension={type:[F.WebGPUSystem],name:"encoder",priority:1};class q0{constructor(e){this._renderTargetStencilState=Object.create(null),this._renderer=e,e.renderTarget.onRenderTargetChange.add(this)}onRenderTargetChange(e){let t=this._renderTargetStencilState[e.uid];t||(t=this._renderTargetStencilState[e.uid]={stencilMode:nt.DISABLED,stencilReference:0}),this._activeRenderTarget=e,this.setStencilMode(t.stencilMode,t.stencilReference)}setStencilMode(e,t){const n=this._renderTargetStencilState[this._activeRenderTarget.uid];n.stencilMode=e,n.stencilReference=t;const i=this._renderer;i.pipeline.setStencilMode(e),i.encoder.renderPassEncoder.setStencilReference(t)}destroy(){this._renderer.renderTarget.onRenderTargetChange.remove(this),this._renderer=null,this._activeRenderTarget=null,this._renderTargetStencilState=null}}q0.extension={type:[F.WebGPUSystem],name:"stencil"};const $o={i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},f16:{align:2,size:2},"vec2<i32>":{align:8,size:8},"vec2<u32>":{align:8,size:8},"vec2<f32>":{align:8,size:8},"vec2<f16>":{align:4,size:4},"vec3<i32>":{align:16,size:12},"vec3<u32>":{align:16,size:12},"vec3<f32>":{align:16,size:12},"vec3<f16>":{align:8,size:6},"vec4<i32>":{align:16,size:16},"vec4<u32>":{align:16,size:16},"vec4<f32>":{align:16,size:16},"vec4<f16>":{align:8,size:8},"mat2x2<f32>":{align:8,size:16},"mat2x2<f16>":{align:4,size:8},"mat3x2<f32>":{align:8,size:24},"mat3x2<f16>":{align:4,size:12},"mat4x2<f32>":{align:8,size:32},"mat4x2<f16>":{align:4,size:16},"mat2x3<f32>":{align:16,size:32},"mat2x3<f16>":{align:8,size:16},"mat3x3<f32>":{align:16,size:48},"mat3x3<f16>":{align:8,size:24},"mat4x3<f32>":{align:16,size:64},"mat4x3<f16>":{align:8,size:32},"mat2x4<f32>":{align:16,size:32},"mat2x4<f16>":{align:8,size:16},"mat3x4<f32>":{align:16,size:48},"mat3x4<f16>":{align:8,size:24},"mat4x4<f32>":{align:16,size:64},"mat4x4<f16>":{align:8,size:32}};function iE(r){const e=r.map(n=>({data:n,offset:0,size:0}));let t=0;for(let n=0;n<e.length;n++){const i=e[n];let s=$o[i.data.type].size;const o=$o[i.data.type].align;if(!$o[i.data.type])throw new Error(`[Pixi.js] WebGPU UniformBuffer: Unknown type ${i.data.type}`);i.data.size>1&&(s=Math.max(s,o)*i.data.size),t=Math.ceil(t/o)*o,i.size=s,i.offset=t,t+=s}return t=Math.ceil(t/16)*16,{uboElements:e,size:t}}function sE(r,e){const{size:t,align:n}=$o[r.data.type],i=(n-t)/4;return`
         v = uv.${r.data.name};
         ${e!==0?`offset += ${e};`:""}

         arrayOffset = offset;

         t = 0;

         for(var i=0; i < ${r.data.size*(t/4)}; i++)
         {
             for(var j = 0; j < ${t/4}; j++)
             {
                 data[arrayOffset++] = v[t++];
             }
             ${i!==0?`arrayOffset += ${i};`:""}
         }
     `}function oE(r){return r0(r,"uboWgsl",sE,QA)}class Y0 extends e0{constructor(){super({createUboElements:iE,generateUboSync:oE})}}Y0.extension={type:[F.WebGPUSystem],name:"ubo"};const $r=128;class K0{constructor(e){this._bindGroupHash=Object.create(null),this._buffers=[],this._bindGroups=[],this._bufferResources=[],this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_bindGroupHash"),this._batchBuffer=new nE({minUniformOffsetAlignment:$r});const t=256/$r;for(let n=0;n<t;n++){let i=Ae.UNIFORM|Ae.COPY_DST;n===0&&(i|=Ae.COPY_SRC),this._buffers.push(new Ht({data:this._batchBuffer.data,usage:i}))}}renderEnd(){this._uploadBindGroups(),this._resetBindGroups()}_resetBindGroups(){for(const e in this._bindGroupHash)this._bindGroupHash[e]=null;this._batchBuffer.clear()}getUniformBindGroup(e,t){if(!t&&this._bindGroupHash[e.uid])return this._bindGroupHash[e.uid];this._renderer.ubo.ensureUniformGroup(e);const n=e.buffer.data,i=this._batchBuffer.addEmptyGroup(n.length);return this._renderer.ubo.syncUniformGroup(e,this._batchBuffer.data,i/4),this._bindGroupHash[e.uid]=this._getBindGroup(i/$r),this._bindGroupHash[e.uid]}getUboResource(e){this._renderer.ubo.updateUniformGroup(e);const t=e.buffer.data,n=this._batchBuffer.addGroup(t);return this._getBufferResource(n/$r)}getArrayBindGroup(e){const t=this._batchBuffer.addGroup(e);return this._getBindGroup(t/$r)}getArrayBufferResource(e){const n=this._batchBuffer.addGroup(e)/$r;return this._getBufferResource(n)}_getBufferResource(e){if(!this._bufferResources[e]){const t=this._buffers[e%2];this._bufferResources[e]=new bd({buffer:t,offset:(e/2|0)*256,size:$r})}return this._bufferResources[e]}_getBindGroup(e){if(!this._bindGroups[e]){const t=new Vr({0:this._getBufferResource(e)});this._bindGroups[e]=t}return this._bindGroups[e]}_uploadBindGroups(){const e=this._renderer.buffer,t=this._buffers[0];t.update(this._batchBuffer.byteIndex),e.updateBuffer(t);const n=this._renderer.gpu.device.createCommandEncoder();for(let i=1;i<this._buffers.length;i++){const s=this._buffers[i];n.copyBufferToBuffer(e.getGPUBuffer(t),$r,e.getGPUBuffer(s),0,this._batchBuffer.byteIndex)}this._renderer.gpu.device.queue.submit([n.finish()])}destroy(){for(let e=0;e<this._bindGroups.length;e++)this._bindGroups[e].destroy();this._bindGroups=null,this._bindGroupHash=null;for(let e=0;e<this._buffers.length;e++)this._buffers[e].destroy();this._buffers=null;for(let e=0;e<this._bufferResources.length;e++)this._bufferResources[e].destroy();this._bufferResources=null,this._batchBuffer.destroy(),this._bindGroupHash=null,this._renderer=null}}K0.extension={type:[F.WebGPUPipes],name:"uniformBatch"};const aE={"point-list":0,"line-list":1,"line-strip":2,"triangle-list":3,"triangle-strip":4};function lE(r,e,t,n,i){return r<<24|e<<16|t<<10|n<<5|i}function uE(r,e,t,n){return t<<6|r<<3|n<<1|e}class $0{constructor(e){this._moduleCache=Object.create(null),this._bufferLayoutsCache=Object.create(null),this._bindingNamesCache=Object.create(null),this._pipeCache=Object.create(null),this._pipeStateCaches=Object.create(null),this._colorMask=15,this._multisampleCount=1,this._renderer=e}contextChange(e){this._gpu=e,this.setStencilMode(nt.DISABLED),this._updatePipeHash()}setMultisampleCount(e){this._multisampleCount!==e&&(this._multisampleCount=e,this._updatePipeHash())}setRenderTarget(e){this._multisampleCount=e.msaaSamples,this._depthStencilAttachment=e.descriptor.depthStencilAttachment?1:0,this._updatePipeHash()}setColorMask(e){this._colorMask!==e&&(this._colorMask=e,this._updatePipeHash())}setStencilMode(e){this._stencilMode!==e&&(this._stencilMode=e,this._stencilState=vn[e],this._updatePipeHash())}setPipeline(e,t,n,i){const s=this.getPipeline(e,t,n);i.setPipeline(s)}getPipeline(e,t,n,i){e._layoutKey||(qv(e,t.attributeData),this._generateBufferKey(e)),i=i||e.topology;const s=lE(e._layoutKey,t._layoutKey,n.data,n._blendModeId,aE[i]);return this._pipeCache[s]?this._pipeCache[s]:(this._pipeCache[s]=this._createPipeline(e,t,n,i),this._pipeCache[s])}_createPipeline(e,t,n,i){const s=this._gpu.device,o=this._createVertexBufferLayouts(e,t),a=this._renderer.state.getColorTargets(n);a[0].writeMask=this._stencilMode===nt.RENDERING_MASK_ADD?0:this._colorMask;const l=this._renderer.shader.getProgramData(t).pipeline,u={vertex:{module:this._getModule(t.vertex.source),entryPoint:t.vertex.entryPoint,buffers:o},fragment:{module:this._getModule(t.fragment.source),entryPoint:t.fragment.entryPoint,targets:a},primitive:{topology:i,cullMode:n.cullMode},layout:l,multisample:{count:this._multisampleCount},label:"PIXI Pipeline"};return this._depthStencilAttachment&&(u.depthStencil={...this._stencilState,format:"depth24plus-stencil8",depthWriteEnabled:n.depthTest,depthCompare:n.depthTest?"less":"always"}),s.createRenderPipeline(u)}_getModule(e){return this._moduleCache[e]||this._createModule(e)}_createModule(e){const t=this._gpu.device;return this._moduleCache[e]=t.createShaderModule({code:e}),this._moduleCache[e]}_generateBufferKey(e){const t=[];let n=0;const i=Object.keys(e.attributes).sort();for(let o=0;o<i.length;o++){const a=e.attributes[i[o]];t[n++]=a.offset,t[n++]=a.format,t[n++]=a.stride,t[n++]=a.instance}const s=t.join("|");return e._layoutKey=Ns(s,"geometry"),e._layoutKey}_generateAttributeLocationsKey(e){const t=[];let n=0;const i=Object.keys(e.attributeData).sort();for(let o=0;o<i.length;o++){const a=e.attributeData[i[o]];t[n++]=a.location}const s=t.join("|");return e._attributeLocationsKey=Ns(s,"programAttributes"),e._attributeLocationsKey}getBufferNamesToBind(e,t){const n=e._layoutKey<<16|t._attributeLocationsKey;if(this._bindingNamesCache[n])return this._bindingNamesCache[n];const i=this._createVertexBufferLayouts(e,t),s=Object.create(null),o=t.attributeData;for(let a=0;a<i.length;a++)for(const l in o)if(o[l].location===a){s[a]=l;break}return this._bindingNamesCache[n]=s,s}_createVertexBufferLayouts(e,t){t._attributeLocationsKey||this._generateAttributeLocationsKey(t);const n=e._layoutKey<<16|t._attributeLocationsKey;if(this._bufferLayoutsCache[n])return this._bufferLayoutsCache[n];const i=[];return e.buffers.forEach(s=>{const o={arrayStride:0,stepMode:"vertex",attributes:[]},a=o.attributes;for(const l in t.attributeData){const u=e.attributes[l];(u.divisor??1)!==1&&de(`Attribute ${l} has an invalid divisor value of '${u.divisor}'. WebGPU only supports a divisor value of 1`),u.buffer===s&&(o.arrayStride=u.stride,o.stepMode=u.instance?"instance":"vertex",a.push({shaderLocation:t.attributeData[l].location,offset:u.offset,format:u.format}))}a.length&&i.push(o)}),this._bufferLayoutsCache[n]=i,i}_updatePipeHash(){const e=uE(this._stencilMode,this._multisampleCount,this._colorMask,this._depthStencilAttachment);this._pipeStateCaches[e]||(this._pipeStateCaches[e]=Object.create(null)),this._pipeCache=this._pipeStateCaches[e]}destroy(){this._renderer=null,this._bufferLayoutsCache=null}}$0.extension={type:[F.WebGPUSystem],name:"pipeline"};class cE{constructor(){this.contexts=[],this.msaaTextures=[],this.msaaSamples=1}}class dE{init(e,t){this._renderer=e,this._renderTargetSystem=t}copyToTexture(e,t,n,i,s){const o=this._renderer,a=this._getGpuColorTexture(e),l=o.texture.getGpuSource(t.source);return o.encoder.commandEncoder.copyTextureToTexture({texture:a,origin:n},{texture:l,origin:s},i),t}startRenderPass(e,t=!0,n,i){const o=this._renderTargetSystem.getGpuRenderTarget(e),a=this.getDescriptor(e,t,n);o.descriptor=a,this._renderer.pipeline.setRenderTarget(o),this._renderer.encoder.beginRenderPass(o),this._renderer.encoder.setViewport(i)}finishRenderPass(){this._renderer.encoder.endRenderPass()}_getGpuColorTexture(e){const t=this._renderTargetSystem.getGpuRenderTarget(e);return t.contexts[0]?t.contexts[0].getCurrentTexture():this._renderer.texture.getGpuSource(e.colorTextures[0].source)}getDescriptor(e,t,n){typeof t=="boolean"&&(t=t?Dt.ALL:Dt.NONE);const i=this._renderTargetSystem,s=i.getGpuRenderTarget(e),o=e.colorTextures.map((u,c)=>{const d=s.contexts[c];let h,f;d?h=d.getCurrentTexture().createView():h=this._renderer.texture.getGpuSource(u).createView({mipLevelCount:1}),s.msaaTextures[c]&&(f=h,h=this._renderer.texture.getTextureView(s.msaaTextures[c]));const p=t&Dt.COLOR?"clear":"load";return n??(n=i.defaultClearColor),{view:h,resolveTarget:f,clearValue:n,storeOp:"store",loadOp:p}});let a;if((e.stencil||e.depth)&&!e.depthStencilTexture&&(e.ensureDepthStencilTexture(),e.depthStencilTexture.source.sampleCount=s.msaa?4:1),e.depthStencilTexture){const u=t&Dt.STENCIL?"clear":"load",c=t&Dt.DEPTH?"clear":"load";a={view:this._renderer.texture.getGpuSource(e.depthStencilTexture.source).createView(),stencilStoreOp:"store",stencilLoadOp:u,depthClearValue:1,depthLoadOp:c,depthStoreOp:"store"}}return{colorAttachments:o,depthStencilAttachment:a}}clear(e,t=!0,n,i){if(!t)return;const{gpu:s,encoder:o}=this._renderer,a=s.device;if(o.commandEncoder===null){const u=a.createCommandEncoder(),c=this.getDescriptor(e,t,n),d=u.beginRenderPass(c);d.setViewport(i.x,i.y,i.width,i.height,0,1),d.end();const h=u.finish();a.queue.submit([h])}else this.startRenderPass(e,t,n,i)}initGpuRenderTarget(e){e.isRoot=!0;const t=new cE;return e.colorTextures.forEach((n,i)=>{if(Xn.test(n.resource)){const s=n.resource.getContext("webgpu"),o=n.transparent?"premultiplied":"opaque";try{s.configure({device:this._renderer.gpu.device,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,format:"bgra8unorm",alphaMode:o})}catch(a){console.error(a)}t.contexts[i]=s}if(t.msaa=n.source.antialias,n.source.antialias){const s=new lt({width:0,height:0,sampleCount:4});t.msaaTextures[i]=s}}),t.msaa&&(t.msaaSamples=4,e.depthStencilTexture&&(e.depthStencilTexture.source.sampleCount=4)),t}destroyGpuRenderTarget(e){e.contexts.forEach(t=>{t.unconfigure()}),e.msaaTextures.forEach(t=>{t.destroy()}),e.msaaTextures.length=0,e.contexts.length=0}ensureDepthStencilTexture(e){const t=this._renderTargetSystem.getGpuRenderTarget(e);e.depthStencilTexture&&t.msaa&&(e.depthStencilTexture.source.sampleCount=4)}resizeGpuRenderTarget(e){const t=this._renderTargetSystem.getGpuRenderTarget(e);t.width=e.width,t.height=e.height,t.msaa&&e.colorTextures.forEach((n,i)=>{t.msaaTextures[i]?.resize(n.source.width,n.source.height,n.source._resolution)})}}class Z0 extends l0{constructor(e){super(e),this.adaptor=new dE,this.adaptor.init(e,this)}}Z0.extension={type:[F.WebGPUSystem],name:"renderTarget"};class Q0{constructor(){this._gpuProgramData=Object.create(null)}contextChange(e){this._gpu=e,this.maxTextures=e.device.limits.maxSampledTexturesPerShaderStage}getProgramData(e){return this._gpuProgramData[e._layoutKey]||this._createGPUProgramData(e)}_createGPUProgramData(e){const t=this._gpu.device,n=e.gpuLayout.map(s=>t.createBindGroupLayout({entries:s})),i={bindGroupLayouts:n};return this._gpuProgramData[e._layoutKey]={bindGroups:n,pipeline:t.createPipelineLayout(i)},this._gpuProgramData[e._layoutKey]}destroy(){this._gpu=null,this._gpuProgramData=null}}Q0.extension={type:[F.WebGPUSystem],name:"shader"};const Rt={};Rt.normal={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"}};Rt.add={alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one",operation:"add"}};Rt.multiply={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"dst",dstFactor:"one-minus-src-alpha",operation:"add"}};Rt.screen={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src",operation:"add"}};Rt.overlay={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src",operation:"add"}};Rt.none={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"zero",dstFactor:"zero",operation:"add"}};Rt["normal-npm"]={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"}};Rt["add-npm"]={alpha:{srcFactor:"one",dstFactor:"one",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one",operation:"add"}};Rt["screen-npm"]={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src",operation:"add"}};Rt.erase={alpha:{srcFactor:"zero",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"zero",dstFactor:"one-minus-src",operation:"add"}};Rt.min={alpha:{srcFactor:"one",dstFactor:"one",operation:"min"},color:{srcFactor:"one",dstFactor:"one",operation:"min"}};Rt.max={alpha:{srcFactor:"one",dstFactor:"one",operation:"max"},color:{srcFactor:"one",dstFactor:"one",operation:"max"}};class J0{constructor(){this.defaultState=new vr,this.defaultState.blend=!0}contextChange(e){this.gpu=e}getColorTargets(e){return[{format:"bgra8unorm",writeMask:0,blend:Rt[e.blendMode]||Rt.normal}]}destroy(){this.gpu=null}}J0.extension={type:[F.WebGPUSystem],name:"state"};const hE={type:"image",upload(r,e,t){const n=r.resource,i=(r.pixelWidth|0)*(r.pixelHeight|0),s=n.byteLength/i;t.device.queue.writeTexture({texture:e},n,{offset:0,rowsPerImage:r.pixelHeight,bytesPerRow:r.pixelHeight*s},{width:r.pixelWidth,height:r.pixelHeight,depthOrArrayLayers:1})}},ex={"bc1-rgba-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"bc2-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc3-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc7-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"etc1-rgb-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"etc2-rgba8unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"astc-4x4-unorm":{blockBytes:16,blockWidth:4,blockHeight:4}},fE={blockBytes:4,blockWidth:1,blockHeight:1},pE={type:"compressed",upload(r,e,t){let n=r.pixelWidth,i=r.pixelHeight;const s=ex[r.format]||fE;for(let o=0;o<r.resource.length;o++){const a=r.resource[o],l=Math.ceil(n/s.blockWidth)*s.blockBytes;t.device.queue.writeTexture({texture:e,mipLevel:o},a,{offset:0,bytesPerRow:l},{width:Math.ceil(n/s.blockWidth)*s.blockWidth,height:Math.ceil(i/s.blockHeight)*s.blockHeight,depthOrArrayLayers:1}),n=Math.max(n>>1,1),i=Math.max(i>>1,1)}}},tx={type:"image",upload(r,e,t){const n=r.resource;if(!n)return;const i=Math.min(e.width,r.resourceWidth||r.pixelWidth),s=Math.min(e.height,r.resourceHeight||r.pixelHeight),o=r.alphaMode==="premultiply-alpha-on-upload";t.device.queue.copyExternalImageToTexture({source:n},{texture:e,premultipliedAlpha:o},{width:i,height:s})}},mE={type:"video",upload(r,e,t){tx.upload(r,e,t)}};class gE{constructor(e){this.device=e,this.sampler=e.createSampler({minFilter:"linear"}),this.pipelines={}}_getMipmapPipeline(e){let t=this.pipelines[e];return t||(this.mipmapShaderModule||(this.mipmapShaderModule=this.device.createShaderModule({code:`
                        var<private> pos : array<vec2<f32>, 3> = array<vec2<f32>, 3>(
                        vec2<f32>(-1.0, -1.0), vec2<f32>(-1.0, 3.0), vec2<f32>(3.0, -1.0));

                        struct VertexOutput {
                        @builtin(position) position : vec4<f32>,
                        @location(0) texCoord : vec2<f32>,
                        };

                        @vertex
                        fn vertexMain(@builtin(vertex_index) vertexIndex : u32) -> VertexOutput {
                        var output : VertexOutput;
                        output.texCoord = pos[vertexIndex] * vec2<f32>(0.5, -0.5) + vec2<f32>(0.5);
                        output.position = vec4<f32>(pos[vertexIndex], 0.0, 1.0);
                        return output;
                        }

                        @group(0) @binding(0) var imgSampler : sampler;
                        @group(0) @binding(1) var img : texture_2d<f32>;

                        @fragment
                        fn fragmentMain(@location(0) texCoord : vec2<f32>) -> @location(0) vec4<f32> {
                        return textureSample(img, imgSampler, texCoord);
                        }
                    `})),t=this.device.createRenderPipeline({layout:"auto",vertex:{module:this.mipmapShaderModule,entryPoint:"vertexMain"},fragment:{module:this.mipmapShaderModule,entryPoint:"fragmentMain",targets:[{format:e}]}}),this.pipelines[e]=t),t}generateMipmap(e){const t=this._getMipmapPipeline(e.format);if(e.dimension==="3d"||e.dimension==="1d")throw new Error("Generating mipmaps for non-2d textures is currently unsupported!");let n=e;const i=e.depthOrArrayLayers||1,s=e.usage&GPUTextureUsage.RENDER_ATTACHMENT;if(!s){const l={size:{width:Math.ceil(e.width/2),height:Math.ceil(e.height/2),depthOrArrayLayers:i},format:e.format,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC|GPUTextureUsage.RENDER_ATTACHMENT,mipLevelCount:e.mipLevelCount-1};n=this.device.createTexture(l)}const o=this.device.createCommandEncoder({}),a=t.getBindGroupLayout(0);for(let l=0;l<i;++l){let u=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:"2d",baseArrayLayer:l,arrayLayerCount:1}),c=s?1:0;for(let d=1;d<e.mipLevelCount;++d){const h=n.createView({baseMipLevel:c++,mipLevelCount:1,dimension:"2d",baseArrayLayer:l,arrayLayerCount:1}),f=o.beginRenderPass({colorAttachments:[{view:h,storeOp:"store",loadOp:"clear",clearValue:{r:0,g:0,b:0,a:0}}]}),p=this.device.createBindGroup({layout:a,entries:[{binding:0,resource:this.sampler},{binding:1,resource:u}]});f.setPipeline(t),f.setBindGroup(0,p),f.draw(3,1,0,0),f.end(),u=h}}if(!s){const l={width:Math.ceil(e.width/2),height:Math.ceil(e.height/2),depthOrArrayLayers:i};for(let u=1;u<e.mipLevelCount;++u)o.copyTextureToTexture({texture:n,mipLevel:u-1},{texture:e,mipLevel:u},l),l.width=Math.ceil(l.width/2),l.height=Math.ceil(l.height/2)}return this.device.queue.submit([o.finish()]),s||n.destroy(),e}}class rx{constructor(e){this.managedTextures=[],this._gpuSources=Object.create(null),this._gpuSamplers=Object.create(null),this._bindGroupHash=Object.create(null),this._textureViewHash=Object.create(null),this._uploads={image:tx,buffer:hE,video:mE,compressed:pE},this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuSources"),e.renderableGC.addManagedHash(this,"_gpuSamplers"),e.renderableGC.addManagedHash(this,"_bindGroupHash"),e.renderableGC.addManagedHash(this,"_textureViewHash")}contextChange(e){this._gpu=e}initSource(e){if(e.autoGenerateMipmaps){const l=Math.max(e.pixelWidth,e.pixelHeight);e.mipLevelCount=Math.floor(Math.log2(l))+1}let t=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST;e.uploadMethodId!=="compressed"&&(t|=GPUTextureUsage.RENDER_ATTACHMENT,t|=GPUTextureUsage.COPY_SRC);const n=ex[e.format]||{blockBytes:4,blockWidth:1,blockHeight:1},i=Math.ceil(e.pixelWidth/n.blockWidth)*n.blockWidth,s=Math.ceil(e.pixelHeight/n.blockHeight)*n.blockHeight,o={label:e.label,size:{width:i,height:s},format:e.format,sampleCount:e.sampleCount,mipLevelCount:e.mipLevelCount,dimension:e.dimension,usage:t},a=this._gpu.device.createTexture(o);return this._gpuSources[e.uid]=a,this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceResize,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),a}onSourceUpdate(e){const t=this.getGpuSource(e);t&&(this._uploads[e.uploadMethodId]&&this._uploads[e.uploadMethodId].upload(e,t,this._gpu),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e))}onSourceUnload(e){const t=this._gpuSources[e.uid];t&&(this._gpuSources[e.uid]=null,t.destroy())}onUpdateMipmaps(e){this._mipmapGenerator||(this._mipmapGenerator=new gE(this._gpu.device));const t=this.getGpuSource(e);this._mipmapGenerator.generateMipmap(t)}onSourceDestroy(e){e.off("update",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("destroy",this.onSourceDestroy,this),e.off("resize",this.onSourceResize,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}onSourceResize(e){const t=this._gpuSources[e.uid];t?(t.width!==e.pixelWidth||t.height!==e.pixelHeight)&&(this._textureViewHash[e.uid]=null,this._bindGroupHash[e.uid]=null,this.onSourceUnload(e),this.initSource(e)):this.initSource(e)}_initSampler(e){return this._gpuSamplers[e._resourceId]=this._gpu.device.createSampler(e),this._gpuSamplers[e._resourceId]}getGpuSampler(e){return this._gpuSamplers[e._resourceId]||this._initSampler(e)}getGpuSource(e){return this._gpuSources[e.uid]||this.initSource(e)}getTextureBindGroup(e){return this._bindGroupHash[e.uid]??this._createTextureBindGroup(e)}_createTextureBindGroup(e){const t=e.source;return this._bindGroupHash[e.uid]=new Vr({0:t,1:t.style,2:new _t({uTextureMatrix:{type:"mat3x3<f32>",value:e.textureMatrix.mapCoord}})}),this._bindGroupHash[e.uid]}getTextureView(e){const t=e.source;return this._textureViewHash[t.uid]??this._createTextureView(t)}_createTextureView(e){return this._textureViewHash[e.uid]=this.getGpuSource(e).createView(),this._textureViewHash[e.uid]}generateCanvas(e){const t=this._renderer,n=t.gpu.device.createCommandEncoder(),i=Ee.get().createCanvas();i.width=e.source.pixelWidth,i.height=e.source.pixelHeight;const s=i.getContext("webgpu");return s.configure({device:t.gpu.device,usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC,format:Ee.get().getNavigator().gpu.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),n.copyTextureToTexture({texture:t.texture.getGpuSource(e.source),origin:{x:0,y:0}},{texture:s.getCurrentTexture()},{width:i.width,height:i.height}),t.gpu.device.queue.submit([n.finish()]),i}getPixels(e){const t=this.generateCanvas(e),n=Wr.getOptimalCanvasAndContext(t.width,t.height),i=n.context;i.drawImage(t,0,0);const{width:s,height:o}=t,a=i.getImageData(0,0,s,o),l=new Uint8ClampedArray(a.data.buffer);return Wr.returnCanvasAndContext(n),{pixels:l,width:s,height:o}}destroy(){this.managedTextures.slice().forEach(e=>this.onSourceDestroy(e)),this.managedTextures=null;for(const e of Object.keys(this._bindGroupHash)){const t=Number(e);this._bindGroupHash[t]?.destroy(),this._bindGroupHash[t]=null}this._gpu=null,this._mipmapGenerator=null,this._gpuSources=null,this._bindGroupHash=null,this._textureViewHash=null,this._gpuSamplers=null}}rx.extension={type:[F.WebGPUSystem],name:"texture"};class nx{init(){const e=new _t({uTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),t=ao({name:"graphics",bits:[Jc,td(ss()),UA,uo]});this.shader=new sr({gpuProgram:t,resources:{localUniforms:e}})}execute(e,t){const n=t.context,i=n.customShader||this.shader,s=e.renderer,o=s.graphicsContext,{batcher:a,instructions:l}=o.getContextRenderData(n),u=s.encoder;u.setPipelineFromGeometryProgramAndState(a.geometry,i.gpuProgram,e.state),u.setGeometry(a.geometry,i.gpuProgram);const c=s.globalUniforms.bindGroup;u.setBindGroup(0,c,i.gpuProgram);const d=s.renderPipes.uniformBatch.getUniformBindGroup(i.resources.localUniforms,!0);u.setBindGroup(2,d,i.gpuProgram);const h=l.instructions;for(let f=0;f<l.instructionSize;f++){const p=h[f];if(i.groups[1]=p.bindGroup,!p.gpuBindGroup){const m=p.textures;p.bindGroup=Qc(m.textures,m.count),p.gpuBindGroup=s.bindGroup.getBindGroup(p.bindGroup,i.gpuProgram,1)}u.setBindGroup(1,p.bindGroup,i.gpuProgram),u.renderPassEncoder.drawIndexed(p.size,1,p.start)}}destroy(){this.shader.destroy(!0),this.shader=null}}nx.extension={type:[F.WebGPUPipesAdaptor],name:"graphics"};class ix{init(){const e=ao({name:"mesh",bits:[ks,DA,uo]});this._shader=new sr({gpuProgram:e,resources:{uTexture:te.EMPTY._source,uSampler:te.EMPTY._source.style,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new ae}}}})}execute(e,t){const n=e.renderer;let i=t._shader;if(!i)i=this._shader,i.groups[2]=n.texture.getTextureBindGroup(t.texture);else if(!i.gpuProgram){de("Mesh shader has no gpuProgram",t.shader);return}const s=i.gpuProgram;if(s.autoAssignGlobalUniforms&&(i.groups[0]=n.globalUniforms.bindGroup),s.autoAssignLocalUniforms){const o=e.localUniforms;i.groups[1]=n.renderPipes.uniformBatch.getUniformBindGroup(o,!0)}n.encoder.draw({geometry:t._geometry,shader:i,state:t.state})}destroy(){this._shader.destroy(!0),this._shader=null}}ix.extension={type:[F.WebGPUPipesAdaptor],name:"mesh"};const vE=[...G0,Y0,X0,Md,W0,rx,Z0,Q0,J0,$0,j0,q0,V0],xE=[...z0,K0],bE=[Gv,ix,nx],sx=[],ox=[],ax=[];he.handleByNamedList(F.WebGPUSystem,sx);he.handleByNamedList(F.WebGPUPipes,ox);he.handleByNamedList(F.WebGPUPipesAdaptor,ax);he.add(...vE,...xE,...bE);class _E extends sl{constructor(){const e={name:"webgpu",type:Wt.WEBGPU,systems:sx,renderPipes:ox,renderPipeAdaptors:ax};super(e)}}const yE=Object.freeze(Object.defineProperty({__proto__:null,WebGPURenderer:_E},Symbol.toStringTag,{value:"Module"}));class lx{constructor(e,t){this.state=vr.for2d(),this._graphicsBatchesHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this.renderer=e,this._adaptor=t,this._adaptor.init(),this.renderer.renderableGC.addManagedHash(this,"_graphicsBatchesHash")}validateRenderable(e){const t=e.context,n=!!this._graphicsBatchesHash[e.uid],i=this.renderer.graphicsContext.updateGpuContext(t);return!!(i.isBatchable||n!==i.isBatchable)}addRenderable(e,t){const n=this.renderer.graphicsContext.updateGpuContext(e.context);e.didViewUpdate&&this._rebuild(e),n.isBatchable?this._addToBatcher(e,t):(this.renderer.renderPipes.batch.break(t),t.add(e))}updateRenderable(e){const t=this._graphicsBatchesHash[e.uid];if(t)for(let n=0;n<t.length;n++){const i=t[n];i._batcher.updateElement(i)}}destroyRenderable(e){this._graphicsBatchesHash[e.uid]&&this._removeBatchForRenderable(e.uid),e.off("destroyed",this._destroyRenderableBound)}execute(e){if(!e.isRenderable)return;const t=this.renderer,n=e.context;if(!t.graphicsContext.getGpuContext(n).batches.length)return;const s=n.customShader||this._adaptor.shader;this.state.blendMode=e.groupBlendMode;const o=s.resources.localUniforms.uniforms;o.uTransformMatrix=e.groupTransform,o.uRound=t._roundPixels|e._roundPixels,ho(e.groupColorAlpha,o.uColor,0),this._adaptor.execute(this,e)}_rebuild(e){const t=!!this._graphicsBatchesHash[e.uid],n=this.renderer.graphicsContext.updateGpuContext(e.context);t&&this._removeBatchForRenderable(e.uid),n.isBatchable&&this._initBatchesForRenderable(e),e.batched=n.isBatchable}_addToBatcher(e,t){const n=this.renderer.renderPipes.batch,i=this._getBatchesForRenderable(e);for(let s=0;s<i.length;s++){const o=i[s];n.addToBatch(o,t)}}_getBatchesForRenderable(e){return this._graphicsBatchesHash[e.uid]||this._initBatchesForRenderable(e)}_initBatchesForRenderable(e){const t=e.context,n=this.renderer.graphicsContext.getGpuContext(t),i=this.renderer._roundPixels|e._roundPixels,s=n.batches.map(o=>{const a=Re.get(sd);return o.copyTo(a),a.renderable=e,a.roundPixels=i,a});return this._graphicsBatchesHash[e.uid]===void 0&&e.on("destroyed",this._destroyRenderableBound),this._graphicsBatchesHash[e.uid]=s,s}_removeBatchForRenderable(e){this._graphicsBatchesHash[e].forEach(t=>{Re.return(t)}),this._graphicsBatchesHash[e]=null}destroy(){this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null;for(const e in this._graphicsBatchesHash)this._removeBatchForRenderable(e);this._graphicsBatchesHash=null}}lx.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"graphics"};const ux=class cx extends pd{constructor(...e){super({});let t=e[0]??{};typeof t=="number"&&(J(Me,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),t={width:t,height:e[1],verticesX:e[2],verticesY:e[3]}),this.build(t)}build(e){e={...cx.defaultOptions,...e},this.verticesX=this.verticesX??e.verticesX,this.verticesY=this.verticesY??e.verticesY,this.width=this.width??e.width,this.height=this.height??e.height;const t=this.verticesX*this.verticesY,n=[],i=[],s=[],o=this.verticesX-1,a=this.verticesY-1,l=this.width/o,u=this.height/a;for(let d=0;d<t;d++){const h=d%this.verticesX,f=d/this.verticesX|0;n.push(h*l,f*u),i.push(h/o,f/a)}const c=o*a;for(let d=0;d<c;d++){const h=d%o,f=d/o|0,p=f*this.verticesX+h,m=f*this.verticesX+h+1,g=(f+1)*this.verticesX+h,v=(f+1)*this.verticesX+h+1;s.push(p,m,g,m,v,g)}this.buffers[0].data=new Float32Array(n),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint32Array(s),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};ux.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let SE=ux;class Rd{constructor(){this.batcherName="default",this.packAsQuad=!1,this.indexOffset=0,this.attributeOffset=0,this.roundPixels=0,this._batcher=null,this._batch=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}get blendMode(){return this.renderable.groupBlendMode}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.geometry=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}get uvs(){const t=this.geometry.getBuffer("aUV"),n=t.data;let i=n;const s=this.texture.textureMatrix;return s.isSimple||(i=this._transformedUvs,(this._textureMatrixUpdateId!==s._updateID||this._uvUpdateId!==t._updateID)&&((!i||i.length<n.length)&&(i=this._transformedUvs=new Float32Array(n.length)),this._textureMatrixUpdateId=s._updateID,this._uvUpdateId=t._updateID,s.multiplyUvs(n,i))),i}get positions(){return this.geometry.positions}get indices(){return this.geometry.indices}get color(){return this.renderable.groupColorAlpha}get groupTransform(){return this.renderable.groupTransform}get attributeSize(){return this.geometry.positions.length/2}get indexSize(){return this.geometry.indices.length}}class dx{constructor(e,t){this.localUniforms=new _t({uTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),this.localUniformsBindGroup=new Vr({0:this.localUniforms}),this._meshDataHash=Object.create(null),this._gpuBatchableMeshHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this.renderer=e,this._adaptor=t,this._adaptor.init(),e.renderableGC.addManagedHash(this,"_gpuBatchableMeshHash"),e.renderableGC.addManagedHash(this,"_meshDataHash")}validateRenderable(e){const t=this._getMeshData(e),n=t.batched,i=e.batched;if(t.batched=i,n!==i)return!0;if(i){const s=e._geometry;if(s.indices.length!==t.indexSize||s.positions.length!==t.vertexSize)return t.indexSize=s.indices.length,t.vertexSize=s.positions.length,!0;const o=this._getBatchableMesh(e),a=e.texture;if(o.texture._source!==a._source&&o.texture._source!==a._source)return!o._batcher.checkAndUpdateTexture(o,a)}return!1}addRenderable(e,t){const n=this.renderer.renderPipes.batch,{batched:i}=this._getMeshData(e);if(i){const s=this._getBatchableMesh(e);s.texture=e._texture,s.geometry=e._geometry,n.addToBatch(s,t)}else n.break(t),t.add(e)}updateRenderable(e){if(e.batched){const t=this._gpuBatchableMeshHash[e.uid];t.texture=e._texture,t.geometry=e._geometry,t._batcher.updateElement(t)}}destroyRenderable(e){this._meshDataHash[e.uid]=null;const t=this._gpuBatchableMeshHash[e.uid];t&&(Re.return(t),this._gpuBatchableMeshHash[e.uid]=null),e.off("destroyed",this._destroyRenderableBound)}execute(e){if(!e.isRenderable)return;e.state.blendMode=Xs(e.groupBlendMode,e.texture._source);const t=this.localUniforms;t.uniforms.uTransformMatrix=e.groupTransform,t.uniforms.uRound=this.renderer._roundPixels|e._roundPixels,t.update(),ho(e.groupColorAlpha,t.uniforms.uColor,0),this._adaptor.execute(this,e)}_getMeshData(e){return this._meshDataHash[e.uid]||this._initMeshData(e)}_initMeshData(e){return this._meshDataHash[e.uid]={batched:e.batched,indexSize:e._geometry.indices?.length,vertexSize:e._geometry.positions?.length},e.on("destroyed",this._destroyRenderableBound),this._meshDataHash[e.uid]}_getBatchableMesh(e){return this._gpuBatchableMeshHash[e.uid]||this._initBatchableMesh(e)}_initBatchableMesh(e){const t=Re.get(Rd);return t.renderable=e,t.texture=e._texture,t.transform=e.groupTransform,t.roundPixels=this.renderer._roundPixels|e._roundPixels,this._gpuBatchableMeshHash[e.uid]=t,t}destroy(){for(const e in this._gpuBatchableMeshHash)this._gpuBatchableMeshHash[e]&&Re.return(this._gpuBatchableMeshHash[e]);this._gpuBatchableMeshHash=null,this._meshDataHash=null,this.localUniforms=null,this.localUniformsBindGroup=null,this._adaptor.destroy(),this._adaptor=null,this.renderer=null}}dx.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"mesh"};class wE{execute(e,t){const n=e.state,i=e.renderer,s=t.shader||e.defaultShader;s.resources.uTexture=t.texture._source,s.resources.uniforms=e.localUniforms;const o=i.gl,a=e.getBuffers(t);i.shader.bind(s),i.state.set(n),i.geometry.bind(a.geometry,s.glProgram);const u=a.geometry.indexBuffer.data.BYTES_PER_ELEMENT===2?o.UNSIGNED_SHORT:o.UNSIGNED_INT;o.drawElements(o.TRIANGLES,t.particleChildren.length*6,u,0)}}class TE{execute(e,t){const n=e.renderer,i=t.shader||e.defaultShader;i.groups[0]=n.renderPipes.uniformBatch.getUniformBindGroup(e.localUniforms,!0),i.groups[1]=n.texture.getTextureBindGroup(t.texture);const s=e.state,o=e.getBuffers(t);n.encoder.draw({geometry:o.geometry,shader:t.shader||e.defaultShader,state:s,size:t.particleChildren.length*6})}}function fp(r,e=null){const t=r*6;if(t>65535?e=e||new Uint32Array(t):e=e||new Uint16Array(t),e.length!==t)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${t}`);for(let n=0,i=0;n<t;n+=6,i+=4)e[n+0]=i+0,e[n+1]=i+1,e[n+2]=i+2,e[n+3]=i+0,e[n+4]=i+2,e[n+5]=i+3;return e}function CE(r){return{dynamicUpdate:pp(r,!0),staticUpdate:pp(r,!1)}}function pp(r,e){const t=[];t.push(`
      
        var index = 0;

        for (let i = 0; i < ps.length; ++i)
        {
            const p = ps[i];

            `);let n=0;for(const s in r){const o=r[s];if(e!==o.dynamic)continue;t.push(`offset = index + ${n}`),t.push(o.code);const a=hn(o.format);n+=a.stride/4}t.push(`
            index += stride * 4;
        }
    `),t.unshift(`
        var stride = ${n};
    `);const i=t.join(`
`);return new Function("ps","f32v","u32v",i)}class PE{constructor(e){this._size=0,this._generateParticleUpdateCache={};const t=this._size=e.size??1e3,n=e.properties;let i=0,s=0;for(const c in n){const d=n[c],h=hn(d.format);d.dynamic?s+=h.stride:i+=h.stride}this._dynamicStride=s/4,this._staticStride=i/4,this.staticAttributeBuffer=new yi(t*4*i),this.dynamicAttributeBuffer=new yi(t*4*s),this.indexBuffer=fp(t);const o=new oo;let a=0,l=0;this._staticBuffer=new Ht({data:new Float32Array(1),label:"static-particle-buffer",shrinkToFit:!1,usage:Ae.VERTEX|Ae.COPY_DST}),this._dynamicBuffer=new Ht({data:new Float32Array(1),label:"dynamic-particle-buffer",shrinkToFit:!1,usage:Ae.VERTEX|Ae.COPY_DST});for(const c in n){const d=n[c],h=hn(d.format);d.dynamic?(o.addAttribute(d.attributeName,{buffer:this._dynamicBuffer,stride:this._dynamicStride*4,offset:a*4,format:d.format}),a+=h.size):(o.addAttribute(d.attributeName,{buffer:this._staticBuffer,stride:this._staticStride*4,offset:l*4,format:d.format}),l+=h.size)}o.addIndex(this.indexBuffer);const u=this.getParticleUpdate(n);this._dynamicUpload=u.dynamicUpdate,this._staticUpload=u.staticUpdate,this.geometry=o}getParticleUpdate(e){const t=AE(e);return this._generateParticleUpdateCache[t]?this._generateParticleUpdateCache[t]:(this._generateParticleUpdateCache[t]=this.generateParticleUpdate(e),this._generateParticleUpdateCache[t])}generateParticleUpdate(e){return CE(e)}update(e,t){e.length>this._size&&(t=!0,this._size=Math.max(e.length,this._size*1.5|0),this.staticAttributeBuffer=new yi(this._size*this._staticStride*4*4),this.dynamicAttributeBuffer=new yi(this._size*this._dynamicStride*4*4),this.indexBuffer=fp(this._size),this.geometry.indexBuffer.setDataWithSize(this.indexBuffer,this.indexBuffer.byteLength,!0));const n=this.dynamicAttributeBuffer;if(this._dynamicUpload(e,n.float32View,n.uint32View),this._dynamicBuffer.setDataWithSize(this.dynamicAttributeBuffer.float32View,e.length*this._dynamicStride*4,!0),t){const i=this.staticAttributeBuffer;this._staticUpload(e,i.float32View,i.uint32View),this._staticBuffer.setDataWithSize(i.float32View,e.length*this._staticStride*4,!0)}}destroy(){this._staticBuffer.destroy(),this._dynamicBuffer.destroy(),this.geometry.destroy()}}function AE(r){const e=[];for(const t in r){const n=r[t];e.push(t,n.code,n.dynamic?"d":"s")}return e.join("_")}var EE=`varying vec2 vUV;
varying vec4 vColor;

uniform sampler2D uTexture;

void main(void){
    vec4 color = texture2D(uTexture, vUV) * vColor;
    gl_FragColor = color;
}`,ME=`attribute vec2 aVertex;
attribute vec2 aUV;
attribute vec4 aColor;

attribute vec2 aPosition;
attribute float aRotation;

uniform mat3 uTranslationMatrix;
uniform float uRound;
uniform vec2 uResolution;
uniform vec4 uColor;

varying vec2 vUV;
varying vec4 vColor;

vec2 roundPixels(vec2 position, vec2 targetSize)
{       
    return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
}

void main(void){
    float cosRotation = cos(aRotation);
    float sinRotation = sin(aRotation);
    float x = aVertex.x * cosRotation - aVertex.y * sinRotation;
    float y = aVertex.x * sinRotation + aVertex.y * cosRotation;

    vec2 v = vec2(x, y);
    v = v + aPosition;

    gl_Position = vec4((uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    if(uRound == 1.0)
    {
        gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
    }

    vUV = aUV;
    vColor = aColor * uColor;
}
`,mp=`
struct ParticleUniforms {
  uProjectionMatrix:mat3x3<f32>,
  uResolution:vec2<f32>,
  uRoundPixels:f32,
};

@group(0) @binding(0) var<uniform> uniforms: ParticleUniforms;

@group(1) @binding(0) var uTexture: texture_2d<f32>;
@group(1) @binding(1) var uSampler : sampler;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) color : vec4<f32>,
  };
@vertex
fn mainVertex(
  @location(0) aVertex: vec2<f32>,
  @location(1) aPosition: vec2<f32>,
  @location(2) aUV: vec2<f32>,
  @location(3) aColor: vec4<f32>,
  @location(4) aRotation: f32,
) -> VSOutput {
  
   let v = vec2(
       aVertex.x * cos(aRotation) - aVertex.y * sin(aRotation),
       aVertex.x * sin(aRotation) + aVertex.y * cos(aRotation)
   ) + aPosition;

   let position = vec4((uniforms.uProjectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

  return VSOutput(
   position,
   aUV,
   aColor,
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @location(1) color: vec4<f32>,
  @builtin(position) position: vec4<f32>,
) -> @location(0) vec4<f32> {

    var sample = textureSample(uTexture, uSampler, uv) * color;
   
    return sample;
}`;class RE extends sr{constructor(){const e=be.from({vertex:ME,fragment:EE}),t=me.from({fragment:{source:mp,entryPoint:"mainFragment"},vertex:{source:mp,entryPoint:"mainVertex"}});super({glProgram:e,gpuProgram:t,resources:{uTexture:te.WHITE.source,uSampler:new tg({}),uniforms:{uTranslationMatrix:{value:new ae,type:"mat3x3<f32>"},uColor:{value:new pe(16777215),type:"vec4<f32>"},uRound:{value:1,type:"f32"},uResolution:{value:[0,0],type:"vec2<f32>"}}}})}}class hx{constructor(e,t){this.state=vr.for2d(),this._gpuBufferHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this.localUniforms=new _t({uTranslationMatrix:{value:new ae,type:"mat3x3<f32>"},uColor:{value:new Float32Array(4),type:"vec4<f32>"},uRound:{value:1,type:"f32"},uResolution:{value:[0,0],type:"vec2<f32>"}}),this.renderer=e,this.adaptor=t,this.defaultShader=new RE,this.state=vr.for2d()}validateRenderable(e){return!1}addRenderable(e,t){this.renderer.renderPipes.batch.break(t),t.add(e)}getBuffers(e){return this._gpuBufferHash[e.uid]||this._initBuffer(e)}_initBuffer(e){return this._gpuBufferHash[e.uid]=new PE({size:e.particleChildren.length,properties:e._properties}),e.on("destroyed",this._destroyRenderableBound),this._gpuBufferHash[e.uid]}updateRenderable(e){}destroyRenderable(e){this._gpuBufferHash[e.uid].destroy(),this._gpuBufferHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}execute(e){const t=e.particleChildren;if(t.length===0)return;const n=this.renderer,i=this.getBuffers(e);e.texture||(e.texture=t[0].texture);const s=this.state;i.update(t,e._childrenDirty),e._childrenDirty=!1,s.blendMode=Xs(e.blendMode,e.texture._source);const o=this.localUniforms.uniforms,a=o.uTranslationMatrix;e.worldTransform.copyTo(a),a.prepend(n.globalUniforms.globalUniformData.projectionMatrix),o.uResolution=n.globalUniforms.globalUniformData.resolution,o.uRound=n._roundPixels|e._roundPixels,ho(e.groupColorAlpha,o.uColor,0),this.adaptor.execute(this,e)}destroy(){this.defaultShader&&(this.defaultShader.destroy(),this.defaultShader=null)}}class fx extends hx{constructor(e){super(e,new wE)}}fx.extension={type:[F.WebGLPipes],name:"particle"};class px extends hx{constructor(e){super(e,new TE)}}px.extension={type:[F.WebGPUPipes],name:"particle"};const mx=class gx extends SE{constructor(e={}){e={...gx.defaultOptions,...e},super({width:e.width,height:e.height,verticesX:4,verticesY:4}),this.update(e)}update(e){this.width=e.width??this.width,this.height=e.height??this.height,this._originalWidth=e.originalWidth??this._originalWidth,this._originalHeight=e.originalHeight??this._originalHeight,this._leftWidth=e.leftWidth??this._leftWidth,this._rightWidth=e.rightWidth??this._rightWidth,this._topHeight=e.topHeight??this._topHeight,this._bottomHeight=e.bottomHeight??this._bottomHeight,this.updateUvs(),this.updatePositions()}updatePositions(){const e=this.positions,t=this._leftWidth+this._rightWidth,n=this.width>t?1:this.width/t,i=this._topHeight+this._bottomHeight,s=this.height>i?1:this.height/i,o=Math.min(n,s);e[9]=e[11]=e[13]=e[15]=this._topHeight*o,e[17]=e[19]=e[21]=e[23]=this.height-this._bottomHeight*o,e[25]=e[27]=e[29]=e[31]=this.height,e[2]=e[10]=e[18]=e[26]=this._leftWidth*o,e[4]=e[12]=e[20]=e[28]=this.width-this._rightWidth*o,e[6]=e[14]=e[22]=e[30]=this.width,this.getBuffer("aPosition").update()}updateUvs(){const e=this.uvs;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1;const t=1/this._originalWidth,n=1/this._originalHeight;e[2]=e[10]=e[18]=e[26]=t*this._leftWidth,e[9]=e[11]=e[13]=e[15]=n*this._topHeight,e[4]=e[12]=e[20]=e[28]=1-t*this._rightWidth,e[17]=e[19]=e[21]=e[23]=1-n*this._bottomHeight,this.getBuffer("aUV").update()}};mx.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let kE=mx;class vx{constructor(e){this._gpuSpriteHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_gpuSpriteHash")}addRenderable(e,t){const n=this._getGpuSprite(e);e.didViewUpdate&&this._updateBatchableSprite(e,n),this._renderer.renderPipes.batch.addToBatch(n,t)}updateRenderable(e){const t=this._gpuSpriteHash[e.uid];e.didViewUpdate&&this._updateBatchableSprite(e,t),t._batcher.updateElement(t)}validateRenderable(e){const t=e._texture,n=this._getGpuSprite(e);return n.texture._source!==t._source?!n._batcher.checkAndUpdateTexture(n,t):!1}destroyRenderable(e){const t=this._gpuSpriteHash[e.uid];Re.return(t.geometry),Re.return(t),this._gpuSpriteHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}_updateBatchableSprite(e,t){t.geometry.update(e),t.texture=e._texture}_getGpuSprite(e){return this._gpuSpriteHash[e.uid]||this._initGPUSprite(e)}_initGPUSprite(e){const t=Re.get(Rd);return t.geometry=Re.get(kE),t.renderable=e,t.transform=e.groupTransform,t.texture=e._texture,t.roundPixels=this._renderer._roundPixels|e._roundPixels,this._gpuSpriteHash[e.uid]=t,e.on("destroyed",this._destroyRenderableBound),t}destroy(){for(const e in this._gpuSpriteHash)this._gpuSpriteHash[e].geometry.destroy();this._gpuSpriteHash=null,this._renderer=null}}vx.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"nineSliceSprite"};const FE={name:"tiling-bit",vertex:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`
            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;

            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;
        `},fragment:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`

            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);
            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;
            var unclamped = coord;
            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);

            var bias = 0.;

            if(unclamped.x == coord.x && unclamped.y == coord.y)
            {
                bias = -32.;
            } 

            outColor = textureSampleBias(uTexture, uSampler, coord, bias);
        `}},IE={name:"tiling-bit",vertex:{header:`
            uniform mat3 uTextureTransform;
            uniform vec4 uSizeAnchor;
        
        `,main:`
            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;

            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;
        `},fragment:{header:`
            uniform sampler2D uTexture;
            uniform mat3 uMapCoord;
            uniform vec4 uClampFrame;
            uniform vec2 uClampOffset;
        `,main:`

        vec2 coord = vUV + ceil(uClampOffset - vUV);
        coord = (uMapCoord * vec3(coord, 1.0)).xy;
        vec2 unclamped = coord;
        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);
        
        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0
    
        `}};let au,lu;class BE extends sr{constructor(){au??(au=ao({name:"tiling-sprite-shader",bits:[ks,FE,uo]})),lu??(lu=lo({name:"tiling-sprite-shader",bits:[gd,IE,co]}));const e=new _t({uMapCoord:{value:new ae,type:"mat3x3<f32>"},uClampFrame:{value:new Float32Array([0,0,1,1]),type:"vec4<f32>"},uClampOffset:{value:new Float32Array([0,0]),type:"vec2<f32>"},uTextureTransform:{value:new ae,type:"mat3x3<f32>"},uSizeAnchor:{value:new Float32Array([100,100,.5,.5]),type:"vec4<f32>"}});super({glProgram:lu,gpuProgram:au,resources:{localUniforms:new _t({uTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),tilingUniforms:e,uTexture:te.EMPTY.source,uSampler:te.EMPTY.source.style}})}updateUniforms(e,t,n,i,s,o){const a=this.resources.tilingUniforms,l=o.width,u=o.height,c=o.textureMatrix,d=a.uniforms.uTextureTransform;d.set(n.a*l/e,n.b*l/t,n.c*u/e,n.d*u/t,n.tx/e,n.ty/t),d.invert(),a.uniforms.uMapCoord=c.mapCoord,a.uniforms.uClampFrame=c.uClampFrame,a.uniforms.uClampOffset=c.uClampOffset,a.uniforms.uTextureTransform=d,a.uniforms.uSizeAnchor[0]=e,a.uniforms.uSizeAnchor[1]=t,a.uniforms.uSizeAnchor[2]=i,a.uniforms.uSizeAnchor[3]=s,o&&(this.resources.uTexture=o.source,this.resources.uSampler=o.source.style)}}class OE extends pd{constructor(){super({positions:new Float32Array([0,0,1,0,1,1,0,1]),uvs:new Float32Array([0,0,1,0,1,1,0,1]),indices:new Uint32Array([0,1,2,0,2,3])})}}function UE(r,e){const t=r.anchor.x,n=r.anchor.y;e[0]=-t*r.width,e[1]=-n*r.height,e[2]=(1-t)*r.width,e[3]=-n*r.height,e[4]=(1-t)*r.width,e[5]=(1-n)*r.height,e[6]=-t*r.width,e[7]=(1-n)*r.height}function DE(r,e,t,n){let i=0;const s=r.length/e,o=n.a,a=n.b,l=n.c,u=n.d,c=n.tx,d=n.ty;for(t*=e;i<s;){const h=r[t],f=r[t+1];r[t]=o*h+l*f+c,r[t+1]=a*h+u*f+d,t+=e,i++}}function GE(r,e){const t=r.texture,n=t.frame.width,i=t.frame.height;let s=0,o=0;r._applyAnchorToTexture&&(s=r.anchor.x,o=r.anchor.y),e[0]=e[6]=-s,e[2]=e[4]=1-s,e[1]=e[3]=-o,e[5]=e[7]=1-o;const a=ae.shared;a.copyFrom(r._tileTransform.matrix),a.tx/=r.width,a.ty/=r.height,a.invert(),a.scale(r.width/n,r.height/i),DE(e,2,0,a)}const No=new OE;class xx{constructor(e){this._state=vr.default2d,this._tilingSpriteDataHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_tilingSpriteDataHash")}validateRenderable(e){const t=this._getTilingSpriteData(e),n=t.canBatch;this._updateCanBatch(e);const i=t.canBatch;if(i&&i===n){const{batchableMesh:s}=t;if(s&&s.texture._source!==e.texture._source)return!s._batcher.checkAndUpdateTexture(s,e.texture)}return n!==i}addRenderable(e,t){const n=this._renderer.renderPipes.batch;this._updateCanBatch(e);const i=this._getTilingSpriteData(e),{geometry:s,canBatch:o}=i;if(o){i.batchableMesh||(i.batchableMesh=new Rd);const a=i.batchableMesh;e.didViewUpdate&&(this._updateBatchableMesh(e),a.geometry=s,a.renderable=e,a.transform=e.groupTransform,a.texture=e._texture),a.roundPixels=this._renderer._roundPixels|e._roundPixels,n.addToBatch(a,t)}else n.break(t),i.shader||(i.shader=new BE),this.updateRenderable(e),t.add(e)}execute(e){const{shader:t}=this._tilingSpriteDataHash[e.uid];t.groups[0]=this._renderer.globalUniforms.bindGroup;const n=t.resources.localUniforms.uniforms;n.uTransformMatrix=e.groupTransform,n.uRound=this._renderer._roundPixels|e._roundPixels,ho(e.groupColorAlpha,n.uColor,0),this._state.blendMode=Xs(e.groupBlendMode,e.texture._source),this._renderer.encoder.draw({geometry:No,shader:t,state:this._state})}updateRenderable(e){const t=this._getTilingSpriteData(e),{canBatch:n}=t;if(n){const{batchableMesh:i}=t;e.didViewUpdate&&this._updateBatchableMesh(e),i._batcher.updateElement(i)}else if(e.didViewUpdate){const{shader:i}=t;i.updateUniforms(e.width,e.height,e._tileTransform.matrix,e.anchor.x,e.anchor.y,e.texture)}}destroyRenderable(e){const t=this._getTilingSpriteData(e);t.batchableMesh=null,t.shader?.destroy(),this._tilingSpriteDataHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}_getTilingSpriteData(e){return this._tilingSpriteDataHash[e.uid]||this._initTilingSpriteData(e)}_initTilingSpriteData(e){const t=new pd({indices:No.indices,positions:No.positions.slice(),uvs:No.uvs.slice()});return this._tilingSpriteDataHash[e.uid]={canBatch:!0,renderable:e,geometry:t},e.on("destroyed",this._destroyRenderableBound),this._tilingSpriteDataHash[e.uid]}_updateBatchableMesh(e){const t=this._getTilingSpriteData(e),{geometry:n}=t,i=e.texture.source.style;i.addressMode!=="repeat"&&(i.addressMode="repeat",i.update()),GE(e,n.uvs),UE(e,n.positions)}destroy(){for(const e in this._tilingSpriteDataHash)this.destroyRenderable(this._tilingSpriteDataHash[e].renderable);this._tilingSpriteDataHash=null,this._renderer=null}_updateCanBatch(e){const t=this._getTilingSpriteData(e),n=e.texture;let i=!0;return this._renderer.type===Wt.WEBGL&&(i=this._renderer.context.supports.nonPowOf2wrapping),t.canBatch=n.textureMatrix.isSimple&&(i||n.source.isPowerOfTwo),t.canBatch}}xx.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"tilingSprite"};const zE={name:"local-uniform-msdf-bit",vertex:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32,
                uRound:f32,
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `},fragment:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
         `,main:` 
            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));
        `}},LE={name:"local-uniform-msdf-bit",vertex:{header:`
            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix *= uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `},fragment:{header:`
            uniform float uDistance;
         `,main:` 
            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));
        `}},NE={name:"msdf-bit",fragment:{header:`
            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {
                
                // MSDF
                var median = msdfColor.r + msdfColor.g + msdfColor.b -
                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));
            
                // SDF
                median = min(median, msdfColor.a);

                var screenPxDistance = distance * (median - 0.5);
                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);
                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));
                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);
                var coverage: f32 = pow(shapeColor.a * alpha, gamma);

                return coverage;
             
            }
        `}},HE={name:"msdf-bit",fragment:{header:`
            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {
                
                // MSDF
                float median = msdfColor.r + msdfColor.g + msdfColor.b -
                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));
               
                // SDF
                median = min(median, msdfColor.a);
            
                float screenPxDistance = distance * (median - 0.5);
                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);
           
                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));
                float gamma = mix(1.0, 1.0 / 2.2, luma);
                float coverage = pow(shapeColor.a * alpha, gamma);  
              
                return coverage;
            }
        `}};let uu,cu;class VE extends sr{constructor(){const e=new _t({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uDistance:{value:4,type:"f32"},uRound:{value:0,type:"f32"}}),t=ss();uu??(uu=ao({name:"sdf-shader",bits:[Jc,td(t),zE,NE,uo]})),cu??(cu=lo({name:"sdf-shader",bits:[ed,rd(t),LE,HE,co]})),super({glProgram:cu,gpuProgram:uu,resources:{localUniforms:e,batchSamplers:nd(t)}})}}class bx{constructor(e){this._gpuBitmapText={},this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_gpuBitmapText")}validateRenderable(e){const t=this._getGpuBitmapText(e);return e._didTextUpdate&&(e._didTextUpdate=!1,this._updateContext(e,t)),this._renderer.renderPipes.graphics.validateRenderable(t)}addRenderable(e,t){const n=this._getGpuBitmapText(e);gp(e,n),e._didTextUpdate&&(e._didTextUpdate=!1,this._updateContext(e,n)),this._renderer.renderPipes.graphics.addRenderable(n,t),n.context.customShader&&this._updateDistanceField(e)}destroyRenderable(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableByUid(e.uid)}_destroyRenderableByUid(e){const t=this._gpuBitmapText[e].context;t.customShader&&(Re.return(t.customShader),t.customShader=null),Re.return(this._gpuBitmapText[e]),this._gpuBitmapText[e]=null}updateRenderable(e){const t=this._getGpuBitmapText(e);gp(e,t),this._renderer.renderPipes.graphics.updateRenderable(t),t.context.customShader&&this._updateDistanceField(e)}_updateContext(e,t){const{context:n}=t,i=$u.getFont(e.text,e._style);n.clear(),i.distanceField.type!=="none"&&(n.customShader||(n.customShader=Re.get(VE)));const s=Array.from(e.text),o=e._style;let a=i.baseLineOffset;const l=fv(s,o,i,!0);let u=0;const c=o.padding,d=l.scale;let h=l.width,f=l.height+l.offsetY;o._stroke&&(h+=o._stroke.width/d,f+=o._stroke.width/d),n.translate(-e._anchor._x*h-c,-e._anchor._y*f-c).scale(d,d);const p=i.applyFillAsTint?o._fill.color:16777215;for(let m=0;m<l.lines.length;m++){const g=l.lines[m];for(let v=0;v<g.charPositions.length;v++){const x=s[u++],b=i.chars[x];b?.texture&&n.texture(b.texture,p||"black",Math.round(g.charPositions[v]+b.xOffset),Math.round(a+b.yOffset))}a+=i.lineHeight}}_getGpuBitmapText(e){return this._gpuBitmapText[e.uid]||this.initGpuText(e)}initGpuText(e){const t=Re.get(Rr);return this._gpuBitmapText[e.uid]=t,this._updateContext(e,t),e.on("destroyed",this._destroyRenderableBound),this._gpuBitmapText[e.uid]}_updateDistanceField(e){const t=this._getGpuBitmapText(e).context,n=e._style.fontFamily,i=Xe.get(`${n}-bitmap`),{a:s,b:o,c:a,d:l}=e.groupTransform,u=Math.sqrt(s*s+o*o),c=Math.sqrt(a*a+l*l),d=(Math.abs(u)+Math.abs(c))/2,h=i.baseRenderedFontSize/e._style.fontSize,f=d*i.distanceField.range*(1/h);t.customShader.resources.localUniforms.uniforms.uDistance=f}destroy(){for(const e in this._gpuBitmapText)this._destroyRenderableByUid(e);this._gpuBitmapText=null,this._renderer=null}}bx.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"bitmapText"};function gp(r,e){e.groupTransform=r.groupTransform,e.groupColorAlpha=r.groupColorAlpha,e.groupColor=r.groupColor,e.groupBlendMode=r.groupBlendMode,e.globalDisplayStatus=r.globalDisplayStatus,e.groupTransform=r.groupTransform,e.localDisplayStatus=r.localDisplayStatus,e.groupAlpha=r.groupAlpha,e._roundPixels=r._roundPixels}class _x{constructor(e){this._gpuText=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e,this._renderer.runners.resolutionChange.add(this),this._renderer.renderableGC.addManagedHash(this,"_gpuText")}resolutionChange(){for(const e in this._gpuText){const t=this._gpuText[e];if(!t)continue;const n=t.batchableSprite.renderable;n._autoResolution&&(n._resolution=this._renderer.resolution,n.onViewUpdate())}}validateRenderable(e){const t=this._getGpuText(e),n=e._getKey();return t.textureNeedsUploading?(t.textureNeedsUploading=!1,!0):t.currentKey!==n}addRenderable(e,t){const i=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),this._renderer.renderPipes.batch.addToBatch(i,t)}updateRenderable(e){const n=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),n._batcher.updateElement(n)}destroyRenderable(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableById(e.uid)}_destroyRenderableById(e){const t=this._gpuText[e];this._renderer.htmlText.decreaseReferenceCount(t.currentKey),Re.return(t.batchableSprite),this._gpuText[e]=null}_updateText(e){const t=e._getKey(),n=this._getGpuText(e),i=n.batchableSprite;n.currentKey!==t&&this._updateGpuText(e).catch(o=>{console.error(o)}),e._didTextUpdate=!1;const s=e._style.padding;Pa(i.bounds,e._anchor,i.texture,s)}async _updateGpuText(e){e._didTextUpdate=!1;const t=this._getGpuText(e);if(t.generatingTexture)return;const n=e._getKey();this._renderer.htmlText.decreaseReferenceCount(t.currentKey),t.generatingTexture=!0,t.currentKey=n;const i=e.resolution??this._renderer.resolution,s=await this._renderer.htmlText.getManagedTexture(e.text,i,e._style,e._getKey()),o=t.batchableSprite;o.texture=t.texture=s,t.generatingTexture=!1,t.textureNeedsUploading=!0,e.onViewUpdate();const a=e._style.padding;Pa(o.bounds,e._anchor,o.texture,a)}_getGpuText(e){return this._gpuText[e.uid]||this.initGpuText(e)}initGpuText(e){const t={texture:te.EMPTY,currentKey:"--",batchableSprite:Re.get(yd),textureNeedsUploading:!1,generatingTexture:!1},n=t.batchableSprite;return n.renderable=e,n.transform=e.groupTransform,n.texture=te.EMPTY,n.bounds={minX:0,maxX:1,minY:0,maxY:0},n.roundPixels=this._renderer._roundPixels|e._roundPixels,e._resolution=e._autoResolution?this._renderer.resolution:e.resolution,this._gpuText[e.uid]=t,e.on("destroyed",this._destroyRenderableBound),t}destroy(){for(const e in this._gpuText)this._destroyRenderableById(e);this._gpuText=null,this._renderer=null}}_x.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"htmlText"};function WE(){const{userAgent:r}=Ee.get().getNavigator();return/^((?!chrome|android).)*safari/i.test(r)}const jE=new Mt;function yx(r,e,t,n){const i=jE;i.minX=0,i.minY=0,i.maxX=r.width/n|0,i.maxY=r.height/n|0;const s=Ge.getOptimalTexture(i.width,i.height,n,!1);return s.source.uploadMethodId="image",s.source.resource=r,s.source.alphaMode="premultiply-alpha-on-upload",s.frame.width=e/n,s.frame.height=t/n,s.source.emit("update",s.source),s.updateUvs(),s}function XE(r,e){const t=e.fontFamily,n=[],i={},s=/font-family:([^;"\s]+)/g,o=r.match(s);function a(l){i[l]||(n.push(l),i[l]=!0)}if(Array.isArray(t))for(let l=0;l<t.length;l++)a(t[l]);else a(t);o&&o.forEach(l=>{const u=l.split(":")[1].trim();a(u)});for(const l in e.tagStyles){const u=e.tagStyles[l].fontFamily;a(u)}return n}async function qE(r){const t=await(await Ee.get().fetch(r)).blob(),n=new FileReader;return await new Promise((s,o)=>{n.onloadend=()=>s(n.result),n.onerror=o,n.readAsDataURL(t)})}async function vp(r,e){const t=await qE(e);return`@font-face {
        font-family: "${r.fontFamily}";
        src: url('${t}');
        font-weight: ${r.fontWeight};
        font-style: ${r.fontStyle};
    }`}const Ho=new Map;async function YE(r,e,t){const n=r.filter(i=>Xe.has(`${i}-and-url`)).map((i,s)=>{if(!Ho.has(i)){const{url:o}=Xe.get(`${i}-and-url`);s===0?Ho.set(i,vp({fontWeight:e.fontWeight,fontStyle:e.fontStyle,fontFamily:i},o)):Ho.set(i,vp({fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontFamily:i},o))}return Ho.get(i)});return(await Promise.all(n)).join(`
`)}function KE(r,e,t,n,i){const{domElement:s,styleElement:o,svgRoot:a}=i;s.innerHTML=`<style>${e.cssStyle}</style><div style='padding:0;'>${r}</div>`,s.setAttribute("style",`transform: scale(${t});transform-origin: top left; display: inline-block`),o.textContent=n;const{width:l,height:u}=i.image;return a.setAttribute("width",l.toString()),a.setAttribute("height",u.toString()),new XMLSerializer().serializeToString(a)}function $E(r,e){const t=Wr.getOptimalCanvasAndContext(r.width,r.height,e),{context:n}=t;return n.clearRect(0,0,r.width,r.height),n.drawImage(r,0,0),t}function ZE(r,e,t){return new Promise(async n=>{t&&await new Promise(i=>setTimeout(i,100)),r.onload=()=>{n()},r.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(e)}`,r.crossOrigin="anonymous"})}class kd{constructor(e){this._activeTextures={},this._renderer=e,this._createCanvas=e.type===Wt.WEBGPU}getTexture(e){return this._buildTexturePromise(e.text,e.resolution,e.style)}getManagedTexture(e,t,n,i){if(this._activeTextures[i])return this._increaseReferenceCount(i),this._activeTextures[i].promise;const s=this._buildTexturePromise(e,t,n).then(o=>(this._activeTextures[i].texture=o,o));return this._activeTextures[i]={texture:null,promise:s,usageCount:1},s}async _buildTexturePromise(e,t,n){const i=Re.get(Ov),s=XE(e,n),o=await YE(s,n,ll.defaultTextStyle),a=Uv(e,n,o,i),l=Math.ceil(Math.ceil(Math.max(1,a.width)+n.padding*2)*t),u=Math.ceil(Math.ceil(Math.max(1,a.height)+n.padding*2)*t),c=i.image,d=2;c.width=(l|0)+d,c.height=(u|0)+d;const h=KE(e,n,t,o,i);await ZE(c,h,WE()&&s.length>0);const f=c;let p;this._createCanvas&&(p=$E(c,t));const m=yx(p?p.canvas:f,c.width-d,c.height-d,t);return this._createCanvas&&(this._renderer.texture.initSource(m.source),Wr.returnCanvasAndContext(p)),Re.return(i),m}_increaseReferenceCount(e){this._activeTextures[e].usageCount++}decreaseReferenceCount(e){const t=this._activeTextures[e];t&&(t.usageCount--,t.usageCount===0&&(t.texture?this._cleanUp(t):t.promise.then(n=>{t.texture=n,this._cleanUp(t)}).catch(()=>{de("HTMLTextSystem: Failed to clean texture")}),this._activeTextures[e]=null))}_cleanUp(e){Ge.returnTexture(e.texture),e.texture.source.resource=null,e.texture.source.uploadMethodId="unknown"}getReferenceCount(e){return this._activeTextures[e].usageCount}destroy(){this._activeTextures=null}}kd.extension={type:[F.WebGLSystem,F.WebGPUSystem,F.CanvasSystem],name:"htmlText"};kd.defaultFontOptions={fontFamily:"Arial",fontStyle:"normal",fontWeight:"normal"};class Sx{constructor(e){this._gpuText=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e,this._renderer.runners.resolutionChange.add(this),this._renderer.renderableGC.addManagedHash(this,"_gpuText")}resolutionChange(){for(const e in this._gpuText){const t=this._gpuText[e];if(!t)continue;const n=t.batchableSprite.renderable;n._autoResolution&&(n._resolution=this._renderer.resolution,n.onViewUpdate())}}validateRenderable(e){const t=this._getGpuText(e),n=e._getKey();return t.currentKey!==n}addRenderable(e,t){const i=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),this._renderer.renderPipes.batch.addToBatch(i,t)}updateRenderable(e){const n=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),n._batcher.updateElement(n)}destroyRenderable(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableById(e.uid)}_destroyRenderableById(e){const t=this._gpuText[e];this._renderer.canvasText.decreaseReferenceCount(t.currentKey),Re.return(t.batchableSprite),this._gpuText[e]=null}_updateText(e){const t=e._getKey(),n=this._getGpuText(e),i=n.batchableSprite;n.currentKey!==t&&this._updateGpuText(e),e._didTextUpdate=!1;const s=e._style.padding;Pa(i.bounds,e._anchor,i.texture,s)}_updateGpuText(e){const t=this._getGpuText(e),n=t.batchableSprite;t.texture&&this._renderer.canvasText.decreaseReferenceCount(t.currentKey),t.texture=n.texture=this._renderer.canvasText.getManagedTexture(e),t.currentKey=e._getKey(),n.texture=t.texture}_getGpuText(e){return this._gpuText[e.uid]||this.initGpuText(e)}initGpuText(e){const t={texture:null,currentKey:"--",batchableSprite:Re.get(yd)};return t.batchableSprite.renderable=e,t.batchableSprite.transform=e.groupTransform,t.batchableSprite.bounds={minX:0,maxX:1,minY:0,maxY:0},t.batchableSprite.roundPixels=this._renderer._roundPixels|e._roundPixels,this._gpuText[e.uid]=t,e._resolution=e._autoResolution?this._renderer.resolution:e.resolution,this._updateText(e),e.on("destroyed",this._destroyRenderableBound),t}destroy(){for(const e in this._gpuText)this._destroyRenderableById(e);this._gpuText=null,this._renderer=null}}Sx.extension={type:[F.WebGLPipes,F.WebGPUPipes,F.CanvasPipes],name:"text"};function xp(r,e,t){for(let n=0,i=4*t*e;n<e;++n,i+=4)if(r[i+3]!==0)return!1;return!0}function bp(r,e,t,n,i){const s=4*e;for(let o=n,a=n*s+4*t;o<=i;++o,a+=s)if(r[a+3]!==0)return!1;return!0}function QE(r,e=1){const{width:t,height:n}=r,i=r.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const o=i.getImageData(0,0,t,n).data;let a=0,l=0,u=t-1,c=n-1;for(;l<n&&xp(o,t,l);)++l;if(l===n)return Le.EMPTY;for(;xp(o,t,c);)--c;for(;bp(o,t,a,l,c);)++a;for(;bp(o,t,u,l,c);)--u;return++u,++c,new Le(a/e,l/e,(u-a)/e,(c-l)/e)}class wx{constructor(e){this._activeTextures={},this._renderer=e}getTextureSize(e,t,n){const i=St.measureText(e||" ",n);let s=Math.ceil(Math.ceil(Math.max(1,i.width)+n.padding*2)*t),o=Math.ceil(Math.ceil(Math.max(1,i.height)+n.padding*2)*t);return s=Math.ceil(s-1e-6),o=Math.ceil(o-1e-6),s=Hi(s),o=Hi(o),{width:s,height:o}}getTexture(e,t,n,i){typeof e=="string"&&(J("8.0.0","CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments"),e={text:e,style:n,resolution:t}),e.style instanceof Yr||(e.style=new Yr(e.style));const{texture:s,canvasAndContext:o}=this.createTextureAndCanvas(e);return this._renderer.texture.initSource(s._source),Wr.returnCanvasAndContext(o),s}createTextureAndCanvas(e){const{text:t,style:n}=e,i=e.resolution??this._renderer.resolution,s=St.measureText(t||" ",n),o=Math.ceil(Math.ceil(Math.max(1,s.width)+n.padding*2)*i),a=Math.ceil(Math.ceil(Math.max(1,s.height)+n.padding*2)*i),l=Wr.getOptimalCanvasAndContext(o,a),{canvas:u}=l;this.renderTextToCanvas(t,n,i,l);const c=yx(u,o,a,i);if(n.trim){const d=QE(u,i);c.frame.copyFrom(d),c.updateUvs()}return{texture:c,canvasAndContext:l}}getManagedTexture(e){e._resolution=e._autoResolution?this._renderer.resolution:e.resolution;const t=e._getKey();if(this._activeTextures[t])return this._increaseReferenceCount(t),this._activeTextures[t].texture;const{texture:n,canvasAndContext:i}=this.createTextureAndCanvas(e);return this._activeTextures[t]={canvasAndContext:i,texture:n,usageCount:1},n}_increaseReferenceCount(e){this._activeTextures[e].usageCount++}decreaseReferenceCount(e){const t=this._activeTextures[e];if(t.usageCount--,t.usageCount===0){Wr.returnCanvasAndContext(t.canvasAndContext),Ge.returnTexture(t.texture);const n=t.texture.source;n.resource=null,n.uploadMethodId="unknown",n.alphaMode="no-premultiply-alpha",this._activeTextures[e]=null}}getReferenceCount(e){return this._activeTextures[e].usageCount}renderTextToCanvas(e,t,n,i){const{canvas:s,context:o}=i,a=Ia(t),l=St.measureText(e||" ",t),u=l.lines,c=l.lineHeight,d=l.lineWidths,h=l.maxLineWidth,f=l.fontProperties,p=s.height;if(o.resetTransform(),o.scale(n,n),o.textBaseline=t.textBaseline,t._stroke?.width){const x=t._stroke;o.lineWidth=x.width,o.miterLimit=x.miterLimit,o.lineJoin=x.join,o.lineCap=x.cap}o.font=a;let m,g;const v=t.dropShadow?2:1;for(let x=0;x<v;++x){const b=t.dropShadow&&x===0,_=b?Math.ceil(Math.max(1,p)+t.padding*2):0,w=_*n;if(b){o.fillStyle="black",o.strokeStyle="black";const S=t.dropShadow,A=S.color,E=S.alpha;o.shadowColor=pe.shared.setValue(A).setAlpha(E).toRgbaString();const U=S.blur*n,L=S.distance*n;o.shadowBlur=U,o.shadowOffsetX=Math.cos(S.angle)*L,o.shadowOffsetY=Math.sin(S.angle)*L+w}else o.fillStyle=t._fill?Ba(t._fill,o):null,t._stroke?.width&&(o.strokeStyle=Ba(t._stroke,o)),o.shadowColor="black";let C=(c-f.fontSize)/2;c-f.fontSize<0&&(C=0);const P=t._stroke?.width??0;for(let S=0;S<u.length;S++)m=P/2,g=P/2+S*c+f.ascent+C,t.align==="right"?m+=h-d[S]:t.align==="center"&&(m+=(h-d[S])/2),t._stroke?.width&&this._drawLetterSpacing(u[S],t,i,m+t.padding,g+t.padding-_,!0),t._fill!==void 0&&this._drawLetterSpacing(u[S],t,i,m+t.padding,g+t.padding-_)}}_drawLetterSpacing(e,t,n,i,s,o=!1){const{context:a}=n,l=t.letterSpacing;let u=!1;if(St.experimentalLetterSpacingSupported&&(St.experimentalLetterSpacing?(a.letterSpacing=`${l}px`,a.textLetterSpacing=`${l}px`,u=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px")),l===0||u){o?a.strokeText(e,i,s):a.fillText(e,i,s);return}let c=i;const d=St.graphemeSegmenter(e);let h=a.measureText(e).width,f=0;for(let p=0;p<d.length;++p){const m=d[p];o?a.strokeText(m,c,s):a.fillText(m,c,s);let g="";for(let v=p+1;v<d.length;++v)g+=d[v];f=a.measureText(g).width,c+=h-f+l,h=f}}destroy(){this._activeTextures=null}}wx.extension={type:[F.WebGLSystem,F.WebGPUSystem,F.CanvasSystem],name:"canvasText"};he.add(KS,$S);var Be=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Oe=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}`,JE=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uGamma;
uniform float uContrast;
uniform float uSaturation;
uniform float uBrightness;
uniform vec4 uColor;

void main()
{
    vec4 c = texture(uTexture, vTextureCoord);

    if (c.a > 0.0) {
        c.rgb /= c.a;

        vec3 rgb = pow(c.rgb, vec3(1. / uGamma));
        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, uSaturation), uContrast);
        rgb.r *= uColor.r;
        rgb.g *= uColor.g;
        rgb.b *= uColor.b;
        c.rgb = rgb * uBrightness;

        c.rgb *= c.a;
    }

    finalColor = c * uColor.a;
}
`,e5=`struct AdjustmentUniforms {
  uGamma: f32,
  uContrast: f32,
  uSaturation: f32,
  uBrightness: f32,
  uColor: vec4<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> adjustmentUniforms : AdjustmentUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
  var sample = textureSample(uTexture, uSampler, uv);
  let color = adjustmentUniforms.uColor;

  if (sample.a > 0.0) 
  {
    sample = vec4<f32>(sample.rgb / sample.a, sample.a);
    var rgb: vec3<f32> = pow(sample.rgb, vec3<f32>(1. / adjustmentUniforms.uGamma));
    rgb = mix(vec3<f32>(.5), mix(vec3<f32>(dot(vec3<f32>(.2125, .7154, .0721), rgb)), rgb, adjustmentUniforms.uSaturation), adjustmentUniforms.uContrast);
    rgb.r *= color.r;
    rgb.g *= color.g;
    rgb.b *= color.b;
    sample = vec4<f32>(rgb.rgb * adjustmentUniforms.uBrightness, sample.a);
    sample = vec4<f32>(sample.rgb * sample.a, sample.a);
  }

  return sample * color.a;
}`,t5=Object.defineProperty,r5=(r,e,t)=>e in r?t5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Tx=(r,e,t)=>(r5(r,typeof e!="symbol"?e+"":e,t),t);const Cx=class Px extends _e{constructor(e){e={...Px.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:e5,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:JE,name:"adjustment-filter"});super({gpuProgram:t,glProgram:n,resources:{adjustmentUniforms:{uGamma:{value:e.gamma,type:"f32"},uContrast:{value:e.contrast,type:"f32"},uSaturation:{value:e.saturation,type:"f32"},uBrightness:{value:e.brightness,type:"f32"},uColor:{value:[e.red,e.green,e.blue,e.alpha],type:"vec4<f32>"}}}}),Tx(this,"uniforms"),this.uniforms=this.resources.adjustmentUniforms.uniforms}get gamma(){return this.uniforms.uGamma}set gamma(e){this.uniforms.uGamma=e}get contrast(){return this.uniforms.uContrast}set contrast(e){this.uniforms.uContrast=e}get saturation(){return this.uniforms.uSaturation}set saturation(e){this.uniforms.uSaturation=e}get brightness(){return this.uniforms.uBrightness}set brightness(e){this.uniforms.uBrightness=e}get red(){return this.uniforms.uColor[0]}set red(e){this.uniforms.uColor[0]=e}get green(){return this.uniforms.uColor[1]}set green(e){this.uniforms.uColor[1]=e}get blue(){return this.uniforms.uColor[2]}set blue(e){this.uniforms.uColor[2]=e}get alpha(){return this.uniforms.uColor[3]}set alpha(e){this.uniforms.uColor[3]=e}};Tx(Cx,"DEFAULT_OPTIONS",{gamma:1,contrast:1,saturation:1,brightness:1,red:1,green:1,blue:1,alpha:1});let n5=Cx;var i5=`
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture(uTexture, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture(uTexture, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture(uTexture, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture(uTexture, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    finalColor = color;
}`,s5=`struct KawaseBlurUniforms {
  uOffset:vec2<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> kawaseBlurUniforms : KawaseBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uOffset = kawaseBlurUniforms.uOffset;
  var color: vec4<f32> = vec4<f32>(0.0);

  // Sample top left pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x - uOffset.x, uv.y + uOffset.y));
  // Sample top right pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x + uOffset.x, uv.y + uOffset.y));
  // Sample bottom right pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x + uOffset.x, uv.y - uOffset.y));
  // Sample bottom left pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x - uOffset.x, uv.y - uOffset.y));
  // Average
  color *= 0.25;

  return color;
}`,o5=`
precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uOffset;

uniform vec4 uInputClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Sample top right pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Sample bottom right pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Sample bottom left pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Average
    color *= 0.25;

    finalColor = color;
}
`,a5=`struct KawaseBlurUniforms {
  uOffset:vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> kawaseBlurUniforms : KawaseBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uOffset = kawaseBlurUniforms.uOffset;
  var color: vec4<f32> = vec4(0.0);

  // Sample top left pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x - uOffset.x, uv.y + uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Sample top right pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x + uOffset.x, uv.y + uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Sample bottom right pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x + uOffset.x, uv.y - uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Sample bottom left pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x - uOffset.x, uv.y - uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Average
  color *= 0.25;
    
  return color;
}`,l5=Object.defineProperty,u5=(r,e,t)=>e in r?l5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Rn=(r,e,t)=>(u5(r,typeof e!="symbol"?e+"":e,t),t);const Ax=class Ex extends _e{constructor(...e){let t=e[0]??{};(typeof t=="number"||Array.isArray(t))&&(J("6.0.0","KawaseBlurFilter constructor params are now options object. See params: { strength, quality, clamp, pixelSize }"),t={strength:t},e[1]!==void 0&&(t.quality=e[1]),e[2]!==void 0&&(t.clamp=e[2])),t={...Ex.DEFAULT_OPTIONS,...t};const n=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:t?.clamp?a5:s5,entryPoint:"mainFragment"}}),i=be.from({vertex:Be,fragment:t?.clamp?o5:i5,name:"kawase-blur-filter"});super({gpuProgram:n,glProgram:i,resources:{kawaseBlurUniforms:{uOffset:{value:new Float32Array(2),type:"vec2<f32>"}}}}),Rn(this,"uniforms"),Rn(this,"_pixelSize",{x:0,y:0}),Rn(this,"_clamp"),Rn(this,"_kernels",[]),Rn(this,"_blur"),Rn(this,"_quality"),this.uniforms=this.resources.kawaseBlurUniforms.uniforms,this.pixelSize=t.pixelSize??{x:1,y:1},Array.isArray(t.strength)?this.kernels=t.strength:typeof t.strength=="number"&&(this._blur=t.strength,this.quality=t.quality??3),this._clamp=!!t.clamp}apply(e,t,n,i){const s=this.pixelSizeX/t.source.width,o=this.pixelSizeY/t.source.height;let a;if(this._quality===1||this._blur===0)a=this._kernels[0]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,t,n,i);else{const l=Ge.getSameSizeTexture(t);let u=t,c=l,d;const h=this._quality-1;for(let f=0;f<h;f++)a=this._kernels[f]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,u,c,!0),d=u,u=c,c=d;a=this._kernels[h]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,u,n,i),Ge.returnTexture(l)}}get strength(){return this._blur}set strength(e){this._blur=e,this._generateKernels()}get quality(){return this._quality}set quality(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}get kernels(){return this._kernels}set kernels(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max(...e)):(this._kernels=[0],this._quality=1)}get pixelSize(){return this._pixelSize}set pixelSize(e){if(typeof e=="number"){this.pixelSizeX=this.pixelSizeY=e;return}if(Array.isArray(e)){this.pixelSizeX=e[0],this.pixelSizeY=e[1];return}this._pixelSize=e}get pixelSizeX(){return this.pixelSize.x}set pixelSizeX(e){this.pixelSize.x=e}get pixelSizeY(){return this.pixelSize.y}set pixelSizeY(e){this.pixelSize.y=e}get clamp(){return this._clamp}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((e,t)=>e+t+.5,0))}_generateKernels(){const e=this._blur,t=this._quality,n=[e];if(e>0){let i=e;const s=e/t;for(let o=1;o<t;o++)i-=s,n.push(i)}this._kernels=n,this._updatePadding()}};Rn(Ax,"DEFAULT_OPTIONS",{strength:4,quality:3,clamp:!1,pixelSize:{x:1,y:1}});let Mx=Ax;var c5=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uMapTexture;
uniform float uBloomScale;
uniform float uBrightness;

void main() {
    vec4 color = texture(uTexture, vTextureCoord);
    color.rgb *= uBrightness;
    vec4 bloomColor = vec4(texture(uMapTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= uBloomScale;
    finalColor = color + bloomColor;
}
`,d5=`struct AdvancedBloomUniforms {
  uBloomScale: f32,
  uBrightness: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> advancedBloomUniforms : AdvancedBloomUniforms;
@group(1) @binding(1) var uMapTexture: texture_2d<f32>;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color = textureSample(uTexture, uSampler, uv);
  color = vec4<f32>(color.rgb * advancedBloomUniforms.uBrightness, color.a);

  var bloomColor = vec4<f32>(textureSample(uMapTexture, uSampler, uv).rgb, 0.0);
  bloomColor = vec4<f32>(bloomColor.rgb * advancedBloomUniforms.uBloomScale, bloomColor.a);
  
  return color + bloomColor;
}
`,h5=`
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uThreshold;

void main() {
    vec4 color = texture(uTexture, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > uThreshold) {
        finalColor = color;
    } else {
        finalColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`,f5=`struct ExtractBrightnessUniforms {
  uThreshold: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> extractBrightnessUniforms : ExtractBrightnessUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  // A simple & fast algorithm for getting brightness.
  // It's inaccurate, but good enough for this feature.
  let max: f32 = max(max(color.r, color.g), color.b);
  let min: f32 = min(min(color.r, color.g), color.b);
  let brightness: f32 = (max + min) * 0.5;

  return select(vec4<f32>(0.), color, brightness > extractBrightnessUniforms.uThreshold);
}
`,p5=Object.defineProperty,m5=(r,e,t)=>e in r?p5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Rx=(r,e,t)=>(m5(r,typeof e!="symbol"?e+"":e,t),t);const kx=class Fx extends _e{constructor(e){e={...Fx.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:f5,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:h5,name:"extract-brightness-filter"});super({gpuProgram:t,glProgram:n,resources:{extractBrightnessUniforms:{uThreshold:{value:e.threshold,type:"f32"}}}}),Rx(this,"uniforms"),this.uniforms=this.resources.extractBrightnessUniforms.uniforms}get threshold(){return this.uniforms.uThreshold}set threshold(e){this.uniforms.uThreshold=e}};Rx(kx,"DEFAULT_OPTIONS",{threshold:.5});let g5=kx;var v5=Object.defineProperty,x5=(r,e,t)=>e in r?v5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,pi=(r,e,t)=>(x5(r,typeof e!="symbol"?e+"":e,t),t);const b5=class Ix extends _e{constructor(e){e={...Ix.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:d5,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:c5,name:"advanced-bloom-filter"});super({gpuProgram:t,glProgram:n,resources:{advancedBloomUniforms:{uBloomScale:{value:e.bloomScale,type:"f32"},uBrightness:{value:e.brightness,type:"f32"}},uMapTexture:te.WHITE}}),pi(this,"uniforms"),pi(this,"bloomScale",1),pi(this,"brightness",1),pi(this,"_extractFilter"),pi(this,"_blurFilter"),this.uniforms=this.resources.advancedBloomUniforms.uniforms,this._extractFilter=new g5({threshold:e.threshold}),this._blurFilter=new Mx({strength:e.kernels??e.blur,quality:e.kernels?void 0:e.quality}),Object.assign(this,e)}apply(e,t,n,i){const s=Ge.getSameSizeTexture(t);this._extractFilter.apply(e,t,s,!0);const o=Ge.getSameSizeTexture(t);this._blurFilter.apply(e,s,o,!0),this.uniforms.uBloomScale=this.bloomScale,this.uniforms.uBrightness=this.brightness,this.resources.uMapTexture=o.source,e.applyFilter(this,t,n,i),Ge.returnTexture(o),Ge.returnTexture(s)}get threshold(){return this._extractFilter.threshold}set threshold(e){this._extractFilter.threshold=e}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get blur(){return this._blurFilter.strength}set blur(e){this._blurFilter.strength=e}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){typeof e=="number"&&(e={x:e,y:e}),Array.isArray(e)&&(e={x:e[0],y:e[1]}),this._blurFilter.pixelSize=e}get pixelSizeX(){return this._blurFilter.pixelSizeX}set pixelSizeX(e){this._blurFilter.pixelSizeX=e}get pixelSizeY(){return this._blurFilter.pixelSizeY}set pixelSizeY(e){this._blurFilter.pixelSizeY=e}};pi(b5,"DEFAULT_OPTIONS",{threshold:.5,bloomScale:1,brightness:1,blur:8,quality:4,pixelSize:{x:1,y:1}});var _5=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uSize;
uniform vec3 uColor;
uniform float uReplaceColor;

uniform vec4 uInputSize;

vec2 mapCoord( vec2 coord )
{
    coord *= uInputSize.xy;
    coord += uInputSize.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= uInputSize.zw;
    coord /= uInputSize.xy;

    return coord;
}

vec2 pixelate(vec2 coord, vec2 size)
{
    return floor(coord / size) * size;
}

vec2 getMod(vec2 coord, vec2 size)
{
    return mod(coord, size) / size;
}

float character(float n, vec2 p)
{
    p = floor(p*vec2(4.0, 4.0) + 2.5);

    if (clamp(p.x, 0.0, 4.0) == p.x)
    {
        if (clamp(p.y, 0.0, 4.0) == p.y)
        {
            if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;
        }
    }
    return 0.0;
}

void main()
{
    vec2 coord = mapCoord(vTextureCoord);

    // get the grid position
    vec2 pixCoord = pixelate(coord, vec2(uSize));
    pixCoord = unmapCoord(pixCoord);

    // sample the color at grid position
    vec4 color = texture(uTexture, pixCoord);

    // brightness of the color as it's perceived by the human eye
    float gray = 0.3 * color.r + 0.59 * color.g + 0.11 * color.b;

    // determine the character to use
    float n =  65536.0;             // .
    if (gray > 0.2) n = 65600.0;    // :
    if (gray > 0.3) n = 332772.0;   // *
    if (gray > 0.4) n = 15255086.0; // o
    if (gray > 0.5) n = 23385164.0; // &
    if (gray > 0.6) n = 15252014.0; // 8
    if (gray > 0.7) n = 13199452.0; // @
    if (gray > 0.8) n = 11512810.0; // #

    // get the mod..
    vec2 modd = getMod(coord, vec2(uSize));

    finalColor = (uReplaceColor > 0.5 ? vec4(uColor, 1.) : color) * character( n, vec2(-1.0) + modd * 2.0);
}
`,y5=`struct AsciiUniforms {
    uSize: f32,
    uColor: vec3<f32>,
    uReplaceColor: f32,
};

struct GlobalFilterUniforms {
    uInputSize:vec4<f32>,
    uInputPixel:vec4<f32>,
    uInputClamp:vec4<f32>,
    uOutputFrame:vec4<f32>,
    uGlobalFrame:vec4<f32>,
    uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> asciiUniforms : AsciiUniforms;

@fragment
fn mainFragment(
    @location(0) uv: vec2<f32>,
    @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
    let pixelSize: f32 = asciiUniforms.uSize;
    let coord: vec2<f32> = mapCoord(uv);

    // get the rounded color..
    var pixCoord: vec2<f32> = pixelate(coord, vec2<f32>(pixelSize));
    pixCoord = unmapCoord(pixCoord);

    var color = textureSample(uTexture, uSampler, pixCoord);

    // determine the character to use
    let gray: f32 = 0.3 * color.r + 0.59 * color.g + 0.11 * color.b;
    
    var n: f32 = 65536.0; // .
    if (gray > 0.2) {
        n = 65600.0;    // :
    }
    if (gray > 0.3) {
        n = 332772.0;   // *
    }
    if (gray > 0.4) {
        n = 15255086.0; // o
    }
    if (gray > 0.5) {
        n = 23385164.0; // &
    }
    if (gray > 0.6) {
        n = 15252014.0; // 8
    }
    if (gray > 0.7) {
        n = 13199452.0; // @
    }
    if (gray > 0.8) {
        n = 11512810.0; // #
    }

    // get the mod..
    let modd: vec2<f32> = getMod(coord, vec2<f32>(pixelSize));
    return select(color, vec4<f32>(asciiUniforms.uColor, 1.), asciiUniforms.uReplaceColor > 0.5) * character(n, vec2<f32>(-1.0) + modd * 2.0);
}

fn pixelate(coord: vec2<f32>, size: vec2<f32>) -> vec2<f32>
{
    return floor( coord / size ) * size;
}

fn getMod(coord: vec2<f32>, size: vec2<f32>) -> vec2<f32>
{
    return moduloVec2( coord , size) / size;
}

fn character(n: f32, p: vec2<f32>) -> f32
{
    var q: vec2<f32> = floor(p*vec2<f32>(4.0, 4.0) + 2.5);

    if (clamp(q.x, 0.0, 4.0) == q.x)
    {
        if (clamp(q.y, 0.0, 4.0) == q.y)
        {
        if (i32(modulo(n/exp2(q.x + 5.0*q.y), 2.0)) == 1)
        {
            return 1.0;
        }
        }
    }

    return 0.0;
}

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

fn moduloVec2(x: vec2<f32>, y: vec2<f32>) -> vec2<f32>
{
  return x - y * floor(x/y);
}

fn mapCoord(coord: vec2<f32> ) -> vec2<f32>
{
    var mappedCoord: vec2<f32> = coord;
    mappedCoord *= gfu.uInputSize.xy;
    mappedCoord += gfu.uOutputFrame.xy;
    return mappedCoord;
}

fn unmapCoord(coord: vec2<f32> ) -> vec2<f32>
{
    var mappedCoord: vec2<f32> = coord;
    mappedCoord -= gfu.uOutputFrame.xy;
    mappedCoord /= gfu.uInputSize.xy;
    return mappedCoord;
}`,S5=Object.defineProperty,w5=(r,e,t)=>e in r?S5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,rc=(r,e,t)=>(w5(r,typeof e!="symbol"?e+"":e,t),t);const T5=class Bx extends _e{constructor(...e){let t=e[0]??{};typeof t=="number"&&(J("6.0.0","AsciiFilter constructor params are now options object. See params: { size, color, replaceColor }"),t={size:t});const n=t?.color&&t.replaceColor!==!1;t={...Bx.DEFAULT_OPTIONS,...t};const i=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:y5,entryPoint:"mainFragment"}}),s=be.from({vertex:Be,fragment:_5,name:"ascii-filter"});super({gpuProgram:i,glProgram:s,resources:{asciiUniforms:{uSize:{value:t.size,type:"f32"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uReplaceColor:{value:Number(n),type:"f32"}}}}),rc(this,"uniforms"),rc(this,"_color"),this.uniforms=this.resources.asciiUniforms.uniforms,this._color=new pe,this.color=t.color??16777215}get size(){return this.uniforms.uSize}set size(e){this.uniforms.uSize=e}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,n,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=n,this.uniforms.uColor[2]=i}get replaceColor(){return this.uniforms.uReplaceColor>.5}set replaceColor(e){this.uniforms.uReplaceColor=e?1:0}};rc(T5,"DEFAULT_OPTIONS",{size:8,color:16777215,replaceColor:!1});var C5=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uBackground;

void main(void){
    vec4 front = texture(uTexture, vTextureCoord);
    vec4 back = texture(uBackground, vTextureCoord);

    if (front.a == 0.0) {
        discard;
    }
    
    vec3 color = mix(back.rgb, front.rgb / front.a, front.a);

    finalColor = vec4(color, 1.0);
}`,P5=`@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var uBackground: texture_2d<f32>; 

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    var front: vec4<f32> = textureSample(uTexture, uSampler, uv);
    var back: vec4<f32> = textureSample(uBackground, uSampler, uv);
    
    if (front.a == 0.0) {
        discard;
    }

    var color: vec3<f32> = mix(back.rgb, front.rgb / front.a, front.a);

    return vec4<f32>(color, 1.0);
}`,A5=Object.defineProperty,E5=(r,e,t)=>e in r?A5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,M5=(r,e,t)=>(E5(r,e+"",t),t);class R5 extends er{constructor(e){super(e),M5(this,"_blendPass"),this.blendRequired=!0,this.padding=0,this._blendPass=new _e({gpuProgram:me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:P5,entryPoint:"mainFragment"}}),glProgram:be.from({vertex:Be,fragment:C5,name:"drop-shadow-filter"}),resources:{uBackground:te.EMPTY}})}apply(e,t,n,i){const s=e._activeFilterData.backTexture,o=Ge.getSameSizeTexture(t);super.apply(e,s,o,!0),this._blendPass.resources.uBackground=o.source,this._blendPass.apply(e,t,n,i),Ge.returnTexture(o)}updatePadding(){this.padding=0}}var k5=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uTransform;
uniform vec3 uLightColor;
uniform float uLightAlpha;
uniform vec3 uShadowColor;
uniform float uShadowAlpha;

uniform vec4 uInputSize;

void main(void) {
    vec2 transform = vec2(1.0 / uInputSize) * vec2(uTransform.x, uTransform.y);
    vec4 color = texture(uTexture, vTextureCoord);
    float light = texture(uTexture, vTextureCoord - transform).a;
    float shadow = texture(uTexture, vTextureCoord + transform).a;

    color.rgb = mix(color.rgb, uLightColor, clamp((color.a - light) * uLightAlpha, 0.0, 1.0));
    color.rgb = mix(color.rgb, uShadowColor, clamp((color.a - shadow) * uShadowAlpha, 0.0, 1.0));
    finalColor = vec4(color.rgb * color.a, color.a);
}
`,F5=`struct BevelUniforms {
  uLightColor: vec3<f32>,
  uLightAlpha: f32,
  uShadowColor: vec3<f32>,
  uShadowAlpha: f32,
  uTransform: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> bevelUniforms : BevelUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let transform = vec2<f32>(1.0 / gfu.uInputSize.xy) * vec2<f32>(bevelUniforms.uTransform.x, bevelUniforms.uTransform.y);
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let lightSample: f32 = textureSample(uTexture, uSampler, uv - transform).a;
  let shadowSample: f32 = textureSample(uTexture, uSampler, uv + transform).a;

  let light = vec4<f32>(bevelUniforms.uLightColor, bevelUniforms.uLightAlpha);
  let shadow = vec4<f32>(bevelUniforms.uShadowColor, bevelUniforms.uShadowAlpha);

  color = vec4<f32>(mix(color.rgb, light.rgb, clamp((color.a - lightSample) * light.a, 0.0, 1.0)), color.a);
  color = vec4<f32>(mix(color.rgb, shadow.rgb, clamp((color.a - shadowSample) * shadow.a, 0.0, 1.0)), color.a);
  
  return vec4<f32>(color.rgb * color.a, color.a);
}`,I5=Object.defineProperty,B5=(r,e,t)=>e in r?I5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,mi=(r,e,t)=>(B5(r,typeof e!="symbol"?e+"":e,t),t);const O5=class Ox extends _e{constructor(e){e={...Ox.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:F5,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:k5,name:"bevel-filter"});super({gpuProgram:t,glProgram:n,resources:{bevelUniforms:{uLightColor:{value:new Float32Array(3),type:"vec3<f32>"},uLightAlpha:{value:e.lightAlpha,type:"f32"},uShadowColor:{value:new Float32Array(3),type:"vec3<f32>"},uShadowAlpha:{value:e.shadowAlpha,type:"f32"},uTransform:{value:new Float32Array(2),type:"vec2<f32>"}}},padding:1}),mi(this,"uniforms"),mi(this,"_thickness"),mi(this,"_rotation"),mi(this,"_lightColor"),mi(this,"_shadowColor"),this.uniforms=this.resources.bevelUniforms.uniforms,this._lightColor=new pe,this._shadowColor=new pe,this.lightColor=e.lightColor??16777215,this.shadowColor=e.shadowColor??0,Object.assign(this,e)}get rotation(){return this._rotation/Ni}set rotation(e){this._rotation=e*Ni,this._updateTransform()}get thickness(){return this._thickness}set thickness(e){this._thickness=e,this._updateTransform()}get lightColor(){return this._lightColor.value}set lightColor(e){this._lightColor.setValue(e);const[t,n,i]=this._lightColor.toArray();this.uniforms.uLightColor[0]=t,this.uniforms.uLightColor[1]=n,this.uniforms.uLightColor[2]=i}get lightAlpha(){return this.uniforms.uLightAlpha}set lightAlpha(e){this.uniforms.uLightAlpha=e}get shadowColor(){return this._shadowColor.value}set shadowColor(e){this._shadowColor.setValue(e);const[t,n,i]=this._shadowColor.toArray();this.uniforms.uShadowColor[0]=t,this.uniforms.uShadowColor[1]=n,this.uniforms.uShadowColor[2]=i}get shadowAlpha(){return this.uniforms.uShadowAlpha}set shadowAlpha(e){this.uniforms.uShadowAlpha=e}_updateTransform(){this.uniforms.uTransform[0]=this.thickness*Math.cos(this._rotation),this.uniforms.uTransform[1]=this.thickness*Math.sin(this._rotation)}};mi(O5,"DEFAULT_OPTIONS",{rotation:45,thickness:2,lightColor:16777215,lightAlpha:.7,shadowColor:0,shadowAlpha:.7});var U5=Object.defineProperty,D5=(r,e,t)=>e in r?U5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Zo=(r,e,t)=>(D5(r,typeof e!="symbol"?e+"":e,t),t);const G5=class Ux extends vA{constructor(...e){let t=e[0]??{};if(typeof t=="number"||Array.isArray(t)||"x"in t&&"y"in t){J("6.0.0","BloomFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }");let n=t;Array.isArray(n)&&(n={x:n[0],y:n[1]}),t={strength:n},e[1]!==void 0&&(t.quality=e[1]),e[2]!==void 0&&(t.resolution=e[2]),e[3]!==void 0&&(t.kernelSize=e[3])}t={...Ux.DEFAULT_OPTIONS,...t},super(),Zo(this,"_blurXFilter"),Zo(this,"_blurYFilter"),Zo(this,"_strength"),this._strength={x:2,y:2},t.strength&&(typeof t.strength=="number"?(this._strength.x=t.strength,this._strength.y=t.strength):(this._strength.x=t.strength.x,this._strength.y=t.strength.y)),this._blurXFilter=new Rs({...t,horizontal:!0,strength:this.strengthX}),this._blurYFilter=new Rs({...t,horizontal:!1,strength:this.strengthY}),this._blurYFilter.blendMode="screen",Object.assign(this,t)}apply(e,t,n,i){const s=Ge.getSameSizeTexture(t);e.applyFilter(this,t,n,i),this._blurXFilter.apply(e,t,s,!0),this._blurYFilter.apply(e,s,n,!1),Ge.returnTexture(s)}get strength(){return this._strength}set strength(e){this._strength=typeof e=="number"?{x:e,y:e}:e,this._updateStrength()}get strengthX(){return this.strength.x}set strengthX(e){this.strength.x=e,this._updateStrength()}get strengthY(){return this.strength.y}set strengthY(e){this.strength.y=e,this._updateStrength()}_updateStrength(){this._blurXFilter.blur=this.strengthX,this._blurYFilter.blur=this.strengthY}get blur(){return J("6.0.0","BloomFilter.blur is deprecated, please use BloomFilter.strength instead"),this.strengthX}set blur(e){J("6.0.0","BloomFilter.blur is deprecated, please use BloomFilter.strength instead"),this.strength=e}get blurX(){return J("6.0.0","BloomFilter.blurX is deprecated, please use BloomFilter.strengthX instead"),this.strengthX}set blurX(e){J("6.0.0","BloomFilter.blurX is deprecated, please use BloomFilter.strengthX instead"),this.strengthX=e}get blurY(){return J("6.0.0","BloomFilter.blurY is deprecated, please use BloomFilter.strengthY instead"),this.strengthY}set blurY(e){J("6.0.0","BloomFilter.blurY is deprecated, please use BloomFilter.strengthY instead"),this.strengthY=e}};Zo(G5,"DEFAULT_OPTIONS",{strength:{x:2,y:2},quality:4,resolution:1,kernelSize:5});var z5=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uDimensions;
uniform vec2 uCenter;
uniform float uRadius;
uniform float uStrength;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

void main()
{
    vec2 coord = vTextureCoord * uInputSize.xy;
    coord -= uCenter * uDimensions.xy;
    float distance = length(coord);

    if (distance < uRadius) {
        float percent = distance / uRadius;
        if (uStrength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, uRadius / distance, percent), uStrength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + uStrength * 0.75) * uRadius / distance, 1.0 - percent);
        }
    }

    coord += uCenter * uDimensions.xy;
    coord /= uInputSize.xy;
    vec2 clampedCoord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    vec4 color = texture(uTexture, clampedCoord);

    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    finalColor = color;
}
`,L5=`struct BulgePinchUniforms {
  uDimensions: vec2<f32>,
  uCenter: vec2<f32>,
  uRadius: f32,
  uStrength: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> bulgePinchUniforms : BulgePinchUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let dimensions: vec2<f32> = bulgePinchUniforms.uDimensions;
  let center: vec2<f32> = bulgePinchUniforms.uCenter;
  let radius: f32 = bulgePinchUniforms.uRadius;
  let strength: f32 = bulgePinchUniforms.uStrength;
  var coord: vec2<f32> = (uv * gfu.uInputSize.xy) - center * dimensions.xy;

  let distance: f32 = length(coord);

  if (distance < radius) {
      let percent: f32 = distance / radius;
      if (strength > 0.0) {
          coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
      } else {
          coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
      }
  }
    coord += (center * dimensions.xy);
    coord /= gfu.uInputSize.xy;

    let clampedCoord: vec2<f32> = clamp(coord, gfu.uInputClamp.xy, gfu.uInputClamp.zw);
    var color: vec4<f32> = textureSample(uTexture, uSampler, clampedCoord);
    if (coord.x != clampedCoord.x && coord.y != clampedCoord.y) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    return color;
}

fn compareVec2(x: vec2<f32>, y: vec2<f32>) -> bool
{
  if (x.x == y.x && x.y == y.y)
  {
    return true;
  }

  return false;
}`,N5=Object.defineProperty,H5=(r,e,t)=>e in r?N5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Dx=(r,e,t)=>(H5(r,typeof e!="symbol"?e+"":e,t),t);const V5=class Gx extends _e{constructor(e){e={...Gx.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:L5,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:z5,name:"bulge-pinch-filter"});super({gpuProgram:t,glProgram:n,resources:{bulgePinchUniforms:{uDimensions:{value:[0,0],type:"vec2<f32>"},uCenter:{value:e.center,type:"vec2<f32>"},uRadius:{value:e.radius,type:"f32"},uStrength:{value:e.strength,type:"f32"}}}}),Dx(this,"uniforms"),this.uniforms=this.resources.bulgePinchUniforms.uniforms,Object.assign(this,e)}apply(e,t,n,i){this.uniforms.uDimensions[0]=t.frame.width,this.uniforms.uDimensions[1]=t.frame.height,e.applyFilter(this,t,n,i)}get center(){return this.uniforms.uCenter}set center(e){typeof e=="number"&&(e={x:e,y:e}),Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.uniforms.uCenter.x}set centerX(e){this.uniforms.uCenter.x=e}get centerY(){return this.uniforms.uCenter.y}set centerY(e){this.uniforms.uCenter.y=e}get radius(){return this.uniforms.uRadius}set radius(e){this.uniforms.uRadius=e}get strength(){return this.uniforms.uStrength}set strength(e){this.uniforms.uStrength=e}};Dx(V5,"DEFAULT_OPTIONS",{center:{x:.5,y:.5},radius:100,strength:1});var W5=`precision highp float;
in vec2 vTextureCoord;
in vec2 vFilterCoord;
out vec4 finalColor;

const int TYPE_LINEAR = 0;
const int TYPE_RADIAL = 1;
const int TYPE_CONIC = 2;
const int MAX_STOPS = 32;

uniform sampler2D uTexture;
uniform vec4 uOptions;
uniform vec2 uCounts;
uniform vec3 uColors[MAX_STOPS];
uniform vec4 uStops[MAX_STOPS];

const float PI = 3.1415926538;
const float PI_2 = PI*2.;

struct ColorStop {
    float offset;
    vec3 color;
    float alpha;
};

mat2 rotate2d(float angle){
    return mat2(cos(angle), -sin(angle),
    sin(angle), cos(angle));
}

float projectLinearPosition(vec2 pos, float angle){
    vec2 center = vec2(0.5);
    vec2 result = pos - center;
    result = rotate2d(angle) * result;
    result = result + center;
    return clamp(result.x, 0., 1.);
}

float projectRadialPosition(vec2 pos) {
    float r = distance(pos, vec2(0.5));
    return clamp(2.*r, 0., 1.);
}

float projectAnglePosition(vec2 pos, float angle) {
    vec2 center = pos - vec2(0.5);
    float polarAngle=atan(-center.y, center.x);
    return mod(polarAngle + angle, PI_2) / PI_2;
}

float projectPosition(vec2 pos, int type, float angle) {
    if (type == TYPE_LINEAR) {
        return projectLinearPosition(pos, angle);
    } else if (type == TYPE_RADIAL) {
        return projectRadialPosition(pos);
    } else if (type == TYPE_CONIC) {
        return projectAnglePosition(pos, angle);
    }

    return pos.y;
}

void main(void) {
    int uType = int(uOptions[0]);
    float uAngle = uOptions[1];
    float uAlpha = uOptions[2];
    float uReplace = uOptions[3];

    int uNumStops = int(uCounts[0]);
    float uMaxColors = uCounts[1];

    // current/original color
    vec4 currentColor = texture(uTexture, vTextureCoord);

    // skip calculations if gradient alpha is 0
    if (0.0 == uAlpha) {
        finalColor = currentColor;
        return;
    }

    // project position
    float y = projectPosition(vFilterCoord, int(uType), radians(uAngle));

    // check gradient bounds
    float offsetMin = uStops[0][0];
    float offsetMax = 0.0;

    int numStops = int(uNumStops);

    for (int i = 0; i < MAX_STOPS; i++) {
        if (i == numStops-1){ // last index
            offsetMax = uStops[i][0];
        }
    }

    if (y  < offsetMin || y > offsetMax) {
        finalColor = currentColor;
        return;
    }

    // limit colors
    if (uMaxColors > 0.) {
        float stepSize = 1./uMaxColors;
        float stepNumber = float(floor(y/stepSize));
        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment
    }

    // find color stops
    ColorStop from;
    ColorStop to;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (y >= uStops[i][0]) {
            from = ColorStop(uStops[i][0], uColors[i], uStops[i][1]);
            to = ColorStop(uStops[i+1][0], uColors[i+1], uStops[i+1][1]);
        }

        if (i == numStops-1){ // last index
            break;
        }
    }

    // mix colors from stops
    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);
    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);

    float segmentHeight = to.offset - from.offset;
    float relativePos = y - from.offset;// position from 0 to [segmentHeight]
    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].

    float gradientAlpha = uAlpha * currentColor.a;
    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

    if (uReplace < 0.5) {
        // mix resulting color with current color
        finalColor = gradientColor + currentColor*(1.-gradientColor.a);
    } else {
        // replace with gradient color
        finalColor = gradientColor;
    }
}
`,j5=`in vec2 aPosition;
out vec2 vTextureCoord;
out vec2 vFilterCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
    vFilterCoord = vTextureCoord * uInputSize.xy / uOutputFrame.zw;
}
`,_p=`struct BaseUniforms {
  uOptions: vec4<f32>,
  uCounts: vec2<f32>,
};

struct StopsUniforms {
  uColors: array<vec3<f32>, MAX_STOPS>,
  uStops: array<vec4<f32>, MAX_STOPS>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> baseUniforms : BaseUniforms;
@group(1) @binding(1) var<uniform> stopsUniforms : StopsUniforms;

struct VSOutput {
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>,
  @location(1) coord : vec2<f32>
};

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn filterCoord( vTextureCoord:vec2<f32> ) -> vec2<f32>
{
    return vTextureCoord * gfu.uInputSize.xy / gfu.uOutputFrame.zw;
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  let vTextureCoord: vec2<f32> = filterTextureCoord(aPosition);
  return VSOutput(
   filterVertexPosition(aPosition),
   vTextureCoord,
   filterCoord(vTextureCoord),
  );
}

struct ColorStop {
  offset: f32,
  color: vec3<f32>,
  alpha: f32,
};

fn rotate2d(angle: f32) -> mat2x2<f32>{
  return mat2x2(cos(angle), -sin(angle),
  sin(angle), cos(angle));
}

fn projectLinearPosition(pos: vec2<f32>, angle: f32) -> f32 {
  var center: vec2<f32> = vec2<f32>(0.5);
  var result: vec2<f32> = pos - center;
  result = rotate2d(angle) * result;
  result = result + center;
  return clamp(result.x, 0.0, 1.0);
}

fn projectRadialPosition(pos: vec2<f32>) -> f32 {
  var r: f32 = distance(pos, vec2<f32>(0.5));
  return clamp(2.0 * r, 0.0, 1.0);
}

fn projectAnglePosition(pos: vec2<f32>, angle: f32) -> f32 {
  var center: vec2<f32> = pos - vec2<f32>(0.5, 0.5);
  var polarAngle: f32 = atan2(-center.y, center.x);
  return ((polarAngle + angle) % PI_2) / PI_2;
}

fn projectPosition(pos: vec2<f32>, gradientType: i32, angle: f32) -> f32 {
  if (gradientType == TYPE_LINEAR) {
      return projectLinearPosition(pos, angle);
  } else if (gradientType == TYPE_RADIAL) {
      return projectRadialPosition(pos);
  } else if (gradientType == TYPE_CONIC) {
      return projectAnglePosition(pos, angle);
  }

  return pos.y;
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>,
  @location(1) coord : vec2<f32>
) -> @location(0) vec4<f32> {
  let uType: i32 = i32(baseUniforms.uOptions[0]);
  let uAngle: f32 = baseUniforms.uOptions[1];
  let uAlpha: f32 = baseUniforms.uOptions[2];
  let uReplace: f32 = baseUniforms.uOptions[3];

  let uNumStops: i32 = i32(baseUniforms.uCounts[0]);
  let uMaxColors: f32 = baseUniforms.uCounts[1];

  // current/original color
  var currentColor: vec4<f32> = textureSample(uTexture, uSampler, uv);

  // skip calculations if gradient alpha is 0
  if (uAlpha == 0.0) { return currentColor; }

  // project position
  var y: f32 = projectPosition(coord, uType, radians(uAngle));

  // check gradient bounds
  var offsetMin: f32 = stopsUniforms.uStops[0][0];
  var offsetMax: f32 = 0.0;

  let numStops: i32 = uNumStops;

  for (var i: i32 = 0; i < MAX_STOPS; i = i + 1) {
      if (i == numStops - 1) { // last index
          offsetMax = stopsUniforms.uStops[i][0];
      }
  }

  if (y  < offsetMin || y > offsetMax) { return currentColor; }

  // limit colors
  if (uMaxColors > 0.0) {
      var stepSize: f32 = 1.0 / uMaxColors;
      var stepNumber: f32 = floor(y / stepSize);
      y = stepSize * (stepNumber + 0.5); // offset by 0.5 to use color from middle of segment
  }

  // find color stops
  var stopFrom: ColorStop;
  var stopTo: ColorStop;

  for (var i: i32 = 0; i < MAX_STOPS; i = i + 1) {
      if (y >= stopsUniforms.uStops[i][0]) {
          stopFrom = ColorStop(stopsUniforms.uStops[i][0], stopsUniforms.uColors[i], stopsUniforms.uStops[i][1]);
          stopTo = ColorStop(stopsUniforms.uStops[i + 1][0], stopsUniforms.uColors[i + 1], stopsUniforms.uStops[i + 1][1]);
      }

      if (i == numStops - 1) { // last index
          break;
      }
  }

  // mix colors from stops
  var colorFrom: vec4<f32> = vec4<f32>(stopFrom.color * stopFrom.alpha, stopFrom.alpha);
  var colorTo: vec4<f32> = vec4<f32>(stopTo.color * stopTo.alpha, stopTo.alpha);

  var segmentHeight: f32 = stopTo.offset - stopFrom.offset;
  var relativePos: f32 = y - stopFrom.offset; // position from 0 to [segmentHeight]
  var relativePercent: f32 = relativePos / segmentHeight; // position in percent between [from.offset] and [to.offset].

  var gradientAlpha: f32 = uAlpha * currentColor.a;
  var gradientColor: vec4<f32> = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

  if (uReplace < 0.5) {
      // mix resulting color with current color
      return gradientColor + currentColor * (1.0 - gradientColor.a);
  } else {
      // replace with gradient color
      return gradientColor;
  }
}

const PI: f32 = 3.14159265358979323846264;
const PI_2: f32 = PI * 2.0;

const TYPE_LINEAR: i32 = 0;
const TYPE_RADIAL: i32 = 1;
const TYPE_CONIC: i32 = 2;
const MAX_STOPS: i32 = 32;`,ti=ti||{};ti.stringify=function(){var r={"visit_linear-gradient":function(e){return r.visit_gradient(e)},"visit_repeating-linear-gradient":function(e){return r.visit_gradient(e)},"visit_radial-gradient":function(e){return r.visit_gradient(e)},"visit_repeating-radial-gradient":function(e){return r.visit_gradient(e)},visit_gradient:function(e){var t=r.visit(e.orientation);return t&&(t+=", "),e.type+"("+t+r.visit(e.colorStops)+")"},visit_shape:function(e){var t=e.value,n=r.visit(e.at),i=r.visit(e.style);return i&&(t+=" "+i),n&&(t+=" at "+n),t},"visit_default-radial":function(e){var t="",n=r.visit(e.at);return n&&(t+=n),t},"visit_extent-keyword":function(e){var t=e.value,n=r.visit(e.at);return n&&(t+=" at "+n),t},"visit_position-keyword":function(e){return e.value},visit_position:function(e){return r.visit(e.value.x)+" "+r.visit(e.value.y)},"visit_%":function(e){return e.value+"%"},visit_em:function(e){return e.value+"em"},visit_px:function(e){return e.value+"px"},visit_literal:function(e){return r.visit_color(e.value,e)},visit_hex:function(e){return r.visit_color("#"+e.value,e)},visit_rgb:function(e){return r.visit_color("rgb("+e.value.join(", ")+")",e)},visit_rgba:function(e){return r.visit_color("rgba("+e.value.join(", ")+")",e)},visit_color:function(e,t){var n=e,i=r.visit(t.length);return i&&(n+=" "+i),n},visit_angular:function(e){return e.value+"deg"},visit_directional:function(e){return"to "+e.value},visit_array:function(e){var t="",n=e.length;return e.forEach(function(i,s){t+=r.visit(i),s<n-1&&(t+=", ")}),t},visit:function(e){if(!e)return"";var t="";if(e instanceof Array)return r.visit_array(e,t);if(e.type){var n=r["visit_"+e.type];if(n)return n(e);throw Error("Missing visitor visit_"+e.type)}else throw Error("Invalid node.")}};return function(e){return r.visit(e)}}();var ti=ti||{};ti.parse=function(){var r={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t(G){var j=new Error(e+": "+G);throw j.source=e,j}function n(){var G=i();return e.length>0&&t("Invalid input not EOF"),G}function i(){return b(s)}function s(){return o("linear-gradient",r.linearGradient,l)||o("repeating-linear-gradient",r.repeatingLinearGradient,l)||o("radial-gradient",r.radialGradient,d)||o("repeating-radial-gradient",r.repeatingRadialGradient,d)}function o(G,j,M){return a(j,function(H){var W=M();return W&&(B(r.comma)||t("Missing comma before color stops")),{type:G,orientation:W,colorStops:b(_)}})}function a(G,j){var M=B(G);if(M){B(r.startCall)||t("Missing (");var H=j(M);return B(r.endCall)||t("Missing )"),H}}function l(){return u()||c()}function u(){return T("directional",r.sideOrCorner,1)}function c(){return T("angular",r.angleValue,1)}function d(){var G,j=h(),M;return j&&(G=[],G.push(j),M=e,B(r.comma)&&(j=h(),j?G.push(j):e=M)),G}function h(){var G=f()||p();if(G)G.at=g();else{var j=m();if(j){G=j;var M=g();M&&(G.at=M)}else{var H=v();H&&(G={type:"default-radial",at:H})}}return G}function f(){var G=T("shape",/^(circle)/i,0);return G&&(G.style=R()||m()),G}function p(){var G=T("shape",/^(ellipse)/i,0);return G&&(G.style=U()||m()),G}function m(){return T("extent-keyword",r.extentKeywords,1)}function g(){if(T("position",/^at/,0)){var G=v();return G||t("Missing positioning value"),G}}function v(){var G=x();if(G.x||G.y)return{type:"position",value:G}}function x(){return{x:U(),y:U()}}function b(G){var j=G(),M=[];if(j)for(M.push(j);B(r.comma);)j=G(),j?M.push(j):t("One extra comma");return M}function _(){var G=w();return G||t("Expected color definition"),G.length=U(),G}function w(){return P()||A()||S()||C()}function C(){return T("literal",r.literalColor,0)}function P(){return T("hex",r.hexColor,1)}function S(){return a(r.rgbColor,function(){return{type:"rgb",value:b(E)}})}function A(){return a(r.rgbaColor,function(){return{type:"rgba",value:b(E)}})}function E(){return B(r.number)[1]}function U(){return T("%",r.percentageValue,1)||L()||R()}function L(){return T("position-keyword",r.positionKeywords,1)}function R(){return T("px",r.pixelValue,1)||T("em",r.emValue,1)}function T(G,j,M){var H=B(j);if(H)return{type:G,value:H[M]}}function B(G){var j,M;return M=/^[\n\r\t\s]+/.exec(e),M&&z(M[0].length),j=G.exec(e),j&&z(j[0].length),j}function z(G){e=e.substr(G)}return function(G){return e=G.toString(),n()}}();var X5=ti.parse;ti.stringify;function q5(r){const e=X5(tM(r));if(e.length===0)throw new Error("Invalid CSS gradient.");if(e.length!==1)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");const t=e[0],n=Y5(t.type),i=K5(t.colorStops),s=J5(t.orientation);return{type:n,stops:i,angle:s}}function Y5(r){const e={"linear-gradient":0,"radial-gradient":1};if(!(r in e))throw new Error(`Unsupported gradient type "${r}"`);return e[r]}function K5(r){const e=Z5(r),t=[],n=new pe;for(let i=0;i<r.length;i++){const s=$5(r[i]),o=n.setValue(s).toArray();t.push({offset:e[i],color:o.slice(0,3),alpha:o[3]})}return t}function $5(r){switch(r.type){case"hex":return`#${r.value}`;case"literal":return r.value;default:return`${r.type}(${r.value.join(",")})`}}function Z5(r){const e=[];for(let s=0;s<r.length;s++){const o=r[s];let a=-1;o.type==="literal"&&o.length&&"type"in o.length&&o.length.type==="%"&&"value"in o.length&&(a=parseFloat(o.length.value)/100),e.push(a)}const n=s=>{for(let o=s;o<e.length;o++)if(e[o]!==-1)return{indexDelta:o-s,offset:e[o]};return{indexDelta:e.length-1-s,offset:1}};let i=0;for(let s=0;s<e.length;s++){const o=e[s];if(o!==-1)i=o;else if(s===0)e[s]=0;else if(s+1===e.length)e[s]=1;else{const a=n(s),u=(a.offset-i)/(1+a.indexDelta);for(let c=0;c<=a.indexDelta;c++)e[s+c]=i+(c+1)*u;s+=a.indexDelta,i=e[s]}}return e.map(Q5)}function Q5(r){return r.toString().length>6?parseFloat(r.toString().substring(0,6)):r}function J5(r){if(typeof r>"u")return 0;if("type"in r&&"value"in r)switch(r.type){case"angular":return parseFloat(r.value);case"directional":return eM(r.value)}return 0}function eM(r){const e={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(r in e))throw new Error(`Unsupported directional value "${r}"`);return e[r]}function tM(r){let e=r.replace(/\s{2,}/gu," ");return e=e.replace(/;/g,""),e=e.replace(/ ,/g,","),e=e.replace(/\( /g,"("),e=e.replace(/ \)/g,")"),e.trim()}var rM=Object.defineProperty,nM=(r,e,t)=>e in r?rM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Gn=(r,e,t)=>(nM(r,typeof e!="symbol"?e+"":e,t),t);const du=90;function iM(r){return[...r].sort((e,t)=>e.offset-t.offset)}const Xi=class Qo extends _e{constructor(e){if(e&&"css"in e?e={...q5(e.css||""),alpha:e.alpha??Qo.defaults.alpha,maxColors:e.maxColors??Qo.defaults.maxColors}:e={...Qo.defaults,...e},!e.stops||e.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");const t=me.from({vertex:{source:_p,entryPoint:"mainVertex"},fragment:{source:_p,entryPoint:"mainFragment"}}),n=be.from({vertex:j5,fragment:W5,name:"color-gradient-filter"}),i=32;super({gpuProgram:t,glProgram:n,resources:{baseUniforms:{uOptions:{value:[e.type,e.angle??du,e.alpha,e.replace?1:0],type:"vec4<f32>"},uCounts:{value:[e.stops.length,e.maxColors],type:"vec2<f32>"}},stopsUniforms:{uColors:{value:new Float32Array(i*3),type:"vec3<f32>",size:i},uStops:{value:new Float32Array(i*4),type:"vec4<f32>",size:i}}}}),Gn(this,"baseUniforms"),Gn(this,"stopsUniforms"),Gn(this,"_stops",[]),this.baseUniforms=this.resources.baseUniforms.uniforms,this.stopsUniforms=this.resources.stopsUniforms.uniforms,Object.assign(this,e)}get stops(){return this._stops}set stops(e){const t=iM(e),n=new pe;let i,s,o;for(let a=0;a<t.length;a++){n.setValue(t[a].color);const l=a*3;[i,s,o]=n.toArray(),this.stopsUniforms.uColors[l]=i,this.stopsUniforms.uColors[l+1]=s,this.stopsUniforms.uColors[l+2]=o,this.stopsUniforms.uStops[a*4]=t[a].offset,this.stopsUniforms.uStops[a*4+1]=t[a].alpha}this.baseUniforms.uCounts[0]=t.length,this._stops=t}get type(){return this.baseUniforms.uOptions[0]}set type(e){this.baseUniforms.uOptions[0]=e}get angle(){return this.baseUniforms.uOptions[1]+du}set angle(e){this.baseUniforms.uOptions[1]=e-du}get alpha(){return this.baseUniforms.uOptions[2]}set alpha(e){this.baseUniforms.uOptions[2]=e}get maxColors(){return this.baseUniforms.uCounts[1]}set maxColors(e){this.baseUniforms.uCounts[1]=e}get replace(){return this.baseUniforms.uOptions[3]>.5}set replace(e){this.baseUniforms.uOptions[3]=e?1:0}};Gn(Xi,"LINEAR",0);Gn(Xi,"RADIAL",1);Gn(Xi,"CONIC",2);Gn(Xi,"defaults",{type:Xi.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0,replace:!1});let yp=Xi;var sM=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uMapTexture;
uniform float uMix;
uniform float uSize;
uniform float uSliceSize;
uniform float uSlicePixelSize;
uniform float uSliceInnerSize;

void main() {
    vec4 color = texture(uTexture, vTextureCoord.xy);
    vec4 adjusted;

    if (color.a > 0.0) {
        color.rgb /= color.a;
        float innerWidth = uSize - 1.0;
        float zSlice0 = min(floor(color.b * innerWidth), innerWidth);
        float zSlice1 = min(zSlice0 + 1.0, innerWidth);
        float xOffset = uSlicePixelSize * 0.5 + color.r * uSliceInnerSize;
        float s0 = xOffset + (zSlice0 * uSliceSize);
        float s1 = xOffset + (zSlice1 * uSliceSize);
        float yOffset = uSliceSize * 0.5 + color.g * (1.0 - uSliceSize);
        vec4 slice0Color = texture(uMapTexture, vec2(s0,yOffset));
        vec4 slice1Color = texture(uMapTexture, vec2(s1,yOffset));
        float zOffset = fract(color.b * innerWidth);
        adjusted = mix(slice0Color, slice1Color, zOffset);

        color.rgb *= color.a;
    }

    finalColor = vec4(mix(color, adjusted, uMix).rgb, color.a);

}`,oM=`struct ColorMapUniforms {
  uMix: f32,
  uSize: f32,
  uSliceSize: f32,
  uSlicePixelSize: f32,
  uSliceInnerSize: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> colorMapUniforms : ColorMapUniforms;
@group(1) @binding(1) var uMapTexture: texture_2d<f32>;
@group(1) @binding(2) var uMapSampler: sampler;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color:vec4<f32> = textureSample(uTexture, uSampler, uv);

  var adjusted: vec4<f32>;

  var altColor: vec4<f32> = vec4<f32>(color.rgb / color.a, color.a);
  let innerWidth: f32 = colorMapUniforms.uSize - 1.0;
  let zSlice0: f32 = min(floor(color.b * innerWidth), innerWidth);
  let zSlice1: f32 = min(zSlice0 + 1.0, innerWidth);
  let xOffset: f32 = colorMapUniforms.uSlicePixelSize * 0.5 + color.r * colorMapUniforms.uSliceInnerSize;
  let s0: f32 = xOffset + (zSlice0 * colorMapUniforms.uSliceSize);
  let s1: f32 = xOffset + (zSlice1 * colorMapUniforms.uSliceSize);
  let yOffset: f32 = colorMapUniforms.uSliceSize * 0.5 + color.g * (1.0 - colorMapUniforms.uSliceSize);
  let slice0Color: vec4<f32> = textureSample(uMapTexture, uMapSampler, vec2(s0,yOffset));
  let slice1Color: vec4<f32> = textureSample(uMapTexture, uMapSampler, vec2(s1,yOffset));
  let zOffset: f32 = fract(color.b * innerWidth);
  adjusted = mix(slice0Color, slice1Color, zOffset);
  altColor = vec4<f32>(color.rgb * color.a, color.a);

  let realColor: vec4<f32> = select(color, altColor, color.a > 0.0);

  return vec4<f32>(mix(realColor, adjusted, colorMapUniforms.uMix).rgb, realColor.a);
}`,aM=Object.defineProperty,lM=(r,e,t)=>e in r?aM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Dr=(r,e,t)=>(lM(r,typeof e!="symbol"?e+"":e,t),t);const uM=class zx extends _e{constructor(...e){let t=e[0]??{};if((t instanceof te||t instanceof lt)&&(J("6.0.0","ColorMapFilter constructor params are now options object. See params: { colorMap, nearest, mix }"),t={colorMap:t},e[1]!==void 0&&(t.nearest=e[1]),e[2]!==void 0&&(t.mix=e[2])),t={...zx.DEFAULT_OPTIONS,...t},!t.colorMap)throw Error("No color map texture source was provided to ColorMapFilter");const n=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:oM,entryPoint:"mainFragment"}}),i=be.from({vertex:Be,fragment:sM,name:"color-map-filter"});super({gpuProgram:n,glProgram:i,resources:{colorMapUniforms:{uMix:{value:t.mix,type:"f32"},uSize:{value:0,type:"f32"},uSliceSize:{value:0,type:"f32"},uSlicePixelSize:{value:0,type:"f32"},uSliceInnerSize:{value:0,type:"f32"}},uMapTexture:t.colorMap.source,uMapSampler:t.colorMap.source.style}}),Dr(this,"uniforms"),Dr(this,"_size",0),Dr(this,"_sliceSize",0),Dr(this,"_slicePixelSize",0),Dr(this,"_sliceInnerSize",0),Dr(this,"_nearest",!1),Dr(this,"_scaleMode","linear"),Dr(this,"_colorMap"),this.uniforms=this.resources.colorMapUniforms.uniforms,Object.assign(this,t)}get mix(){return this.uniforms.uMix}set mix(e){this.uniforms.uMix=e}get colorSize(){return this._size}get colorMap(){return this._colorMap}set colorMap(e){if(!e||e===this.colorMap)return;const t=e instanceof te?e.source:e;t.style.scaleMode=this._scaleMode,t.autoGenerateMipmaps=!1,this._size=t.height,this._sliceSize=1/this._size,this._slicePixelSize=this._sliceSize/this._size,this._sliceInnerSize=this._slicePixelSize*(this._size-1),this.uniforms.uSize=this._size,this.uniforms.uSliceSize=this._sliceSize,this.uniforms.uSlicePixelSize=this._slicePixelSize,this.uniforms.uSliceInnerSize=this._sliceInnerSize,this.resources.uMapTexture=t,this._colorMap=e}get nearest(){return this._nearest}set nearest(e){this._nearest=e,this._scaleMode=e?"nearest":"linear";const t=this._colorMap;t&&t.source&&(t.source.scaleMode=this._scaleMode,t.source.autoGenerateMipmaps=!1,t.source.style.update(),t.source.update())}updateColorMap(){const e=this._colorMap;e?.source&&(e.source.update(),this.colorMap=e)}destroy(){this._colorMap?.destroy(),super.destroy()}};Dr(uM,"DEFAULT_OPTIONS",{colorMap:te.WHITE,nearest:!1,mix:1});var cM=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uColor;
uniform float uAlpha;

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);
    finalColor = vec4(mix(c.rgb, uColor.rgb, c.a * uAlpha), c.a);
}
`,dM=`struct ColorOverlayUniforms {
    uColor: vec3<f32>,
    uAlpha: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> colorOverlayUniforms : ColorOverlayUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    let c = textureSample(uTexture, uSampler, uv);
    return vec4<f32>(mix(c.rgb, colorOverlayUniforms.uColor.rgb, c.a * colorOverlayUniforms.uAlpha), c.a);
}
`,hM=Object.defineProperty,fM=(r,e,t)=>e in r?hM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,nc=(r,e,t)=>(fM(r,typeof e!="symbol"?e+"":e,t),t);const pM=class Lx extends _e{constructor(...e){let t=e[0]??{};(typeof t=="number"||Array.isArray(t)||t instanceof Float32Array)&&(J("6.0.0","ColorOverlayFilter constructor params are now options object. See params: { color, alpha }"),t={color:t},e[1]!==void 0&&(t.alpha=e[1])),t={...Lx.DEFAULT_OPTIONS,...t};const n=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:dM,entryPoint:"mainFragment"}}),i=be.from({vertex:Be,fragment:cM,name:"color-overlay-filter"});super({gpuProgram:n,glProgram:i,resources:{colorOverlayUniforms:{uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:t.alpha,type:"f32"}}}}),nc(this,"uniforms"),nc(this,"_color"),this.uniforms=this.resources.colorOverlayUniforms.uniforms,this._color=new pe,this.color=t.color??0}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,n,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=n,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}};nc(pM,"DEFAULT_OPTIONS",{color:0,alpha:1});var mM=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uOriginalColor;
uniform vec3 uTargetColor;
uniform float uTolerance;

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);
    vec3 colorDiff = uOriginalColor - (c.rgb / max(c.a, 0.0000000001));
    float colorDistance = length(colorDiff);
    float doReplace = step(colorDistance, uTolerance);
    finalColor = vec4(mix(c.rgb, (uTargetColor + colorDiff) * c.a, doReplace), c.a);
}
`,gM=`struct ColorReplaceUniforms {
  uOriginalColor: vec3<f32>,
  uTargetColor: vec3<f32>,
  uTolerance: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> colorReplaceUniforms : ColorReplaceUniforms;

@fragment
fn mainFragment(
   @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let sample: vec4<f32> = textureSample(uTexture, uSampler, uv);

  let colorDiff: vec3<f32> = colorReplaceUniforms.uOriginalColor - (sample.rgb / max(sample.a, 0.0000000001));
  let colorDistance: f32 = length(colorDiff);
  let doReplace: f32 = step(colorDistance, colorReplaceUniforms.uTolerance);

  return vec4<f32>(mix(sample.rgb, (colorReplaceUniforms.uTargetColor + colorDiff) * sample.a, doReplace), sample.a);
}`,vM=Object.defineProperty,xM=(r,e,t)=>e in r?vM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Jo=(r,e,t)=>(xM(r,typeof e!="symbol"?e+"":e,t),t);const bM=class Nx extends _e{constructor(...e){let t=e[0]??{};(typeof t=="number"||Array.isArray(t)||t instanceof Float32Array)&&(J("6.0.0","ColorReplaceFilter constructor params are now options object. See params: { originalColor, targetColor, tolerance }"),t={originalColor:t},e[1]!==void 0&&(t.targetColor=e[1]),e[2]!==void 0&&(t.tolerance=e[2])),t={...Nx.DEFAULT_OPTIONS,...t};const n=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:gM,entryPoint:"mainFragment"}}),i=be.from({vertex:Be,fragment:mM,name:"color-replace-filter"});super({gpuProgram:n,glProgram:i,resources:{colorReplaceUniforms:{uOriginalColor:{value:new Float32Array(3),type:"vec3<f32>"},uTargetColor:{value:new Float32Array(3),type:"vec3<f32>"},uTolerance:{value:t.tolerance,type:"f32"}}}}),Jo(this,"uniforms"),Jo(this,"_originalColor"),Jo(this,"_targetColor"),this.uniforms=this.resources.colorReplaceUniforms.uniforms,this._originalColor=new pe,this._targetColor=new pe,this.originalColor=t.originalColor??16711680,this.targetColor=t.targetColor??0,Object.assign(this,t)}get originalColor(){return this._originalColor.value}set originalColor(e){this._originalColor.setValue(e);const[t,n,i]=this._originalColor.toArray();this.uniforms.uOriginalColor[0]=t,this.uniforms.uOriginalColor[1]=n,this.uniforms.uOriginalColor[2]=i}get targetColor(){return this._targetColor.value}set targetColor(e){this._targetColor.setValue(e);const[t,n,i]=this._targetColor.toArray();this.uniforms.uTargetColor[0]=t,this.uniforms.uTargetColor[1]=n,this.uniforms.uTargetColor[2]=i}get tolerance(){return this.uniforms.uTolerance}set tolerance(e){this.uniforms.uTolerance=e}set newColor(e){J("6.0.0","ColorReplaceFilter.newColor is deprecated, please use ColorReplaceFilter.targetColor instead"),this.targetColor=e}get newColor(){return J("6.0.0","ColorReplaceFilter.newColor is deprecated, please use ColorReplaceFilter.targetColor instead"),this.targetColor}set epsilon(e){J("6.0.0","ColorReplaceFilter.epsilon is deprecated, please use ColorReplaceFilter.tolerance instead"),this.tolerance=e}get epsilon(){return J("6.0.0","ColorReplaceFilter.epsilon is deprecated, please use ColorReplaceFilter.tolerance instead"),this.tolerance}};Jo(bM,"DEFAULT_OPTIONS",{originalColor:16711680,targetColor:0,tolerance:.4});var _M=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uTexelSize;
uniform mat3 uMatrix;

void main(void)
{
    vec4 c11 = texture(uTexture, vTextureCoord - uTexelSize); // top left
    vec4 c12 = texture(uTexture, vec2(vTextureCoord.x, vTextureCoord.y - uTexelSize.y)); // top center
    vec4 c13 = texture(uTexture, vec2(vTextureCoord.x + uTexelSize.x, vTextureCoord.y - uTexelSize.y)); // top right

    vec4 c21 = texture(uTexture, vec2(vTextureCoord.x - uTexelSize.x, vTextureCoord.y)); // mid left
    vec4 c22 = texture(uTexture, vTextureCoord); // mid center
    vec4 c23 = texture(uTexture, vec2(vTextureCoord.x + uTexelSize.x, vTextureCoord.y)); // mid right

    vec4 c31 = texture(uTexture, vec2(vTextureCoord.x - uTexelSize.x, vTextureCoord.y + uTexelSize.y)); // bottom left
    vec4 c32 = texture(uTexture, vec2(vTextureCoord.x, vTextureCoord.y + uTexelSize.y)); // bottom center
    vec4 c33 = texture(uTexture, vTextureCoord + uTexelSize); // bottom right

    finalColor =
        c11 * uMatrix[0][0] + c12 * uMatrix[0][1] + c13 * uMatrix[0][2] +
        c21 * uMatrix[1][0] + c22 * uMatrix[1][1] + c23 * uMatrix[1][2] +
        c31 * uMatrix[2][0] + c32 * uMatrix[2][1] + c33 * uMatrix[2][2];

    finalColor.a = c22.a;
}`,yM=`struct ConvolutionUniforms {
    uMatrix: mat3x3<f32>,
    uTexelSize: vec2<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> convolutionUniforms : ConvolutionUniforms;

@fragment
fn mainFragment(
    @location(0) uv: vec2<f32>,
    @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
    let texelSize = convolutionUniforms.uTexelSize;
    let matrix = convolutionUniforms.uMatrix;

    let c11: vec4<f32> = textureSample(uTexture, uSampler, uv - texelSize); // top left
    let c12: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x, uv.y - texelSize.y)); // top center
    let c13: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x + texelSize.x, uv.y - texelSize.y)); // top right

    let c21: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x - texelSize.x, uv.y)); // mid left
    let c22: vec4<f32> = textureSample(uTexture, uSampler, uv); // mid center
    let c23: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x + texelSize.x, uv.y)); // mid right

    let c31: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x - texelSize.x, uv.y + texelSize.y)); // bottom left
    let c32: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x, uv.y + texelSize.y)); // bottom center
    let c33: vec4<f32> = textureSample(uTexture, uSampler, uv + texelSize); // bottom right

    var finalColor: vec4<f32> = vec4<f32>(
        c11 * matrix[0][0] + c12 * matrix[0][1] + c13 * matrix[0][2] +
        c21 * matrix[1][0] + c22 * matrix[1][1] + c23 * matrix[1][2] +
        c31 * matrix[2][0] + c32 * matrix[2][1] + c33 * matrix[2][2]
    );

    finalColor.a = c22.a;

    return finalColor;
}`,SM=Object.defineProperty,wM=(r,e,t)=>e in r?SM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Hx=(r,e,t)=>(wM(r,typeof e!="symbol"?e+"":e,t),t);const TM=class Vx extends _e{constructor(...e){let t=e[0]??{};Array.isArray(t)&&(J("6.0.0","ConvolutionFilter constructor params are now options object. See params: { matrix, width, height }"),t={matrix:t},e[1]!==void 0&&(t.width=e[1]),e[2]!==void 0&&(t.height=e[2])),t={...Vx.DEFAULT_OPTIONS,...t};const n=t.width??200,i=t.height??200,s=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:yM,entryPoint:"mainFragment"}}),o=be.from({vertex:Be,fragment:_M,name:"convolution-filter"});super({gpuProgram:s,glProgram:o,resources:{convolutionUniforms:{uMatrix:{value:t.matrix,type:"mat3x3<f32>"},uTexelSize:{value:{x:1/n,y:1/i},type:"vec2<f32>"}}}}),Hx(this,"uniforms"),this.uniforms=this.resources.convolutionUniforms.uniforms,this.width=n,this.height=i}get matrix(){return this.uniforms.uMatrix}set matrix(e){e.forEach((t,n)=>{this.uniforms.uMatrix[n]=t})}get width(){return 1/this.uniforms.uTexelSize.x}set width(e){this.uniforms.uTexelSize.x=1/e}get height(){return 1/this.uniforms.uTexelSize.y}set height(e){this.uniforms.uTexelSize.y=1/e}};Hx(TM,"DEFAULT_OPTIONS",{matrix:new Float32Array(9),width:200,height:200});var CM=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec4 uLine;
uniform vec2 uNoise;
uniform vec3 uVignette;
uniform float uSeed;
uniform float uTime;
uniform vec2 uDimensions;

uniform vec4 uInputSize;

const float SQRT_2 = 1.414213;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

float vignette(vec3 co, vec2 coord)
{
    float outter = SQRT_2 - uVignette[0] * SQRT_2;
    vec2 dir = vec2(0.5) - coord;
    dir.y *= uDimensions.y / uDimensions.x;
    float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);
    return darker + (1.0 - darker) * (1.0 - uVignette[1]);
}

float noise(vec2 coord)
{
    vec2 pixelCoord = coord * uInputSize.xy;
    pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
    pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
    return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}

vec3 interlaceLines(vec3 co, vec2 coord)
{
    vec3 color = co;

    float curvature = uLine[0];
    float lineWidth = uLine[1];
    float lineContrast = uLine[2];
    float verticalLine = uLine[3];

    vec2 dir = vec2(coord * uInputSize.xy / uDimensions - 0.5);

    float _c = curvature > 0. ? curvature : 1.;
    float k = curvature > 0. ? (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
    vec2 uv = dir * k;
    float v = verticalLine > 0.5 ? uv.x * uDimensions.x : uv.y * uDimensions.y;
    v *= min(1.0, 2.0 / lineWidth ) / _c;
    float j = 1. + cos(v * 1.2 - uTime) * 0.5 * lineContrast;
    color *= j;

    float segment = verticalLine > 0.5 ? mod((dir.x + .5) * uDimensions.x, 4.) : mod((dir.y + .5) * uDimensions.y, 4.);
    color *= 0.99 + ceil(segment) * 0.015;

    return color;
}

void main(void)
{
    finalColor = texture(uTexture, vTextureCoord);
    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions;

    if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
    {
        float n = noise(vTextureCoord);
        finalColor += vec4(n, n, n, finalColor.a);
    }

    if (uVignette[0] > 0.)
    {
        float v = vignette(finalColor.rgb, coord);
        finalColor *= vec4(v, v, v, finalColor.a);
    }

    if (uLine[1] > 0.0)
    {
        finalColor = vec4(interlaceLines(finalColor.rgb, vTextureCoord), finalColor.a);  
    }
}
`,PM=`struct CRTUniforms {
    uLine: vec4<f32>,
    uNoise: vec2<f32>,
    uVignette: vec3<f32>,
    uSeed: f32,
    uTime: f32,
    uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> crtUniforms : CRTUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let coord: vec2<f32> = uv * gfu.uInputSize.xy / crtUniforms.uDimensions;

  let uNoise = crtUniforms.uNoise;

  if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
  {
    color += vec4<f32>(vec3<f32>(noise(uv)), color.a);
  }

  if (crtUniforms.uVignette[0] > 0.)
  {
    color *= vec4<f32>(vec3<f32>(vignette(color.rgb, coord)), color.a);
  }

  if (crtUniforms.uLine[1] > 0.0)
  {
    color = vec4<f32>(vec3<f32>(interlaceLines(color.rgb, uv)), color.a);  
  }

  return color;
}

const SQRT_2: f32 = 1.414213;

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

fn rand(co: vec2<f32>) -> f32
{
  return fract(sin(dot(co, vec2<f32>(12.9898, 78.233))) * 43758.5453);
}

fn vignette(co: vec3<f32>, coord: vec2<f32>) -> f32
{
  let uVignette = crtUniforms.uVignette;
  let uDimensions = crtUniforms.uDimensions;
  
  let outter: f32 = SQRT_2 - uVignette[0] * SQRT_2;
  var dir: vec2<f32> = vec2<f32>(0.5) - coord;
  dir.y *= uDimensions.y / uDimensions.x;
  let darker: f32 = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);
  return darker + (1.0 - darker) * (1.0 - uVignette[1]);
}

fn noise(coord: vec2<f32>) -> f32
{
  let uNoise = crtUniforms.uNoise;
  let uSeed = crtUniforms.uSeed;

  var pixelCoord: vec2<f32> = coord * gfu.uInputSize.xy;
  pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
  pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
  return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}

fn interlaceLines(co: vec3<f32>, coord: vec2<f32>) -> vec3<f32>
{
  var color = co;

  let uDimensions = crtUniforms.uDimensions;

  let curvature: f32 = crtUniforms.uLine[0];
  let lineWidth: f32 = crtUniforms.uLine[1];
  let lineContrast: f32 = crtUniforms.uLine[2];
  let verticalLine: f32 = crtUniforms.uLine[3];

  let dir: vec2<f32> = vec2<f32>(coord * gfu.uInputSize.xy / uDimensions - 0.5);

  let _c: f32 = select(1., curvature, curvature > 0.);
  let k: f32 = select(1., (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c), curvature > 0.);
  let uv: vec2<f32> = dir * k;
  let v: f32 = select(uv.y * uDimensions.y, uv.x * uDimensions.x, verticalLine > 0.5) * min(1.0, 2.0 / lineWidth ) / _c;
  let j: f32 = 1. + cos(v * 1.2 - crtUniforms.uTime) * 0.5 * lineContrast;
  color *= j;

  let segment: f32 = select(modulo((dir.y + .5) * uDimensions.y, 4.), modulo((dir.x + .5) * uDimensions.x, 4.), verticalLine > 0.5);
  color *= 0.99 + ceil(segment) * 0.015;

  return color;
}`,AM=Object.defineProperty,EM=(r,e,t)=>e in r?AM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ea=(r,e,t)=>(EM(r,typeof e!="symbol"?e+"":e,t),t);const MM=class Wx extends _e{constructor(e){e={...Wx.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:PM,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:CM,name:"crt-filter"});super({gpuProgram:t,glProgram:n,resources:{crtUniforms:{uLine:{value:new Float32Array(4),type:"vec4<f32>"},uNoise:{value:new Float32Array(2),type:"vec2<f32>"},uVignette:{value:new Float32Array(3),type:"vec3<f32>"},uSeed:{value:e.seed,type:"f32"},uTime:{value:e.time,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),ea(this,"uniforms"),ea(this,"seed"),ea(this,"time"),this.uniforms=this.resources.crtUniforms.uniforms,Object.assign(this,e)}apply(e,t,n,i){this.uniforms.uDimensions[0]=t.frame.width,this.uniforms.uDimensions[1]=t.frame.height,this.uniforms.uSeed=this.seed,this.uniforms.uTime=this.time,e.applyFilter(this,t,n,i)}get curvature(){return this.uniforms.uLine[0]}set curvature(e){this.uniforms.uLine[0]=e}get lineWidth(){return this.uniforms.uLine[1]}set lineWidth(e){this.uniforms.uLine[1]=e}get lineContrast(){return this.uniforms.uLine[2]}set lineContrast(e){this.uniforms.uLine[2]=e}get verticalLine(){return this.uniforms.uLine[3]>.5}set verticalLine(e){this.uniforms.uLine[3]=e?1:0}get noise(){return this.uniforms.uNoise[0]}set noise(e){this.uniforms.uNoise[0]=e}get noiseSize(){return this.uniforms.uNoise[1]}set noiseSize(e){this.uniforms.uNoise[1]=e}get vignetting(){return this.uniforms.uVignette[0]}set vignetting(e){this.uniforms.uVignette[0]=e}get vignettingAlpha(){return this.uniforms.uVignette[1]}set vignettingAlpha(e){this.uniforms.uVignette[1]=e}get vignettingBlur(){return this.uniforms.uVignette[2]}set vignettingBlur(e){this.uniforms.uVignette[2]=e}};ea(MM,"DEFAULT_OPTIONS",{curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0,seed:0});var RM=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uAngle;
uniform float uScale;
uniform bool uGrayScale;

uniform vec4 uInputSize;

float pattern()
{
    float s = sin(uAngle), c = cos(uAngle);
    vec2 tex = vTextureCoord * uInputSize.xy;
    vec2 point = vec2(
        c * tex.x - s * tex.y,
        s * tex.x + c * tex.y
    ) * uScale;
    return (sin(point.x) * sin(point.y)) * 4.0;
    }

    void main()
    {
    vec4 color = texture(uTexture, vTextureCoord);
    vec3 colorRGB = vec3(color);

    if (uGrayScale)
    {
        colorRGB = vec3(color.r + color.g + color.b) / 3.0;
    }

    finalColor = vec4(colorRGB * 10.0 - 5.0 + pattern(), color.a);
}
`,kM=`struct DotUniforms {
  uScale:f32,
  uAngle:f32,
  uGrayScale:f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> dotUniforms : DotUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
  let color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let gray: vec3<f32> = vec3<f32>(dot(color.rgb, vec3<f32>(0.299, 0.587, 0.114)));
  // dotUniforms.uGrayScale == 1 doesn't ever pass so it is converted to a float and compared to 0.5 instead 
  let finalColor: vec3<f32> = select(color.rgb, gray, f32(dotUniforms.uGrayScale) >= 0.5);

  return vec4<f32>(finalColor * 10.0 - 5.0 + pattern(uv), color.a);
}

fn pattern(uv: vec2<f32>) -> f32
{
  let s: f32 = sin(dotUniforms.uAngle);
  let c: f32 = cos(dotUniforms.uAngle);
  
  let tex: vec2<f32> = uv * gfu.uInputSize.xy;
  
  let p: vec2<f32> = vec2<f32>(
      c * tex.x - s * tex.y,
      s * tex.x + c * tex.y
  ) * dotUniforms.uScale;

  return (sin(p.x) * sin(p.y)) * 4.0;
}`,FM=Object.defineProperty,IM=(r,e,t)=>e in r?FM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,BM=(r,e,t)=>(IM(r,e+"",t),t);const OM=class jx extends _e{constructor(...e){let t=e[0]??{};typeof t=="number"&&(J("6.0.0","DotFilter constructor params are now options object. See params: { scale, angle, grayscale }"),t={scale:t},e[1]!==void 0&&(t.angle=e[1]),e[2]!==void 0&&(t.grayscale=e[2])),t={...jx.DEFAULT_OPTIONS,...t};const n={uScale:{value:t.scale,type:"f32"},uAngle:{value:t.angle,type:"f32"},uGrayScale:{value:t.grayscale?1:0,type:"f32"}},i=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:kM,entryPoint:"mainFragment"}}),s=be.from({vertex:Be,fragment:RM,name:"dot-filter"});super({gpuProgram:i,glProgram:s,resources:{dotUniforms:n}})}get scale(){return this.resources.dotUniforms.uniforms.uScale}set scale(e){this.resources.dotUniforms.uniforms.uScale=e}get angle(){return this.resources.dotUniforms.uniforms.uAngle}set angle(e){this.resources.dotUniforms.uniforms.uAngle=e}get grayscale(){return this.resources.dotUniforms.uniforms.uGrayScale===1}set grayscale(e){this.resources.dotUniforms.uniforms.uGrayScale=e?1:0}};BM(OM,"DEFAULT_OPTIONS",{scale:1,angle:5,grayscale:!0});var UM=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uAlpha;
uniform vec3 uColor;
uniform vec2 uOffset;

uniform vec4 uInputSize;

void main(void){
    vec4 sample = texture(uTexture, vTextureCoord - uOffset * uInputSize.zw);

    // Premultiply alpha
    sample.rgb = uColor.rgb * sample.a;

    // alpha user alpha
    sample *= uAlpha;

    finalColor = sample;
}`,DM=`struct DropShadowUniforms {
  uAlpha: f32,
  uColor: vec3<f32>,
  uOffset: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> dropShadowUniforms : DropShadowUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv - dropShadowUniforms.uOffset * gfu.uInputSize.zw);

  // Premultiply alpha
  color = vec4<f32>(vec3<f32>(dropShadowUniforms.uColor.rgb * color.a), color.a);
  // alpha user alpha
  color *= dropShadowUniforms.uAlpha;

  return color;
}`,GM=Object.defineProperty,zM=(r,e,t)=>e in r?GM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,gi=(r,e,t)=>(zM(r,typeof e!="symbol"?e+"":e,t),t);const Xx=class qx extends _e{constructor(e){e={...qx.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:DM,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:UM,name:"drop-shadow-filter"});super({gpuProgram:t,glProgram:n,resources:{dropShadowUniforms:{uAlpha:{value:e.alpha,type:"f32"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uOffset:{value:e.offset,type:"vec2<f32>"}}},resolution:e.resolution}),gi(this,"uniforms"),gi(this,"shadowOnly",!1),gi(this,"_color"),gi(this,"_blurFilter"),gi(this,"_basePass"),this.uniforms=this.resources.dropShadowUniforms.uniforms,this._color=new pe,this.color=e.color??0,this._blurFilter=new Mx({strength:e.kernels??e.blur,quality:e.kernels?void 0:e.quality}),this._basePass=new _e({gpuProgram:me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:`
                    @group(0) @binding(1) var uTexture: texture_2d<f32>; 
                    @group(0) @binding(2) var uSampler: sampler;
                    @fragment
                    fn mainFragment(
                        @builtin(position) position: vec4<f32>,
                        @location(0) uv : vec2<f32>
                    ) -> @location(0) vec4<f32> {
                        return textureSample(uTexture, uSampler, uv);
                    }
                    `,entryPoint:"mainFragment"}}),glProgram:be.from({vertex:Be,fragment:`
                in vec2 vTextureCoord;
                out vec4 finalColor;
                uniform sampler2D uTexture;

                void main(void){
                    finalColor = texture(uTexture, vTextureCoord);
                }
                `,name:"drop-shadow-filter"}),resources:{}}),Object.assign(this,e)}apply(e,t,n,i){const s=Ge.getSameSizeTexture(t);e.applyFilter(this,t,s,!0),this._blurFilter.apply(e,s,n,i),this.shadowOnly||e.applyFilter(this._basePass,t,n,!1),Ge.returnTexture(s)}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e,this._updatePadding()}get offsetX(){return this.offset.x}set offsetX(e){this.offset.x=e,this._updatePadding()}get offsetY(){return this.offset.y}set offsetY(e){this.offset.y=e,this._updatePadding()}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,n,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=n,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get blur(){return this._blurFilter.strength}set blur(e){this._blurFilter.strength=e,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e,this._updatePadding()}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){typeof e=="number"&&(e={x:e,y:e}),Array.isArray(e)&&(e={x:e[0],y:e[1]}),this._blurFilter.pixelSize=e}get pixelSizeX(){return this._blurFilter.pixelSizeX}set pixelSizeX(e){this._blurFilter.pixelSizeX=e}get pixelSizeY(){return this._blurFilter.pixelSizeY}set pixelSizeY(e){this._blurFilter.pixelSizeY=e}_updatePadding(){const e=Math.max(Math.abs(this.offsetX),Math.abs(this.offsetY));this.padding=e+this.blur*2+this.quality*4}};gi(Xx,"DEFAULT_OPTIONS",{offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:void 0,blur:2,quality:3,pixelSize:{x:1,y:1},resolution:1});let Yx=Xx;var LM=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uDisplacementMap;
uniform float uSeed;
uniform vec2 uDimensions;
uniform float uAspect;
uniform float uFillMode;
uniform float uOffset;
uniform float uDirection;
uniform vec2 uRed;
uniform vec2 uGreen;
uniform vec2 uBlue;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * uInputSize.xy) / uDimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float sinDir = sin(uDirection);
    float cosDir = cos(uDirection);

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * uAspect;
    float ny = (-sinDir * cx + cosDir * cy) / uAspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture(uDisplacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (uOffset / uInputSize.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * uAspect);

    int fillMode = int(uFillMode);

    if (fillMode == CLAMP) {
        coord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    } else {
        if( coord.x > uInputClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= uInputClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = uInputClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < uInputClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += uInputClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -uInputClamp.z;
            }
        }

        if( coord.y > uInputClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= uInputClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = uInputClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < uInputClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += uInputClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -uInputClamp.w;
            }
        }
    }

    finalColor.r = texture(uTexture, coord + uRed * (1.0 - uSeed * 0.4) / uInputSize.xy).r;
    finalColor.g = texture(uTexture, coord + uGreen * (1.0 - uSeed * 0.3) / uInputSize.xy).g;
    finalColor.b = texture(uTexture, coord + uBlue * (1.0 - uSeed * 0.2) / uInputSize.xy).b;
    finalColor.a = texture(uTexture, coord).a;
}
`,NM=`struct GlitchUniforms {
  uSeed: f32,
  uDimensions: vec2<f32>,
  uAspect: f32,
  uFillMode: f32,
  uOffset: f32,
  uDirection: f32,
  uRed: vec2<f32>,
  uGreen: vec2<f32>,
  uBlue: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> glitchUniforms : GlitchUniforms;
@group(1) @binding(1) var uDisplacementMap: texture_2d<f32>; 
@group(1) @binding(2) var uDisplacementSampler: sampler; 

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uSeed: f32 = glitchUniforms.uSeed;
  let uDimensions: vec2<f32> = glitchUniforms.uDimensions;
  let uAspect: f32 = glitchUniforms.uAspect;
  let uOffset: f32 = glitchUniforms.uOffset;
  let uDirection: f32 = glitchUniforms.uDirection;
  let uRed: vec2<f32> = glitchUniforms.uRed;
  let uGreen: vec2<f32> = glitchUniforms.uGreen;
  let uBlue: vec2<f32> = glitchUniforms.uBlue;

  let uInputSize: vec4<f32> = gfu.uInputSize;
  let uInputClamp: vec4<f32> = gfu.uInputClamp;

  var discarded: bool = false;
  var coord: vec2<f32> = (uv * uInputSize.xy) / uDimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
      discarded = true;
    }

    let sinDir: f32 = sin(uDirection);
    let cosDir: f32 = cos(uDirection);

    let cx: f32 = coord.x - 0.5;
    let cy: f32 = (coord.y - 0.5) * uAspect;
    var ny: f32 = (-sinDir * cx + cosDir * cy) / uAspect + 0.5;

    ny = select(select(ny, -ny, ny < 0.0), 2.0 - ny, ny > 1.0);

    let dc: vec4<f32> = textureSample(uDisplacementMap, uDisplacementSampler, vec2<f32>(0.5, ny));

    let displacement: f32 = (dc.r - dc.g) * (uOffset / uInputSize.x);

    coord = uv + vec2<f32>(cosDir * displacement, sinDir * displacement * uAspect);

    let fillMode: i32 = i32(glitchUniforms.uFillMode);

    if (fillMode == CLAMP) {
      coord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    } else {
      if (coord.x > uInputClamp.z) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.x = coord.x - uInputClamp.z;
        } else if (fillMode == MIRROR) {
          coord.x = uInputClamp.z * 2.0 - coord.x;
        }
      } else if (coord.x < uInputClamp.x) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.x = coord.x + uInputClamp.z;
        } else if (fillMode == MIRROR) {
          coord.x = coord.x * -uInputClamp.z;
        }
      }

      if (coord.y > uInputClamp.w) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.y = coord.y - uInputClamp.w;
        } else if (fillMode == MIRROR) {
          coord.y = uInputClamp.w * 2.0 - coord.y;
        }
      } else if (coord.y < uInputClamp.y) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.y = coord.y + uInputClamp.w;
        } else if (fillMode == MIRROR) {
          coord.y = coord.y * -uInputClamp.w;
        }
      }
    }

    let seedR: f32 = 1.0 - uSeed * 0.4;
    let seedG: f32 = 1.0 - uSeed * 0.3;
    let seedB: f32 = 1.0 - uSeed * 0.2;

    let offsetR: vec2<f32> = vec2(uRed.x * seedR / uInputSize.x, uRed.y * seedR / uInputSize.y);
    let offsetG: vec2<f32> = vec2(uGreen.x * seedG / uInputSize.x, uGreen.y * seedG / uInputSize.y);
    let offsetB: vec2<f32> = vec2(uBlue.x * seedB / uInputSize.x, uBlue.y * seedB / uInputSize.y);

    let r = textureSample(uTexture, uSampler, coord + offsetR).r;
    let g = textureSample(uTexture, uSampler, coord + offsetG).g;
    let b = textureSample(uTexture, uSampler, coord + offsetB).b;
    let a = textureSample(uTexture, uSampler, coord).a;

    return select(vec4<f32>(r, g, b, a), vec4<f32>(0.0,0.0,0.0,0.0), discarded);
}

const TRANSPARENT: i32 = 0;
const ORIGINAL: i32 = 1;
const LOOP: i32 = 2;
const CLAMP: i32 = 3;
const MIRROR: i32 = 4;`,HM=Object.defineProperty,VM=(r,e,t)=>e in r?HM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Pr=(r,e,t)=>(VM(r,typeof e!="symbol"?e+"":e,t),t);const WM=class Kx extends _e{constructor(e){e={...Kx.defaults,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:NM,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:LM,name:"glitch-filter"}),i=document.createElement("canvas");i.width=4,i.height=e.sampleSize??512;const s=new te({source:new ei({resource:i})});super({gpuProgram:t,glProgram:n,resources:{glitchUniforms:{uSeed:{value:e?.seed??0,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"},uAspect:{value:1,type:"f32"},uFillMode:{value:e?.fillMode??0,type:"f32"},uOffset:{value:e?.offset??100,type:"f32"},uDirection:{value:e?.direction??0,type:"f32"},uRed:{value:e.red,type:"vec2<f32>"},uGreen:{value:e.green,type:"vec2<f32>"},uBlue:{value:e.blue,type:"vec2<f32>"}},uDisplacementMap:s.source,uDisplacementSampler:s.source.style}}),Pr(this,"uniforms"),Pr(this,"average",!1),Pr(this,"minSize",8),Pr(this,"sampleSize",512),Pr(this,"_canvas"),Pr(this,"texture"),Pr(this,"_slices",0),Pr(this,"_sizes",new Float32Array(1)),Pr(this,"_offsets",new Float32Array(1)),this.uniforms=this.resources.glitchUniforms.uniforms,this._canvas=i,this.texture=s,Object.assign(this,e)}apply(e,t,n,i){const{width:s,height:o}=t.frame;this.uniforms.uDimensions[0]=s,this.uniforms.uDimensions[1]=o,this.uniforms.uAspect=o/s,e.applyFilter(this,t,n,i)}_randomizeSizes(){const e=this._sizes,t=this._slices-1,n=this.sampleSize,i=Math.min(this.minSize/n,.9/this._slices);if(this.average){const s=this._slices;let o=1;for(let a=0;a<t;a++){const l=o/(s-a),u=Math.max(l*(1-Math.random()*.6),i);e[a]=u,o-=u}e[t]=o}else{let s=1;const o=Math.sqrt(1/this._slices);for(let a=0;a<t;a++){const l=Math.max(o*s*Math.random(),i);e[a]=l,s-=l}e[t]=s}this.shuffle()}shuffle(){const e=this._sizes,t=this._slices-1;for(let n=t;n>0;n--){const i=Math.random()*n>>0,s=e[n];e[n]=e[i],e[i]=s}}_randomizeOffsets(){for(let e=0;e<this._slices;e++)this._offsets[e]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const e=this.sampleSize,t=this.texture,n=this._canvas.getContext("2d");n.clearRect(0,0,8,e);let i,s=0;for(let o=0;o<this._slices;o++){i=Math.floor(this._offsets[o]*256);const a=this._sizes[o]*e,l=i>0?i:0,u=i<0?-i:0;n.fillStyle=`rgba(${l}, ${u}, 0, 1)`,n.fillRect(0,s>>0,e,a+1>>0),s+=a}t.source.update()}set sizes(e){const t=Math.min(this._slices,e.length);for(let n=0;n<t;n++)this._sizes[n]=e[n]}get sizes(){return this._sizes}set offsets(e){const t=Math.min(this._slices,e.length);for(let n=0;n<t;n++)this._offsets[n]=e[n]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(e){this._slices!==e&&(this._slices=e,this._sizes=new Float32Array(e),this._offsets=new Float32Array(e),this.refresh())}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}get fillMode(){return this.uniforms.uFillMode}set fillMode(e){this.uniforms.uFillMode=e}get direction(){return this.uniforms.uDirection/Ni}set direction(e){this.uniforms.uDirection=e*Ni}get red(){return this.uniforms.uRed}set red(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uRed=e}get green(){return this.uniforms.uGreen}set green(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uGreen=e}get blue(){return this.uniforms.uBlue}set blue(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uBlue=e}destroy(){this.texture?.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};Pr(WM,"defaults",{slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:{x:0,y:0},green:{x:0,y:0},blue:{x:0,y:0},minSize:8,sampleSize:512});var jM=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uStrength;
uniform vec3 uColor;
uniform float uKnockout;
uniform float uAlpha;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

const float PI = 3.14159265358979323846264;

// Hard-assignment of DIST and ANGLE_STEP_SIZE instead of using uDistance and uQuality to allow them to be use on GLSL loop conditions
const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.);
const float ANGLE_STEP_NUM = ceil(PI * 2. / ANGLE_STEP_SIZE);
const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.) / 2.;

void main(void) {
    vec2 px = vec2(1.) / uInputSize.xy;

    float totalAlpha = 0.;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.; angle < PI * 2.; angle += ANGLE_STEP_SIZE) {
      direction = vec2(cos(angle), sin(angle)) * px;

      for (float curDistance = 0.; curDistance < DIST; curDistance++) {
          displaced = clamp(vTextureCoord + direction * (curDistance + 1.), uInputClamp.xy, uInputClamp.zw);
          curColor = texture(uTexture, displaced);
          totalAlpha += (DIST - curDistance) * curColor.a;
      }
    }
    
    curColor = texture(uTexture, vTextureCoord);

    vec4 glowColor = vec4(uColor, uAlpha);
    bool knockout = uKnockout > .5;
    float innerStrength = uStrength[0];
    float outerStrength = uStrength[1];

    float alphaRatio = totalAlpha / MAX_TOTAL_ALPHA;
    float innerGlowAlpha = (1. - alphaRatio) * innerStrength * curColor.a * uAlpha;
    float innerGlowStrength = min(1., innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);
    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a) * uAlpha;
    float outerGlowStrength = min(1. - innerColor.a, outerGlowAlpha);
    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;

    if (knockout) {
      float resultAlpha = outerGlowAlpha + innerGlowAlpha;
      finalColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      finalColor = innerColor + outerGlowColor;
    }
}
`,XM=`struct GlowUniforms {
  uDistance: f32,
  uStrength: vec2<f32>,
  uColor: vec3<f32>,
  uAlpha: f32,
  uQuality: f32,
  uKnockout: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> glowUniforms : GlowUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let quality = glowUniforms.uQuality;
  let distance = glowUniforms.uDistance;

  let dist: f32 = glowUniforms.uDistance;
  let angleStepSize: f32 = min(1. / quality / distance, PI * 2.0);
  let angleStepNum: f32 = ceil(PI * 2.0 / angleStepSize);

  let px: vec2<f32> = vec2<f32>(1.0 / gfu.uInputSize.xy);

  var totalAlpha: f32 = 0.0;

  var direction: vec2<f32>;
  var displaced: vec2<f32>;
  var curColor: vec4<f32>;

  for (var angle = 0.0; angle < PI * 2.0; angle += angleStepSize) {
    direction = vec2<f32>(cos(angle), sin(angle)) * px;
    for (var curDistance = 0.0; curDistance < dist; curDistance+=1) {
      displaced = vec2<f32>(clamp(uv + direction * (curDistance + 1.0), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
      curColor = textureSample(uTexture, uSampler, displaced);
      totalAlpha += (dist - curDistance) * curColor.a;
    }
  }
    
  curColor = textureSample(uTexture, uSampler, uv);

  let glowColorRGB = glowUniforms.uColor;
  let glowAlpha = glowUniforms.uAlpha;
  let glowColor = vec4<f32>(glowColorRGB, glowAlpha);
  let knockout: bool = glowUniforms.uKnockout > 0.5;
  let innerStrength = glowUniforms.uStrength[0];
  let outerStrength = glowUniforms.uStrength[1];

  let alphaRatio: f32 = (totalAlpha / (angleStepNum * dist * (dist + 1.0) / 2.0));
  let innerGlowAlpha: f32 = (1.0 - alphaRatio) * innerStrength * curColor.a * glowAlpha;
  let innerGlowStrength: f32 = min(1.0, innerGlowAlpha);
  
  let innerColor: vec4<f32> = mix(curColor, glowColor, innerGlowStrength);
  let outerGlowAlpha: f32 = alphaRatio * outerStrength * (1. - curColor.a) * glowAlpha;
  let outerGlowStrength: f32 = min(1.0 - innerColor.a, outerGlowAlpha);
  let outerGlowColor: vec4<f32> = outerGlowStrength * glowColor.rgba;
  
  if (knockout) {
    let resultAlpha: f32 = outerGlowAlpha + innerGlowAlpha;
    return vec4<f32>(glowColor.rgb * resultAlpha, resultAlpha);
  }
  else {
    return innerColor + outerGlowColor;
  }
}

const PI: f32 = 3.14159265358979323846264;`,qM=Object.defineProperty,YM=(r,e,t)=>e in r?qM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ic=(r,e,t)=>(YM(r,typeof e!="symbol"?e+"":e,t),t);const KM=class $x extends _e{constructor(e){e={...$x.DEFAULT_OPTIONS,...e};const t=e.distance??10,n=e.quality??.1,i=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:XM,entryPoint:"mainFragment"}}),s=be.from({vertex:Be,fragment:jM.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/n/t).toFixed(7)}`).replace(/__DIST__/gi,`${t.toFixed(0)}.0`),name:"glow-filter"});super({gpuProgram:i,glProgram:s,resources:{glowUniforms:{uDistance:{value:t,type:"f32"},uStrength:{value:[e.innerStrength,e.outerStrength],type:"vec2<f32>"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:e.alpha,type:"f32"},uQuality:{value:n,type:"f32"},uKnockout:{value:e?.knockout??!1?1:0,type:"f32"}}},padding:t}),ic(this,"uniforms"),ic(this,"_color"),this.uniforms=this.resources.glowUniforms.uniforms,this._color=new pe,this.color=e.color??16777215}get distance(){return this.uniforms.uDistance}set distance(e){this.uniforms.uDistance=this.padding=e}get innerStrength(){return this.uniforms.uStrength[0]}set innerStrength(e){this.uniforms.uStrength[0]=e}get outerStrength(){return this.uniforms.uStrength[1]}set outerStrength(e){this.uniforms.uStrength[1]=e}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,n,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=n,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get quality(){return this.uniforms.uQuality}set quality(e){this.uniforms.uQuality=e}get knockout(){return this.uniforms.uKnockout===1}set knockout(e){this.uniforms.uKnockout=e?1:0}};ic(KM,"DEFAULT_OPTIONS",{distance:10,outerStrength:4,innerStrength:0,color:16777215,alpha:1,quality:.1,knockout:!1});var $M=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uDimensions;
uniform float uParallel;
uniform vec2 uLight;
uniform float uAspect;
uniform float uTime;
uniform vec3 uRay;

uniform vec4 uInputSize;

\${PERLIN}

void main(void) {
    vec2 uDimensions = uDimensions;
    bool uParallel = uParallel > 0.5;
    vec2 uLight = uLight;
    float uAspect = uAspect;

    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions;

    float d;

    if (uParallel) {
        float _cos = uLight.x;
        float _sin = uLight.y;
        d = (_cos * coord.x) + (_sin * coord.y * uAspect);
    } else {
        float dx = coord.x - uLight.x / uDimensions.x;
        float dy = (coord.y - uLight.y / uDimensions.y) * uAspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    float uTime = uTime;
    vec3 uRay = uRay;

    float gain = uRay[0];
    float lacunarity = uRay[1];
    float alpha = uRay[2];

    vec3 dir = vec3(d, d, 0.0);
    float noise = turb(dir + vec3(uTime, 0.0, 62.1 + uTime) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(vec3(noise), 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    finalColor = texture(uTexture, vTextureCoord) + mist;
}
`,ZM=`struct GodrayUniforms {
  uLight: vec2<f32>,
  uParallel: f32,
  uAspect: f32,
  uTime: f32,
  uRay: vec3<f32>,
  uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> godrayUniforms : GodrayUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uDimensions: vec2<f32> = godrayUniforms.uDimensions;
  let uParallel: bool = godrayUniforms.uParallel > 0.5;
  let uLight: vec2<f32> = godrayUniforms.uLight;
  let uAspect: f32 = godrayUniforms.uAspect;

  let coord: vec2<f32> = uv * gfu.uInputSize.xy / uDimensions;

  var d: f32;

  if (uParallel) {
    let _cos: f32 = uLight.x;
    let _sin: f32 = uLight.y;
    d = (_cos * coord.x) + (_sin * coord.y * uAspect);
  } else {
    let dx: f32 = coord.x - uLight.x / uDimensions.x;
    let dy: f32 = (coord.y - uLight.y / uDimensions.y) * uAspect;
    let dis: f32 = sqrt(dx * dx + dy * dy) + 0.00001;
    d = dy / dis;
  }

  let uTime: f32 = godrayUniforms.uTime;
  let uRay: vec3<f32> = godrayUniforms.uRay;
  
  let gain = uRay[0];
  let lacunarity = uRay[1];
  let alpha = uRay[2];

  let dir: vec3<f32> = vec3<f32>(d, d, 0.0);
  var noise: f32 = turb(dir + vec3<f32>(uTime, 0.0, 62.1 + uTime) * 0.05, vec3<f32>(480.0, 320.0, 480.0), lacunarity, gain);
  noise = mix(noise, 0.0, 0.3);
  //fade vertically.
  var mist: vec4<f32> = vec4<f32>(vec3<f32>(noise), 1.0) * (1.0 - coord.y);
  mist.a = 1.0;
  // apply user alpha
  mist *= alpha;
  return textureSample(uTexture, uSampler, uv) + mist;
}

\${PERLIN}`,QM=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,JM=`// Taken from https://gist.github.com/munrocket/236ed5ba7e409b8bdf1ff6eca5dcdc39

fn moduloVec3(x: vec3<f32>, y: vec3<f32>) -> vec3<f32>
{
  return x - y * floor(x/y);
}
fn mod289Vec3(x: vec3<f32>) -> vec3<f32>
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
fn mod289Vec4(x: vec4<f32>) -> vec4<f32>
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
fn permute4(x: vec4<f32>) -> vec4<f32>
{
    return mod289Vec4(((x * 34.0) + 1.0) * x);
}
fn taylorInvSqrt(r: vec4<f32>) -> vec4<f32>
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
fn fade3(t: vec3<f32>) -> vec3<f32>
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
fn fade2(t: vec2<f32>) -> vec2<f32> { return t * t * t * (t * (t * 6. - 15.) + 10.); }

fn perlinNoise2(P: vec2<f32>) -> f32 {
  var Pi: vec4<f32> = floor(P.xyxy) + vec4<f32>(0., 0., 1., 1.);
  let Pf = fract(P.xyxy) - vec4<f32>(0., 0., 1., 1.);
  Pi = Pi % vec4<f32>(289.); // To avoid truncation effects in permutation
  let ix = Pi.xzxz;
  let iy = Pi.yyww;
  let fx = Pf.xzxz;
  let fy = Pf.yyww;
  let i = permute4(permute4(ix) + iy);
  var gx: vec4<f32> = 2. * fract(i * 0.0243902439) - 1.; // 1/41 = 0.024...
  let gy = abs(gx) - 0.5;
  let tx = floor(gx + 0.5);
  gx = gx - tx;
  var g00: vec2<f32> = vec2<f32>(gx.x, gy.x);
  var g10: vec2<f32> = vec2<f32>(gx.y, gy.y);
  var g01: vec2<f32> = vec2<f32>(gx.z, gy.z);
  var g11: vec2<f32> = vec2<f32>(gx.w, gy.w);
  let norm = 1.79284291400159 - 0.85373472095314 *
      vec4<f32>(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11));
  g00 = g00 * norm.x;
  g01 = g01 * norm.y;
  g10 = g10 * norm.z;
  g11 = g11 * norm.w;
  let n00 = dot(g00, vec2<f32>(fx.x, fy.x));
  let n10 = dot(g10, vec2<f32>(fx.y, fy.y));
  let n01 = dot(g01, vec2<f32>(fx.z, fy.z));
  let n11 = dot(g11, vec2<f32>(fx.w, fy.w));
  let fade_xy = fade2(Pf.xy);
  let n_x = mix(vec2<f32>(n00, n01), vec2<f32>(n10, n11), vec2<f32>(fade_xy.x));
  let n_xy = mix(n_x.x, n_x.y, fade_xy.y);
  return 2.3 * n_xy;
}

// Classic Perlin noise, periodic variant
fn perlinNoise3(P: vec3<f32>, rep: vec3<f32>) -> f32
{
    var Pi0: vec3<f32> = moduloVec3(floor(P), rep); // Integer part, modulo period
    var Pi1: vec3<f32> = moduloVec3(Pi0 + vec3<f32>(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289Vec3(Pi0);
    Pi1 = mod289Vec3(Pi1);
    let Pf0: vec3<f32> = fract(P); // Fractional part for interpolation
    let Pf1: vec3<f32> = Pf0 - vec3<f32>(1.0); // Fractional part - 1.0
    let ix: vec4<f32> = vec4<f32>(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    let iy: vec4<f32> = vec4<f32>(Pi0.yy, Pi1.yy);
    let iz0: vec4<f32> = Pi0.zzzz;
    let iz1: vec4<f32> = Pi1.zzzz;
    let ixy: vec4<f32> = permute4(permute4(ix) + iy);
    let ixy0: vec4<f32> = permute4(ixy + iz0);
    let ixy1: vec4<f32> = permute4(ixy + iz1);
    var gx0: vec4<f32> = ixy0 * (1.0 / 7.0);
    var gy0: vec4<f32> = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    let gz0: vec4<f32> = vec4<f32>(0.5) - abs(gx0) - abs(gy0);
    let sz0: vec4<f32> = step(gz0, vec4<f32>(0.0));
    gx0 -= sz0 * (step(vec4<f32>(0.0), gx0) - 0.5);
    gy0 -= sz0 * (step(vec4<f32>(0.0), gy0) - 0.5);
    var gx1: vec4<f32> = ixy1 * (1.0 / 7.0);
    var gy1: vec4<f32> = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    let gz1: vec4<f32> = vec4<f32>(0.5) - abs(gx1) - abs(gy1);
    let sz1: vec4<f32> = step(gz1, vec4<f32>(0.0));
    gx1 -= sz1 * (step(vec4<f32>(0.0), gx1) - 0.5);
    gy1 -= sz1 * (step(vec4<f32>(0.0), gy1) - 0.5);
    var g000: vec3<f32> = vec3<f32>(gx0.x, gy0.x, gz0.x);
    var g100: vec3<f32> = vec3<f32>(gx0.y, gy0.y, gz0.y);
    var g010: vec3<f32> = vec3<f32>(gx0.z, gy0.z, gz0.z);
    var g110: vec3<f32> = vec3<f32>(gx0.w, gy0.w, gz0.w);
    var g001: vec3<f32> = vec3<f32>(gx1.x, gy1.x, gz1.x);
    var g101: vec3<f32> = vec3<f32>(gx1.y, gy1.y, gz1.y);
    var g011: vec3<f32> = vec3<f32>(gx1.z, gy1.z, gz1.z);
    var g111: vec3<f32> = vec3<f32>(gx1.w, gy1.w, gz1.w);
    let norm0: vec4<f32> = taylorInvSqrt(vec4<f32>(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    let norm1: vec4<f32> = taylorInvSqrt(vec4<f32>(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    let n000: f32 = dot(g000, Pf0);
    let n100: f32 = dot(g100, vec3<f32>(Pf1.x, Pf0.yz));
    let n010: f32 = dot(g010, vec3<f32>(Pf0.x, Pf1.y, Pf0.z));
    let n110: f32 = dot(g110, vec3<f32>(Pf1.xy, Pf0.z));
    let n001: f32 = dot(g001, vec3<f32>(Pf0.xy, Pf1.z));
    let n101: f32 = dot(g101, vec3<f32>(Pf1.x, Pf0.y, Pf1.z));
    let n011: f32 = dot(g011, vec3<f32>(Pf0.x, Pf1.yz));
    let n111: f32 = dot(g111, Pf1);
    let fade_xyz: vec3<f32> = fade3(Pf0);
    let n_z: vec4<f32> = mix(vec4<f32>(n000, n100, n010, n110), vec4<f32>(n001, n101, n011, n111), fade_xyz.z);
    let n_yz: vec2<f32> = mix(n_z.xy, n_z.zw, fade_xyz.y);
    let n_xyz: f32 = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
fn turb(P: vec3<f32>, rep: vec3<f32>, lacunarity: f32, gain: f32) -> f32
{
    var sum: f32 = 0.0;
    var sc: f32 = 1.0;
    var totalgain: f32 = 1.0;
    for (var i = 0.0; i < 6.0; i += 1)
    {
        sum += totalgain * perlinNoise3(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}`,eR=Object.defineProperty,tR=(r,e,t)=>e in r?eR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,vi=(r,e,t)=>(tR(r,typeof e!="symbol"?e+"":e,t),t);const rR=class Zx extends _e{constructor(e){e={...Zx.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:ZM.replace("${PERLIN}",JM),entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:$M.replace("${PERLIN}",QM),name:"god-ray-filter"});super({gpuProgram:t,glProgram:n,resources:{godrayUniforms:{uLight:{value:new Float32Array(2),type:"vec2<f32>"},uParallel:{value:0,type:"f32"},uAspect:{value:0,type:"f32"},uTime:{value:e.time,type:"f32"},uRay:{value:new Float32Array(3),type:"vec3<f32>"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),vi(this,"uniforms"),vi(this,"time",0),vi(this,"_angleLight",[0,0]),vi(this,"_angle",0),vi(this,"_center"),this.uniforms=this.resources.godrayUniforms.uniforms,Object.assign(this,e)}apply(e,t,n,i){const s=t.frame.width,o=t.frame.height;this.uniforms.uLight[0]=this.parallel?this._angleLight[0]:this._center.x,this.uniforms.uLight[1]=this.parallel?this._angleLight[1]:this._center.y,this.uniforms.uDimensions[0]=s,this.uniforms.uDimensions[1]=o,this.uniforms.uAspect=o/s,this.uniforms.uTime=this.time,e.applyFilter(this,t,n,i)}get angle(){return this._angle}set angle(e){this._angle=e;const t=e*Ni;this._angleLight[0]=Math.cos(t),this._angleLight[1]=Math.sin(t)}get parallel(){return this.uniforms.uParallel>.5}set parallel(e){this.uniforms.uParallel=e?1:0}get center(){return this._center}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this._center=e}get centerX(){return this.center.x}set centerX(e){this.center.x=e}get centerY(){return this.center.y}set centerY(e){this.center.y=e}get gain(){return this.uniforms.uRay[0]}set gain(e){this.uniforms.uRay[0]=e}get lacunarity(){return this.uniforms.uRay[1]}set lacunarity(e){this.uniforms.uRay[1]=e}get alpha(){return this.uniforms.uRay[2]}set alpha(e){this.uniforms.uRay[2]=e}};vi(rR,"DEFAULT_OPTIONS",{angle:30,gain:.5,lacunarity:2.5,parallel:!0,time:0,center:{x:0,y:0},alpha:1});var nR=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uHsl;
uniform float uAlpha;
uniform float uColorize;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

float getWeightedAverage(vec3 rgb) {
    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const vec3 k = vec3(0.57735, 0.57735, 0.57735);

vec3 hueShift(vec3 color, float angle) {
    float cosAngle = cos(angle);
    return vec3(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}

void main()
{
    vec4 color = texture(uTexture, vTextureCoord);
    vec3 resultRGB = color.rgb;

    float hue = uHsl[0];
    float saturation = uHsl[1];
    float lightness = uHsl[2];

    // colorize
    if (uColorize > 0.5) {
        resultRGB = vec3(getWeightedAverage(resultRGB), 0., 0.);
    }

    // hue
    resultRGB = hueShift(resultRGB, hue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    float average = (resultRGB.r + resultRGB.g + resultRGB.b) / 3.0;

    if (saturation > 0.) {
        resultRGB += (average - resultRGB) * (1. - 1. / (1.001 - saturation));
    } else {
        resultRGB -= (average - resultRGB) * saturation;
    }

    // lightness
    resultRGB = mix(resultRGB, vec3(ceil(lightness)) * color.a, abs(lightness));

    // alpha
    finalColor = mix(color, vec4(resultRGB, color.a), uAlpha);
}
`,iR=`struct HslUniforms {
  uHsl:vec3<f32>,
  uColorize:f32,
  uAlpha:f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> hslUniforms : HslUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
    let color: vec4<f32> = textureSample(uTexture, uSampler, uv);
    var resultRGB: vec3<f32> = color.rgb;

    let hue: f32 = hslUniforms.uHsl[0];
    let saturation: f32 = hslUniforms.uHsl[1];
    let lightness: f32 = hslUniforms.uHsl[2];

    // colorize
    if (hslUniforms.uColorize > 0.5) {
        resultRGB = vec3<f32>(dot(color.rgb, vec3<f32>(0.299, 0.587, 0.114)), 0., 0.);
    }

    // hue
    resultRGB = hueShift(resultRGB, hue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    let average: f32 = (resultRGB.r + resultRGB.g + resultRGB.b) / 3.0;

    if (saturation > 0.) {
        resultRGB += (average - resultRGB) * (1. - 1. / (1.001 - saturation));
    } else {
        resultRGB -= (average - resultRGB) * saturation;
    }

    // lightness
    resultRGB = mix(resultRGB, vec3<f32>(ceil(lightness)) * color.a, abs(lightness));

    // alpha
    return mix(color, vec4<f32>(resultRGB, color.a), hslUniforms.uAlpha);
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const k: vec3<f32> = vec3(0.57735, 0.57735, 0.57735);

fn hueShift(color: vec3<f32>, angle: f32) -> vec3<f32> 
{
    let cosAngle: f32 = cos(angle);
    return vec3<f32>(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}`,sR=Object.defineProperty,oR=(r,e,t)=>e in r?sR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,sc=(r,e,t)=>(oR(r,typeof e!="symbol"?e+"":e,t),t);const aR=class Qx extends _e{constructor(e){e={...Qx.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:iR,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:nR,name:"hsl-adjustment-filter"});super({gpuProgram:t,glProgram:n,resources:{hslUniforms:{uHsl:{value:new Float32Array(3),type:"vec3<f32>"},uColorize:{value:e.colorize?1:0,type:"f32"},uAlpha:{value:e.alpha,type:"f32"}}}}),sc(this,"uniforms"),sc(this,"_hue"),this.uniforms=this.resources.hslUniforms.uniforms,Object.assign(this,e)}get hue(){return this._hue}set hue(e){this._hue=e,this.uniforms.uHsl[0]=e*(Math.PI/180)}get saturation(){return this.uniforms.uHsl[1]}set saturation(e){this.uniforms.uHsl[1]=e}get lightness(){return this.uniforms.uHsl[2]}set lightness(e){this.uniforms.uHsl[2]=e}get colorize(){return this.uniforms.uColorize===1}set colorize(e){this.uniforms.uColorize=e?1:0}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}};sc(aR,"DEFAULT_OPTIONS",{hue:0,saturation:0,lightness:0,colorize:!1,alpha:1});var lR=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uVelocity;
uniform int uKernelSize;
uniform float uOffset;

uniform vec4 uInputSize;

const int MAX_KERNEL_SIZE = 2048;

// Notice:
// the perfect way:
//    int kernelSize = min(uKernelSize, MAX_KERNELSIZE);
// BUT in real use-case , uKernelSize < MAX_KERNELSIZE almost always.
// So use uKernelSize directly.

void main(void)
{
    vec4 color = texture(uTexture, vTextureCoord);

    if (uKernelSize == 0)
    {
        finalColor = color;
        return;
    }

    vec2 velocity = uVelocity / uInputSize.xy;
    float offset = -uOffset / length(uVelocity) - 0.5;
    int k = uKernelSize - 1;

    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {
        if (i == k) {
            break;
        }
        vec2 bias = velocity * (float(i) / float(k) + offset);
        color += texture(uTexture, vTextureCoord + bias);
    }
    finalColor = color / float(uKernelSize);
}
`,uR=`struct MotionBlurUniforms {
  uVelocity: vec2<f32>,
  uKernelSize: f32,
  uOffset: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> motionBlurUniforms : MotionBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uVelocity = motionBlurUniforms.uVelocity;
  let uKernelSize = motionBlurUniforms.uKernelSize;
  let uOffset = motionBlurUniforms.uOffset;

  let velocity: vec2<f32> = uVelocity / gfu.uInputSize.xy;
  let offset: f32 = -uOffset / length(uVelocity) - 0.5;
  let k: i32 = i32(min(uKernelSize - 1, MAX_KERNEL_SIZE - 1));

  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  for(var i: i32 = 0; i < k; i += 1) {
    let bias: vec2<f32> = velocity * (f32(i) / f32(k) + offset);
    color += textureSample(uTexture, uSampler, uv + bias);
  }
  
  return select(color / f32(uKernelSize), textureSample(uTexture, uSampler, uv), uKernelSize == 0);
}

const MAX_KERNEL_SIZE: f32 = 2048;`,cR=Object.defineProperty,dR=(r,e,t)=>e in r?cR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,oc=(r,e,t)=>(dR(r,typeof e!="symbol"?e+"":e,t),t);const hR=class Jx extends _e{constructor(...e){let t=e[0]??{};if(Array.isArray(t)||"x"in t&&"y"in t||t instanceof yt){J("6.0.0","MotionBlurFilter constructor params are now options object. See params: { velocity, kernelSize, offset }");const s="x"in t?t.x:t[0],o="y"in t?t.y:t[1];t={velocity:{x:s,y:o}},e[1]!==void 0&&(t.kernelSize=e[1]),e[2]!==void 0&&(t.offset=e[2])}t={...Jx.DEFAULT_OPTIONS,...t};const n=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:uR,entryPoint:"mainFragment"}}),i=be.from({vertex:Be,fragment:lR,name:"motion-blur-filter"});super({gpuProgram:n,glProgram:i,resources:{motionBlurUniforms:{uVelocity:{value:t.velocity,type:"vec2<f32>"},uKernelSize:{value:Math.trunc(t.kernelSize??5),type:"i32"},uOffset:{value:t.offset,type:"f32"}}}}),oc(this,"uniforms"),oc(this,"_kernelSize"),this.uniforms=this.resources.motionBlurUniforms.uniforms,Object.assign(this,t)}get velocity(){return this.uniforms.uVelocity}set velocity(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uVelocity=e,this._updateDirty()}get velocityX(){return this.velocity.x}set velocityX(e){this.velocity.x=e,this._updateDirty()}get velocityY(){return this.velocity.y}set velocityY(e){this.velocity.y=e,this._updateDirty()}get kernelSize(){return this._kernelSize}set kernelSize(e){this._kernelSize=e,this._updateDirty()}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e}_updateDirty(){this.padding=(Math.max(Math.abs(this.velocityX),Math.abs(this.velocityY))>>0)+1,this.uniforms.uKernelSize=this.velocityX!==0||this.velocityY!==0?this._kernelSize:0}};oc(hR,"DEFAULT_OPTIONS",{velocity:{x:0,y:0},kernelSize:5,offset:0});var fR=`in vec2 vTextureCoord;
out vec4 finalColor;

const int MAX_COLORS = \${MAX_COLORS};

uniform sampler2D uTexture;
uniform vec3 uOriginalColors[MAX_COLORS];
uniform vec3 uTargetColors[MAX_COLORS];
uniform float uTolerance;

void main(void)
{
    finalColor = texture(uTexture, vTextureCoord);

    float alpha = finalColor.a;
    if (alpha < 0.0001)
    {
      return;
    }

    vec3 color = finalColor.rgb / alpha;

    for(int i = 0; i < MAX_COLORS; i++)
    {
      vec3 origColor = uOriginalColors[i];
      if (origColor.r < 0.0)
      {
        break;
      }
      vec3 colorDiff = origColor - color;
      if (length(colorDiff) < uTolerance)
      {
        vec3 targetColor = uTargetColors[i];
        finalColor = vec4((targetColor + colorDiff) * alpha, alpha);
        return;
      }
    }
}
`,pR=`struct MultiColorReplaceUniforms {
  uOriginalColors: array<vec3<f32>, MAX_COLORS>,
  uTargetColors: array<vec3<f32>, MAX_COLORS>,
  uTolerance:f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> multiColorReplaceUniforms : MultiColorReplaceUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uOriginalColors = multiColorReplaceUniforms.uOriginalColors;
  let uTargetColors = multiColorReplaceUniforms.uTargetColors;
  let uTolerance = multiColorReplaceUniforms.uTolerance;

  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  let alpha: f32 = color.a;

  if (alpha > 0.0001)
  {
    var modColor: vec3<f32> = vec3<f32>(color.rgb) / alpha;

    for(var i: i32 = 0; i < MAX_COLORS; i += 1)
    {
      let origColor: vec3<f32> = uOriginalColors[i];
      if (origColor.r < 0.0)
      {
        break;
      }
      let colorDiff: vec3<f32> = origColor - modColor;
      
      if (length(colorDiff) < uTolerance)
      {
        let targetColor: vec3<f32> = uTargetColors[i];
        color = vec4((targetColor + colorDiff) * alpha, alpha);
        return color;
      }
    }
  }

  return color;
}

const MAX_COLORS: i32 = \${MAX_COLORS};`,mR=Object.defineProperty,gR=(r,e,t)=>e in r?mR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ta=(r,e,t)=>(gR(r,typeof e!="symbol"?e+"":e,t),t);const vR=class eb extends _e{constructor(...e){let t=e[0]??{};Array.isArray(t)&&(J("6.0.0","MultiColorReplaceFilter constructor params are now options object. See params: { replacements, tolerance, maxColors }"),t={replacements:t},e[1]&&(t.tolerance=e[1]),e[2]&&(t.maxColors=e[2])),t={...eb.DEFAULT_OPTIONS,...t};const n=t.maxColors??t.replacements.length,i=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:pR.replace(/\$\{MAX_COLORS\}/g,n.toFixed(0)),entryPoint:"mainFragment"}}),s=be.from({vertex:Be,fragment:fR.replace(/\$\{MAX_COLORS\}/g,n.toFixed(0)),name:"multi-color-replace-filter"});super({gpuProgram:i,glProgram:s,resources:{multiColorReplaceUniforms:{uOriginalColors:{value:new Float32Array(3*n),type:"vec3<f32>",size:n},uTargetColors:{value:new Float32Array(3*n),type:"vec3<f32>",size:n},uTolerance:{value:t.tolerance,type:"f32"}}}}),ta(this,"uniforms"),ta(this,"_replacements",[]),ta(this,"_maxColors"),this._maxColors=n,this.uniforms=this.resources.multiColorReplaceUniforms.uniforms,this.replacements=t.replacements}set replacements(e){const t=this.uniforms.uOriginalColors,n=this.uniforms.uTargetColors,i=e.length,s=new pe;if(i>this._maxColors)throw new Error(`Length of replacements (${i}) exceeds the maximum colors length (${this._maxColors})`);t[i*3]=-1;let o,a,l;for(let u=0;u<i;u++){const c=e[u];s.setValue(c[0]),[o,a,l]=s.toArray(),t[u*3]=o,t[u*3+1]=a,t[u*3+2]=l,s.setValue(c[1]),[o,a,l]=s.toArray(),n[u*3]=o,n[u*3+1]=a,n[u*3+2]=l}this._replacements=e}get replacements(){return this._replacements}refresh(){this.replacements=this._replacements}get maxColors(){return this._maxColors}get tolerance(){return this.uniforms.uTolerance}set tolerance(e){this.uniforms.uTolerance=e}set epsilon(e){J("6.0.0","MultiColorReplaceFilter.epsilon is deprecated, please use MultiColorReplaceFilter.tolerance instead"),this.tolerance=e}get epsilon(){return J("6.0.0","MultiColorReplaceFilter.epsilon is deprecated, please use MultiColorReplaceFilter.tolerance instead"),this.tolerance}};ta(vR,"DEFAULT_OPTIONS",{replacements:[[16711680,255]],tolerance:.05,maxColors:void 0});var xR=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uSepia;
uniform vec2 uNoise;
uniform vec3 uScratch;
uniform vec3 uVignetting;
uniform float uSeed;
uniform vec2 uDimensions;

uniform vec4 uInputSize;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    finalColor = texture(uTexture, vTextureCoord);
    vec3 color = finalColor.rgb;

    if (uSepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + uSepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions.xy;

    float vignette = uVignetting[0];
    float vignetteAlpha = uVignetting[1];
    float vignetteBlur = uVignetting[2];

    if (vignette > 0.0)
    {
        float outter = SQRT_2 - vignette * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= uDimensions.y / uDimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignetteBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignetteAlpha);
    }

    float scratch = uScratch[0];
    float scratchDensity = uScratch[1];
    float scratchWidth = uScratch[2];

    if (scratchDensity > uSeed && scratch != 0.0)
    {
        float phase = uSeed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(uSeed * dist, abs(s - uSeed * dist)));
        if (d < uSeed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / uDimensions.x * (0.75 + uSeed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    float noise = uNoise[0];
    float noiseSize = uNoise[1];

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * uInputSize.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + uSeed * 512.0, 1024.0 - uSeed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * uSeed) - 0.5;
        color += _noise * noise;
    }

    finalColor.rgb = color;
}`,bR=`struct OldFilmUniforms {
    uSepia: f32,
    uNoise: vec2<f32>,
    uScratch: vec3<f32>,
    uVignetting: vec3<f32>,
    uSeed: f32,
    uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> oldFilmUniforms : OldFilmUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  if (oldFilmUniforms.uSepia > 0.)
  {
    color = vec4<f32>(sepia(color.rgb), color.a);
  }

  let coord: vec2<f32> = uv * gfu.uInputSize.xy / oldFilmUniforms.uDimensions;

  if (oldFilmUniforms.uVignetting[0] > 0.)
  {
    color *= vec4<f32>(vec3<f32>(vignette(color.rgb, coord)), color.a);
  }

  let uScratch = oldFilmUniforms.uScratch; 

  if (uScratch[1] > oldFilmUniforms.uSeed && uScratch[0] != 0.)
  {
    color = vec4<f32>(scratch(color.rgb, coord), color.a);
  }

  let uNoise = oldFilmUniforms.uNoise;

  if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
  {
    color += vec4<f32>(vec3<f32>(noise(uv)), color.a);
  }

  return color;
}

const SQRT_2: f32 = 1.414213;
const SEPIA_RGB: vec3<f32> = vec3<f32>(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

fn rand(co: vec2<f32>) -> f32
{
  return fract(sin(dot(co, vec2<f32>(12.9898, 78.233))) * 43758.5453);
}

fn overlay(src: vec3<f32>, dst: vec3<f32>) -> vec3<f32>
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)

    return vec3<f32>(
      select((1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)), (2.0 * src.x * dst.x), (dst.x <= 0.5)), 
      select((1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)), (2.0 * src.y * dst.y), (dst.y <= 0.5)),
      select((1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)), (2.0 * src.z * dst.z), (dst.z <= 0.5))
    );
}

fn sepia(co: vec3<f32>) -> vec3<f32>
{
  let gray: f32 = (co.x + co.y + co.z) / 3.0;
  let grayscale: vec3<f32> = vec3<f32>(gray);
  let color = overlay(SEPIA_RGB, grayscale);
  return grayscale + oldFilmUniforms.uSepia * (color - grayscale);
}

fn vignette(co: vec3<f32>, coord: vec2<f32>) -> f32
{
  let uVignetting = oldFilmUniforms.uVignetting;
  let uDimensions = oldFilmUniforms.uDimensions;
  
  let outter: f32 = SQRT_2 - uVignetting[0] * SQRT_2;
  var dir: vec2<f32> = vec2<f32>(vec2<f32>(0.5) - coord);
  dir.y *= uDimensions.y / uDimensions.x;
  let darker: f32 = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignetting[2] * SQRT_2), 0.0, 1.0);
  return darker + (1.0 - darker) * (1.0 - uVignetting[1]);
}

fn scratch(co: vec3<f32>, coord: vec2<f32>) -> vec3<f32>
{
  var color = co;
  let uScratch = oldFilmUniforms.uScratch;
  let uSeed = oldFilmUniforms.uSeed;
  let uDimensions = oldFilmUniforms.uDimensions;

  let phase: f32 = uSeed * 256.0;
  let s: f32 = modulo(floor(phase), 2.0);
  let dist: f32 = 1.0 / uScratch[1];
  let d: f32 = distance(coord, vec2<f32>(uSeed * dist, abs(s - uSeed * dist)));

  if (d < uSeed * 0.6 + 0.4)
  {
    let period: f32 = uScratch[1] * 10.0;

    let xx: f32 = coord.x * period + phase;
    let aa: f32 = abs(modulo(xx, 0.5) * 4.0);
    let bb: f32 = modulo(floor(xx / 0.5), 2.0);
    let yy: f32 = (1.0 - bb) * aa + bb * (2.0 - aa);

    let kk: f32 = 2.0 * period;
    let dw: f32 = uScratch[2] / uDimensions.x * (0.75 + uSeed);
    let dh: f32 = dw * kk;

    var tine: f32 = (yy - (2.0 - dh));

    if (tine > 0.0) {
        let _sign: f32 = sign(uScratch[0]);

        tine = s * tine / period + uScratch[0] + 0.1;
        tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

        color *= tine;
    }
  }

  return color;
}

fn noise(coord: vec2<f32>) -> f32
{
  let uNoise = oldFilmUniforms.uNoise;
  let uSeed = oldFilmUniforms.uSeed;

  var pixelCoord: vec2<f32> = coord * gfu.uInputSize.xy;
  pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
  pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
  return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}`,_R=Object.defineProperty,yR=(r,e,t)=>e in r?_R(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ac=(r,e,t)=>(yR(r,typeof e!="symbol"?e+"":e,t),t);const tb=class rb extends _e{constructor(e){e={...rb.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:bR,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:xR,name:"old-film-filter"});super({gpuProgram:t,glProgram:n,resources:{oldFilmUniforms:{uSepia:{value:e.sepia,type:"f32"},uNoise:{value:new Float32Array(2),type:"vec2<f32>"},uScratch:{value:new Float32Array(3),type:"vec3<f32>"},uVignetting:{value:new Float32Array(3),type:"vec3<f32>"},uSeed:{value:e.seed,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),ac(this,"uniforms"),ac(this,"seed"),this.uniforms=this.resources.oldFilmUniforms.uniforms,Object.assign(this,e)}apply(e,t,n,i){this.uniforms.uDimensions[0]=t.frame.width,this.uniforms.uDimensions[1]=t.frame.height,this.uniforms.uSeed=this.seed,e.applyFilter(this,t,n,i)}get sepia(){return this.uniforms.uSepia}set sepia(e){this.uniforms.uSepia=e}get noise(){return this.uniforms.uNoise[0]}set noise(e){this.uniforms.uNoise[0]=e}get noiseSize(){return this.uniforms.uNoise[1]}set noiseSize(e){this.uniforms.uNoise[1]=e}get scratch(){return this.uniforms.uScratch[0]}set scratch(e){this.uniforms.uScratch[0]=e}get scratchDensity(){return this.uniforms.uScratch[1]}set scratchDensity(e){this.uniforms.uScratch[1]=e}get scratchWidth(){return this.uniforms.uScratch[2]}set scratchWidth(e){this.uniforms.uScratch[2]=e}get vignetting(){return this.uniforms.uVignetting[0]}set vignetting(e){this.uniforms.uVignetting[0]=e}get vignettingAlpha(){return this.uniforms.uVignetting[1]}set vignettingAlpha(e){this.uniforms.uVignetting[1]=e}get vignettingBlur(){return this.uniforms.uVignetting[2]}set vignettingBlur(e){this.uniforms.uVignetting[2]=e}};ac(tb,"DEFAULT_OPTIONS",{sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,seed:0});let SR=tb;var wR=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uThickness;
uniform vec3 uColor;
uniform float uAlpha;
uniform float uKnockout;

uniform vec4 uInputClamp;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${ANGLE_STEP};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture(uTexture, clamp(displacedPos, uInputClamp.xy, uInputClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture(uTexture, vTextureCoord);
    vec4 contentColor = sourceColor * float(uKnockout < 0.5);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    finalColor = contentColor + outlineColor;
}
`,TR=`struct OutlineUniforms {
  uThickness:vec2<f32>,
  uColor:vec3<f32>,
  uAlpha:f32,
  uAngleStep:f32,
  uKnockout:f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> outlineUniforms : OutlineUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let sourceColor: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let contentColor: vec4<f32> = sourceColor * (1. - outlineUniforms.uKnockout);
  
  let outlineAlpha: f32 = outlineUniforms.uAlpha * outlineMaxAlphaAtPos(uv) * (1. - sourceColor.a);
  let outlineColor: vec4<f32> = vec4<f32>(vec3<f32>(outlineUniforms.uColor) * outlineAlpha, outlineAlpha);
  
  return contentColor + outlineColor;
}

fn outlineMaxAlphaAtPos(uv: vec2<f32>) -> f32 {
  let thickness = outlineUniforms.uThickness;

  if (thickness.x == 0. || thickness.y == 0.) {
    return 0.;
  }
  
  let angleStep = outlineUniforms.uAngleStep;

  var displacedColor: vec4<f32>;
  var displacedPos: vec2<f32>;

  var maxAlpha: f32 = 0.;
  var displaced: vec2<f32>;
  var curColor: vec4<f32>;

  for (var angle = 0.; angle <= DOUBLE_PI; angle += angleStep)
  {
    displaced.x = uv.x + thickness.x * cos(angle);
    displaced.y = uv.y + thickness.y * sin(angle);
    curColor = textureSample(uTexture, uSampler, clamp(displaced, gfu.uInputClamp.xy, gfu.uInputClamp.zw));
    maxAlpha = max(maxAlpha, curColor.a);
  }

  return maxAlpha;
}

const DOUBLE_PI: f32 = 3.14159265358979323846264 * 2.;`,CR=Object.defineProperty,PR=(r,e,t)=>e in r?CR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Un=(r,e,t)=>(PR(r,typeof e!="symbol"?e+"":e,t),t);const Fd=class kn extends _e{constructor(...e){let t=e[0]??{};typeof t=="number"&&(J("6.0.0","OutlineFilter constructor params are now options object. See params: { thickness, color, quality, alpha, knockout }"),t={thickness:t},e[1]!==void 0&&(t.color=e[1]),e[2]!==void 0&&(t.quality=e[2]),e[3]!==void 0&&(t.alpha=e[3]),e[4]!==void 0&&(t.knockout=e[4])),t={...kn.DEFAULT_OPTIONS,...t};const n=t.quality??.1,i=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:TR,entryPoint:"mainFragment"}}),s=be.from({vertex:Be,fragment:wR.replace(/\$\{ANGLE_STEP\}/,kn.getAngleStep(n).toFixed(7)),name:"outline-filter"});super({gpuProgram:i,glProgram:s,resources:{outlineUniforms:{uThickness:{value:new Float32Array(2),type:"vec2<f32>"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:t.alpha,type:"f32"},uAngleStep:{value:0,type:"f32"},uKnockout:{value:t.knockout?1:0,type:"f32"}}}}),Un(this,"uniforms"),Un(this,"_thickness"),Un(this,"_quality"),Un(this,"_color"),this.uniforms=this.resources.outlineUniforms.uniforms,this.uniforms.uAngleStep=kn.getAngleStep(n),this._color=new pe,this.color=t.color??0,Object.assign(this,t)}apply(e,t,n,i){this.uniforms.uThickness[0]=this.thickness/t.source.width,this.uniforms.uThickness[1]=this.thickness/t.source.height,e.applyFilter(this,t,n,i)}static getAngleStep(e){return parseFloat((Math.PI*2/Math.max(e*kn.MAX_SAMPLES,kn.MIN_SAMPLES)).toFixed(7))}get thickness(){return this._thickness}set thickness(e){this._thickness=this.padding=e}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,n,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=n,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get quality(){return this._quality}set quality(e){this._quality=e,this.uniforms.uAngleStep=kn.getAngleStep(e)}get knockout(){return this.uniforms.uKnockout===1}set knockout(e){this.uniforms.uKnockout=e?1:0}};Un(Fd,"DEFAULT_OPTIONS",{thickness:1,color:0,alpha:1,quality:.1,knockout:!1});Un(Fd,"MIN_SAMPLES",1);Un(Fd,"MAX_SAMPLES",100);var AR=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uRadian;
uniform vec2 uCenter;
uniform float uRadius;
uniform int uKernelSize;

uniform vec4 uInputSize;

const int MAX_KERNEL_SIZE = 2048;

void main(void)
{
    vec4 color = texture(uTexture, vTextureCoord);

    if (uKernelSize == 0)
    {
        finalColor = color;
        return;
    }

    float aspect = uInputSize.y / uInputSize.x;
    vec2 center = uCenter.xy / uInputSize.xy;
    float gradient = uRadius / uInputSize.x * 0.3;
    float radius = uRadius / uInputSize.x - gradient * 0.5;
    int k = uKernelSize - 1;

    vec2 coord = vTextureCoord;
    vec2 dir = vec2(center - coord);
    float dist = length(vec2(dir.x, dir.y * aspect));

    float radianStep = uRadian;
    if (radius >= 0.0 && dist > radius) {
        float delta = dist - radius;
        float gap = gradient;
        float scale = 1.0 - abs(delta / gap);
        if (scale <= 0.0) {
            finalColor = color;
            return;
        }
        radianStep *= scale;
    }
    radianStep /= float(k);

    float s = sin(radianStep);
    float c = cos(radianStep);
    mat2 rotationMatrix = mat2(vec2(c, -s), vec2(s, c));

    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {
        if (i == k) {
            break;
        }

        coord -= center;
        coord.y *= aspect;
        coord = rotationMatrix * coord;
        coord.y /= aspect;
        coord += center;

        vec4 sample = texture(uTexture, coord);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample;
    }

    finalColor = color / float(uKernelSize);
}
`,ER=`struct RadialBlurUniforms {
  uRadian: f32,
  uCenter: vec2<f32>,
  uKernelSize: f32,
  uRadius: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> radialBlurUniforms : RadialBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uRadian = radialBlurUniforms.uRadian;
  let uCenter = radialBlurUniforms.uCenter;
  let uKernelSize = radialBlurUniforms.uKernelSize;
  let uRadius = radialBlurUniforms.uRadius;
  
  var returnColorOnly = false;

  if (uKernelSize == 0)
  {
    returnColorOnly = true;
  }

  let aspect: f32 = gfu.uInputSize.y / gfu.uInputSize.x;
  let center: vec2<f32> = uCenter.xy / gfu.uInputSize.xy;
  let gradient: f32 = uRadius / gfu.uInputSize.x * 0.3;
  let radius: f32 = uRadius / gfu.uInputSize.x - gradient * 0.5;
  let k: i32 = i32(uKernelSize - 1);

  var coord: vec2<f32> = uv;
  let dir: vec2<f32> = vec2<f32>(center - coord);
  let dist: f32 = length(vec2<f32>(dir.x, dir.y * aspect));

  var radianStep: f32 = uRadian;
  
  if (radius >= 0.0 && dist > radius)
  {
    let delta: f32 = dist - radius;
    let gap: f32 = gradient;
    let scale: f32 = 1.0 - abs(delta / gap);
    if (scale <= 0.0) {
      returnColorOnly = true;
    }
    radianStep *= scale;
  }

  radianStep /= f32(k);

  let s: f32 = sin(radianStep);
  let c: f32 = cos(radianStep);
  let rotationMatrix: mat2x2<f32> = mat2x2<f32>(vec2<f32>(c, -s), vec2<f32>(s, c));
  
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let baseColor = vec4<f32>(color);

  let minK: i32 = min(i32(uKernelSize) - 1, MAX_KERNEL_SIZE - 1);

  for(var i: i32 = 0; i < minK; i += 1) 
  {
    coord -= center;
    coord.y *= aspect;
    coord = rotationMatrix * coord;
    coord.y /= aspect;
    coord += center;
    let sample: vec4<f32> = textureSample(uTexture, uSampler, coord);
    // switch to pre-multiplied alpha to correctly blur transparent images
    // sample.rgb *= sample.a;
    color += sample;
  }

  return select(color / f32(uKernelSize), baseColor, returnColorOnly);
}

const MAX_KERNEL_SIZE: i32 = 2048;`,MR=Object.defineProperty,RR=(r,e,t)=>e in r?MR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ra=(r,e,t)=>(RR(r,typeof e!="symbol"?e+"":e,t),t);const kR=class nb extends _e{constructor(...e){let t=e[0]??{};if(typeof t=="number"){if(J("6.0.0","RadialBlurFilter constructor params are now options object. See params: { angle, center, kernelSize, radius }"),t={angle:t},e[1]){const s="x"in e[1]?e[1].x:e[1][0],o="y"in e[1]?e[1].y:e[1][1];t.center={x:s,y:o}}e[2]&&(t.kernelSize=e[2]),e[3]&&(t.radius=e[3])}t={...nb.DEFAULT_OPTIONS,...t};const n=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:ER,entryPoint:"mainFragment"}}),i=be.from({vertex:Be,fragment:AR,name:"radial-blur-filter"});super({gpuProgram:n,glProgram:i,resources:{radialBlurUniforms:{uRadian:{value:0,type:"f32"},uCenter:{value:t.center,type:"vec2<f32>"},uKernelSize:{value:t.kernelSize,type:"i32"},uRadius:{value:t.radius,type:"f32"}}}}),ra(this,"uniforms"),ra(this,"_angle"),ra(this,"_kernelSize"),this.uniforms=this.resources.radialBlurUniforms.uniforms,Object.assign(this,t)}_updateKernelSize(){this.uniforms.uKernelSize=this._angle!==0?this.kernelSize:0}get angle(){return this._angle}set angle(e){this._angle=e,this.uniforms.uRadian=e*Math.PI/180,this._updateKernelSize()}get center(){return this.uniforms.uCenter}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.center.x}set centerX(e){this.center.x=e}get centerY(){return this.center.y}set centerY(e){this.center.y=e}get kernelSize(){return this._kernelSize}set kernelSize(e){this._kernelSize=e,this._updateKernelSize()}get radius(){return this.uniforms.uRadius}set radius(e){this.uniforms.uRadius=e<0||e===1/0?-1:e}};ra(kR,"DEFAULT_OPTIONS",{angle:0,center:{x:0,y:0},kernelSize:5,radius:-1});var FR=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uMirror;
uniform float uBoundary;
uniform vec2 uAmplitude;
uniform vec2 uWavelength;
uniform vec2 uAlpha;
uniform float uTime;
uniform vec2 uDimensions;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * uInputSize.xy;
    vec2 coord = pixelCoord / uDimensions;

    if (coord.y < uBoundary) {
        finalColor = texture(uTexture, vTextureCoord);
        return;
    }

    float k = (coord.y - uBoundary) / (1. - uBoundary + 0.0001);
    float areaY = uBoundary * uDimensions.y / uInputSize.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = uMirror > 0.5 ? v : vTextureCoord.y;

    float _amplitude = ((uAmplitude.y - uAmplitude.x) * k + uAmplitude.x ) / uInputSize.x;
    float _waveLength = ((uWavelength.y - uWavelength.x) * k + uWavelength.x) / uInputSize.y;
    float _alpha = (uAlpha.y - uAlpha.x) * k + uAlpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - uTime) * _amplitude;
    x = clamp(x, uInputClamp.x, uInputClamp.z);

    vec4 color = texture(uTexture, vec2(x, y));

    finalColor = color * _alpha;
}
`,IR=`struct ReflectionUniforms {
  uMirror: f32,
  uBoundary: f32,
  uAmplitude: vec2<f32>,
  uWavelength: vec2<f32>,
  uAlpha: vec2<f32>,
  uTime: f32,
  uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> reflectionUniforms : ReflectionUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uDimensions: vec2<f32> = reflectionUniforms.uDimensions;
  let uBoundary: f32 = reflectionUniforms.uBoundary;
  let uMirror: bool = reflectionUniforms.uMirror > 0.5;
  let uAmplitude: vec2<f32> = reflectionUniforms.uAmplitude;
  let uWavelength: vec2<f32> = reflectionUniforms.uWavelength;
  let uAlpha: vec2<f32> = reflectionUniforms.uAlpha;
  let uTime: f32 = reflectionUniforms.uTime;

  let pixelCoord: vec2<f32> = uv * gfu.uInputSize.xy;
  let coord: vec2<f32> = pixelCoord /uDimensions;
  var returnColorOnly: bool = false;

  if (coord.y < uBoundary) {
    returnColorOnly = true;
  }

  let k: f32 = (coord.y - uBoundary) / (1. - uBoundary + 0.0001);
  let areaY: f32 = uBoundary * uDimensions.y / gfu.uInputSize.y;
  let v: f32 = areaY + areaY - uv.y;
  let y: f32 = select(uv.y, v, uMirror);

  let amplitude: f32 = ((uAmplitude.y - uAmplitude.x) * k + uAmplitude.x ) / gfu.uInputSize.x;
  let waveLength: f32 = ((uWavelength.y - uWavelength.x) * k + uWavelength.x) / gfu.uInputSize.y;
  let alpha: f32 = select((uAlpha.y - uAlpha.x) * k + uAlpha.x, 1., returnColorOnly);

  var x: f32 = uv.x + cos(v * 6.28 / waveLength - uTime) * amplitude;
  x = clamp(x, gfu.uInputClamp.x, gfu.uInputClamp.z);
  
  return textureSample(uTexture, uSampler, select(vec2<f32>(x, y), uv, returnColorOnly)) * alpha;
}

fn rand(co: vec2<f32>) -> f32 
{
  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}`,BR=Object.defineProperty,OR=(r,e,t)=>e in r?BR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,lc=(r,e,t)=>(OR(r,typeof e!="symbol"?e+"":e,t),t);const UR=class ib extends _e{constructor(e){e={...ib.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:IR,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:FR,name:"reflection-filter"});super({gpuProgram:t,glProgram:n,resources:{reflectionUniforms:{uMirror:{value:e.mirror?1:0,type:"f32"},uBoundary:{value:e.boundary,type:"f32"},uAmplitude:{value:e.amplitude,type:"vec2<f32>"},uWavelength:{value:e.waveLength,type:"vec2<f32>"},uAlpha:{value:e.alpha,type:"vec2<f32>"},uTime:{value:e.time,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),lc(this,"uniforms"),lc(this,"time",0),this.uniforms=this.resources.reflectionUniforms.uniforms,Object.assign(this,e)}apply(e,t,n,i){this.uniforms.uDimensions[0]=t.frame.width,this.uniforms.uDimensions[1]=t.frame.height,this.uniforms.uTime=this.time,e.applyFilter(this,t,n,i)}get mirror(){return this.uniforms.uMirror>.5}set mirror(e){this.uniforms.uMirror=e?1:0}get boundary(){return this.uniforms.uBoundary}set boundary(e){this.uniforms.uBoundary=e}get amplitude(){return Array.from(this.uniforms.uAmplitude)}set amplitude(e){this.uniforms.uAmplitude[0]=e[0],this.uniforms.uAmplitude[1]=e[1]}get amplitudeStart(){return this.uniforms.uAmplitude[0]}set amplitudeStart(e){this.uniforms.uAmplitude[0]=e}get amplitudeEnd(){return this.uniforms.uAmplitude[1]}set amplitudeEnd(e){this.uniforms.uAmplitude[1]=e}get waveLength(){return Array.from(this.uniforms.uWavelength)}set waveLength(e){this.uniforms.uWavelength[0]=e[0],this.uniforms.uWavelength[1]=e[1]}get wavelengthStart(){return this.uniforms.uWavelength[0]}set wavelengthStart(e){this.uniforms.uWavelength[0]=e}get wavelengthEnd(){return this.uniforms.uWavelength[1]}set wavelengthEnd(e){this.uniforms.uWavelength[1]=e}get alpha(){return Array.from(this.uniforms.uAlpha)}set alpha(e){this.uniforms.uAlpha[0]=e[0],this.uniforms.uAlpha[1]=e[1]}get alphaStart(){return this.uniforms.uAlpha[0]}set alphaStart(e){this.uniforms.uAlpha[0]=e}get alphaEnd(){return this.uniforms.uAlpha[1]}set alphaEnd(e){this.uniforms.uAlpha[1]=e}};lc(UR,"DEFAULT_OPTIONS",{mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0});var DR=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec4 uInputSize;
uniform vec2 uRed;
uniform vec2 uGreen;
uniform vec2 uBlue;

void main(void)
{
   float r = texture(uTexture, vTextureCoord + uRed/uInputSize.xy).r;
   float g = texture(uTexture, vTextureCoord + uGreen/uInputSize.xy).g;
   float b = texture(uTexture, vTextureCoord + uBlue/uInputSize.xy).b;
   float a = texture(uTexture, vTextureCoord).a;
   finalColor = vec4(r, g, b, a);
}
`,GR=`struct RgbSplitUniforms {
    uRed: vec2<f32>,
    uGreen: vec2<f32>,
    uBlue: vec3<f32>,
};

struct GlobalFilterUniforms {
    uInputSize:vec4<f32>,
    uInputPixel:vec4<f32>,
    uInputClamp:vec4<f32>,
    uOutputFrame:vec4<f32>,
    uGlobalFrame:vec4<f32>,
    uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> rgbSplitUniforms : RgbSplitUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    let r = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uRed.x / gfu.uInputSize.x, rgbSplitUniforms.uRed.y / gfu.uInputSize.y)).r;
    let g = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uGreen.x / gfu.uInputSize.x, rgbSplitUniforms.uGreen.y / gfu.uInputSize.y)).g;
    let b = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uBlue.x / gfu.uInputSize.x, rgbSplitUniforms.uBlue.y / gfu.uInputSize.y)).b;
    let a = textureSample(uTexture, uSampler, uv).a;
    return vec4<f32>(r, g, b, a);
}
`,zR=Object.defineProperty,LR=(r,e,t)=>e in r?zR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,sb=(r,e,t)=>(LR(r,typeof e!="symbol"?e+"":e,t),t);const NR=class ob extends _e{constructor(...e){let t=e[0]??{};(Array.isArray(t)||"x"in t&&"y"in t)&&(J("6.0.0","RGBSplitFilter constructor params are now options object. See params: { red, green, blue }"),t={red:t},e[1]!==void 0&&(t.green=e[1]),e[2]!==void 0&&(t.blue=e[2])),t={...ob.DEFAULT_OPTIONS,...t};const n=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:GR,entryPoint:"mainFragment"}}),i=be.from({vertex:Be,fragment:DR,name:"rgb-split-filter"});super({gpuProgram:n,glProgram:i,resources:{rgbSplitUniforms:{uRed:{value:t.red,type:"vec2<f32>"},uGreen:{value:t.green,type:"vec2<f32>"},uBlue:{value:t.blue,type:"vec2<f32>"}}}}),sb(this,"uniforms"),this.uniforms=this.resources.rgbSplitUniforms.uniforms,Object.assign(this,t)}get red(){return this.uniforms.uRed}set red(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uRed=e}get redX(){return this.red.x}set redX(e){this.red.x=e}get redY(){return this.red.y}set redY(e){this.red.y=e}get green(){return this.uniforms.uGreen}set green(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uGreen=e}get greenX(){return this.green.x}set greenX(e){this.green.x=e}get greenY(){return this.green.y}set greenY(e){this.green.y=e}get blue(){return this.uniforms.uBlue}set blue(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uBlue=e}get blueX(){return this.blue.x}set blueX(e){this.blue.x=e}get blueY(){return this.blue.y}set blueY(e){this.blue.y=e}};sb(NR,"DEFAULT_OPTIONS",{red:{x:-10,y:0},green:{x:0,y:10},blue:{x:0,y:0}});var HR=`
precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uCenter;
uniform float uTime;
uniform float uSpeed;
uniform vec4 uWave;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

const float PI = 3.14159;

void main()
{
    float uAmplitude = uWave[0];
    float uWavelength = uWave[1];
    float uBrightness = uWave[2];
    float uRadius = uWave[3];

    float halfWavelength = uWavelength * 0.5 / uInputSize.x;
    float maxRadius = uRadius / uInputSize.x;
    float currentRadius = uTime * uSpeed / uInputSize.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            finalColor = texture(uTexture, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - uCenter / uInputSize.xy);
    dir.y *= uInputSize.y / uInputSize.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        finalColor = texture(uTexture, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );

    vec2 offset = diffUV * powDiff / uInputSize.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    vec4 color = texture(uTexture, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // finalColor = texture(uTexture, vTextureCoord + offset);

    color.rgb *= 1.0 + (uBrightness - 1.0) * p * fade;

    finalColor = color;
}
`,VR=`
struct ShockWaveUniforms {
    uTime: f32,
    uOffset: vec2<f32>,
    uSpeed: f32,
    uWave: vec4<f32>,
};

struct GlobalFilterUniforms {
    uInputSize:vec4<f32>,
    uInputPixel:vec4<f32>,
    uInputClamp:vec4<f32>,
    uOutputFrame:vec4<f32>,
    uGlobalFrame:vec4<f32>,
    uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> shockwaveUniforms : ShockWaveUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {

    let uTime = shockwaveUniforms.uTime;
    let uOffset = shockwaveUniforms.uOffset;
    let uSpeed = shockwaveUniforms.uSpeed;
    let uAmplitude = shockwaveUniforms.uWave[0];
    let uWavelength = shockwaveUniforms.uWave[1];
    let uBrightness = shockwaveUniforms.uWave[2];
    let uRadius = shockwaveUniforms.uWave[3];
    let halfWavelength: f32 = uWavelength * 0.5 / gfu.uInputSize.x;
    let maxRadius: f32 = uRadius / gfu.uInputSize.x;
    let currentRadius: f32 = uTime * uSpeed / gfu.uInputSize.x;
    var fade: f32 = 1.0;
    var returnColorOnly: bool = false;
    
    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            returnColorOnly = true;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }
    var dir: vec2<f32> = vec2<f32>(uv - uOffset / gfu.uInputSize.xy);
    dir.y *= gfu.uInputSize.y / gfu.uInputSize.x;

    let dist:f32 = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        returnColorOnly = true;
    }

    let diffUV: vec2<f32> = normalize(dir);
    let diff: f32 = (dist - currentRadius) / halfWavelength;
    let p: f32 = 1.0 - pow(abs(diff), 2.0);
    let powDiff: f32 = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );
    let offset: vec2<f32> = diffUV * powDiff / gfu.uInputSize.xy;
    // Do clamp :
    let coord: vec2<f32> = uv + offset;
    let clampedCoord: vec2<f32> = clamp(coord, gfu.uInputClamp.xy, gfu.uInputClamp.zw);

    var clampedColor: vec4<f32> = textureSample(uTexture, uSampler, clampedCoord);
    
    if (boolVec2(coord, clampedCoord)) 
    {
        clampedColor *= max(0.0, 1.0 - length(coord - clampedCoord));
    }
    // No clamp :
    var finalColor = clampedColor;

    return select(finalColor, textureSample(uTexture, uSampler, uv), returnColorOnly);
}

fn boolVec2(x: vec2<f32>, y: vec2<f32>) -> bool
{
    if (x.x == y.x && x.y == y.y)
    {
        return true;
    }
    
    return false;
}

const PI: f32 = 3.14159265358979323846264;
`,WR=Object.defineProperty,jR=(r,e,t)=>e in r?WR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,uc=(r,e,t)=>(jR(r,typeof e!="symbol"?e+"":e,t),t);const XR=class ab extends _e{constructor(...e){let t=e[0]??{};(Array.isArray(t)||"x"in t&&"y"in t)&&(J("6.0.0","ShockwaveFilter constructor params are now options object. See params: { center, speed, amplitude, wavelength, brightness, radius, time }"),t={center:t,...e[1]},e[2]!==void 0&&(t.time=e[2])),t={...ab.DEFAULT_OPTIONS,...t};const n=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:VR,entryPoint:"mainFragment"}}),i=be.from({vertex:Be,fragment:HR,name:"shockwave-filter"});super({gpuProgram:n,glProgram:i,resources:{shockwaveUniforms:{uTime:{value:t.time,type:"f32"},uCenter:{value:t.center,type:"vec2<f32>"},uSpeed:{value:t.speed,type:"f32"},uWave:{value:new Float32Array(4),type:"vec4<f32>"}}}}),uc(this,"uniforms"),uc(this,"time"),this.time=0,this.uniforms=this.resources.shockwaveUniforms.uniforms,Object.assign(this,t)}apply(e,t,n,i){this.uniforms.uTime=this.time,e.applyFilter(this,t,n,i)}get center(){return this.uniforms.uCenter}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.uniforms.uCenter.x}set centerX(e){this.uniforms.uCenter.x=e}get centerY(){return this.uniforms.uCenter.y}set centerY(e){this.uniforms.uCenter.y=e}get speed(){return this.uniforms.uSpeed}set speed(e){this.uniforms.uSpeed=e}get amplitude(){return this.uniforms.uWave[0]}set amplitude(e){this.uniforms.uWave[0]=e}get wavelength(){return this.uniforms.uWave[1]}set wavelength(e){this.uniforms.uWave[1]=e}get brightness(){return this.uniforms.uWave[2]}set brightness(e){this.uniforms.uWave[2]=e}get radius(){return this.uniforms.uWave[3]}set radius(e){this.uniforms.uWave[3]=e}};uc(XR,"DEFAULT_OPTIONS",{center:{x:0,y:0},speed:500,amplitude:30,wavelength:160,brightness:1,radius:-1});var qR=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uMapTexture;
uniform vec3 uColor;
uniform float uAlpha;
uniform vec2 uDimensions;

uniform vec4 uInputSize;

void main() {
    vec4 diffuseColor = texture(uTexture, vTextureCoord);
    vec2 lightCoord = (vTextureCoord * uInputSize.xy) / uDimensions;
    vec4 light = texture(uMapTexture, lightCoord);
    vec3 ambient = uColor.rgb * uAlpha;
    vec3 intensity = ambient + light.rgb;
    vec3 color = diffuseColor.rgb * intensity;
    finalColor = vec4(color, diffuseColor.a);
}
`,YR=`struct SimpleLightmapUniforms {
  uColor: vec3<f32>,
  uAlpha: f32,
  uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> simpleLightmapUniforms : SimpleLightmapUniforms;
@group(1) @binding(1) var uMapTexture: texture_2d<f32>;
@group(1) @binding(2) var uMapSampler: sampler;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>,
) -> @location(0) vec4<f32> {
  let uColor = simpleLightmapUniforms.uColor;
  let uAlpha = simpleLightmapUniforms.uAlpha;
  let uDimensions = simpleLightmapUniforms.uDimensions;

  let diffuseColor: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let lightCoord: vec2<f32> = (uv * gfu.uInputSize.xy) / simpleLightmapUniforms.uDimensions;
  let light: vec4<f32> = textureSample(uMapTexture, uMapSampler, lightCoord);
  let ambient: vec3<f32> = uColor * uAlpha;
  let intensity: vec3<f32> = ambient + light.rgb;
  let finalColor: vec3<f32> = diffuseColor.rgb * intensity;
  return vec4<f32>(finalColor, diffuseColor.a);
}`,KR=Object.defineProperty,$R=(r,e,t)=>e in r?KR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,na=(r,e,t)=>($R(r,typeof e!="symbol"?e+"":e,t),t);const ZR=class lb extends _e{constructor(...e){let t=e[0]??{};if(t instanceof te&&(J("6.0.0","SimpleLightmapFilter constructor params are now options object. See params: { lightMap, color, alpha }"),t={lightMap:t},e[1]!==void 0&&(t.color=e[1]),e[2]!==void 0&&(t.alpha=e[2])),t={...lb.DEFAULT_OPTIONS,...t},!t.lightMap)throw Error("No light map texture source was provided to SimpleLightmapFilter");const n=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:YR,entryPoint:"mainFragment"}}),i=be.from({vertex:Be,fragment:qR,name:"simple-lightmap-filter"});super({gpuProgram:n,glProgram:i,resources:{simpleLightmapUniforms:{uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:t.alpha,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}},uMapTexture:t.lightMap.source,uMapSampler:t.lightMap.source.style}}),na(this,"uniforms"),na(this,"_color"),na(this,"_lightMap"),this.uniforms=this.resources.simpleLightmapUniforms.uniforms,this._color=new pe,this.color=t.color??0,Object.assign(this,t)}apply(e,t,n,i){this.uniforms.uDimensions[0]=t.frame.width,this.uniforms.uDimensions[1]=t.frame.height,e.applyFilter(this,t,n,i)}get lightMap(){return this._lightMap}set lightMap(e){this._lightMap=e,this.resources.uMapTexture=e.source,this.resources.uMapSampler=e.source.style}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,n,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=n,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}};na(ZR,"DEFAULT_OPTIONS",{lightMap:te.WHITE,color:0,alpha:1});var QR=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uBlur;
uniform vec2 uStart;
uniform vec2 uEnd;
uniform vec2 uDelta;
uniform vec2 uDimensions;

float random(vec3 scale, float seed)
{
    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}

void main(void)
{
    vec4 color = vec4(0.0);
    float total = 0.0;

    float blur = uBlur[0];
    float gradientBlur = uBlur[1];

    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
    vec2 normal = normalize(vec2(uStart.y - uEnd.y, uEnd.x - uStart.x));
    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * uDimensions - uStart, normal)) / gradientBlur) * blur;

    for (float t = -30.0; t <= 30.0; t++)
    {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 sample = texture(uTexture, vTextureCoord + uDelta / uDimensions * percent * radius);
        sample.rgb *= sample.a;
        color += sample * weight;
        total += weight;
    }

    color /= total;
    color.rgb /= color.a + 0.00001;

    finalColor = color;
}
`,JR=`struct TiltShiftUniforms {
  uBlur: vec2<f32>,
  uStart: vec2<f32>,
  uEnd: vec2<f32>,
  uDelta: vec2<f32>,
  uDimensions: vec2<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> tiltShiftUniforms : TiltShiftUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uBlur = tiltShiftUniforms.uBlur[0];
  let uBlurGradient = tiltShiftUniforms.uBlur[1];
  let uStart = tiltShiftUniforms.uStart;
  let uEnd = tiltShiftUniforms.uEnd;
  let uDelta = tiltShiftUniforms.uDelta;
  let uDimensions = tiltShiftUniforms.uDimensions;

  var color: vec4<f32> = vec4<f32>(0.0);
  var total: f32 = 0.0;

  let offset: f32 = random(position, vec3<f32>(12.9898, 78.233, 151.7182), 0.0);
  let normal: vec2<f32> = normalize(vec2<f32>(uStart.y - uEnd.y, uEnd.x - uStart.x));
  let radius: f32 = smoothstep(0.0, 1.0, abs(dot(uv * uDimensions - uStart, normal)) / uBlurGradient) * uBlur;

  for (var t: f32 = -30.0; t <= 30.0; t += 1.0)
  {
    var percent: f32 = (t + offset - 0.5) / 30.0;
    var weight: f32 = 1.0 - abs(percent);
    var sample: vec4<f32> = textureSample(uTexture, uSampler, uv + uDelta / uDimensions * percent * radius);
    sample = vec4<f32>(sample.xyz * sample.a, sample.a); // multiply sample.rgb with sample.a
    color += sample * weight;
    total += weight;
  }

  color /= total;
  color = vec4<f32>(color.xyz / (color.a + 0.00001), color.a); // divide color.rgb by color.a + 0.00001

  return color;
}


fn random(position: vec4<f32>, scale: vec3<f32>, seed: f32) -> f32
{
  return fract(sin(dot(position.xyz + seed, scale)) * 43758.5453 + seed);
}`,ek=Object.defineProperty,tk=(r,e,t)=>e in r?ek(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,cc=(r,e,t)=>(tk(r,typeof e!="symbol"?e+"":e,t),t);const ub=class cb extends _e{constructor(e){const{width:t,height:n}=D0.defaultOptions;e={...cb.DEFAULT_OPTIONS,start:{x:0,y:n/2},end:{x:t,y:n/2},...e};const i=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:JR,entryPoint:"mainFragment"}}),s=be.from({vertex:Be,fragment:QR,name:"tilt-shift-axis-filter"});super({gpuProgram:i,glProgram:s,resources:{tiltShiftUniforms:{uBlur:{value:new Float32Array([e.blur,e.gradientBlur]),type:"vec2<f32>"},uStart:{value:e.start,type:"vec2<f32>"},uEnd:{value:e.end,type:"vec2<f32>"},uDelta:{value:new Float32Array([0,0]),type:"vec2<f32>"},uDimensions:{value:new Float32Array([t,n]),type:"vec2<f32>"}}}}),cc(this,"uniforms"),cc(this,"_tiltAxis"),this.uniforms=this.resources.tiltShiftUniforms.uniforms,this._tiltAxis=e.axis}updateDimensions(e){const{uDimensions:t}=this.uniforms;t[0]=e.frame.width,t[1]=e.frame.height}updateDelta(){if(this.uniforms.uDelta[0]=0,this.uniforms.uDelta[1]=0,this._tiltAxis===void 0)return;const e=this.uniforms.uEnd,t=this.uniforms.uStart,n=e.x-t.x,i=e.y-t.y,s=Math.sqrt(n*n+i*i),o=this._tiltAxis==="vertical";this.uniforms.uDelta[0]=o?-i/s:n/s,this.uniforms.uDelta[1]=o?n/s:i/s}};cc(ub,"DEFAULT_OPTIONS",{blur:100,gradientBlur:600});let hu=ub;var rk=Object.defineProperty,nk=(r,e,t)=>e in r?rk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ik=(r,e,t)=>(nk(r,e+"",t),t);class sk extends hu{constructor(e){e={...hu.DEFAULT_OPTIONS,...e},super({...e,axis:"horizontal"}),ik(this,"_tiltShiftYFilter"),this._tiltShiftYFilter=new hu({...e,axis:"vertical"}),this.updateDelta(),Object.assign(this,e)}apply(e,t,n,i){const s=Ge.getSameSizeTexture(t);this.updateDimensions(t),this._tiltShiftYFilter.updateDimensions(t),e.applyFilter(this,t,s,!0),e.applyFilter(this._tiltShiftYFilter,s,n,i),Ge.returnTexture(s)}updateDelta(){super.updateDelta(),this._tiltShiftYFilter.updateDelta()}get blur(){return this.uniforms.uBlur[0]}set blur(e){this.uniforms.uBlur[0]=this._tiltShiftYFilter.uniforms.uBlur[0]=e}get gradientBlur(){return this.uniforms.uBlur[1]}set gradientBlur(e){this.uniforms.uBlur[1]=this._tiltShiftYFilter.uniforms.uBlur[1]=e}get start(){return this.uniforms.uStart}set start(e){this.uniforms.uStart=this._tiltShiftYFilter.uniforms.uStart=e,this.updateDelta()}get startX(){return this.start.x}set startX(e){this.start.x=e,this.updateDelta()}get startY(){return this.start.y}set startY(e){this.start.y=e,this.updateDelta()}get end(){return this.uniforms.uEnd}set end(e){this.uniforms.uEnd=this._tiltShiftYFilter.uniforms.uEnd=e,this.updateDelta()}get endX(){return this.end.x}set endX(e){this.end.x=e,this.updateDelta()}get endY(){return this.end.y}set endY(e){this.end.y=e,this.updateDelta()}}var ok=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uTwist;
uniform vec2 uOffset;
uniform vec4 uInputSize;

vec2 mapCoord( vec2 coord )
{
    coord *= uInputSize.xy;
    coord += uInputSize.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= uInputSize.zw;
    coord /= uInputSize.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= uOffset;

    float dist = length(coord);
    float uRadius = uTwist[0];
    float uAngle = uTwist[1];

    if (dist < uRadius)
    {
        float ratioDist = (uRadius - dist) / uRadius;
        float angleMod = ratioDist * ratioDist * uAngle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += uOffset;

    return coord;
}

void main(void)
{
    vec2 coord = mapCoord(vTextureCoord);
    coord = twist(coord);
    coord = unmapCoord(coord);
    finalColor = texture(uTexture, coord);
}
`,ak=`struct TwistUniforms {
  uTwist:vec2<f32>,
  uOffset:vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> twistUniforms : TwistUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
  return textureSample(uTexture, uSampler, unmapCoord(twist(mapCoord(uv))));
}

fn mapCoord(coord: vec2<f32> ) -> vec2<f32>
{
  var mappedCoord: vec2<f32> = coord;
  mappedCoord *= gfu.uInputSize.xy;
  mappedCoord += gfu.uOutputFrame.xy;
  return mappedCoord;
}

fn unmapCoord(coord: vec2<f32> ) -> vec2<f32>
{
  var mappedCoord: vec2<f32> = coord;
  mappedCoord -= gfu.uOutputFrame.xy;
  mappedCoord /= gfu.uInputSize.xy;
  return mappedCoord;
}

fn twist(coord: vec2<f32>) -> vec2<f32>
{
  var twistedCoord: vec2<f32> = coord;
  let uRadius = twistUniforms.uTwist[0];
  let uAngle = twistUniforms.uTwist[1];
  let uOffset = twistUniforms.uOffset;

  twistedCoord -= uOffset;
  
  let dist = length(twistedCoord);

  if (dist < uRadius)
  {
    let ratioDist: f32 = (uRadius - dist) / uRadius;
    let angleMod: f32 = ratioDist * ratioDist * uAngle;
    let s: f32 = sin(angleMod);
    let c: f32 = cos(angleMod);
    twistedCoord = vec2<f32>(twistedCoord.x * c - twistedCoord.y * s, twistedCoord.x * s + twistedCoord.y * c);
  }

  twistedCoord += uOffset;
  return twistedCoord;
}
`,lk=Object.defineProperty,uk=(r,e,t)=>e in r?lk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,db=(r,e,t)=>(uk(r,typeof e!="symbol"?e+"":e,t),t);const ck=class hb extends _e{constructor(e){e={...hb.DEFAULT_OPTIONS,...e};const t=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:ak,entryPoint:"mainFragment"}}),n=be.from({vertex:Be,fragment:ok,name:"twist-filter"});super({gpuProgram:t,glProgram:n,resources:{twistUniforms:{uTwist:{value:[e.radius??0,e.angle??0],type:"vec2<f32>"},uOffset:{value:e.offset,type:"vec2<f32>"}}},...e}),db(this,"uniforms"),this.uniforms=this.resources.twistUniforms.uniforms}get radius(){return this.uniforms.uTwist[0]}set radius(e){this.uniforms.uTwist[0]=e}get angle(){return this.uniforms.uTwist[1]}set angle(e){this.uniforms.uTwist[1]=e}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e}get offsetX(){return this.offset.x}set offsetX(e){this.offset.x=e}get offsetY(){return this.offset.y}set offsetY(e){this.offset.y=e}};db(ck,"DEFAULT_OPTIONS",{padding:20,radius:200,angle:4,offset:{x:0,y:0}});var dk=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uStrength;
uniform vec2 uCenter;
uniform vec2 uRadii;

uniform vec4 uInputSize;

const float MAX_KERNEL_SIZE = \${MAX_KERNEL_SIZE};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {
    float minGradient = uRadii[0] * 0.3;
    float innerRadius = (uRadii[0] + minGradient * 0.5) / uInputSize.x;

    float gradient = uRadii[1] * 0.3;
    float radius = (uRadii[1] - gradient * 0.5) / uInputSize.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / uInputSize.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * uInputSize.y / uInputSize.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / uInputSize.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture(uTexture, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture(uTexture, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,hk=`struct ZoomBlurUniforms {
    uStrength:f32,
    uCenter:vec2<f32>,
    uRadii:vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> zoomBlurUniforms : ZoomBlurUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uStrength = zoomBlurUniforms.uStrength;
  let uCenter = zoomBlurUniforms.uCenter;
  let uRadii = zoomBlurUniforms.uRadii;

  let minGradient: f32 = uRadii[0] * 0.3;
  let innerRadius: f32 = (uRadii[0] + minGradient * 0.5) / gfu.uInputSize.x;

  let gradient: f32 = uRadii[1] * 0.3;
  let radius: f32 = (uRadii[1] - gradient * 0.5) / gfu.uInputSize.x;

  let MAX_KERNEL_SIZE: f32 = \${MAX_KERNEL_SIZE};

  var countLimit: f32 = MAX_KERNEL_SIZE;

  var dir: vec2<f32> = vec2<f32>(uCenter / gfu.uInputSize.xy - uv);
  let dist: f32 = length(vec2<f32>(dir.x, dir.y * gfu.uInputSize.y / gfu.uInputSize.x));

  var strength: f32 = uStrength;

  var delta: f32 = 0.0;
  var gap: f32;

  if (dist < innerRadius) {
      delta = innerRadius - dist;
      gap = minGradient;
  } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
      delta = dist - radius;
      gap = gradient;
  }

  var returnColorOnly: bool = false;

  if (delta > 0.0) {
    let normalCount: f32 = gap / gfu.uInputSize.x;
    delta = (normalCount - delta) / normalCount;
    countLimit *= delta;
    strength *= delta;
    
    if (countLimit < 1.0)
    {
      returnColorOnly = true;;
    }
  }

  // randomize the lookup values to hide the fixed number of samples
  let offset: f32 = rand(uv, 0.0);

  var total: f32 = 0.0;
  var color: vec4<f32> = vec4<f32>(0.);

  dir *= strength;

  for (var t = 0.0; t < MAX_KERNEL_SIZE; t += 1.0) {
    let percent: f32 = (t + offset) / MAX_KERNEL_SIZE;
    let weight: f32 = 4.0 * (percent - percent * percent);
    let p: vec2<f32> = uv + dir * percent;
    let sample: vec4<f32> = textureSample(uTexture, uSampler, p);
    
    if (t < countLimit)
    {
      color += sample * weight;
      total += weight;
    }
  }

  color /= total;

  return select(color, textureSample(uTexture, uSampler, uv), returnColorOnly);
}

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
fn rand(co: vec2<f32>, seed: f32) -> f32
{
  let a: f32 = 12.9898;
  let b: f32 = 78.233;
  let c: f32 = 43758.5453;
  let dt: f32 = dot(co + seed, vec2<f32>(a, b));
  let sn: f32 = modulo(dt, 3.14159);
  return fract(sin(sn) * c + seed);
}`,fk=Object.defineProperty,pk=(r,e,t)=>e in r?fk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,fb=(r,e,t)=>(pk(r,typeof e!="symbol"?e+"":e,t),t);const pb=class mb extends _e{constructor(e){e={...mb.DEFAULT_OPTIONS,...e};const t=e.maxKernelSize??32,n=me.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:hk.replace("${MAX_KERNEL_SIZE}",t.toFixed(1)),entryPoint:"mainFragment"}}),i=be.from({vertex:Be,fragment:dk.replace("${MAX_KERNEL_SIZE}",t.toFixed(1)),name:"zoom-blur-filter"});super({gpuProgram:n,glProgram:i,resources:{zoomBlurUniforms:{uStrength:{value:e.strength,type:"f32"},uCenter:{value:e.center,type:"vec2<f32>"},uRadii:{value:new Float32Array(2),type:"vec2<f32>"}}}}),fb(this,"uniforms"),this.uniforms=this.resources.zoomBlurUniforms.uniforms,Object.assign(this,e)}get strength(){return this.uniforms.uStrength}set strength(e){this.uniforms.uStrength=e}get center(){return this.uniforms.uCenter}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.uniforms.uCenter.x}set centerX(e){this.uniforms.uCenter.x=e}get centerY(){return this.uniforms.uCenter.y}set centerY(e){this.uniforms.uCenter.y=e}get innerRadius(){return this.uniforms.uRadii[0]}set innerRadius(e){this.uniforms.uRadii[0]=e}get radius(){return this.uniforms.uRadii[1]}set radius(e){this.uniforms.uRadii[1]=e<0||e===1/0?-1:e}};fb(pb,"DEFAULT_OPTIONS",{strength:.1,center:{x:0,y:0},innerRadius:0,radius:-1,maxKernelSize:32});let mk=pb;class gk{constructor(e,t,n){this.updater=e,this.fail=t,this.success=n}cache=new Map;last_failed=void 0;async get(e){if(this.last_failed===e)return null;if(this.cache.has(e))return this.cache.get(e);try{const t=await this.updater(e);return this.success&&this.success(e),this.cache.set(e,t),t}catch{return this.last_failed=e,this.fail&&this.fail(e),null}}get size(){return this.cache.size}}class Id{app;textures;constructor(e,t){this.textures=new gk(async n=>await ws.load(n),e,t)}static async create(e){const t=new this(e.texture_fail,e.texture_success);return await t.init(e),t}async init(e){this.app=new Wg;const[t,n]=this.splitRGBA(e.background);await this.app.init({background:t,backgroundAlpha:0,width:e.width,height:e.height,antialias:!1,useBackBuffer:e.back_bufer===void 0?!0:e.back_bufer}),await this.mount(e.state),e.mount_point.appendChild(this.app.canvas)}splitRGBA(e){return[e.slice(0,7),e.length>7?parseInt(e.slice(7,9),16)/255:1]}createRoundedRectMask(e,t,n){const i=new Rr;return i.roundRect(0,0,e,t,n),i.fill(16777215),i}diff(e,t,n=[]){if(e===void 0||t===void 0)return["undefined"];for(const i in e){const s=[...n,i];if(typeof e[i]=="object"){const o=this.diff(e[i],t[i],s);if(o.length>0)return o}else if(e[i]!=t[i])return s}return[]}nochange(e,t){return e!==void 0&&t!==void 0&&this.diff(e,t).length===0?!0:(e=structuredClone(t),!1)}buildFilters(e,t){const n=[];if(e.adjustment.enabled&&n.push(new n5({gamma:e.adjustment.gamma,saturation:e.adjustment.saturation,contrast:e.adjustment.contrast,brightness:e.adjustment.brightness})),e.blur.enabled&&(t.x-=e.blur.value,t.y-=e.blur.value,t.width+=2*e.blur.value,t.height+=2*e.blur.value,n.push(new er({strength:e.blur.value,quality:15}))),e.tilt_shift.enabled&&n.push(new sk({blur:e.tilt_shift.blur,start:{x:e.tilt_shift.start.x,y:e.tilt_shift.start.y},end:{x:e.tilt_shift.end.x,y:e.tilt_shift.end.y}})),e.vignetting.enabled&&n.push(new SR({sepia:0,noise:0,scratch:0,vignetting:e.vignetting.value,vignettingAlpha:e.vignetting.alpha,vignettingBlur:e.vignetting.blur})),e.zoom_blur.enabled&&n.push(new mk({strength:e.zoom_blur.value,center:{x:e.zoom_blur.center.x,y:e.zoom_blur.center.y},innerRadius:e.zoom_blur.radius})),e.gradient.enabled){const i=this.splitRGBA(e.gradient.start.color),s=this.splitRGBA(e.gradient.mid.color),o=this.splitRGBA(e.gradient.end.color),a=[{color:i[0],alpha:i[1],offset:e.gradient.start.value},{color:s[0],alpha:s[1],offset:e.gradient.mid.value},{color:o[0],alpha:o[1],offset:e.gradient.end.value}];a[0].offset>0&&a.unshift({color:i[0],alpha:i[1],offset:0}),n.push(new yp({type:yp.LINEAR,stops:a,angle:e.gradient.orientation==="horizontal"?90:0}))}return n}}class vk extends Id{text_group=new fe;title=new Si;description=new Si;background_group=new fe;backrgound=new Ke;logo_group=new fe;logo=new Ke;categories_group=new fe;prev_category_round;prev_filters;async mount(e){this.prev_category_round=e.categories.round,this.backrgound=Ke.from(e.background.src,!0),this.logo=Ke.from(e.logo.src,!0),this.text_group.addChild(this.title,this.description),this.background_group.addChild(this.backrgound),this.logo_group.addChild(this.logo),this.app.stage.addChild(this.background_group,this.logo_group,this.text_group,this.categories_group)}updateText(e,t){this.updateTitle(e,t),this.updateDescription(e,t)}updateTitle(e,t){this.title.x=e.x,this.title.y=e.y,this.title.text=e.text;const[n,i]=this.splitRGBA(e.shadow.color);this.title.style={fontFamily:e.font.face,fontSize:e.font.size,fill:e.font.color,fontWeight:e.font.weight,lineHeight:e.font.line_height,dropShadow:{color:n,blur:e.shadow.value,distance:0,alpha:i}};const s=St.measureText(this.title.text,this.title.style);this.description.y=s.height+t.font.line_height+t.gap}updateDescription(e,t){const[n,i]=this.splitRGBA(t.shadow.color);this.description.text=t.text,this.description.x=t.x,this.description.style={fontFamily:t.font.face,fontSize:t.font.size,fill:t.font.color,fontWeight:t.font.weight,lineHeight:t.font.line_height,dropShadow:{color:n,blur:t.shadow.value,distance:0,alpha:i}};const s=St.measureText(this.title.text,this.title.style);this.description.y=s.height+t.font.line_height+t.gap}async updateBackground(e,t){const n=await this.textures.get(e.src);n&&(this.backrgound.texture=n),this.backrgound.x=e.x,this.backrgound.y=e.y,this.backrgound.width=e.w,this.backrgound.height=e.h,e.flip_h?(this.backrgound.scale.x=-Math.abs(this.backrgound.scale.x),this.backrgound.x=this.backrgound.x+this.backrgound.width):this.backrgound.scale.x=Math.abs(this.backrgound.scale.x),e.flip_v?(this.backrgound.scale.y=-Math.abs(this.backrgound.scale.y),this.backrgound.y=this.backrgound.y+this.backrgound.height):this.backrgound.scale.y=Math.abs(this.backrgound.scale.y),!(this.prev_filters!==void 0&&this.diff(this.prev_filters,t).length===0)&&(this.prev_filters=structuredClone(t),this.background_group.filters=this.buildFilters(t,this.backrgound))}async updateLogo(e){this.logo.x=e.x,this.logo.y=e.y,this.logo.width=e.w,this.logo.height=e.h,this.logo.alpha=e.alpha;const t=await this.textures.get(e.src);t&&(this.logo.texture=t),this.logo.filters=[new er({strength:e.blur,quality:15})]}async updateCategories(e){if(this.prev_category_round!=e.round){for(const i of this.categories_group.children){const s=this.createRoundedRectMask(e.w,e.h,e.round);i.removeChildAt(1);const o=i.children[0];o.mask=s,i.addChild(s)}this.prev_category_round=e.round;return}this.categories_group.x=e.x,this.categories_group.y=e.y;const[t,n]=this.splitRGBA(e.shadow.color);for(const[i,s]of e.src.entries()){const o=await this.textures.get(s);if(!o)continue;let a;if(i<this.categories_group.children.length){a=this.categories_group.getChildAt(i);const l=a.getChildAt(0);l.texture=o}else{a=new fe;const l=this.createRoundedRectMask(e.w,e.h,e.round),u=new Ke({width:e.w,height:e.h,texture:o,mask:l});a.addChild(u),a.addChild(l),this.categories_group.addChild(a)}a.x=i*(e.w+e.margin),a.y=0,a.width=e.w,a.height=e.h,a.filters=[new er({strength:e.blur,quality:15}),new Yx({offset:{x:0,y:0},color:parseInt(t.slice(1),16),alpha:n,blur:e.shadow.value,quality:15})]}for(;this.categories_group.children.length>e.src.length;)this.categories_group.removeChildAt(this.categories_group.children.length-1)}}var gb={exports:{}};(function(r){(function(){function e(m,g){document.addEventListener?m.addEventListener("scroll",g,!1):m.attachEvent("scroll",g)}function t(m){document.body?m():document.addEventListener?document.addEventListener("DOMContentLoaded",function g(){document.removeEventListener("DOMContentLoaded",g),m()}):document.attachEvent("onreadystatechange",function g(){(document.readyState=="interactive"||document.readyState=="complete")&&(document.detachEvent("onreadystatechange",g),m())})}function n(m){this.g=document.createElement("div"),this.g.setAttribute("aria-hidden","true"),this.g.appendChild(document.createTextNode(m)),this.h=document.createElement("span"),this.i=document.createElement("span"),this.m=document.createElement("span"),this.j=document.createElement("span"),this.l=-1,this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.h.appendChild(this.m),this.i.appendChild(this.j),this.g.appendChild(this.h),this.g.appendChild(this.i)}function i(m,g){m.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+g+";"}function s(m){var g=m.g.offsetWidth,v=g+100;return m.j.style.width=v+"px",m.i.scrollLeft=v,m.h.scrollLeft=m.h.scrollWidth+100,m.l!==g?(m.l=g,!0):!1}function o(m,g){function v(){var b=x;s(b)&&b.g.parentNode!==null&&g(b.l)}var x=m;e(m.h,v),e(m.i,v),s(m)}function a(m,g,v){g=g||{},v=v||window,this.family=m,this.style=g.style||"normal",this.weight=g.weight||"normal",this.stretch=g.stretch||"normal",this.context=v}var l=null,u=null,c=null,d=null;function h(m){return u===null&&(f(m)&&/Apple/.test(window.navigator.vendor)?(m=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),u=!!m&&603>parseInt(m[1],10)):u=!1),u}function f(m){return d===null&&(d=!!m.document.fonts),d}function p(m,g){var v=m.style,x=m.weight;if(c===null){var b=document.createElement("div");try{b.style.font="condensed 100px sans-serif"}catch{}c=b.style.font!==""}return[v,x,c?m.stretch:"","100px",g].join(" ")}a.prototype.load=function(m,g){var v=this,x=m||"BESbswy",b=0,_=g||3e3,w=new Date().getTime();return new Promise(function(C,P){if(f(v.context)&&!h(v.context)){var S=new Promise(function(E,U){function L(){new Date().getTime()-w>=_?U(Error(""+_+"ms timeout exceeded")):v.context.document.fonts.load(p(v,'"'+v.family+'"'),x).then(function(R){1<=R.length?E():setTimeout(L,25)},U)}L()}),A=new Promise(function(E,U){b=setTimeout(function(){U(Error(""+_+"ms timeout exceeded"))},_)});Promise.race([A,S]).then(function(){clearTimeout(b),C(v)},P)}else t(function(){function E(){var O;(O=B!=-1&&z!=-1||B!=-1&&G!=-1||z!=-1&&G!=-1)&&((O=B!=z&&B!=G&&z!=G)||(l===null&&(O=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),l=!!O&&(536>parseInt(O[1],10)||parseInt(O[1],10)===536&&11>=parseInt(O[2],10))),O=l&&(B==j&&z==j&&G==j||B==M&&z==M&&G==M||B==H&&z==H&&G==H)),O=!O),O&&(W.parentNode!==null&&W.parentNode.removeChild(W),clearTimeout(b),C(v))}function U(){if(new Date().getTime()-w>=_)W.parentNode!==null&&W.parentNode.removeChild(W),P(Error(""+_+"ms timeout exceeded"));else{var O=v.context.document.hidden;(O===!0||O===void 0)&&(B=L.g.offsetWidth,z=R.g.offsetWidth,G=T.g.offsetWidth,E()),b=setTimeout(U,50)}}var L=new n(x),R=new n(x),T=new n(x),B=-1,z=-1,G=-1,j=-1,M=-1,H=-1,W=document.createElement("div");W.dir="ltr",i(L,p(v,"sans-serif")),i(R,p(v,"serif")),i(T,p(v,"monospace")),W.appendChild(L.g),W.appendChild(R.g),W.appendChild(T.g),v.context.document.body.appendChild(W),j=L.g.offsetWidth,M=R.g.offsetWidth,H=T.g.offsetWidth,U(),o(L,function(O){B=O,E()}),i(L,p(v,'"'+v.family+'",sans-serif')),o(R,function(O){z=O,E()}),i(R,p(v,'"'+v.family+'",serif')),o(T,function(O){G=O,E()}),i(T,p(v,'"'+v.family+'",monospace'))})})},r.exports=a})()})(gb);var xk=gb.exports;const bk=tl(xk),_k=(r,e)=>{if(r[0]==="#"&&(r=r.slice(1)),r.length===3){let n="";r.split("").forEach(i=>{n+=i,n+=i}),r=n}return`rgba(${(r.match(/.{2}/g)||[]).map(n=>parseInt(n,16)).join(", ")}, ${e})`};var yk=Y('<div class="wrapper svelte-1cx3779"><div class="spinner-inner svelte-1cx3779"><div id="top" class="mask svelte-1cx3779"><div class="plane svelte-1cx3779"></div></div> <div id="middle" class="mask svelte-1cx3779"><div class="plane svelte-1cx3779"></div></div> <div id="bottom" class="mask svelte-1cx3779"><div class="plane svelte-1cx3779"></div></div></div></div>');function Sk(r,e){ye(e,!1);let t=X(e,"color",8,"#FF3E00"),n=X(e,"unit",8,"px"),i=X(e,"duration",8,"1.3s"),s=X(e,"size",8,"60"),o=X(e,"pause",8,!1),a=He();it(()=>rt(t()),()=>{ne(a,_k(t(),.6))}),Kn(),kt();var l=yk(),u=ie(l);le(()=>{ve(l,"style",`--size: ${s()??""}${n()??""}; --color: ${t()??""}; --rgba: ${k(a)??""}; --duration: ${i()??""};`),Ya(u,"pause-animation",o())}),N(r,l),Se()}function wk(r,e){k(e)==="STANDBY"&&ne(e,"DRAG")}function Tk(r,e){k(e)==="DRAG"&&ne(e,"STANDBY")}function Ck(r,e,t,n){k(e)==="DRAG"&&(D(n.background,y(t).x+=r.movementX,y(t)),D(n.background,y(t).y+=r.movementY,y(t)))}var Pk=Y('<div class="loading svelte-tz9rki"><!></div>'),Ak=Y('<div class="svelte-tz9rki"><!></div>');function Bd(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.datastate,"$datastate",t),i=()=>oe(e.appstate,"$appstate",t),s=()=>oe(e.background,"$background",t);let o,a,l=Ii("STANDBY"),u=Ii(""),c=pt(()=>`width: ${n().width}px; height: ${n().height}px;${n().scale!=1?` transform: scale(${n().scale});`:""}`);const d=v=>window.dispatchEvent(new CustomEvent("texture_loaded",{detail:v}));kr(()=>{y(()=>{e.drawer.create({mount_point:o,state:n(),background:"#14151e",width:n().width,height:n().height,back_buffer:e.back_buffer,texture_success:d,texture_fail:d}).then(async v=>{e.preload_font&&await new bk(e.preload_font).load().catch(()=>alert(`Error: font ${e.preload_font} not loaded`)),e.subscriptions(v),D(e.appstate,y(i).app=v,y(i)),a=o.querySelector("canvas")})})}),kr(()=>{const v=[];s().x>0&&v.push("-3px 0px 0px 0px var(--red)"),s().y>0&&v.push("0px -3px 0px 0px var(--red)"),s().x+s().w<n().width&&v.push("3px 0px 0px 0px var(--red)"),s().y+s().h<n().height&&v.push("0px 3px 0px 0px var(--red)"),v.length>0?ne(u,`${k(c)} box-shadow: ${v.join(", ")};`):ne(u,qe(k(c)))});function h(v){v.preventDefault();const x=-v.deltaY*1e-4,b=a.width*x,_=b/i().background_aspect;D(e.background,y(s).w+=Math.floor(b*10)/10,y(s)),D(e.background,y(s).h+=Math.floor(_*10)/10,y(s)),D(e.background,y(s).x-=Math.floor(b*10/2)/10,y(s)),D(e.background,y(s).y-=Math.floor(_*10/2)/10,y(s))}function f(v){if(v.preventDefault(),v.stopPropagation(),s().paste_mode==="fit")D(e.background,y(s).x=0,y(s)),D(e.background,y(s).y=0,y(s)),D(e.background,y(s).w=a.width,y(s)),D(e.background,y(s).h=a.height,y(s));else if(s().paste_mode==="aspect"){const x=Oc(n().width,n().height,i().background_width,i().background_height);Gr(e.background,qe({...s(),...x}))}}function p(v){v.preventDefault(),v.stopPropagation()}var m=Ak();Qn(m,v=>o=v,()=>o),m.__mousedown=[wk,l],m.__mouseup=[Tk,l],m.__mousemove=[Ck,l,s,e],m.__dblclick=f;var g=ie(m);Fe(g,()=>i().background_loading,v=>{var x=Pk(),b=ie(x);Sk(b,{color:"#d42834"}),N(v,x)}),le(()=>ve(m,"style",k(u))),ge("wheel",m,h),ge("selectstart",m,p),N(r,m),Se()}Zn(["mousedown","mouseup","mousemove","dblclick"]);function Ek(r,e){ye(e,!1);const t=$e(),n=()=>oe(ya,"$filter",t),i=()=>oe(Ei,"$background",t),s=()=>oe(wa,"$description",t),o=()=>oe(Sa,"$title",t);function a(l){Ei.subscribe(u=>{l.updateBackground(u,n())}),ya.subscribe(u=>{l.updateBackground(i(),u)}),zc.subscribe(u=>{l.updateLogo(u)}),Sa.subscribe(u=>{l.updateText(u,s())}),wa.subscribe(u=>{l.updateText(o(),u)}),Lc.subscribe(u=>{l.updateCategories(u)})}kt(),Bd(r,{background:Ei,subscriptions:a,datastate:Nc,appstate:Ta,drawer:vk,back_buffer:!1,preload_font:"Gilroy"}),Se()}const vb={adjustment:{enabled:!1,gamma:1,saturation:1,contrast:1,brightness:1},blur:{enabled:!0,value:.2},tilt_shift:{enabled:!1,blur:5,start:{x:600,y:0},end:{x:600,y:720}},vignetting:{enabled:!1,value:.3,alpha:1,blur:.3},zoom_blur:{enabled:!1,center:{x:900,y:360},value:.03,radius:500},gradient:{enabled:!0,orientation:"horizontal",start:{value:0,color:"#0000008c"},mid:{value:.34,color:"#00000066"},end:{value:.6,color:"#00000000"}}},Mk={src:Wm,x:0,y:0,w:1273,h:711,flip_h:!1,flip_v:!1,paste_mode:"aspect"},Rk={src:Gc,x:1092,y:60,w:121,h:100,blur:0,alpha:.6},kk={text:`Стримим
контент`,x:120,y:219,font:{face:"Gilroy",size:90,weight:"700",color:"#ffffff",line_height:109},shadow:{value:0,color:"#00000088"}},Fk={src:[Dc],x:452,y:481,w:128,h:170,round:12,blur:.1,margin:20,shadow:{value:2,color:"#00000066"}},Ik={x:0,y:0,w:60,h:711,color:"#9047fe"},Bk={text:`WELOVEGAMES
Чат`,x:120,y:481,h:75,padding_x:21,padding_y:20,margin_x:12,margin_y:20,round:12,color:"#1414188f",backdrop:{blur:12,quality:12},font:{face:"Gilroy",size:32,weight:"500",color:"#ffffff",line_height:75}},Ok={0:"Воскресенье",1:"Понедельник",2:"Вторник",3:"Среда",4:"Четверг",5:"Пятница",6:"Суббота"},Ua=new Date;Ua.setHours(Ua.getHours()+1);const Uk={text:`${Ok[Ua.getDay()]},${Ua.getHours()}:00 МСК`,x:120,y:60,h:75,padding_x:21,padding_y:20,margin_x:12,margin_y:20,round:12,color:"#dddddd4d",backdrop:{blur:12,quality:12},font:{face:"Gilroy",size:32,weight:"500",color:"#ffffff",line_height:75}},Da=xe(structuredClone(vb)),ki=xe(structuredClone(Mk)),Od=xe(structuredClone(Rk)),Ud=xe(structuredClone(kk)),Ga=xe(structuredClone(Fk)),Dd=xe(structuredClone(Ik)),za=xe(structuredClone(Bk)),Gd=xe(structuredClone(Uk)),zd=mt([Da,ki,Od,Ud,Ga,Dd,za,Gd],([r,e,t,n,i,s,o,a])=>({version:0,width:1273,height:711,scale:1,debug:!1,filter:r,background:e,logo:t,title:n,categories:i,stripe:s,roles:o,time:a})),La=xe({background:Wm.split(",")[0],background_loading:!1,background_width:1273,background_height:711,background_aspect:1273/711,logo:Gc.split(",")[0],app:void 0});function Dk(r,e){const t=r.target;e(t.dataset.value)}var Gk=Y('<div class="label svelte-7fu1cm"> </div>'),zk=Y('<button class="option svelte-7fu1cm"></button>'),Lk=Y('<div class="container svelte-7fu1cm"><!> <!></div>');function xb(r,e){let t=X(e,"value",15);var n=Lk(),i=ie(n);Fe(i,()=>e.label,o=>{var a=Gk(),l=ie(a);le(()=>bt(l,e.label)),N(o,a)});var s=I(i,2);Di(s,17,()=>e.options,Ui,(o,a)=>{var l=zk();l.__click=[Dk,t],le(()=>{ve(l,"style",`background: ${k(a)??""}`),ve(l,"aria-label",k(a)),ve(l,"data-value",k(a))}),N(o,l)}),N(r,n)}Zn(["click"]);var Nk=Y("<!> <!> <!> <!>",1),Hk=Y("<!> <!>",1),Vk=Y("<!> <!>",1);function Wk(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.stripe,"$stripe",t);let i=X(e,"collapsed",3,!1);ir(r,{title:"Полоса",get collapsed(){return i()},children:(s,o)=>{var a=Vk(),l=K(a);Te(l,{children:(c,d)=>{var h=Nk(),f=K(h);Z(f,{label:"X",get value(){return n().x},set value(v){D(e.stripe,y(n).x=v,y(n))}});var p=I(f,2);Z(p,{label:"Y",get value(){return n().y},set value(v){D(e.stripe,y(n).y=v,y(n))}});var m=I(p,2);Z(m,{label:"W",get value(){return n().w},set value(v){D(e.stripe,y(n).w=v,y(n))}});var g=I(m,2);Z(g,{label:"H",get value(){return n().h},set value(v){D(e.stripe,y(n).h=v,y(n))}}),N(c,h)},$$slots:{default:!0}});var u=I(l,2);Te(u,{children:(c,d)=>{var h=Hk(),f=K(h);At(f,{label:"color",get hex(){return n().color},set hex(m){D(e.stripe,y(n).color=m,y(n))}});var p=I(f,2);xb(p,{label:"palette",options:["#9047fe","#f05f2d"],get value(){return n().color},set value(m){D(e.stripe,y(n).color=m,y(n))}}),N(c,h)},$$slots:{default:!0}}),N(s,a)},$$slots:{default:!0}}),Se()}var jk=Y("<!> <!> <!> <!> <!> <!> <!>",1),Xk=Y("<!> <!> <!> <!>",1),qk=Y("<!> <!> <!> <!> <!>",1),Yk=Y("<!> <!> <!>",1);function bb(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.badges,"$badges",t);var i=Yk(),s=K(i);Te(s,{children:(l,u)=>{var c=jk(),d=K(c);Z(d,{label:"X",get value(){return n().x},set value(x){D(e.badges,y(n).x=x,y(n))}});var h=I(d,2);Z(h,{label:"Y",get value(){return n().y},set value(x){D(e.badges,y(n).y=x,y(n))}});var f=I(h,2);Z(f,{label:"H",get value(){return n().h},set value(x){D(e.badges,y(n).h=x,y(n))}});var p=I(f,2);Z(p,{label:"PX",get value(){return n().padding_x},set value(x){D(e.badges,y(n).padding_x=x,y(n))}});var m=I(p,2);Z(m,{label:"PY",get value(){return n().padding_y},set value(x){D(e.badges,y(n).padding_y=x,y(n))}});var g=I(m,2);Z(g,{label:"MX",get value(){return n().margin_x},set value(x){D(e.badges,y(n).margin_x=x,y(n))}});var v=I(g,2);Z(v,{label:"MY",get value(){return n().margin_y},set value(x){D(e.badges,y(n).margin_y=x,y(n))}}),N(l,c)},$$slots:{default:!0}});var o=I(s,2);Te(o,{children:(l,u)=>{var c=Xk(),d=K(c);Z(d,{label:"round",get value(){return n().round},set value(m){D(e.badges,y(n).round=m,y(n))},min:0});var h=I(d,2);Z(h,{label:"blur",get value(){return n().backdrop.blur},set value(m){D(e.badges,y(n).backdrop.blur=m,y(n))},min:0});var f=I(h,2);Z(f,{label:"backdrop",get value(){return n().backdrop.quality},set value(m){D(e.badges,y(n).backdrop.quality=m,y(n))},min:1});var p=I(f,2);At(p,{label:"bg",get hex(){return n().color},set hex(m){D(e.badges,y(n).color=m,y(n))}}),N(l,c)},$$slots:{default:!0}});var a=I(o,2);Te(a,{children:(l,u)=>{var c=qk(),d=K(c);Vt(d,{placeholder:"Arial",label:"font",get value(){return n().font.face},set value(g){D(e.badges,y(n).font.face=g,y(n))},width:100});var h=I(d,2);Z(h,{placeholder:"60",label:"size",get value(){return n().font.size},set value(g){D(e.badges,y(n).font.size=g,y(n))},min:0});var f=I(h,2);Z(f,{placeholder:"60",label:"lh",get value(){return n().font.line_height},set value(g){D(e.badges,y(n).font.line_height=g,y(n))},min:0});var p=I(f,2);Vt(p,{placeholder:"bold",label:"weight",get value(){return n().font.weight},set value(g){D(e.badges,y(n).font.weight=g,y(n))},width:40});var m=I(p,2);At(m,{label:"color",get hex(){return n().font.color},set hex(g){D(e.badges,y(n).font.color=g,y(n))}}),N(l,c)},$$slots:{default:!0}}),N(r,i),Se()}var Kk=Y("<!> <!>",1);function $k(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.roles,"$roles",t);ir(r,{title:"В ролях",children:(i,s)=>{var o=Kk(),a=K(o);Te(a,{children:(u,c)=>{io(u,{placeholder:"бейджики",get value(){return n().text},set value(d){D(e.roles,y(n).text=d,y(n))}})},$$slots:{default:!0}});var l=I(a,2);bb(l,{get badges(){return e.roles}}),N(i,o)},$$slots:{default:!0}}),Se()}var Zk=Y("<!> <!>",1),Qk=Y("<!> <!>",1);function Jk(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.datetime,"$datetime",t),i=n().text.split(",");let s=Ii(qe(i[0].trim())),o=Ii(qe(i[1].trim()));kr(()=>{D(e.datetime,y(n).text=`${k(s)},${k(o)}`,y(n))}),ir(r,{title:"Время",children:(a,l)=>{var u=Qk(),c=K(u);Te(c,{children:(h,f)=>{var p=Zk(),m=K(p);Vt(m,{placeholder:"день...",get value(){return k(s)},set value(v){ne(s,qe(v))},width:120});var g=I(m,2);Vt(g,{placeholder:"время...",get value(){return k(o)},set value(v){ne(o,qe(v))},width:120}),N(h,p)},$$slots:{default:!0}});var d=I(c,2);bb(d,{get badges(){return e.datetime}}),N(a,u)},$$slots:{default:!0}}),Se()}var e8=Y("<!> <!> <!> <!> <!> <!> <!> <!>",1);function t8(r){var e=e8(),t=K(e);Uc(t,{background:ki,appstate:La,datastate:zd});var n=I(t,2);Bc(n,{logo:Od,appstate:La});var i=I(n,2);Wk(i,{stripe:Dd,collapsed:!0});var s=I(i,2);Ic(s,{filter:Da,defaults:vb,collapsed:!0});var o=I(s,2);Jk(o,{datetime:Gd});var a=I(o,2);Hm(a,{title:Ud});var l=I(a,2);Nm(l,{categories:Ga});var u=I(l,2);$k(u,{roles:za}),N(r,e)}class r8 extends Id{text_group=new fe;title=new Si;background_group=new fe;backrgound=new Ke;logo_group=new fe;logo=new Ke;stripe=new Rr;categories_group=new fe;categories_block=new fe;categories_title=new Si({text:"В планах",x:0,y:-44,style:{fontFamily:"Gilroy",fontSize:24,fill:"#ffffff",fontWeight:"500",lineHeight:20}});roles_block=new fe;roles_group=new fe;roles_title=new Si({text:"В ролях",x:0,y:-44,style:{fontFamily:"Gilroy",fontSize:24,fill:"#ffffff",fontWeight:"500",lineHeight:20}});time_group=new fe;prev_filters;prev_category_round;async mount(e){this.prev_category_round=e.categories.round,this.backrgound=Ke.from(e.background.src),this.logo=Ke.from(e.logo.src),this.text_group.addChild(this.title),this.background_group.addChild(this.backrgound),this.logo_group.addChild(this.logo),this.categories_block.addChild(this.categories_title,this.categories_group),this.roles_block.addChild(this.roles_title,this.roles_group),this.app.stage.addChild(this.background_group,this.logo_group,this.stripe,this.categories_block,this.text_group,this.roles_block,this.time_group)}updateTitle(e){this.title.text=e.text;const t=this.title.text.split(`
`).length;this.title.y=e.y-(t-1)*Math.floor(e.font.line_height/2),this.title.x=e.x;const[n,i]=this.splitRGBA(e.shadow.color);this.title.style={fontFamily:e.font.face,fontSize:e.font.size,fill:e.font.color,fontWeight:e.font.weight,lineHeight:e.font.line_height,dropShadow:{color:n,blur:e.shadow.value,distance:0,alpha:i}}}async updateBackground(e,t){const n=await this.textures.get(e.src);n&&(this.backrgound.texture=n),this.backrgound.x=e.x,this.backrgound.y=e.y,this.backrgound.width=e.w,this.backrgound.height=e.h,e.flip_h?(this.backrgound.scale.x=-Math.abs(this.backrgound.scale.x),this.backrgound.x=this.backrgound.x+this.backrgound.width):this.backrgound.scale.x=Math.abs(this.backrgound.scale.x),e.flip_v?(this.backrgound.scale.y=-Math.abs(this.backrgound.scale.y),this.backrgound.y=this.backrgound.y+this.backrgound.height):this.backrgound.scale.y=Math.abs(this.backrgound.scale.y),!(this.prev_filters!==void 0&&this.diff(this.prev_filters,t).length===0)&&(this.prev_filters=structuredClone(t),this.background_group.filters=this.buildFilters(t,this.backrgound))}async updateLogo(e){this.logo.x=e.x,this.logo.y=e.y,this.logo.width=e.w,this.logo.height=e.h,this.logo.alpha=e.alpha;const t=await this.textures.get(e.src);t&&(this.logo.texture=t),this.logo.filters=[new er({strength:e.blur,quality:15})]}updateStripe(e){this.stripe.clear(),this.stripe.rect(e.x,e.y,e.w,e.h),this.stripe.fill(e.color)}async updateCategories(e,t){if(this.prev_category_round!=e.round){for(const o of this.categories_group.children){const a=this.createRoundedRectMask(e.w,e.h,e.round);o.removeChildAt(1);const l=o.children[0];l.mask=a,o.addChild(a)}this.prev_category_round=e.round;return}e.src.length===0?this.categories_title.renderable=!1:this.categories_title.renderable=!0,this.categories_block.x=e.x,this.categories_block.y=e.y;const{maxX:n}=this.roles_block.getBounds();n>e.x-t.margin_x*2&&(this.categories_block.x=n+t.margin_x*2);const[i,s]=this.splitRGBA(e.shadow.color);for(const[o,a]of e.src.entries()){const l=await this.textures.get(a);if(!l)continue;let u;if(o<this.categories_group.children.length){u=this.categories_group.getChildAt(o);const c=u.getChildAt(0);c.texture=l}else{u=new fe;const c=this.createRoundedRectMask(e.w,e.h,e.round),d=new Ke({width:e.w,height:e.h,texture:l,mask:c});u.addChild(d),u.addChild(c),this.categories_group.addChild(u)}u.x=o*(e.w+e.margin),u.y=0,u.width=e.w,u.height=e.h,u.filters=[new er({strength:e.blur,quality:15}),new Yx({offset:{x:0,y:0},color:parseInt(i.slice(1),16),alpha:s,blur:e.shadow.value,quality:15})]}for(;this.categories_group.children.length>e.src.length;)this.categories_group.removeChildAt(this.categories_group.children.length-1)}updateRoles(e,t){e.text.length===0?(this.roles_title.renderable=!1,this.categories_block.x=t.x):this.roles_title.renderable=!0,this.updateBadges(e,this.roles_group,this.roles_block);const{maxX:n}=this.roles_block.getBounds();n>t.x-e.margin_x*2&&(this.categories_block.x=n+e.margin_x*2)}updateTime(e){this.updateBadges(e,this.time_group)}updateBadges(e,t,n){function i(u,c,d){const h=new Si({text:d,x:e.padding_x-1,style:{fontFamily:e.font.face,fontSize:e.font.size,fill:e.font.color,fontWeight:e.font.weight,lineHeight:e.font.line_height}}),f=St.measureText(d,h.style),p=f.width+e.padding_x*2-1;h.y=Math.ceil(e.h/2-f.height/2);const m=new Rr().roundRect(0,0,p,e.h,e.round).fill(e.color);return m.filters=[new er({strength:.4,quality:10})],m.filterArea=new Le(0,0,p-1,e.h),{container:new fe({x:u,y:c,width:p,height:e.h,children:[m,h]}),width:p}}if(t.removeChildren(),n?(n.x=e.x,n.y=e.y):(t.x=e.x,t.y=e.y),e.text.length===0)return;let s=0,o=0;const a=e.text.split(`
`),l=new R5({strength:e.backdrop.blur,quality:e.backdrop.quality});for(let u=0;u<a.length;u++){const c=a[u].split(",");for(let d=0;d<c.length;d++){const{container:h,width:f}=i(s,o,c[d].trim());h.filters=[l],h.filterArea=new Le(-l.strength,-l.strength,h.width+l.strength*2,h.height+l.strength*2),t.addChild(h),s+=e.margin_x+f}o+=e.margin_y+e.h,s=0}}}function n8(r,e){ye(e,!1);const t=$e(),n=()=>oe(Da,"$filter",t),i=()=>oe(ki,"$background",t),s=()=>oe(za,"$roles",t),o=()=>oe(Ga,"$categories",t);function a(l){ki.subscribe(u=>{l.updateBackground(u,n())}),Da.subscribe(u=>{l.updateBackground(i(),u)}),Od.subscribe(u=>{l.updateLogo(u)}),Ud.subscribe(u=>{l.updateTitle(u)}),Ga.subscribe(u=>{l.updateCategories(u,s())}),za.subscribe(u=>{l.updateRoles(u,o())}),Gd.subscribe(u=>{l.updateTime(u)}),Dd.subscribe(u=>{l.updateStripe(u)})}kt(),Bd(r,{background:ki,subscriptions:a,datastate:zd,appstate:La,drawer:r8,back_buffer:!0,preload_font:"Gilroy"}),Se()}var ls={};const i8="bold|bolder|lighter|[1-9]00",s8="italic|oblique",o8="small-caps",a8="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",l8="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",Sp=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,u8=new RegExp(`(${i8}) +`,"i"),c8=new RegExp(`(${s8}) +`,"i"),d8=new RegExp(`(${o8}) +`,"i"),h8=new RegExp(`(${a8}) +`,"i"),f8=new RegExp(`([\\d\\.]+)(${l8}) *((?:${Sp})( *, *(?:${Sp}))*)`),fu={},p8=16;var m8=r=>{if(fu[r])return fu[r];const e=f8.exec(r);if(!e)return;const t={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(e[1]),unit:e[2],family:e[3].replace(/["']/g,"").replace(/ *, */g,",")};let n,i,s,o;const a=r.substring(0,e.index);switch((n=u8.exec(a))&&(t.weight=n[1]),(i=c8.exec(a))&&(t.style=i[1]),(s=d8.exec(a))&&(t.variant=s[1]),(o=h8.exec(a))&&(t.stretch=o[1]),t.unit){case"pt":t.size/=.75;break;case"pc":t.size*=16;break;case"in":t.size*=96;break;case"cm":t.size*=96/2.54;break;case"mm":t.size*=96/25.4;break;case"%":break;case"em":case"rem":t.size*=p8/.75;break;case"q":t.size*=96/25.4/4;break}return fu[r]=t};const g8=m8;ls.parseFont=g8;ls.createCanvas=function(r,e){return Object.assign(document.createElement("canvas"),{width:r,height:e})};ls.createImageData=function(r,e,t){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(r);case 2:return new ImageData(r,e);default:return new ImageData(r,e,t)}};ls.loadImage=function(r,e){return new Promise(function(t,n){const i=Object.assign(document.createElement("img"),e);function s(){i.onload=null,i.onerror=null}i.onload=function(){s(),t(i)},i.onerror=function(){s(),n(new Error('Failed to load the image "'+r+'"'))},i.src=r})};const{createCanvas:v8}=ls;var x8=class{constructor(e){const{width:t,height:n}=e;this.canvas=v8(t,n),this.context=this.canvas.getContext("2d"),this.width=t,this.height=n,this.context.drawImage(e,0,0,this.width,this.height)}clear(){this.context.clearRect(0,0,this.width,this.height)}update(e){this.context.putImageData(e,0,0)}getPixelCount(){return this.width*this.height}getImageData(){return this.context.getImageData(0,0,this.width,this.height)}},_b={};/*!
 * quantize.js Copyright 2008 Nick Rabinowitz.
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 * @license
 *//*!
 * Block below copied from Protovis: http://mbostock.github.com/protovis/
 * Copyright 2010 Stanford Visualization Group
 * Licensed under the BSD License: http://www.opensource.org/licenses/bsd-license.php
 * @license
 */const Ys={map(r,e){const t={};return e?r.map((n,i)=>(t.index=i,e.call(t,n))):r.slice()},naturalOrder(r,e){return r<e?-1:r>e?1:0},sum(r,e){const t={};return r.reduce(e?(n,i,s)=>(t.index=s,n+e.call(t,i)):(n,i)=>n+i,0)},max(r,e){return Math.max.apply(null,e?Ys.map(r,e):r)}},Ks=5,jr=8-Ks,wp=1e3,b8=.75,Fi=(r,e,t)=>(r<<2*Ks)+(e<<Ks)+t;class dc{constructor(e){this.comparator=e,this.contents=[],this.sorted=!1}sort(){this.contents.sort(this.comparator),this.sorted=!0}push(e){this.contents.push(e),this.sorted=!1}peek(e){return this.sorted||this.sort(),e===void 0&&(e=this.contents.length-1),this.contents[e]}pop(){return this.sorted||this.sort(),this.contents.pop()}size(){return this.contents.length}map(e){return this.contents.map(e)}debug(){return this.sorted||this.sort(),this.contents}}class Ld{constructor(e,t,n,i,s,o,a){this.r1=e,this.r2=t,this.g1=n,this.g2=i,this.b1=s,this.b2=o,this.histo=a}volume(e){let t=this;return(!t._volume||e)&&(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume}count(e){let t=this,n=t.histo;if(!t._count_set||e){let i=0,s,o,a,l;for(o=t.r1;o<=t.r2;o++)for(a=t.g1;a<=t.g2;a++)for(l=t.b1;l<=t.b2;l++)s=Fi(o,a,l),i+=n[s]||0;t._count=i,t._count_set=!0}return t._count}copy(){let e=this;return new Ld(e.r1,e.r2,e.g1,e.g2,e.b1,e.b2,e.histo)}avg(e){let t=this,n=t.histo;if(!t._avg||e){let i=0,s=1<<8-Ks,o=0,a=0,l=0,u,c,d,h,f;for(c=t.r1;c<=t.r2;c++)for(d=t.g1;d<=t.g2;d++)for(h=t.b1;h<=t.b2;h++)f=Fi(c,d,h),u=n[f]||0,i+=u,o+=u*(c+.5)*s,a+=u*(d+.5)*s,l+=u*(h+.5)*s;i?t._avg=[~~(o/i),~~(a/i),~~(l/i)]:t._avg=[~~(s*(t.r1+t.r2+1)/2),~~(s*(t.g1+t.g2+1)/2),~~(s*(t.b1+t.b2+1)/2)]}return t._avg}contains(e){let t=this,n=e[0]>>jr;return gval=e[1]>>jr,bval=e[2]>>jr,n>=t.r1&&n<=t.r2&&gval>=t.g1&&gval<=t.g2&&bval>=t.b1&&bval<=t.b2}}class _8{constructor(){this.vboxes=new dc((e,t)=>Ys.naturalOrder(e.vbox.count()*e.vbox.volume(),t.vbox.count()*t.vbox.volume()))}push(e){this.vboxes.push({vbox:e,color:e.avg()})}palette(){return this.vboxes.map(e=>e.color)}size(){return this.vboxes.size()}map(e){let t=this.vboxes;for(let n=0;n<t.size();n++)if(t.peek(n).vbox.contains(e))return t.peek(n).color;return this.nearest(e)}nearest(e){let t=this.vboxes,n,i,s;for(let o=0;o<t.size();o++)i=Math.sqrt(Math.pow(e[0]-t.peek(o).color[0],2)+Math.pow(e[1]-t.peek(o).color[1],2)+Math.pow(e[2]-t.peek(o).color[2],2)),(i<n||n===void 0)&&(n=i,s=t.peek(o).color);return s}}const y8=r=>{let e=1<<3*Ks,t=new Array(e),n,i,s,o;return r.forEach(a=>{i=a[0]>>jr,s=a[1]>>jr,o=a[2]>>jr,n=Fi(i,s,o),t[n]=(t[n]||0)+1}),t},S8=(r,e)=>{let t=1e6,n=0,i=1e6,s=0,o=1e6,a=0,l,u,c;return r.forEach(d=>{l=d[0]>>jr,u=d[1]>>jr,c=d[2]>>jr,l<t?t=l:l>n&&(n=l),u<i?i=u:u>s&&(s=u),c<o?o=c:c>a&&(a=c)}),new Ld(t,n,i,s,o,a,e)},w8=(r,e)=>{if(!e.count())return;let t=e.r2-e.r1+1,n=e.g2-e.g1+1,i=e.b2-e.b1+1,s=Ys.max([t,n,i]);if(e.count()==1)return[e.copy()];let o=0,a=[],l=[],u,c,d,h,f;if(s==t)for(u=e.r1;u<=e.r2;u++){for(h=0,c=e.g1;c<=e.g2;c++)for(d=e.b1;d<=e.b2;d++)f=Fi(u,c,d),h+=r[f]||0;o+=h,a[u]=o}else if(s==n)for(u=e.g1;u<=e.g2;u++){for(h=0,c=e.r1;c<=e.r2;c++)for(d=e.b1;d<=e.b2;d++)f=Fi(c,u,d),h+=r[f]||0;o+=h,a[u]=o}else for(u=e.b1;u<=e.b2;u++){for(h=0,c=e.r1;c<=e.r2;c++)for(d=e.g1;d<=e.g2;d++)f=Fi(c,d,u),h+=r[f]||0;o+=h,a[u]=o}a.forEach((m,g)=>{l[g]=o-m});const p=m=>{let g=m+"1",v=m+"2",x,b,_,w,C,P=0;for(u=e[g];u<=e[v];u++)if(a[u]>o/2){for(_=e.copy(),w=e.copy(),x=u-e[g],b=e[v]-u,x<=b?C=Math.min(e[v]-1,~~(u+b/2)):C=Math.max(e[g],~~(u-1-x/2));!a[C];)C++;for(P=l[C];!P&&a[C-1];)P=l[--C];return _[v]=C,w[g]=_[v]+1,[_,w]}};return s==t?p("r"):s==n?p("g"):p("b")};_b.quantize=(r,e)=>{if(!r.length||e<2||e>256)return!1;let t=y8(r),n=0;t.forEach(()=>n++);let i=S8(r,t),s=new dc((u,c)=>Ys.naturalOrder(u.count(),c.count()));s.push(i);const o=(u,c)=>{let d=1,h=0,f;for(;h<wp;){if(f=u.pop(),!f.count()){u.push(f),h++;continue}let p=w8(t,f),m=p[0],g=p[1];if(!m||(u.push(m),g&&(u.push(g),d++),d>=c)||h++>wp)return}};o(s,b8*e);let a=new dc((u,c)=>Ys.naturalOrder(u.count()*u.volume(),c.count()*c.volume()));for(;s.size();)a.push(s.pop());o(a,e-a.size());let l=new _8;for(;a.size();)l.push(a.pop());return l};/**
 * Color Thief v2.0
 * by Lokesh Dhakar - http://www.lokeshdhakar.com
 *
 * Thanks
 * ------
 * Nick Rabinowitz - For creating quantize.js.
 * John Schulz - For clean up and optimization. @JFSIII
 * Nathan Spady - For adding drag and drop support to the demo page.
 *
 * License
 * -------
 * Copyright 2011, 2015 Lokesh Dhakar
 * Released under the MIT license
 * https://raw.githubusercontent.com/lokesh/color-thief/master/LICENSE
 *
 * @license
 */const{loadImage:T8}=ls,C8=x8,{quantize:P8}=_b,A8=(r,e=5,t=5)=>{(e<2||e>256)&&(e=5),t<1&&(t=5);const n=new C8(r),s=n.getImageData().data,o=n.getPixelCount(),a=[];for(let c=0,d,h,f,p,m;c<o;c+=t)d=c*4,h=s[d+0],f=s[d+1],p=s[d+2],m=s[d+3],m>=125&&(h>250&&f>250&&p>250||a.push([h,f,p]));const l=P8(a,e);return l?l.palette():[[255,255,255]]};var E8=async(r,e,t)=>T8(r).then(n=>A8(n,e,t)),M8=Y("<!> <!> <!> <!>",1),R8=Y("<!> <!> <!> <!>",1),k8=Y("<!> <!> <!> <!> <!> <!>",1),F8=Y("<!> <!>",1),I8=Y("<!> <!> <!> <!> <!>",1);function B8(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.background,"$background",t),i=()=>oe(e.title_badge,"$title_badge",t);let s,o=["#d42834","#9047fe","#f27930"],a=Ii(qe(o));function l([u,c,d]){return u=Math.max(0,Math.min(255,u)),c=Math.max(0,Math.min(255,c)),d=Math.max(0,Math.min(255,d)),`#${((1<<24)+(u<<16)+(c<<8)+d).toString(16).slice(1).toUpperCase()}`}kr(()=>{n().src!==s&&(s=n().src,E8(n().src,12,10).then(u=>{ne(a,qe([...o,...u.map(l)]))}))}),ir(r,{title:"Плашечка",children:(u,c)=>{var d=I8(),h=K(d);Te(h,{children:(v,x)=>{io(v,{placeholder:"заголовок...",get value(){return i().text},set value(b){D(e.title_badge,y(i).text=b,y(i))},tabindex:2})},$$slots:{default:!0}});var f=I(h,2);Te(f,{children:(v,x)=>{var b=M8(),_=K(b);Z(_,{label:"center X",get value(){return i().x},set value(S){D(e.title_badge,y(i).x=S,y(i))}});var w=I(_,2);Z(w,{label:"center Y",get value(){return i().y},set value(S){D(e.title_badge,y(i).y=S,y(i))}});var C=I(w,2);Z(C,{label:"min W",get value(){return i().rect.w},set value(S){D(e.title_badge,y(i).rect.w=S,y(i))},min:0});var P=I(C,2);Z(P,{label:"min H",get value(){return i().rect.h},set value(S){D(e.title_badge,y(i).rect.h=S,y(i))},min:0}),N(v,b)},$$slots:{default:!0}});var p=I(f,2);Te(p,{children:(v,x)=>{var b=R8(),_=K(b);Z(_,{label:"border",get value(){return i().rect.border_width},set value(S){D(e.title_badge,y(i).rect.border_width=S,y(i))},min:0});var w=I(_,2);Z(w,{label:"PX",get value(){return i().rect.padding_x},set value(S){D(e.title_badge,y(i).rect.padding_x=S,y(i))},min:0});var C=I(w,2);Z(C,{label:"PY",get value(){return i().rect.padding_y},set value(S){D(e.title_badge,y(i).rect.padding_y=S,y(i))},min:0});var P=I(C,2);At(P,{label:"bg",get hex(){return i().rect.color},set hex(S){D(e.title_badge,y(i).rect.color=S,y(i))}}),N(v,b)},$$slots:{default:!0}});var m=I(p,2);Te(m,{children:(v,x)=>{var b=k8(),_=K(b);Vt(_,{placeholder:"Arial",label:"font",get value(){return i().font.face},set value(E){D(e.title_badge,y(i).font.face=E,y(i))},width:90});var w=I(_,2);Z(w,{placeholder:"60",label:"size",get value(){return i().font.size},set value(E){D(e.title_badge,y(i).font.size=E,y(i))},min:0,width:35});var C=I(w,2);Z(C,{placeholder:"60",label:"lh",get value(){return i().font.line_height},set value(E){D(e.title_badge,y(i).font.line_height=E,y(i))},min:0,width:35});var P=I(C,2);Vt(P,{placeholder:"bold",label:"weight",get value(){return i().font.weight},set value(E){D(e.title_badge,y(i).font.weight=E,y(i))},width:30});var S=I(P,2);Z(S,{placeholder:"12",label:"sp",get value(){return i().font.space_width},set value(E){D(e.title_badge,y(i).font.space_width=E,y(i))},min:0,width:35});var A=I(S,2);At(A,{label:"color",get hex(){return i().font.color},set hex(E){D(e.title_badge,y(i).font.color=E,y(i))}}),N(v,b)},$$slots:{default:!0}});var g=I(m,2);Te(g,{children:(v,x)=>{var b=F8(),_=K(b);At(_,{label:"accent",get hex(){return i().accent},set hex(C){D(e.title_badge,y(i).accent=C,y(i))}});var w=I(_,2);xb(w,{label:"palette",get options(){return k(a)},get value(){return i().accent},set value(C){D(e.title_badge,y(i).accent=C,y(i))}}),N(v,b)},$$slots:{default:!0}}),N(u,d)},$$slots:{default:!0}}),Se()}const yb={adjustment:{enabled:!1,gamma:1,saturation:1,contrast:1,brightness:1},blur:{enabled:!0,value:.2},tilt_shift:{enabled:!1,blur:5,start:{x:0,y:300},end:{x:1280,y:960}},vignetting:{enabled:!1,value:.2,alpha:.75,blur:.3},zoom_blur:{enabled:!1,center:{x:640,y:450},value:.03,radius:440},gradient:{enabled:!0,orientation:"vertical",start:{value:0,color:"#000000b3"},mid:{value:.25,color:"#0000008a"},end:{value:.5,color:"#00000000"}}},O8={src:jm,x:0,y:0,w:1280,h:960,flip_h:!1,flip_v:!1,paste_mode:"aspect"},Sb={src:qm,x:1030,y:70,w:180,h:146,blur:.1,alpha:.3},U8={enabled:!1,src:Ym,x:917,y:69,w:292,h:119,blur:.1,alpha:.6,translate_x:685,translate_y:69,translate_w:144,translate_h:119},D8={text:`Розыгрыш
%Розыгрыша`,x:640,y:730,accent:"#d42834",font:{face:"U.S. 101",size:82,weight:"400",color:"#ffffff",line_height:76,space_width:12},rect:{w:608,h:219,border_width:9,color:"#000000cc",padding_x:20,padding_y:20},footnote:{enabled:!1,text:"Для подписчиков boosty TIER 3-6 и %KING %OF %BOOSTY",image:Eu(),size:32,space_width:5,margin:46}},Na=xe(structuredClone(yb)),zn=xe(structuredClone(O8)),$s=xe(structuredClone(Sb)),Nd=xe(structuredClone(U8)),Ha=xe(structuredClone(D8)),Hd=mt([Na,zn,$s,Ha,Nd],([r,e,t,n,i])=>({version:0,width:1280,height:960,scale:.9,debug:!1,filter:r,background:e,logo:t,custom_logo:i,title_badge:n})),Is=xe({background:jm.split(",")[0],background_loading:!1,background_width:1280,background_height:960,background_aspect:1280/960,logo:qm.split(",")[0],custom_logo:Ym.split(",")[0],app:void 0});var G8=Y("<!> <!> <!> <!> <!> <!> <!>",1),z8=Y("<!> <!>",1);function L8(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.custom_logo,"$custom_logo",t),i=()=>oe(e.logo,"$logo",t),s=()=>oe(e.appstate,"$appstate",t);kr(()=>{n().enabled?(D(e.logo,y(i).x=n().translate_x,y(i)),D(e.logo,y(i).y=n().translate_y,y(i)),D(e.logo,y(i).w=n().translate_w,y(i)),D(e.logo,y(i).h=n().translate_h,y(i)),D(e.logo,y(i).alpha=n().alpha,y(i))):(D(e.logo,y(i).x=e.default_logo.x,y(i)),D(e.logo,y(i).y=e.default_logo.y,y(i)),D(e.logo,y(i).w=e.default_logo.w,y(i)),D(e.logo,y(i).h=e.default_logo.h,y(i)),D(e.logo,y(i).alpha=e.default_logo.alpha,y(i)))});function o(a){D(e.custom_logo,y(n).src=a.target?.value,y(n))}ir(r,{title:"Ещё лого",collapsed:!0,children:(a,l)=>{var u=z8(),c=K(u);Te(c,{children:(h,f)=>{Vt(h,{placeholder:"ссылка на картинку логотипа...",get value(){return s().custom_logo},set value(p){D(e.appstate,y(s).custom_logo=p,y(s))},onchange:o})},$$slots:{default:!0}});var d=I(c,2);Te(d,{children:(h,f)=>{var p=G8(),m=K(p);Im(m,{label:"on",get checked(){return n().enabled},set checked(C){D(e.custom_logo,y(n).enabled=C,y(n))}});var g=I(m,2);Z(g,{label:"X",get value(){return n().x},set value(C){D(e.custom_logo,y(n).x=C,y(n))}});var v=I(g,2);Z(v,{label:"Y",get value(){return n().y},set value(C){D(e.custom_logo,y(n).y=C,y(n))}});var x=I(v,2);Z(x,{label:"W",get value(){return n().w},set value(C){D(e.custom_logo,y(n).w=C,y(n))}});var b=I(x,2);Z(b,{label:"H",get value(){return n().h},set value(C){D(e.custom_logo,y(n).h=C,y(n))}});var _=I(b,2);Z(_,{label:"blur",get value(){return n().blur},set value(C){D(e.custom_logo,y(n).blur=C,y(n))},step:.1,min:0});var w=I(_,2);Z(w,{label:"α",get value(){return n().alpha},set value(C){D(e.custom_logo,y(n).alpha=C,y(n))},step:.01,min:0,max:1}),N(h,p)},$$slots:{default:!0}}),N(a,u)},$$slots:{default:!0}}),Se()}var N8=Y("<!> <!> <!> <!>",1),H8=Y("<!> <!>",1);function V8(r,e){ye(e,!0);const t=$e(),n=()=>oe(e.title_badge,"$title_badge",t);ir(r,{title:"Сноска",collapsed:!0,children:(i,s)=>{var o=H8(),a=K(o);Te(a,{children:(u,c)=>{io(u,{placeholder:"текст сноски...",get value(){return n().footnote.text},set value(d){D(e.title_badge,y(n).footnote.text=d,y(n))}})},$$slots:{default:!0}});var l=I(a,2);Te(l,{children:(u,c)=>{var d=N8(),h=K(d);Im(h,{label:"on",get checked(){return n().footnote.enabled},set checked(g){D(e.title_badge,y(n).footnote.enabled=g,y(n))}});var f=I(h,2);Z(f,{label:"size",get value(){return n().footnote.size},set value(g){D(e.title_badge,y(n).footnote.size=g,y(n))}});var p=I(f,2);Z(p,{label:"margin",get value(){return n().footnote.margin},set value(g){D(e.title_badge,y(n).footnote.margin=g,y(n))}});var m=I(p,2);Z(m,{label:"sp",get value(){return n().footnote.space_width},set value(g){D(e.title_badge,y(n).footnote.space_width=g,y(n))}}),N(u,d)},$$slots:{default:!0}}),N(i,o)},$$slots:{default:!0}}),Se()}var W8=Y("<!> <!> <!> <!> <!> <!>",1);function j8(r){var e=W8(),t=K(e);Uc(t,{background:zn,appstate:Is,datastate:Hd});var n=I(t,2);Bc(n,{logo:$s,appstate:Is});var i=I(n,2);L8(i,{logo:$s,custom_logo:Nd,appstate:Is,default_logo:Sb});var s=I(i,2);Ic(s,{filter:Na,defaults:yb});var o=I(s,2);B8(o,{title_badge:Ha,background:zn});var a=I(o,2);V8(a,{title_badge:Ha}),N(r,e)}class X8 extends Id{background_group=new fe;backrgound=new Ke;logo_group=new fe({renderable:!1});logo=new Ke;custom_logo_group=new fe({renderable:!1});custom_logo=new Ke;custom_logo_x=new Qf({text:"x",x:0,y:0,style:{fontFamily:"Gilroy",fontSize:72,fill:"#ffffff",fontWeight:"700",lineHeight:20}});title_badge_group=new fe;boosty_logo=new Ke;prev_filters;prev_title_badge;async mount(e){this.backrgound=Ke.from(e.background.src,!0),this.logo=Ke.from(e.logo.src,!0),this.custom_logo=Ke.from(e.custom_logo.src,!0),this.boosty_logo=Ke.from(Eu(e.title_badge.accent),!0),this.boosty_logo.filters=[new er({strength:.2,quality:5})],this.custom_logo_group.renderable=!1,this.title_badge_group.x=0,this.title_badge_group.y=0,this.title_badge_group.width=e.width,this.title_badge_group.height=e.height,this.background_group.addChild(this.backrgound),this.logo_group.addChild(this.logo),this.custom_logo_group.addChild(this.custom_logo,this.custom_logo_x),this.app.stage.addChild(this.background_group,this.logo_group,this.custom_logo_group,this.title_badge_group)}async update(e){}async updateBackground(e,t){const n=await this.textures.get(e.src);n&&(this.backrgound.texture=n),this.backrgound.x=e.x,this.backrgound.y=e.y,this.backrgound.width=e.w,this.backrgound.height=e.h,e.flip_h?(this.backrgound.scale.x=-Math.abs(this.backrgound.scale.x),this.backrgound.x=this.backrgound.x+this.backrgound.width):this.backrgound.scale.x=Math.abs(this.backrgound.scale.x),e.flip_v?(this.backrgound.scale.y=-Math.abs(this.backrgound.scale.y),this.backrgound.y=this.backrgound.y+this.backrgound.height):this.backrgound.scale.y=Math.abs(this.backrgound.scale.y),!(this.prev_filters!==void 0&&this.diff(this.prev_filters,t).length===0)&&(this.prev_filters=structuredClone(t),this.background_group.filters=this.buildFilters(t,this.backrgound))}async updateLogo(e){this.logo_group.renderable=!0,this.logo.x=e.x,this.logo.y=e.y,this.logo.width=e.w,this.logo.height=e.h,this.logo.alpha=e.alpha;const t=await this.textures.get(e.src);t&&(this.logo.texture=t),this.logo.filters=[new er({strength:e.blur,quality:15})]}async updateCustomLogo(e,t){if(!e.enabled){this.custom_logo_group.renderable=!1;return}this.custom_logo_group.renderable=!0,this.custom_logo.x=e.x,this.custom_logo.y=e.y,this.custom_logo.width=e.w,this.custom_logo.height=e.h,this.custom_logo.alpha=e.alpha;const n=await this.textures.get(e.src);n&&(this.custom_logo.texture=n),this.custom_logo.filters=[new er({strength:e.blur,quality:15})];const i=St.measureText(this.custom_logo_x.text,this.custom_logo_x.style);this.custom_logo_x.x=(t.x+t.w+e.x)/2-i.width/2,this.custom_logo_x.y=(e.y+e.h)/2-i.height/4,this.custom_logo_x.alpha=e.alpha}async updateTitleBadge(e){this.title_badge_group.removeChildren();const t=await this.textures.get(Eu(e.accent));t&&(this.boosty_logo.texture=t);function n(d,h,f,p){const m=new Rr().rect(d,h,f,p).fill(e.rect.color),g=new Rr().rect(d-e.rect.border_width,h-e.rect.border_width,f+e.rect.border_width*2,e.rect.border_width).rect(d-e.rect.border_width,h+p,f+e.rect.border_width*2,e.rect.border_width).rect(d-e.rect.border_width,h-e.rect.border_width,e.rect.border_width,p+e.rect.border_width*2).rect(d+f,h-e.rect.border_width,e.rect.border_width,p+e.rect.border_width*2).fill(e.accent);function v(C,P,S=1){return new Rr().moveTo(C,P).lineTo(C+30*S,P-30).lineTo(C+38*S,P-22).lineTo(C+16*S,P).lineTo(C+38*S,P+22).lineTo(C+30*S,P+30).lineTo(C,P).fill(e.accent)}const x=new fe,b=73,_=23,w=25;return x.addChild(m,g,v(d-b,h+_),v(d-(b+w),h+_),v(d+f+b,h+p-_,-1),v(d+f+(b+w),h+p-_,-1)),x.filters=[new er({strength:.4,quality:5})],x}const i=(d,h,f,p,m,g)=>{const v=d.split(`
`),x=new fe,b={fontFamily:e.font.face,fontSize:p,fill:e.font.color,fontWeight:e.font.weight,lineHeight:m};let _=0;for(let w=0;w<v.length;w++){const C=v[w],P=new fe,S=[];let A=0;for(let U of C.split(" ")){let L=!1;if(U.toLocaleLowerCase()==="boosty"){this.boosty_logo.width=m*3.5,this.boosty_logo.height=m+5,this.boosty_logo.y=-1,S.push({width:this.boosty_logo.width,height:this.boosty_logo.height}),A+=this.boosty_logo.width+g,P.addChild(this.boosty_logo);continue}U.startsWith("%")&&(L=!0,U=U.slice(1));const R=new Qf({text:U,resolution:2,style:{...b,fill:L?e.accent:e.font.color}}),T=St.measureText(U,R.style);A+=T.width+g,S.push(T),P.addChild(R)}A-=g,P.y=f+Math.floor((w-(v.length-1)/2)*m-S[0].height/2),_=Math.max(_,A);let E=h-A/2;for(let U=0;U<S.length;U++){const L=P.getChildAt(U),R=S[U];L.x=E,E+=R.width+g}x.addChild(P)}return{text:x,max_width:_,height:v.length*m}},{text:s,max_width:o,height:a}=i(e.text,e.x,e.y,e.font.size,e.font.line_height,e.font.space_width);let l=e.rect.w,u=e.rect.h;o>l-e.rect.padding_x*2&&(l=o+e.rect.padding_x*2),a>u-e.rect.padding_y*2&&(u=a+e.rect.padding_y*2);const c=n(e.x-l/2,e.y-u/2,l,u);if(this.title_badge_group.addChild(c,s),e.footnote.enabled){const{text:d}=i(e.footnote.text,e.x,e.y+u/2+e.footnote.margin,e.footnote.size,e.footnote.size,e.footnote.space_width);this.title_badge_group.addChild(d)}}}function q8(r,e){ye(e,!1);const t=$e(),n=()=>oe(Na,"$filter",t),i=()=>oe(zn,"$background",t),s=()=>oe($s,"$logo",t);function o(a){zn.subscribe(l=>{a.updateBackground(l,n())}),Na.subscribe(l=>{a.updateBackground(i(),l)}),$s.subscribe(l=>{a.updateLogo(l)}),Nd.subscribe(l=>{a.updateCustomLogo(l,s())}),Ha.subscribe(l=>{a.updateTitleBadge(l)})}kt(),Bd(r,{background:zn,subscriptions:o,datastate:Hd,appstate:Is,drawer:X8,back_buffer:!0,preload_font:"U.S. 101"}),Se()}function Y8(r,e){const t=nr(e,["children","$$slots","$$events","$$legacy"]);mn(r,Kr({name:"youtube"},()=>t,{iconNode:[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17"}],["path",{d:"m10 15 5-3-5-3z"}]],children:(i,s)=>{var o=Pe(),a=K(o);tr(a,rr(e),{}),N(i,o)},$$slots:{default:!0}}))}function K8(r,e){const t=nr(e,["children","$$slots","$$events","$$legacy"]);mn(r,Kr({name:"twitch"},()=>t,{iconNode:[["path",{d:"M21 2H3v16h5v4l4-4h5l4-4V2zm-10 9V7m5 4V7"}]],children:(i,s)=>{var o=Pe(),a=K(o);tr(a,rr(e),{}),N(i,o)},$$slots:{default:!0}}))}function $8(r,e){const t=nr(e,["children","$$slots","$$events","$$legacy"]);mn(r,Kr({name:"send"},()=>t,{iconNode:[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]],children:(i,s)=>{var o=Pe(),a=K(o);tr(a,rr(e),{}),N(i,o)},$$slots:{default:!0}}))}var Z8=Y("<div><!> </div>"),Q8=Y("<div></div>"),J8=Y('<div class="container svelte-1p7cd3z"><button><!> </button> <!></div>');function eF(r,e){ye(e,!0);const t=$e(),n=()=>oe(c,"$trigger",t),i=()=>oe(f,"$selectedLabel",t),s=()=>oe(p,"$open",t),o=()=>oe(d,"$menu",t),a=()=>oe(h,"$option",t),l=(P,S=Pt)=>{var A=Pe(),E=K(A);Fe(E,()=>S()==="youtube",U=>{Y8(U,{})},U=>{var L=Pe(),R=K(L);Fe(R,()=>S()==="twitch",T=>{K8(T,{})},T=>{var B=Pe(),z=K(B);Fe(z,()=>S()==="post",G=>{$8(G,{})},null,!0),N(T,B)},!0),N(U,L)}),N(P,A)};let u=X(e,"selected",15);const{elements:{trigger:c,menu:d,option:h},states:{selectedLabel:f,open:p},helpers:{isSelected:m}}=y1({forceVisible:!0,positioning:{placement:"bottom",fitViewport:!0,sameWidth:!0},defaultSelected:{value:u(),label:u()},onSelectedChange:({curr:P,next:S})=>(u(S.value),S)});function g(P){switch(P){case"youtube":return"Youtube";case"twitch":return"Twitch";case"post":return"Телеграм";default:return P}}var v=J8(),x=ie(v);let b;var _=ie(x);l(_,i);var w=I(_,1,!0);le(()=>bt(w,g(i())||"Выберите шаблон..."));var C=I(x,2);Fe(C,s,P=>{var S=Q8();let A;Di(S,21,()=>e.options,Ui,(E,U)=>{var L=Z8();let R;le(()=>R=at(L,R,{class:"option",...a()({value:k(U),label:k(U)})},"svelte-1p7cd3z"));var T=ie(L);l(T,()=>k(U));var B=I(T);le(()=>bt(B,` ${g(k(U))??""}`)),xt(L,z=>h(z)),N(E,L)}),le(()=>A=at(S,A,{class:"options",...o()},"svelte-1p7cd3z")),xt(S,E=>d(E)),Gs(3,S,()=>Fc,()=>({duration:150})),N(P,S)}),le(()=>b=at(x,b,{class:"",...n(),"aria-label":"Шаблоны"},"svelte-1p7cd3z")),xt(x,P=>c(P)),N(r,v),Se()}var tF=Y('<div class="container svelte-1wdpzi2"><main class="svelte-1wdpzi2"><div class="selector svelte-1wdpzi2"><!></div> <!></main> <aside class="svelte-1wdpzi2"><!></aside></div>');function rF(r,e){ye(e,!0);const t=$e(),n=()=>oe(l,"$appstate",t),i=()=>oe(a,"$background",t),s=()=>oe(u,"$datastate",t);let o=Ii(qe(localStorage.getItem("template")??"youtube")),a,l,u,c="";window.addEventListener("texture_loaded",w=>{w.detail===c&&(D(l,y(n).background_loading=!1,y(n)),c="")}),kr(()=>{switch(k(o)){case"youtube":a=Ei,u=Nc,l=Ta;break;case"twitch":a=ki,u=zd,l=La;break;case"post":a=zn,u=Hd,l=Is}localStorage.setItem("template",k(o)),zr()});function d(w){w?.target?.nodeName==="INPUT"||w?.target?.nodeName==="TEXTAREA"||f(w.clipboardData?.items)&&w.preventDefault()}function h(w){f(w.dataTransfer?.items)}function f(w){if(!w)return!1;for(const C of Object.values(w)){if(C.kind!=="file")continue;D(l,y(n).background_loading=!0,y(n));const P=C.getAsFile(),S=new FileReader;S.onload=A=>{const E=A.target?.result,U=E.split(",")[0];if(c=E,U.includes("data:image")){if(D(l,y(n).background=U,y(n)),i().paste_mode==="fit"){Gr(a,qe({...i(),src:E,x:0,y:0,w:s().width,h:s().height}));const L=new Image;L.src=E,L.onload=()=>{Gr(l,qe({...n(),background_width:L.width,background_height:L.height,background_aspect:L.width/L.height}))}}else if(i().paste_mode==="aspect"){const L=new Image;L.src=E,L.onload=()=>{const R=Oc(s().width,s().height,L.width,L.height);Gr(a,qe({...i(),...R,src:E})),Gr(l,qe({...n(),background_width:L.width,background_height:L.height,background_aspect:L.width/L.height}))}}return!0}},S.onerror=()=>{D(l,y(n).background_loading=!1,y(n)),alert("Error reading file")},S.onabort=S.onerror,P&&S.readAsDataURL(P)}return!1}var p=tF();ge("paste",zt,d),ge("dragover",zt,pr(function(w){bu.call(this,e,w)})),ge("drop",zt,pr(h));var m=ie(p),g=ie(m),v=ie(g);eF(v,{options:["youtube","twitch","post"],get selected(){return k(o)},set selected(w){ne(o,qe(w))}});var x=I(g,2);Fe(x,()=>k(o)==="youtube",w=>{var C=Pe(),P=K(C);Ot(P,()=>Ek,(S,A)=>{A(S,{})}),N(w,C)},w=>{var C=Pe(),P=K(C);Fe(P,()=>k(o)==="twitch",S=>{var A=Pe(),E=K(A);Ot(E,()=>n8,(U,L)=>{L(U,{})}),N(S,A)},S=>{var A=Pe(),E=K(A);Fe(E,()=>k(o)==="post",U=>{var L=Pe(),R=K(L);Ot(R,()=>q8,(T,B)=>{B(T,{})}),N(U,L)},U=>{var L=Ar("empty");N(U,L)},!0),N(S,A)},!0),N(w,C)});var b=I(m,2),_=ie(b);Fe(_,()=>k(o)==="youtube",w=>{var C=Pe(),P=K(C);Ot(P,()=>XS,(S,A)=>{A(S,{})}),N(w,C)},w=>{var C=Pe(),P=K(C);Fe(P,()=>k(o)==="twitch",S=>{var A=Pe(),E=K(A);Ot(E,()=>t8,(U,L)=>{L(U,{})}),N(S,A)},S=>{var A=Pe(),E=K(A);Fe(E,()=>k(o)==="post",U=>{var L=Pe(),R=K(L);Ot(R,()=>j8,(T,B)=>{B(T,{})}),N(U,L)},U=>{var L=Ar("empty");N(U,L)},!0),N(S,A)},!0),N(w,C)}),N(r,p),Se()}var nF=Y('<div id="build" class="svelte-1lsgswv"></div> <!>',1);function iF(r,e){ye(e,!1);let t="2024-10-13T11:30:44.909Z";kt();var n=nF(),i=K(n);i.textContent=`build ${t}`;var s=I(i,2);rF(s,{}),N(r,n),Se()}C_(iF,{target:document.getElementById("app")});he.add(Pg);fe.mixin(Zw);he.add(jg);he.add(Xg);he.add(_v);fe.mixin(pA);he.add(lx);he.add(ad);he.add(dx);he.add(fx);he.add(px);he.add(wx);he.add(Sx);he.add(bx);he.add(kd);he.add(_x);he.add(xx);he.add(vx);he.add(Ev);he.add(Pv);const sF=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),oF=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));
</script>
    <style rel="stylesheet" crossorigin>:root{--bg-light: #20202c;--bg-dark: #14151e;--bg-dark-extra: #101018;--bg-medium: #1a1a24;--bg-light-extra: #282a39;--text: #fff;--text-2: rgba(255, 255, 255, .5);--border-light: #292b3b;--violet: #9047fe;--violet-dark: #4933c2;--violet-light: #ae81ff;--red-dark: #ad1010;--red: #f85212;--green: #6dd919;--green-dark: #105a18;--blue: #559eff;--blue-light: #2392cc;--blue-light-extra: #42bdf9;--yellow: #fc0;--yellow-dark: #e6db74;--grey-dark: #75715e;--pink: #f92672;--green-light: #a9f513ee;--orange: #fd971f;--grey: #cfcfc2;--none: #0000;--font-size-base: 16px;--f1: "Geist";--f2: "Geist";font-family:var(--f1),var(--f2),sans-serif}body{margin:0;padding:0;height:100%}*{scrollbar-width:thin;scrollbar-color:var(--bg-light-extra) var(--bg-light)}*::-webkit-scrollbar{height:12px;width:12px}*::-webkit-scrollbar-track{background:var(--bg-light)}*::-webkit-scrollbar-thumb{background-color:var(--bg-light-extra);border-radius:5px;border:3px solid var(--bg-light)}textarea,input[type=text],input[type=url],input[type=number]{border:none;color:var(--text);font-family:var(--f2);font-size:1rem;padding:5px 10px;background-color:transparent;border-bottom:2px solid var(--bg-light)}input[type=number]{width:50px;padding-left:0;padding-right:0;text-align:center}textarea,input[type=text],input[type=url]{width:100%;text-align:left}textarea{background-color:var(--bg-light)}textarea:focus{outline:2px solid var(--violet)}input[type=text]:focus,input[type=url]:focus,input[type=number]:focus{outline:none;border-color:var(--violet);background:"transparent"!important}input:-webkit-autofill,input:-webkit-autofill:focus{transition:background-color 0s 600000s,color 0s 600000s!important}textarea:hover:not(:focus){outline:2px solid var(--bg-light-extra)}input[type=text]:hover:not(:focus),input[type=url]:hover:not(:focus),input[type=number]:hover:not(:focus){outline:none;border-color:var(--bg-light-extra)}input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=text].invalid{border-color:var(--red)}input[type=text].valid{border-color:var(--green-light)}input[type=checkbox]{-webkit-appearance:none;appearance:none;width:14px;height:14px;border:none;border-radius:4px;background-color:var(--bg-light);cursor:pointer;position:relative;margin:0;padding:0}input[type=checkbox]:checked{background-color:var(--violet)}input[type=checkbox]:checked:after{content:"✔";font-size:12px;color:var(--text);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}canvas{background-color:var(--bg-dark)}.root.svelte-p8m809{background-color:var(--bg-medium);margin-top:5px;margin-bottom:5px;padding:5px}.header.svelte-p8m809{display:flex;align-items:center;justify-content:space-between;padding:5px 10px;font-weight:600}.label.svelte-p8m809{font-size:1.2rem;line-height:1.5rem;cursor:pointer}button.svelte-p8m809{position:relative;height:1.5rem;width:1.5rem;place-items:center;border-radius:10px;border:0px;background-color:var(--bg-light-extra);color:var(--text);font-size:.875rem;line-height:1.25rem;cursor:pointer}button.svelte-p8m809:hover{opacity:.75}.item.svelte-p8m809{border-top:1px solid var(--bg-light-extra);padding:10px;border-radius:.25rem;background-color:rgb(var(--color-white) / 1);box-shadow:0 10px 15px -3px rgb(var(--color-black) / .1),0 4px 6px -4px rgb(var(--color-black) / .1)}.row.svelte-9ejy6{display:flex;flex-direction:row;align-items:center;gap:.6rem}.container.svelte-1dl1v59{display:flex;align-items:center;justify-content:center;gap:.5rem}.switch.svelte-1dl1v59{display:inline-block}.switch.svelte-1dl1v59 input:where(.svelte-1dl1v59){display:none}.switch.svelte-1dl1v59 label:where(.svelte-1dl1v59){display:block;width:30px;height:14px;padding:2px;border-radius:15px;cursor:pointer;transition:.3s;background:var(--bg-light-extra)}.switch.svelte-1dl1v59 label:where(.svelte-1dl1v59):after{content:"";display:inherit;width:14px;height:14px;border-radius:12px;background:var(--bg-dark);transition:.3s}.switch.svelte-1dl1v59 input:checked~label:where(.svelte-1dl1v59):after{translate:15px 0;background:var(--bg-dark)}.switch.svelte-1dl1v59 input:checked~label:where(.svelte-1dl1v59){background:var(--violet)}.switch.svelte-1dl1v59 input:disabled~label:where(.svelte-1dl1v59){opacity:.5;cursor:not-allowed}.label.svelte-1dl1v59,label.svelte-18hsjvr{font-size:smaller;color:var(--text-2)}.slider.svelte-w4j1dz{---track-width: var(--track-width, unset);---track-height: var(--track-height, 6px);---track-background: var(--track-background, #949494);---track-border: var(--track-border, none);---thumb-size: var(--thumb-size, 16px);---thumb-background: var(--thumb-background, #2d2d2d);---thumb-border: var(--thumb-border, none);---position: var(--position, 0px);---margin-inline-thumb-bigger: max(var(---thumb-size) - var(---track-height), 0px);---margin-inline-thumb-smaller: max(var(---track-height) - var(---thumb-size), 0px);position:relative;margin:auto;user-select:none;-webkit-user-select:none;background-color:transparent}.slider.svelte-w4j1dz:before{background-color:transparent}[aria-orientation=horizontal].svelte-w4j1dz{width:var(---track-width);max-width:calc(100% - 2 * var(---margin-inline-thumb-bigger));height:calc(max(var(---track-height),var(---thumb-size)) + 4px);height:max(var(---track-height),var(---thumb-size));margin-inline:var(---margin-inline-thumb-bigger);margin-block:var(--margin-block, 8px)}[aria-orientation=vertical].svelte-w4j1dz{width:calc(max(var(---track-height),var(---thumb-size)) + 4px);width:max(var(---track-height),var(---thumb-size));height:var(---track-width);max-height:calc(100% - 2 * var(---margin-inline-thumb-bigger));margin-block:var(---margin-inline-thumb-bigger);margin-inline:var(--margin-block, 8px)}.track.svelte-w4j1dz{position:absolute;pointer-events:none;background:var(---track-background);border:var(---track-border);border-radius:calc(var(---track-height) / 2);box-sizing:border-box}[aria-orientation=horizontal].svelte-w4j1dz .track:where(.svelte-w4j1dz){height:var(---track-height);top:50%;transform:translateY(-50%);left:0;right:0}[aria-orientation=vertical].svelte-w4j1dz .track:where(.svelte-w4j1dz){width:var(---track-height);left:50%;transform:translate(-50%);top:0;bottom:0}.thumb.svelte-w4j1dz{pointer-events:none;position:absolute;height:var(---thumb-size);width:var(---thumb-size);border-radius:calc(var(---thumb-size) / 2);background:var(---thumb-background);border:var(---thumb-border);box-sizing:border-box;transform:translate(-50%,-50%);--margin-left: ( 2 * var(---track-height) - var(---thumb-size) - var(---margin-inline-thumb-smaller) ) / 2;--left: calc(var(---position) * (100% - 2 * var(--margin-left)) + var(--margin-left))}[aria-orientation=horizontal].svelte-w4j1dz:not(.reverse) .thumb:where(.svelte-w4j1dz){top:50%;left:var(--left)}[aria-orientation=vertical].svelte-w4j1dz:not(.reverse) .thumb:where(.svelte-w4j1dz){left:50%;bottom:calc(var(--left) - var(---thumb-size))}[aria-orientation=horizontal].reverse.svelte-w4j1dz .thumb:where(.svelte-w4j1dz){top:50%;right:calc(var(--left) - var(---thumb-size))}[aria-orientation=vertical].reverse.svelte-w4j1dz .thumb:where(.svelte-w4j1dz){left:50%;top:calc(var(--left))}.slider.svelte-w4j1dz:focus-visible{outline:none}.slider.svelte-w4j1dz:focus-visible .track:where(.svelte-w4j1dz){outline:2px solid var(--focus-color, red);outline-offset:2px}.picker.svelte-1x9tz9y{position:relative;display:inline-block;width:var(--picker-width, 200px);height:var(--picker-height, 200px);background:linear-gradient(#fff0,#000),linear-gradient(.25turn,#fff,#0000),var(--picker-color-bg);border-radius:var(--picker-radius, 8px);outline:none;user-select:none}.s.svelte-1x9tz9y,.v.svelte-1x9tz9y{position:absolute;--track-background: none;--track-border: none;--thumb-background: none;--thumb-border: none;--thumb-size: 2px;--margin-block: 0;--track-height: var(--picker-indicator-size, 10px);user-select:none;-webkit-user-select:none}.s.svelte-1x9tz9y{top:calc(var(--pos-y) * (var(--picker-height, 200px) - var(--picker-indicator-size, 10px) - 4px) / 100 + 2px);left:2px;--track-width: calc(var(--picker-width, 200px) - 4px)}.v.svelte-1x9tz9y{top:2px;left:calc(var(--pos-x) * (var(--picker-width, 200px) - var(--picker-indicator-size, 10px) - 4px) / 100 + 2px);--track-width: calc(var(--picker-height, 200px) - 4px)}div.svelte-i5mg2p{position:absolute;left:calc(var(--pos-x) * (var(--picker-width, 200px) - var(--picker-indicator-size, 10px) - 4px) / 100 + 2px);top:calc(var(--pos-y) * (var(--picker-height, 200px) - var(--picker-indicator-size, 10px) - 4px) / 100 + 2px);width:var(--picker-indicator-size, 10px);height:var(--picker-indicator-size, 10px);background-color:#fff;box-shadow:0 0 4px #000;border-radius:50%;pointer-events:none;z-index:1;transition:box-shadow .2s}.is-dark.svelte-i5mg2p{box-shadow:0 0 4px #fff}.text-input.svelte-qtukzs{margin:var(--text-input-margin, 5px 0 0)}.input-container.svelte-qtukzs{display:flex;flex:1;gap:10px}input.svelte-qtukzs,button.svelte-qtukzs,.button-like.svelte-qtukzs{flex:1;border:none;background-color:var(--cp-input-color, #eee);color:var(--cp-text-color, var(--cp-border-color));padding:0;border-radius:5px;height:30px;line-height:30px;text-align:center}input.svelte-qtukzs{width:5px;font-family:inherit}button.svelte-qtukzs,.button-like.svelte-qtukzs{position:relative;flex:1;margin:8px 0 0;height:30px;width:100%;transition:background-color .2s;cursor:pointer;font-family:inherit}.button-like.svelte-qtukzs{cursor:default}.appear.svelte-qtukzs,.disappear.svelte-qtukzs{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:100%;transition:all .5s}button.svelte-qtukzs:hover .disappear:where(.svelte-qtukzs),.appear.svelte-qtukzs{opacity:0}.disappear.svelte-qtukzs,button.svelte-qtukzs:hover .appear:where(.svelte-qtukzs){opacity:1}button.svelte-qtukzs:hover{background-color:var(--cp-button-hover-color, #ccc)}input.svelte-qtukzs:focus,button.svelte-qtukzs:focus{outline:none}input.svelte-qtukzs:focus-visible,button.svelte-qtukzs:focus-visible{outline:2px solid var(--focus-color, red);outline-offset:2px}label.svelte-lemcb1{display:inline-flex;align-items:center;gap:8px;cursor:pointer;border-radius:3px;margin:4px;height:var(--input-size, 25px);user-select:none}.container.svelte-lemcb1{position:relative;display:block;display:flex;align-items:center;justify-content:center;width:var(--input-size, 25px)}input.svelte-lemcb1{margin:0;padding:0;border:none;width:1px;height:1px;flex-shrink:0;opacity:0}.alpha.svelte-lemcb1{clip-path:circle(50%);background:var(--alpha-grid-bg)}.alpha.svelte-lemcb1,.color.svelte-lemcb1{position:absolute;width:var(--input-size, 25px);height:var(--input-size, 25px);border-radius:50%;user-select:none}input.svelte-lemcb1:focus-visible~.color:where(.svelte-lemcb1){outline:2px solid var(--focus-color, red);outline-offset:2px}div.svelte-h9ar9{padding:8px;background-color:var(--cp-bg-color, white);margin:0 10px 10px;border:1px solid var(--cp-border-color, black);border-radius:12px;display:none;width:max-content}.is-open.svelte-h9ar9{display:inline-block}[role=dialog].svelte-h9ar9{position:absolute;top:calc(var(--input-size, 25px) + 12px);left:0;z-index:var(--picker-z-index, 2)}label.svelte-oskb5b{display:flex;justify-content:center;margin-bottom:4px;grid-area:nullable;user-select:none}input.svelte-oskb5b{margin:0}input.svelte-oskb5b:focus-visible{outline:none}input.svelte-oskb5b:focus-visible+span:where(.svelte-oskb5b){width:14px;height:14px;border-radius:2px;outline:2px solid var(--focus-color, red);outline-offset:2px}div.svelte-oskb5b{width:32px;aspect-ratio:2;position:relative}div.svelte-oskb5b :where(.svelte-oskb5b){position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}span.svelte-tsvobk{position:relative;color:var(--cp-text-color, var(--cp-border-color));--alpha-grid-bg: linear-gradient(45deg, #eee 25%, #0000 25%, #0000 75%, #eee 75%) 0 0 / 10px 10px, linear-gradient(45deg, #eee 25%, #0000 25%, #0000 75%, #eee 75%) 5px 5px / 10px 10px}.h.svelte-tsvobk,.a.svelte-tsvobk{display:inline-flex;justify-content:center;--track-height: var(--slider-width, 10px);--track-width: var(--picker-height, 200px);--track-border: none;--thumb-size: calc(var(--slider-width, 10px) - 3px);--thumb-background: white;--thumb-border: 1px solid black;--margin-block: 0;--gradient-direction: .5turn}.horizontal.svelte-tsvobk .h:where(.svelte-tsvobk),.horizontal.svelte-tsvobk .a:where(.svelte-tsvobk){--track-width: calc(var(--picker-width, 200px) - 12px);--gradient-direction: .25turn;margin:4px 6px}.horizontal.svelte-tsvobk .h:where(.svelte-tsvobk){margin-top:8px}.vertical.svelte-tsvobk .h:where(.svelte-tsvobk),.vertical.svelte-tsvobk .a:where(.svelte-tsvobk){margin-left:3px}.h.svelte-tsvobk{grid-area:hue;--gradient-hue: #ff1500fb, #ffff00 17.2%, #ffff00 18.2%, #00ff00 33.3%, #00ffff 49.5%, #00ffff 51.5%, #0000ff 67.7%, #ff00ff 83.3%, #ff0000;--track-background: linear-gradient(var(--gradient-direction), var(--gradient-hue))}.a.svelte-tsvobk{grid-area:alpha;margin-top:2px;--track-background: linear-gradient(var(--gradient-direction), rgba(0, 0, 0, 0), var(--alphaless-color)), var(--alpha-grid-bg)}span.svelte-tsvobk .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}div.svelte-1le3y9a{background-color:var(--cp-bg-color, white);margin:0 10px 15px;border:1px solid var(--cp-border-color, black);border-radius:8px;display:none;--text-input-margin: 5px 5px 6px;--picker-radius: 8px 8px 0 0;--picker-width: 260px}.is-open.svelte-1le3y9a{display:flex;flex-direction:column}[role=dialog].svelte-1le3y9a{position:absolute;top:calc(var(--input-size, 25px) + 12px);left:0;z-index:var(--picker-z-index, 2)}div.svelte-1le3y9a:not([role=dialog]){display:inline-flex;flex-direction:column}div.svelte-1qo09sh{padding:6px;background-color:var(--cp-bg-color, white);margin:0 10px 10px;border:1px solid var(--cp-border-color, black);border-radius:12px;display:none;width:max-content}.is-open.svelte-1qo09sh{display:block}@media (min-width: 768px){.is-open.svelte-1qo09sh{display:grid;gap:5px;grid-template:"nullable . . ." "picker hue alpha a11y" "input input input a11y";grid-template-rows:auto var(--picker-height, 200px) auto}}div.svelte-1qo09sh .picker{grid-area:picker}div.svelte-1qo09sh .text-input{grid-area:input}div.svelte-1qo09sh .a11y-notice{grid-area:a11y;margin:0 4px 0 6px}[role=dialog].svelte-1qo09sh{position:absolute;top:calc(var(--input-size, 25px) + 12px);left:0;z-index:var(--picker-z-index, 2)}.a11y-notice.svelte-12hg05j{display:grid;grid-template-columns:auto 1fr;grid-template-rows:auto repeat(var(--item-count),1fr) auto;justify-items:stretch;align-items:center;gap:0 12px;width:max-content}.title.svelte-12hg05j{margin:12px 0 0;grid-column:1 / 3;background:none;border:none;padding:0 8px;line-height:24px}@media (min-width: 768px){.title.svelte-12hg05j{margin:0}}.guidelines.svelte-12hg05j{grid-column:1 / 3;margin-top:10px;font-size:12px}.svelte-12hg05j:focus-visible,.guidelines.svelte-12hg05j :focus-visible{border-radius:2px;outline:2px solid var(--focus-color, red);outline-offset:2px}.lorem.svelte-1qfifh1{flex:1;text-align:center;padding:4px 8px;margin-top:10px;border-radius:4px;border:1px solid black;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.large.svelte-1qfifh1{font-size:22px;padding:2px 8px}.grade.svelte-1qfifh1{border-radius:50px;padding:0 8px 2px;background-color:#ff6100;font-weight:700}.grade-ok.svelte-1qfifh1{background-color:green;color:#fff}p.svelte-1qfifh1{margin:0}:root{--cp-bg-color: var(--bg-light-extra);--cp-border-color: var(--bg-light);--cp-text-color: var(--text-2);--cp-input-color: var(--bg-dark);--cp-button-hover-color: var(--bg-light-extra);--focus-color: var(--violet);--picker-z-index: 10000}span.svelte-cj1vhf{font-size:smaller;color:var(--text-2);padding:0;margin:0;display:inline-block}.hide.svelte-cj1vhf{display:none}.content.svelte-57nmje{display:flex;align-items:center;justify-content:center}.tooltip.svelte-57nmje{background-color:var(--bg-dark-extra);border-radius:.3rem;padding:5px;display:flex;z-index:10;font-size:smaller;color:var(--text-2)}.tooltip-text.svelte-57nmje{margin:0;padding:0}.toggle{display:flex;align-items:center;justify-content:center;min-width:1rem;width:fit-content;height:2rem;padding:.4rem;border-radius:.5rem;color:var(--text);cursor:pointer;font-family:var(--f1);font-size:1rem}.toggle:hover{background-color:var(--bg-dark)}.toggle[data-state=on]{background-color:var(--bg-dark-extra);border:1px solid var(--bg-dark-extra)}.toggle[data-state=off]{background-color:var(--bg-light);border:1px solid var(--bg-light)}.reset.svelte-r37183{margin-left:auto}.reset_filters.svelte-r37183{background:var(--bg-light-extra);padding:.4rem;border-radius:.3rem;border:none;color:var(--text-2);cursor:pointer}.reset_filters.svelte-r37183:hover{background:var(--bg-dark)}label.svelte-18hsjvr{font-size:smaller;color:var(--text-2)}label.svelte-rey57u{background:var(--bg-light-extra);border:2px solid var(--bg-light);border-radius:7px;color:var(--text-2);margin-left:auto;cursor:pointer;padding:2px 2px 2px 5px;display:flex;align-items:center;justify-content:center}label.svelte-rey57u:hover{color:var(--text)}input[type=file].svelte-rey57u{display:none}.container.svelte-1rzpjof{display:flex;align-items:center;justify-content:center}.container.svelte-1rzpjof button:where(.svelte-1rzpjof):nth-child(1){border-top-left-radius:.5rem;border-bottom-left-radius:.5rem}.container.svelte-1rzpjof button:where(.svelte-1rzpjof):nth-last-child(1){border-top-right-radius:.5rem;border-bottom-right-radius:.5rem}button.svelte-1rzpjof{display:flex;align-items:center;justify-content:center;min-width:1rem;width:fit-content;height:2rem;padding:.4rem;color:var(--text);cursor:pointer;font-family:var(--f1);font-size:1rem}button.svelte-1rzpjof:hover{background-color:var(--bg-dark)}button[data-state=on].svelte-1rzpjof{background-color:var(--bg-dark-extra);border:1px solid var(--bg-dark-extra)}button[data-state=off].svelte-1rzpjof{background-color:var(--bg-light);border:1px solid var(--bg-light)}.toggle-item.svelte-1rzpjof{display:flex;align-items:center;justify-content:center}.spacer.svelte-sob386{height:100%;width:2rem}div.container.svelte-3nax8w{position:relative;align-items:center;display:flex;cursor:text;box-sizing:border-box}div.tags.svelte-3nax8w{display:flex;flex:1;padding:0;margin:0;flex-wrap:wrap}div.tag.svelte-3nax8w{display:flex;justify-content:center;align-items:center;border-radius:3pt;margin:.2rem .1rem;background:var(--bg-light-extra);padding:.2rem .2rem .2rem .3rem;color:var(--text);font-size:smaller}button.delete.svelte-3nax8w{cursor:pointer;background:none;border:none;color:var(--text-2);display:flex;padding:0;padding-bottom:.15rem;margin-left:.2rem}button.delete.svelte-3nax8w:hover{color:var(--text)}input.svelte-3nax8w{margin-left:.2rem;padding-left:.3rem;min-width:7rem;width:auto}ul.options.svelte-3nax8w{list-style:none;top:calc(100% + 5px);left:0;width:100%;position:absolute;overflow:auto;background:var(--bg-light);max-height:30vh;overscroll-behavior:none;border-radius:8px;padding:0;margin:0;z-index:100}li.option.svelte-3nax8w{padding:.2rem .6rem;cursor:pointer;scroll-margin:var(--sms-options-scroll-margin, 100px);text-align:left;display:block;z-index:200}li.option.svelte-3nax8w:hover{background:var(--bg-light-extra)}.input-container.svelte-3nax8w{position:relative}.loader.svelte-3nax8w{position:absolute;width:1rem;height:1rem;right:.2rem;bottom:.2rem;border-radius:50%;border:.3rem solid var(--bg-light);border-top-color:var(--violet);animation:2s infinite svelte-3nax8w-rotation}@keyframes svelte-3nax8w-rotation{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.circle.svelte-dqjlks{height:var(--size);width:var(--size);border-color:var(--color) transparent var(--color) var(--color);border-width:calc(var(--size) / 15);border-style:solid;border-image:initial;border-radius:50%;animation:var(--duration) linear 0s infinite normal none running svelte-dqjlks-rotate}.pause-animation.svelte-dqjlks{animation-play-state:paused}@keyframes svelte-dqjlks-rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.circle.svelte-1w4sjib{width:var(--size);height:var(--size);box-sizing:border-box;position:relative;border:3px solid transparent;border-top-color:var(--colorOuter);border-radius:50%;animation:svelte-1w4sjib-circleSpin var(--durationOuter) linear infinite}.circle.svelte-1w4sjib:before,.circle.svelte-1w4sjib:after{content:"";box-sizing:border-box;position:absolute;border:3px solid transparent;border-radius:50%}.circle.svelte-1w4sjib:after{border-top-color:var(--colorInner);inset:9px;animation:svelte-1w4sjib-circleSpin var(--durationInner) linear infinite}.circle.svelte-1w4sjib:before{border-top-color:var(--colorCenter);inset:3px;animation:svelte-1w4sjib-circleSpin var(--durationCenter) linear infinite}.pause-animation.svelte-1w4sjib,.pause-animation.svelte-1w4sjib:after,.pause-animation.svelte-1w4sjib:before{animation-play-state:paused}@keyframes svelte-1w4sjib-circleSpin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.wrapper.svelte-7wj78d{width:var(--size);height:var(--size);display:flex;justify-content:center;align-items:center;line-height:0;box-sizing:border-box}.inner.svelte-7wj78d{transform:scale(calc(var(--floatSize) / 52))}.ball-container.svelte-7wj78d{animation:svelte-7wj78d-ballTwo var(--duration) infinite;width:44px;height:44px;flex-shrink:0;position:relative}.single-ball.svelte-7wj78d{width:44px;height:44px;position:absolute}.ball.svelte-7wj78d{width:20px;height:20px;border-radius:50%;position:absolute;animation:svelte-7wj78d-ballOne var(--duration) infinite ease}.pause-animation.svelte-7wj78d{animation-play-state:paused}.ball-top-left.svelte-7wj78d{background-color:var(--ballTopLeftColor);top:0;left:0}.ball-top-right.svelte-7wj78d{background-color:var(--ballTopRightColor);top:0;left:24px}.ball-bottom-left.svelte-7wj78d{background-color:var(--ballBottomLeftColor);top:24px;left:0}.ball-bottom-right.svelte-7wj78d{background-color:var(--ballBottomRightColor);top:24px;left:24px}@keyframes svelte-7wj78d-ballOne{0%{position:absolute}50%{top:12px;left:12px;position:absolute;opacity:.5}to{position:absolute}}@keyframes svelte-7wj78d-ballTwo{0%{transform:rotate(0) scale(1)}50%{transform:rotate(360deg) scale(1.3)}to{transform:rotate(720deg) scale(1)}}.wrapper.svelte-1bsg8wv{position:relative;width:var(--size);height:var(--size)}.circle.svelte-1bsg8wv{position:absolute;width:var(--size);height:var(--size);background-color:var(--color);border-radius:100%;opacity:.6;top:0;left:0;animation-fill-mode:both;animation-name:svelte-1bsg8wv-bounce!important}.pause-animation.svelte-1bsg8wv{animation-play-state:paused}@keyframes svelte-1bsg8wv-bounce{0%,to{transform:scale(0)}50%{transform:scale(1)}}.svelte-rhgdjk{overflow:hidden;position:relative;text-indent:-9999px;display:inline-block;background:#f86;border-radius:50%;transform:rotate(90deg);transform-origin:50% 50%;animation:svelte-rhgdjk-plus-loader-background var(--duration) infinite ease-in-out}.svelte-rhgdjk:after{background:#f86;border-radius:50% 0 0 50%;content:"";position:absolute;right:50%;top:0;width:50%;height:100%;transform-origin:100% 50%;animation:svelte-rhgdjk-plus-loader-top var(--duration) infinite linear}.svelte-rhgdjk:before{background:#fc6;border-radius:50% 0 0 50%;content:"";position:absolute;right:50%;top:0;width:50%;height:100%;transform-origin:100% 50%;animation:svelte-rhgdjk-plus-loader-bottom var(--duration) infinite linear}.pause-animation.svelte-rhgdjk,.pause-animation.svelte-rhgdjk:before,.pause-animation.svelte-rhgdjk:after{animation-play-state:paused}@keyframes svelte-rhgdjk-plus-loader-top{2.5%{background:#f86;transform:rotateY(0);animation-timing-function:ease-in}13.75%{background:#ff430d;transform:rotateY(90deg);animation-timing-function:step-start}13.76%{background:#ffae0d;transform:rotateY(90deg);animation-timing-function:ease-out}25%{background:#fc6;transform:rotateY(180deg)}27.5%{background:#fc6;transform:rotateY(180deg);animation-timing-function:ease-in}41.25%{background:#ffae0d;transform:rotateY(90deg);animation-timing-function:step-start}41.26%{background:#2cc642;transform:rotateY(90deg);animation-timing-function:ease-out}50%{background:#6d7;transform:rotateY(0)}52.5%{background:#6d7;transform:rotateY(0);animation-timing-function:ease-in}63.75%{background:#2cc642;transform:rotateY(90deg);animation-timing-function:step-start}63.76%{background:#1386d2;transform:rotateY(90deg);animation-timing-function:ease-out}75%{background:#4ae;transform:rotateY(180deg)}77.5%{background:#4ae;transform:rotateY(180deg);animation-timing-function:ease-in}91.25%{background:#1386d2;transform:rotateY(90deg);animation-timing-function:step-start}91.26%{background:#ff430d;transform:rotateY(90deg);animation-timing-function:ease-in}to{background:#f86;transform:rotateY(0);animation-timing-function:step-start}}@keyframes svelte-rhgdjk-plus-loader-bottom{0%{background:#fc6;animation-timing-function:step-start}50%{background:#fc6;animation-timing-function:step-start}75%{background:#4ae;animation-timing-function:step-start}to{background:#4ae;animation-timing-function:step-start}}@keyframes svelte-rhgdjk-plus-loader-background{0%{background:#f86;transform:rotate(180deg)}25%{background:#f86;transform:rotate(180deg);animation-timing-function:step-start}27.5%{background:#6d7;transform:rotate(90deg)}50%{background:#6d7;transform:rotate(90deg);animation-timing-function:step-start}52.5%{background:#6d7;transform:rotate(0)}75%{background:#6d7;transform:rotate(0);animation-timing-function:step-start}77.5%{background:#f86;transform:rotate(270deg)}to{background:#f86;transform:rotate(270deg);animation-timing-function:step-start}}.wrapper.svelte-1w1ueev{width:var(--size);height:var(--size)}.circle.svelte-1w1ueev{width:var(--size);height:var(--size);background-color:var(--color);animation-duration:var(--duration);border-radius:100%;display:inline-block;animation:svelte-1w1ueev-scaleOut var(--duration) ease-in-out infinite}.pause-animation.svelte-1w1ueev{animation-play-state:paused}@keyframes svelte-1w1ueev-scaleOut{0%{transform:scale(0)}to{transform:scale(1);opacity:0}}.wrapper.svelte-nfuakd{width:var(--size);height:var(--stroke);transform:scale(calc(var(--floatSize) / 75));display:flex;justify-content:center;align-items:center}.line.svelte-nfuakd{width:var(--size);height:var(--stroke);background:var(--color);border-radius:var(--stroke);transform-origin:center center;animation:svelte-nfuakd-spineLine var(--duration) ease infinite}.pause-animation.svelte-nfuakd{animation-play-state:paused}@keyframes svelte-nfuakd-spineLine{0%{transform:rotate(-20deg);height:5px;width:75px}5%{height:5px;width:75px}30%{transform:rotate(380deg);height:5px;width:75px}40%{transform:rotate(360deg);height:5px;width:75px}55%{transform:rotate(0);height:5px;width:5px}65%{transform:rotate(0);height:5px;width:85px}68%{transform:rotate(0);height:5px}75%{transform:rotate(0);height:5px;width:1px}78%{height:5px;width:5px}90%{height:5px;width:75px;transform:rotate(0)}99%,to{height:5px;width:75px;transform:rotate(-20deg)}}.wrapper.svelte-cihful{height:var(--size);width:var(--size);display:inline-block;text-align:center;font-size:10px}.rect.svelte-cihful{height:100%;width:10%;display:inline-block;margin-right:4px;transform:scaleY(.4);background-color:var(--color);animation:svelte-cihful-stretch var(--duration) ease-in-out infinite}.pause-animation.svelte-cihful{animation-play-state:paused}@keyframes svelte-cihful-stretch{0%,40%,to{transform:scaleY(.4)}20%{transform:scaleY(1)}}.wrapper.svelte-bnawe9{height:calc(var(--size) / 15);width:calc(var(--size) * 2);background-color:var(--rgba);position:relative;overflow:hidden;background-clip:padding-box}.lines.svelte-bnawe9{height:calc(var(--size) / 15);background-color:var(--color)}.small-lines.svelte-bnawe9{position:absolute;overflow:hidden;background-clip:padding-box;display:block;border-radius:2px;will-change:left,right;animation-fill-mode:forwards}.small-lines.\31.svelte-bnawe9{animation:var(--duration) cubic-bezier(.65,.815,.735,.395) 0s infinite normal none running svelte-bnawe9-long}.small-lines.\32.svelte-bnawe9{animation:var(--duration) cubic-bezier(.165,.84,.44,1) calc((var(--duration) + .1) / 2) infinite normal none running svelte-bnawe9-short}.pause-animation.svelte-bnawe9{animation-play-state:paused}@keyframes svelte-bnawe9-long{0%{left:-35%;right:100%}60%{left:100%;right:-90%}to{left:100%;right:-90%}}@keyframes svelte-bnawe9-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}to{left:107%;right:-8%}}.wrapper.svelte-c0n7a9{width:var(--size);height:var(--size)}.circle.svelte-c0n7a9{border-radius:100%;animation-fill-mode:both;position:absolute;opacity:0;width:var(--size);height:var(--size);background-color:var(--color);animation:svelte-c0n7a9-bounce var(--duration) linear infinite}.pause-animation.svelte-c0n7a9{animation-play-state:paused}@keyframes svelte-c0n7a9-bounce{0%{opacity:0;transform:scale(0)}5%{opacity:1}to{opacity:0;transform:scale(1)}}.wrapper.svelte-kxapcj{position:relative;width:var(--size);height:var(--size)}.border.svelte-kxapcj{border-color:var(--color);position:absolute;top:0;left:0;width:var(--size);height:var(--size);opacity:.4;perspective:800px;border-width:6px;border-style:solid;border-image:initial;border-radius:100%}.border.\31.svelte-kxapcj{animation:var(--duration) linear 0s infinite normal none running svelte-kxapcj-ringOne}.border.\32.svelte-kxapcj{animation:var(--duration) linear 0s infinite normal none running svelte-kxapcj-ringTwo}.pause-animation.svelte-kxapcj{animation-play-state:paused}@keyframes svelte-kxapcj-ringOne{0%{transform:rotateX(0) rotateY(0) rotate(0)}to{transform:rotateX(360deg) rotateY(180deg) rotate(360deg)}}@keyframes svelte-kxapcj-ringTwo{0%{transform:rotateX(0) rotateY(0) rotate(0)}to{transform:rotateX(180deg) rotateY(360deg) rotate(360deg)}}.wrapper.svelte-14x3x60{height:var(--size);width:var(--size);display:flex;align-items:center;justify-content:center}.dot.svelte-14x3x60{height:var(--dotSize);width:var(--dotSize);background-color:var(--color);margin:2px;display:inline-block;border-radius:100%;animation:svelte-14x3x60-sync var(--duration) ease-in-out infinite alternate both running}.pause-animation.svelte-14x3x60{animation-play-state:paused}@-webkit-keyframes svelte-14x3x60-sync{33%{-webkit-transform:translateY(10px);transform:translateY(10px)}66%{-webkit-transform:translateY(-10px);transform:translateY(-10px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes svelte-14x3x60-sync{33%{-webkit-transform:translateY(10px);transform:translateY(10px)}66%{-webkit-transform:translateY(-10px);transform:translateY(-10px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}.wrapper.svelte-1lgkc8y{width:var(--size);height:calc(var(--size) / 2);overflow:hidden}.rainbow.svelte-1lgkc8y{width:var(--size);height:var(--size);border-left-color:transparent;border-bottom-color:transparent;border-top-color:var(--color);border-right-color:var(--color);box-sizing:border-box;transform:rotate(-200deg);border-radius:50%;border-style:solid;animation:var(--duration) ease-in-out 0s infinite normal none running svelte-1lgkc8y-rotate}.pause-animation.svelte-1lgkc8y{animation-play-state:paused}@keyframes svelte-1lgkc8y-rotate{0%{border-width:10px}25%{border-width:3px}50%{transform:rotate(115deg);border-width:10px}75%{border-width:3px}to{border-width:10px}}.wrapper.svelte-x7zza7{width:calc(var(--size) * 1.3);height:calc(var(--size) * 1.3);display:flex;justify-content:center;align-items:center}.firework.svelte-x7zza7{border:calc(var(--size) / 10) dotted var(--color);width:var(--size);height:var(--size);border-radius:50%;animation:svelte-x7zza7-fire var(--duration) cubic-bezier(.165,.84,.44,1) infinite}.pause-animation.svelte-x7zza7{animation-play-state:paused}@keyframes svelte-x7zza7-fire{0%{opacity:1;transform:scale(.1)}25%{opacity:.85}to{transform:scale(1);opacity:0}}.wrapper.svelte-1w8rpx6{position:relative;display:flex;justify-content:center;align-items:center;width:var(--size);height:calc(var(--size) / 2.5)}.cube.svelte-1w8rpx6{position:absolute;top:0;width:calc(var(--size) / 5);height:calc(var(--size) / 2.5);background-color:var(--color);animation:svelte-1w8rpx6-motion var(--duration) cubic-bezier(.895,.03,.685,.22) infinite}.pause-animation.svelte-1w8rpx6{animation-play-state:paused}@keyframes svelte-1w8rpx6-motion{0%{opacity:1}50%{opacity:0}to{opacity:1}}.wrapper.svelte-1rvptk{position:relative;display:flex;justify-content:center;align-items:center;width:var(--size);height:var(--size)}.ring.svelte-1rvptk{position:absolute;border:2px solid var(--color);border-radius:50%;background-color:transparent;animation:svelte-1rvptk-motion var(--duration) ease infinite}.pause-animation.svelte-1rvptk{animation-play-state:paused}@keyframes svelte-1rvptk-motion{0%{transform:translateY(var(--motionOne))}50%{transform:translateY(var(--motionTwo))}to{transform:translateY(var(--motionThree))}}.wrapper.svelte-1uhddr4{height:var(--size);width:var(--size);display:flex;justify-content:center;align-items:center}.spinner.svelte-1uhddr4{height:var(--size);width:var(--size);animation:svelte-1uhddr4-rotate var(--duration) infinite linear}.dot.svelte-1uhddr4{width:60%;height:60%;display:inline-block;position:absolute;top:0;background-color:var(--color);border-radius:100%;animation:svelte-1uhddr4-bounce var(--duration) infinite ease-in-out}.pause-animation.svelte-1uhddr4{animation-play-state:paused}@keyframes svelte-1uhddr4-rotate{to{transform:rotate(360deg)}}@keyframes svelte-1uhddr4-bounce{0%,to{transform:scale(0)}50%{transform:scale(1)}}.square.svelte-x90y{height:var(--size);width:var(--size);background-color:var(--color);animation:svelte-x90y-squareDelay var(--duration) 0s infinite cubic-bezier(.09,.57,.49,.9);animation-fill-mode:both;perspective:100px;display:inline-block}.pause-animation.svelte-x90y{animation-play-state:paused}@keyframes svelte-x90y-squareDelay{25%{-webkit-transform:rotateX(180deg) rotateY(0);transform:rotateX(180deg) rotateY(0)}50%{-webkit-transform:rotateX(180deg) rotateY(180deg);transform:rotateX(180deg) rotateY(180deg)}75%{-webkit-transform:rotateX(0) rotateY(180deg);transform:rotateX(0) rotateY(180deg)}to{-webkit-transform:rotateX(0) rotateY(0);transform:rotateX(0) rotateY(0)}}.wrapper.svelte-5bpnhx{position:relative;display:flex;justify-content:center;align-items:center;width:var(--size);height:var(--size)}.shadow.svelte-5bpnhx{color:var(--color);font-size:var(--size);overflow:hidden;width:var(--size);height:var(--size);border-radius:50%;margin:28px auto;position:relative;transform:translateZ(0);animation:svelte-5bpnhx-load var(--duration) infinite ease,svelte-5bpnhx-round var(--duration) infinite ease}.pause-animation.svelte-5bpnhx{animation-play-state:paused}@keyframes svelte-5bpnhx-load{0%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}5%,95%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}10%,59%{box-shadow:0 -.83em 0 -.4em,-.087em -.825em 0 -.42em,-.173em -.812em 0 -.44em,-.256em -.789em 0 -.46em,-.297em -.775em 0 -.477em}20%{box-shadow:0 -.83em 0 -.4em,-.338em -.758em 0 -.42em,-.555em -.617em 0 -.44em,-.671em -.488em 0 -.46em,-.749em -.34em 0 -.477em}38%{box-shadow:0 -.83em 0 -.4em,-.377em -.74em 0 -.42em,-.645em -.522em 0 -.44em,-.775em -.297em 0 -.46em,-.82em -.09em 0 -.477em}to{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}}@keyframes svelte-5bpnhx-round{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.wrapper.svelte-e653jg{height:var(--size);width:var(--size);border-radius:100%;animation:svelte-e653jg-moonStretchDelay var(--duration) 0s infinite linear;animation-fill-mode:forwards;position:relative}.circle-one.svelte-e653jg{top:var(--moonSize);background-color:var(--color);width:calc(var(--size) / 7);height:calc(var(--size) / 7);border-radius:100%;animation:svelte-e653jg-moonStretchDelay var(--duration) 0s infinite linear;animation-fill-mode:forwards;opacity:.8;position:absolute}.circle-two.svelte-e653jg{opacity:.1;border:calc(var(--size) / 7) solid var(--color);height:var(--size);width:var(--size);border-radius:100%;box-sizing:border-box}.pause-animation.svelte-e653jg{animation-play-state:paused}@keyframes svelte-e653jg-moonStretchDelay{to{transform:rotate(360deg)}}.wrapper.svelte-1cx3779{height:var(--size);width:var(--size);position:relative;display:flex;justify-content:center;align-items:center}.wrapper.svelte-1cx3779 :where(.svelte-1cx3779){line-height:0;box-sizing:border-box}.spinner-inner.svelte-1cx3779{height:var(--size);width:var(--size);transform:scale(calc(var(--size) / 70))}.mask.svelte-1cx3779{position:absolute;border-radius:2px;overflow:hidden;perspective:1000;backface-visibility:hidden}.plane.svelte-1cx3779{background:var(--color);width:400%;height:100%;position:absolute;z-index:100;perspective:1000;backface-visibility:hidden}#top.svelte-1cx3779 .plane:where(.svelte-1cx3779){z-index:2000;animation:svelte-1cx3779-trans1 var(--duration) ease-in infinite 0s backwards}#middle.svelte-1cx3779 .plane:where(.svelte-1cx3779){transform:translateZ(0);background:var(--rgba);animation:svelte-1cx3779-trans2 var(--duration) linear infinite calc(var(--duration) / 4) backwards}#bottom.svelte-1cx3779 .plane:where(.svelte-1cx3779){z-index:2000;animation:svelte-1cx3779-trans3 var(--duration) ease-out infinite calc(var(--duration) / 2) backwards}#top.svelte-1cx3779{width:53px;height:20px;left:20px;top:5px;transform:skew(-15deg);z-index:100}#middle.svelte-1cx3779{width:33px;height:20px;left:20px;top:21px;transform:skew(-15deg,40deg)}#bottom.svelte-1cx3779{width:53px;height:20px;top:35px;transform:skew(-15deg)}.pause-animation.svelte-1cx3779 .plane:where(.svelte-1cx3779){animation-play-state:paused}@keyframes svelte-1cx3779-trans1{0%{transform:translate3d(53px,0,0)}to{transform:translate3d(-250px,0,0)}}@keyframes svelte-1cx3779-trans2{0%{transform:translate3d(-160px,0,0)}to{transform:translate3d(53px,0,0)}}@keyframes svelte-1cx3779-trans3{0%{transform:translate3d(53px,0,0)}to{transform:translate3d(-220px,0,0)}}span.svelte-1jnfmql{width:var(--size);height:calc(var(--size) / 4);position:relative;display:block}div.svelte-1jnfmql{width:calc(var(--size) / 4);height:calc(var(--size) / 4);position:absolute;left:0%;top:0;border-radius:2px;background:var(--color);transform:translate(-50%) rotate(45deg) scale(0);animation:svelte-1jnfmql-diamonds var(--duration) linear infinite}div.svelte-1jnfmql:nth-child(1){animation-delay:calc(var(--duration) * 2 / 3 * -1)}div.svelte-1jnfmql:nth-child(2){animation-delay:calc(var(--duration) * 2 / 3 * -2)}div.svelte-1jnfmql:nth-child(3){animation-delay:calc(var(--duration) * 2 / 3 * -3)}.pause-animation.svelte-1jnfmql div:where(.svelte-1jnfmql){animation-play-state:paused}@keyframes svelte-1jnfmql-diamonds{50%{left:50%;transform:translate(-50%) rotate(45deg) scale(1)}to{left:100%;transform:translate(-50%) rotate(45deg) scale(0)}}div.svelte-db2m9w{position:relative;width:var(--size);height:var(--size);background-color:transparent;box-shadow:inset 0 0 0 2px var(--color);border-radius:50%}div.svelte-db2m9w:before,div.svelte-db2m9w:after{position:absolute;content:"";background-color:var(--color)}div.svelte-db2m9w:after{width:calc(var(--size) / 2.4);height:2px;top:calc(var(--size) / 2);left:calc(var(--size) / 2);transform-origin:1px 1px;animation:svelte-db2m9w-rotate calc(var(--duration) / 4) linear infinite}div.svelte-db2m9w:before{width:calc(var(--size) / 3);height:2px;top:calc((var(--size) / 2));left:calc((var(--size) / 2));transform-origin:1px 1px;animation:svelte-db2m9w-rotate var(--duration) linear infinite}.pause-animation.svelte-db2m9w,.pause-animation.svelte-db2m9w:before,.pause-animation.svelte-db2m9w:after{animation-play-state:paused}@keyframes svelte-db2m9w-rotate{to{transform:rotate(360deg)}}.wrapper.svelte-1vzsw15{position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--size) * 2.5);height:var(--size);overflow:hidden}.bar.svelte-1vzsw15{position:absolute;top:calc(var(--size) / 10);width:calc(var(--size) / 5);height:calc(var(--size) / 10);margin-top:calc(var(--size) - var(--size) / 10);transform:skewY(0);background-color:var(--color);animation:svelte-1vzsw15-motion var(--duration) ease-in-out infinite}.pause-animation.svelte-1vzsw15{animation-play-state:paused}@keyframes svelte-1vzsw15-motion{25%{transform:skewY(25deg)}50%{height:100%;margin-top:0}75%{transform:skewY(-25deg)}}.wrapper.svelte-bv9t2p{display:inherit;position:relative;width:var(--size);height:var(--size)}.circle.svelte-bv9t2p{position:absolute;width:var(--size);height:var(--size);border:thick solid var(--rgba);border-radius:50%;opacity:1;top:0;left:0;animation-fill-mode:both;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.165,.84,.44,1),cubic-bezier(.3,.61,.355,1);animation-direction:normal,normal;animation-fill-mode:none,none;animation-play-state:running,running;animation-name:svelte-bv9t2p-puff-1,svelte-bv9t2p-puff-2;box-sizing:border-box}.pause-animation.svelte-bv9t2p{animation-play-state:paused}@keyframes svelte-bv9t2p-puff-1{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes svelte-bv9t2p-puff-2{0%{opacity:1}to{opacity:0}}.wrapper.svelte-f6hkgc{width:var(--size);height:calc(var(--size) * 1.5);margin-left:var(--size);background:var(--color);display:inline-block;position:relative;box-sizing:border-box;animation:svelte-f6hkgc-bump var(--duration) ease-in infinite alternate}.wrapper.svelte-f6hkgc:after{content:"";box-sizing:border-box;left:50%;top:100%;transform:translate(-50%);position:absolute;border:var(--size) solid transparent;border-top-color:var(--color)}.pause-animation.svelte-f6hkgc{animation-play-state:paused}@keyframes svelte-f6hkgc-bump{0%{transform:translate(-50%,5px)}to{transform:translate(-50%,-5px)}}.wrapper.svelte-1ju64u{width:var(--size);height:calc(var(--size) * 1.5);margin-left:var(--size);margin-top:var(--size);background:var(--color);display:inline-block;position:relative;box-sizing:border-box;animation:svelte-1ju64u-bump var(--duration) ease-in infinite alternate}.wrapper.svelte-1ju64u:after{content:"";box-sizing:border-box;left:50%;bottom:100%;transform:translate(-50%);position:absolute;border:var(--size) solid transparent;border-bottom-color:var(--color)}.pause-animation.svelte-1ju64u{animation-play-state:paused}@keyframes svelte-1ju64u-bump{0%{transform:translate(-50%,5px)}to{transform:translate(-50%,-5px)}}div.svelte-tz9rki{background-color:var(--bg-medium);position:relative}.loading.svelte-tz9rki{position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--bg-dark-extra);opacity:.8;z-index:1000;display:flex;justify-content:center;align-items:center;font-size:24px;font-weight:700;color:var(--text-medium)}.container.svelte-7fu1cm{display:flex;flex-direction:row;flex-wrap:wrap;gap:.2rem}.option.svelte-7fu1cm{width:24px;height:24px;border-radius:5px;cursor:pointer;border:none}.label.svelte-7fu1cm{font-size:smaller;color:var(--text-2);display:flex;justify-content:center;align-items:center;margin:0 .5rem}.container.svelte-1p7cd3z{display:flex;flex-direction:column;gap:1rem}button.svelte-1p7cd3z{display:flex;min-width:220px;align-items:center;justify-content:flex-start;gap:.5rem;background-color:var(--bg-light);color:var(--text);font-family:inherit;font-size:1rem;border:0;border-radius:.3rem;padding:.4rem .7rem;cursor:pointer}.options.svelte-1p7cd3z{list-style:none;top:calc(100% + 5px);left:0;width:100%;position:absolute;overflow:auto;background:var(--bg-light);max-height:30vh;overscroll-behavior:none;border-radius:8px;padding:0;margin:0;z-index:100}.option.svelte-1p7cd3z{padding:.2rem .6rem;cursor:pointer;scroll-margin:var(--sms-options-scroll-margin, 100px);text-align:left;display:flex;align-items:center;justify-content:start;gap:.5rem;flex-direction:row}.option.svelte-1p7cd3z:hover{background:var(--bg-light-extra)}body{color:var(--text)}.container.svelte-1wdpzi2{display:flex;height:100vh}aside.svelte-1wdpzi2{width:600px;background-color:var(--bg-dark);overflow-y:auto;overflow-x:hidden;padding:1rem}main.svelte-1wdpzi2{flex:1;padding:1rem;background-color:var(--bg-dark-extra);display:flex;align-items:center;justify-content:center;text-align:center;position:relative}.selector.svelte-1wdpzi2{position:absolute;top:20px;left:50%;translate:-50% 0;color:var(--text-2);font-size:.8rem;z-index:10000}#build.svelte-1lsgswv{position:fixed;top:20;left:20;color:var(--text-2);font-size:.8rem;z-index:10000}
</style>
  </head>
  <body>
    <div id="app"></div>
  </body>
</html>
